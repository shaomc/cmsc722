cscope 15 $HOME/ale/ale_v0.1/src               0000772930
	@common/Array.hxx

22 #iâdeà
ARRAY_HXX


23 
	#ARRAY_HXX


	)

25 
	~<as£¹.h
>

27 
	~"b¥f.hxx
"

29 
Çme¥aû
 
	gCommÚ
 {

31 
	g‹m¶©e
 <
şass
 
	gT
>

32 şas 
	cA¼ay


34 
	g´Ùeùed
:

35 
_ÿ·c™y
;

36 
	g_size
;

37 
T
 *
	g_d©a
;

39 
	gpublic
:

40 
T
 *
	t™”©Ü
;

41 cÚ¡ 
	tT
 *
	tcÚ¡_™”©Ü
;

43 
	gpublic
:

44 
A¼ay
<
T
>(è: 
_ÿ·c™y
(0), 
_size
(0), 
_d©a
(0) {}

45 
	gA¼ay
<
	gT
>(cÚ¡ A¼ay<T>& 
	g¬¿y
è: 
_ÿ·c™y
(0), 
_size
(0), 
_d©a
(0)

47 
	g_size
 = 
¬¿y
.
_size
;

48 
	g_ÿ·c™y
 = 
_size
 + 128;

49 
	g_d©a
 = 
Ãw
 
T
[
_ÿ·c™y
];

50 
	gi
 = 0; i < 
	g_size
; i++)

51 
	g_d©a
[
i
] = 
¬¿y
.
_d©a
[i];

54 ~
	gA¼ay
<
	gT
>()

56 ià(
	g_d©a
)

57 
	gd–‘e
 [] 
	g_d©a
;

60 
push_back
(cÚ¡ 
T
& 
–em’t
)

62 
’su»C­ac™y
(
_size
 + 1);

63 
	g_d©a
[
_size
++] = 
–em’t
;

66 
push_back
(cÚ¡ 
A¼ay
<
T
>& 
¬¿y
)

68 
’su»C­ac™y
(
_size
 + 
¬¿y
._size);

69 
	gi
 = 0; i < 
	g¬¿y
.
	g_size
; i++)

70 
	g_d©a
[
_size
++] = 
¬¿y
.
_d©a
[
i
];

73 
š£¹_©
(
idx
, cÚ¡ 
T
& 
–em’t
)

75 
as£¹
(
idx
 >ğ0 && idx <ğ
_size
);

76 
’su»C­ac™y
(
_size
 + 1);

82 
	gi
 = 
_size
; i > 
	gidx
; i--)

83 
	g_d©a
[
i
] = 
_d©a
[i-1];

85 
	g_d©a
[
idx
] = 
–em’t
;

86 
	g_size
++;

89 
T
 
»move_©
(
idx
)

91 
as£¹
(
idx
 >ğ0 && idx < 
_size
);

92 
T
 
	gtmp
 = 
_d©a
[
idx
];

93 
	gi
 = 
idx
; i < 
	g_size
 - 1; i++)

94 
	g_d©a
[
i
] = 
_d©a
[i+1];

95 
	g_size
--;

96  
	gtmp
;

101 
	gT
& 
	gİ”©Ü
 [](
	gidx
)

103 
as£¹
(
idx
 >ğ0 && idx < 
_size
);

104  
	g_d©a
[
idx
];

107 cÚ¡ 
	gT
& 
	gİ”©Ü
 [](
	gidx
) const

109 
as£¹
(
idx
 >ğ0 && idx < 
_size
);

110  
	g_d©a
[
idx
];

113 
	gA¼ay
<
	gT
>& 
	gİ”©Ü
 =(cÚ¡ 
A¼ay
<
T
>& 
¬¿y
)

115 ià(
_d©a
)

116 
d–‘e
 [] 
_d©a
;

117 
	g_size
 = 
¬¿y
.
_size
;

118 
	g_ÿ·c™y
 = 
_size
 + 128;

119 
	g_d©a
 = 
Ãw
 
T
[
_ÿ·c™y
];

120 
	gi
 = 0; i < 
	g_size
; i++)

121 
	g_d©a
[
i
] = 
¬¿y
.
_d©a
[i];

123  *
	gthis
;

126 
size
(ècÚ¡ {  
	g_size
; }

128 
ş—r
()

130 if(
	g_d©a
)

132 
	gd–‘e
 [] 
	g_d©a
;

133 
	g_d©a
 = 0;

135 
	g_size
 = 0;

136 
	g_ÿ·c™y
 = 0;

139 
boŞ
 
isEm±y
() const

141  (
	g_size
 == 0);

144 
™”©Ü
 
begš
()

146  
	g_d©a
;

149 
™”©Ü
 
’d
()

151  
	g_d©a
 + 
	g_size
;

154 
cÚ¡_™”©Ü
 
begš
() const

156  
	g_d©a
;

159 
cÚ¡_™”©Ü
 
’d
() const

161  
	g_d©a
 + 
	g_size
;

164 
boŞ
 
cÚšs
(cÚ¡ 
T
 &
key
) const

166 
cÚ¡_™”©Ü
 
	gi
 = 
begš
(); i !ğ
’d
(); ++i) {

167 ià(*
	gi
 =ğ
key
)

168  
Œue
;

170  
	gçl£
;

173 
	g´Ùeùed
:

174 
’su»C­ac™y
(
Ãw_Ën
)

176 ià(
Ãw_Ën
 <ğ
_ÿ·c™y
)

179 
T
 *
	gŞd_d©a
 = 
_d©a
;

180 
	g_ÿ·c™y
 = 
Ãw_Ën
 + 128;

181 
	g_d©a
 = 
Ãw
 
T
[
_ÿ·c™y
];

183 ià(
	gŞd_d©a
)

186 
	gi
 = 0; i < 
	g_size
; i++)

187 
	g_d©a
[
i
] = 
Şd_d©a
[i];

188 
	gd–‘e
 [] 
	gŞd_d©a
;

195 
	gCommÚ
::
	tA¼ay
<> 
	tIÁA¼ay
;

196 
	gCommÚ
::
	tA¼ay
<
	tboŞ
> 
	tBoŞA¼ay
;

197 
	gCommÚ
::
	tA¼ay
<
	tuIÁ8
> 
	tBy‹A¼ay
;

	@common/GuiUtils.hxx

22 #iâdeà
UTILITIES_HXX


23 
	#UTILITIES_HXX


	)

25 
	~"b¥f.hxx
"

35 
	#kSüŞlB¬Width
 9

	)

39 
	mkOKCmd
 = 'OK ',

40 
	mkClo£Cmd
 = 'CLOS',

41 
	mkNextCmd
 = 'NEXT',

42 
	mkP»vCmd
 = 'PREV',

43 
	mkEd™Cmd
 = 'EDIT',

44 
	mkDeçuÉsCmd
 = 'DEFA',

45 
	mkS‘Pos™iÚCmd
 = 'SETP',

46 
	mkTabChªgedCmd
 = 'TBCH',

47 
	mkCheckAùiÚCmd
 = 'CBAC',

48 
	mkReäeshAÎCmd
 = 'REFA'

51 cÚ¡ 
¡ršg
 
Em±ySŒšg
("");

	@common/RectList.cxx

19 
	~<SDL/SDL.h
>

20 
	~"ReùLi¡.hxx
"

23 
	gReùLi¡
::
	$ReùLi¡
(
Ušt32
 
size
)

25 
cu¼’tSize
 = 
size
;

26 
cu¼’tReù
 = 0;

28 
»ùA¼ay
 = 
Ãw
 
SDL_Reù
[
cu¼’tSize
];

29 
	}
}

32 
	gReùLi¡
::~
	$ReùLi¡
()

34 
d–‘e
[] 
»ùA¼ay
;

35 
	}
}

38 
	gReùLi¡
::
	$add
(
SDL_Reù
* 
ÃwReù
)

40 if(
cu¼’tReù
 >ğ
cu¼’tSize
)

42 
cu¼’tSize
 = currentSize * 2;

43 
SDL_Reù
 *
‹mp
 = 
Ãw
 SDL_Reù[
cu¼’tSize
];

45 
Ušt32
 
i
 = 0; i < 
cu¼’tReù
; ++i)

46 
‹mp
[
i
] = 
»ùA¼ay
[i];

48 
d–‘e
[] 
»ùA¼ay
;

49 
»ùA¼ay
 = 
‹mp
;

52 
»ùA¼ay
[
cu¼’tReù
].
x
 = 
ÃwReù
->x;

53 
»ùA¼ay
[
cu¼’tReù
].
y
 = 
ÃwReù
->y;

54 
»ùA¼ay
[
cu¼’tReù
].
w
 = 
ÃwReù
->w;

55 
»ùA¼ay
[
cu¼’tReù
].
h
 = 
ÃwReù
->h;

57 ++
cu¼’tReù
;

58 
	}
}

61 
SDL_Reù
* 
	gReùLi¡
::
	$»ùs
()

63  
»ùA¼ay
;

64 
	}
}

67 
Ušt32
 
	gReùLi¡
::
	$numReùs
()

69  
cu¼’tReù
;

70 
	}
}

73 
	gReùLi¡
::
	$¡¬t
()

75 
cu¼’tReù
 = 0;

76 
	}
}

	@common/RectList.hxx

19 #iâdeà
RECTLIST_HXX


20 
	#RECTLIST_HXX


	)

22 
	~<SDL/SDL.h
>

24 şas 
	cReùLi¡


26 
	mpublic
:

27 
ReùLi¡
(
Ušt32
 
size
 = 512);

28 ~
ReùLi¡
();

30 
add
(
SDL_Reù
* 
»ù
);

32 
SDL_Reù
* 
»ùs
();

33 
Ušt32
 
numReùs
();

34 
¡¬t
();

36 
	m´iv©e
:

37 
Ušt32
 
cu¼’tSize
, 
	mcu¼’tReù
;

39 
SDL_Reù
* 
	m»ùA¼ay
;

	@common/SoundNull.cxx

19 
	~"S”Ÿliz”.hxx
"

20 
	~"De£rŸliz”.hxx
"

22 
	~"b¥f.hxx
"

24 
	~"OSy¡em.hxx
"

25 
	~"S‘tšgs.hxx
"

26 
	~"SoundNuÎ.hxx
"

29 
	gSoundNuÎ
::
	$SoundNuÎ
(
OSy¡em
* 
osy¡em
)

30 : 
	$Sound
(
osy¡em
)

33 if(
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("showinfo"))

34 
cout
 << "Sound di§bËd." << 
’dl
 <<ƒndl;

35 
	}
}

38 
	gSoundNuÎ
::~
	$SoundNuÎ
()

40 
	}
}

43 
boŞ
 
SoundNuÎ
::
	$lßd
(
De£rŸliz”
& 
š
)

45 
¡ršg
 
soundDeviû
 = "TIASound";

46 if(
š
.
	`g‘SŒšg
(è!ğ
soundDeviû
)

47  
çl£
;

49 
uIÁ8
 
»g
;

50 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

51 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

52 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

53 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

54 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

55 
»g
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

58 
š
.
	`g‘IÁ
();

60  
Œue
;

61 
	}
}

64 
boŞ
 
	gSoundNuÎ
::
	$§ve
(
S”Ÿliz”
& 
out
)

66 
out
.
	`putSŒšg
("TIASound");

68 
uIÁ8
 
»g
 = 0;

69 
out
.
	`putIÁ
(
»g
);

70 
out
.
	`putIÁ
(
»g
);

71 
out
.
	`putIÁ
(
»g
);

72 
out
.
	`putIÁ
(
»g
);

73 
out
.
	`putIÁ
(
»g
);

74 
out
.
	`putIÁ
(
»g
);

77 
out
.
	`putIÁ
(0);

79  
Œue
;

80 
	}
}

	@common/SoundNull.hxx

19 #iâdeà
SOUND_NULL_HXX


20 
	#SOUND_NULL_HXX


	)

22 
şass
 
	gOSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"Sound.hxx
"

36 şas 
	cSoundNuÎ
 : 
public
 
Sound


38 
public
:

43 
SoundNuÎ
(
OSy¡em
* 
osy¡em
);

48 
	mvœtu®
 ~
SoundNuÎ
();

50 
	mpublic
:

57 
	$£tEÇbËd
(
boŞ
 
’abË
) { }

65 
	$adju¡CyşeCouÁ”
(
IÁ32
 
amouÁ
è{ 
	}
}

72 
	$£tChªÃls
(
uIÁ32
 
chªÃls
è{ 
	}
}

80 
	$£tF¿meR©e
(
uIÁ32
 
äam”©e
è{ 
	}
}

86 
	$š™Ÿlize
(è{ 
	}
}

92 
	$şo£
(è{ 
	}
}

99 
boŞ
 
	$isSucûssfuÎyIn™Ÿlized
(ècÚ¡ {  
çl£
; 
	}
}

106 
	$mu‹
(
boŞ
 
¡©e
è{ 
	}
}

111 
	$»£t
(è{ 
	}
}

120 
	$£t
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
, 
IÁ32
 
cyşe
è{ 
	}
}

129 
	$£tVŞume
(
IÁ32
 
³rûÁ
è{ 
	}
}

137 
	$adju¡VŞume
(
IÁ8
 
dœeùiÚ
è{ 
	}
}

139 
	gpublic
:

146 
boŞ
 
lßd
(
De£rŸliz”
& 
š
);

154 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
);

	@common/SoundSDL.cxx

19 #ifdeà
SOUND_SUPPORT


21 
	~<s¡»am
>

22 
	~<ÿs£¹
>

23 
	~<cm©h
>

24 
	~<SDL/SDL.h
>

26 
	~"TIASnd.hxx
"

27 
	~"F¿meBufãr.hxx
"

28 
	~"S”Ÿliz”.hxx
"

29 
	~"De£rŸliz”.hxx
"

30 
	~"S‘tšgs.hxx
"

31 
	~"Sy¡em.hxx
"

32 
	~"OSy¡em.hxx
"

34 
	~"SoundSDL.hxx
"

37 
	gSoundSDL
::
	$SoundSDL
(
OSy¡em
* 
osy¡em
)

38 : 
	`Sound
(
osy¡em
),

39 
	`myIsEÇbËd
(
osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("sound")),

40 
	`myIsIn™ŸlizedFÏg
(
çl£
),

41 
	`myLa¡Regi¡”S‘Cyşe
(0),

42 
	`myDi¥ÏyF¿meR©e
(60),

43 
	`myNumChªÃls
(1),

44 
	`myF¿gm’tSizeLogBa£2
(0),

45 
	`myIsMu‹d
(
çl£
),

46 
	$myVŞume
(100)

48 
	}
}

51 
	gSoundSDL
::~
	$SoundSDL
()

54 
	`şo£
();

55 
	}
}

58 
	gSoundSDL
::
	$£tEÇbËd
(
boŞ
 
¡©e
)

60 
myIsEÇbËd
 = 
¡©e
;

61 
myOSy¡em
->
	`£‰šgs
().
	`£tBoŞ
("sound", 
¡©e
);

62 
	}
}

65 
	gSoundSDL
::
	$š™Ÿlize
()

68 if(!
myIsEÇbËd
)

70 
	`şo£
();

71 if(
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("showinfo"))

72 
û¼
 << "Sound di§bËd." << 
’dl
 <<ƒndl;

77 
myRegWr™eQueue
.
	`ş—r
();

78 
myTIASound
.
	`»£t
();

80 if(!((
	`SDL_WasIn™
(
SDL_INIT_AUDIO
) & SDL_INIT_AUDIO) > 0))

82 
myIsIn™ŸlizedFÏg
 = 
çl£
;

83 
myIsMu‹d
 = 
çl£
;

84 
myLa¡Regi¡”S‘Cyşe
 = 0;

86 if(
	`SDL_In™SubSy¡em
(
SDL_INIT_AUDIO
) < 0)

88 
û¼
 << "WARNING: Couldn'ˆš™ŸlizSDL‡udiØsy¡em! " << 
’dl
;

89 
û¼
 << " " << 
	`SDL_G‘E¼Ü
(è<< 
’dl
;

94 
uIÁ32
 
äagsize
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("fragsize");

95 
IÁ32
 
äequ’cy
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("freq");

96 
IÁ32
 
tŸäeq
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("tiafreq");

98 
SDL_AudioS³c
 
desœed
;

99 
desœed
.
äeq
 = 
äequ’cy
;

100 #iâdeà
GP2X


101 
desœed
.
fÜm©
 = 
AUDIO_U8
;

103 
desœed
.
fÜm©
 = 
AUDIO_U16
;

105 
desœed
.
chªÃls
 = 
myNumChªÃls
;

106 
desœed
.
§m¶es
 = 
äagsize
;

107 
desœed
.
ÿÎback
 = callback;

108 
desœed
.
u£rd©a
 = (*)
this
;

110 if(
	`SDL_O³nAudio
(&
desœed
, &
myH¬dw¬eS³c
) < 0)

112 
û¼
 << "WARNING: Couldn'ˆİ’ SDL‡udiØsy¡em! " << 
’dl
;

113 
û¼
 << " " << 
	`SDL_G‘E¼Ü
(è<< 
’dl
;

119 if((()
myH¬dw¬eS³c
.
§m¶es
 / ()myH¬dw¬eS³c.
äeq
) >= 0.25)

121 
û¼
 << "WARNING: Sound device doesn't support„ealtime‡udio! Make ";

122 
û¼
 << "su»‡ sound" << 
’dl
;

123 
û¼
 << " s”v” i¢'ˆruÂšg. AudiØi di§bËd." << 
’dl
;

125 
	`SDL_Clo£Audio
();

129 
myIsIn™ŸlizedFÏg
 = 
Œue
;

130 
myIsMu‹d
 = 
çl£
;

131 
myF¿gm’tSizeLogBa£2
 = 
	`log
(()
myH¬dw¬eS³c
.
§m¶es
) /†og(2.0);

143 
myTIASound
.
	`ouutF»qu’cy
(
myH¬dw¬eS³c
.
äeq
);

144 
myTIASound
.
	`tŸF»qu’cy
(
tŸäeq
);

145 
myTIASound
.
	`chªÃls
(
myH¬dw¬eS³c
.
chªÃls
);

147 
boŞ
 
şvŞ
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("clipvol");

148 
myTIASound
.
	`şVŞume
(
şvŞ
);

151 
myVŞume
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("volume");

152 
	`£tVŞume
(
myVŞume
);

155 if(
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("showinfo"))

156 
û¼
 << "SoundƒÇbËd:" << 
’dl


157 << " VŞum : " << 
myVŞume
 << 
’dl


158 << " F¿g siz : " << 
äagsize
 << 
’dl


159 << " F»qu’cy : " << 
myH¬dw¬eS³c
.
äeq
 << 
’dl


160 << " FÜm© : " << 
myH¬dw¬eS³c
.
fÜm©
 << 
’dl


161 << " TIA F»q. : " << 
tŸäeq
 << 
’dl


162 << " ChªÃl  : " << 
myNumChªÃls
 << 
’dl


163 << " Cl vŞume: " << ()
şvŞ
 << 
’dl
 <<ƒndl;

168 if(
myIsIn™ŸlizedFÏg
)

170 
	`SDL_Pau£Audio
(0);

172 
	}
}

175 
	gSoundSDL
::
	$şo£
()

177 if(
myIsIn™ŸlizedFÏg
)

179 
	`SDL_Clo£Audio
();

180 
myIsIn™ŸlizedFÏg
 = 
çl£
;

182 
	}
}

185 
boŞ
 
	gSoundSDL
::
	$isSucûssfuÎyIn™Ÿlized
() const

187  
myIsIn™ŸlizedFÏg
;

188 
	}
}

191 
	gSoundSDL
::
	$mu‹
(
boŞ
 
¡©e
)

193 if(
myIsIn™ŸlizedFÏg
)

196 if(
myIsMu‹d
 =ğ
¡©e
)

201 
myIsMu‹d
 = 
¡©e
;

203 
	`SDL_Pau£Audio
(
myIsMu‹d
 ? 1 : 0);

204 
myRegWr™eQueue
.
	`ş—r
();

206 
	}
}

209 
	gSoundSDL
::
	$»£t
()

211 if(
myIsIn™ŸlizedFÏg
)

213 
	`SDL_Pau£Audio
(1);

214 
myIsMu‹d
 = 
çl£
;

215 
myLa¡Regi¡”S‘Cyşe
 = 0;

216 
myTIASound
.
	`»£t
();

217 
myRegWr™eQueue
.
	`ş—r
();

218 
	`SDL_Pau£Audio
(0);

220 
	}
}

223 
	gSoundSDL
::
	$£tVŞume
(
IÁ32
 
³rûÁ
)

225 if(
myIsIn™ŸlizedFÏg
)

227 if((
³rûÁ
 >= 0) && (percent <= 100))

229 
myOSy¡em
->
	`£‰šgs
().
	`£tIÁ
("vŞume", 
³rûÁ
);

230 
	`SDL_LockAudio
();

231 
myVŞume
 = 
³rûÁ
;

232 
myTIASound
.
	`vŞume
(
³rûÁ
);

233 
	`SDL_UÆockAudio
();

236 
	}
}

239 
	gSoundSDL
::
	$adju¡VŞume
(
IÁ8
 
dœeùiÚ
)

241 
o¡ršg¡»am
 
¡rv®
;

242 
¡ršg
 
mes§ge
;

244 
IÁ32
 
³rûÁ
 = 
myVŞume
;

246 if(
dœeùiÚ
 == -1)

247 
³rûÁ
 -= 2;

248 if(
dœeùiÚ
 == 1)

249 
³rûÁ
 += 2;

251 if((
³rûÁ
 < 0) || (percent > 100))

254 
	`£tVŞume
(
³rûÁ
);

257 
¡rv®
 << 
³rûÁ
;

258 
mes§ge
 = "Volume seto ";

259 
mes§ge
 +ğ
¡rv®
.
	`¡r
();

261 
myOSy¡em
->
	`äameBufãr
().
	`showMes§ge
(
mes§ge
);

262 
	}
}

265 
	gSoundSDL
::
	$adju¡CyşeCouÁ”
(
IÁ32
 
amouÁ
)

267 
myLa¡Regi¡”S‘Cyşe
 +ğ
amouÁ
;

268 
	}
}

271 
	gSoundSDL
::
	$£tChªÃls
(
uIÁ32
 
chªÃls
)

273 if(
chªÃls
 == 1 || channels == 2)

274 
myNumChªÃls
 = 
chªÃls
;

275 
	}
}

278 
	gSoundSDL
::
	$£tF¿meR©e
(
uIÁ32
 
äam”©e
)

281 
myDi¥ÏyF¿meR©e
 = 
äam”©e
;

282 
myLa¡Regi¡”S‘Cyşe
 = 0;

283 
	}
}

286 
	gSoundSDL
::
	$£t
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
, 
IÁ32
 
cyşe
)

288 
	`SDL_LockAudio
();

292 
d–
 = ((()(
cyşe
 - 
myLa¡Regi¡”S‘Cyşe
)) /

299 
d–
 = d– * (
myDi¥ÏyF¿meR©e
 / ()
myOSy¡em
->
	`äameR©e
());

300 
RegWr™e
 
šfo
;

301 
šfo
.
addr
 =‡ddr;

302 
šfo
.
v®ue
 = value;

303 
šfo
.
d–
 = delta;

304 
myRegWr™eQueue
.
	`’queue
(
šfo
);

307 
myLa¡Regi¡”S‘Cyşe
 = 
cyşe
;

309 
	`SDL_UÆockAudio
();

310 
	}
}

313 
	gSoundSDL
::
	$´oûssF¿gm’t
(
uIÁ8
* 
¡»am
, 
IÁ32
 
Ëngth
)

315 if(!
myIsIn™ŸlizedFÏg
)

318 
uIÁ32
 
chªÃls
 = 
myH¬dw¬eS³c
.channels;

319 
Ëngth
 =†’gth / 
chªÃls
;

322 if(
myRegWr™eQueue
.
	`du¿tiÚ
() >

323 (
myF¿gm’tSizeLogBa£2
 / 
myDi¥ÏyF¿meR©e
))

325 
»moved
 = 0.0;

326 
»moved
 < ((
myF¿gm’tSizeLogBa£2
 - 1è/ 
myDi¥ÏyF¿meR©e
))

328 
RegWr™e
& 
šfo
 = 
myRegWr™eQueue
.
	`äÚt
();

329 
»moved
 +ğ
šfo
.
d–
;

330 
myTIASound
.
	`£t
(
šfo
.
addr
, info.
v®ue
);

331 
myRegWr™eQueue
.
	`dequeue
();

336 
pos™iÚ
 = 0.0;

337 
»maššg
 = 
Ëngth
;

339 
»maššg
 > 0.0)

341 if(
myRegWr™eQueue
.
	`size
() == 0)

346 
myTIASound
.
	`´oûss
(
¡»am
 + ((
uIÁ32
)
pos™iÚ
 * 
chªÃls
),

347 
Ëngth
 - (
uIÁ32
)
pos™iÚ
);

353 
myLa¡Regi¡”S‘Cyşe
 = 0;

360 
RegWr™e
& 
šfo
 = 
myRegWr™eQueue
.
	`äÚt
();

363 
du¿tiÚ
 = 
»maššg
 / ()
myH¬dw¬eS³c
.
äeq
;

366 if(
šfo
.
d–
 <ğ
du¿tiÚ
)

370 if(
šfo
.
d–
 > 0.0)

374 
§m¶es
 = (
myH¬dw¬eS³c
.
äeq
 * 
šfo
.
d–
);

378 
myTIASound
.
	`´oûss
(
¡»am
 + ((
uIÁ32
)
pos™iÚ
 * 
chªÃls
),

379 (
uIÁ32
)
§m¶es
 + (uIÁ32)(
pos™iÚ
 + samples) -

380 ((
uIÁ32
)
pos™iÚ
 + (uIÁ32)
§m¶es
));

382 
pos™iÚ
 +ğ
§m¶es
;

383 
»maššg
 -ğ
§m¶es
;

385 
myTIASound
.
	`£t
(
šfo
.
addr
, info.
v®ue
);

386 
myRegWr™eQueue
.
	`dequeue
();

394 
myTIASound
.
	`´oûss
(
¡»am
 + ((
uIÁ32
)
pos™iÚ
 * 
chªÃls
),

395 
Ëngth
 - (
uIÁ32
)
pos™iÚ
);

396 
šfo
.
d–
 -ğ
du¿tiÚ
;

401 
	}
}

404 
	gSoundSDL
::
	$ÿÎback
(* 
ud©a
, 
uIÁ8
* 
¡»am
, 
Ën
)

406 
SoundSDL
* 
sound
 = (SoundSDL*)
ud©a
;

407 
sound
->
	`´oûssF¿gm’t
(
¡»am
, (
IÁ32
)
Ën
);

408 #ifdeà
ATARIVOX_SUPPORT


409 
û¼
 << "SoundSDL::ÿÎback():†’==" << 
Ën
 << 
’dl
;

412 
AriVox
 *
vox
 = 
sound
->
myOSy¡em
->
	`cÚsŞe
().
	`©¬iVox
();

413 if(
vox
)

416 
uIÁ8
 *
s
 = 
¡»am
;

417 
i
=0; i<
Ën
/
OUTPUT_BUFFER_SIZE
; i++)

419 
couÁ
;

420 
uIÁ8
 *
voxSam¶es
 = 
vox
->
	`g‘S³akJ‘
()->
	`g‘Sam¶es
(&
couÁ
);

421 if(!
couÁ
)

423 
	`SDL_MixAudio
(
s
, 
voxSam¶es
, 
OUTPUT_BUFFER_SIZE
, 
SDL_MIX_MAXVOLUME
);

424 
s
 +ğ
OUTPUT_BUFFER_SIZE
;

428 
	}
}

431 
boŞ
 
	gSoundSDL
::
	$lßd
(
De£rŸliz”
& 
š
)

433 
¡ršg
 
deviû
 = "TIASound";

435 
Œy


437 if(
š
.
	`g‘SŒšg
(è!ğ
deviû
)

438  
çl£
;

440 
uIÁ8
 
»g1
 = 0, 
»g2
 = 0, 
»g3
 = 0, 
»g4
 = 0, 
»g5
 = 0, 
»g6
 = 0;

441 
»g1
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

442 
»g2
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

443 
»g3
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

444 
»g4
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

445 
»g5
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

446 
»g6
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

448 
myLa¡Regi¡”S‘Cyşe
 = (
IÁ32
è
š
.
	`g‘IÁ
();

452 if(
myIsIn™ŸlizedFÏg
)

454 
	`SDL_Pau£Audio
(1);

455 
myRegWr™eQueue
.
	`ş—r
();

456 
myTIASound
.
	`£t
(0x15, 
»g1
);

457 
myTIASound
.
	`£t
(0x16, 
»g2
);

458 
myTIASound
.
	`£t
(0x17, 
»g3
);

459 
myTIASound
.
	`£t
(0x18, 
»g4
);

460 
myTIASound
.
	`£t
(0x19, 
»g5
);

461 
myTIASound
.
	`£t
(0x1a, 
»g6
);

462 
	`SDL_Pau£Audio
(0);

465 
	`ÿtch
(*
msg
)

467 
û¼
 << 
msg
 << 
’dl
;

468  
çl£
;

470 
	`ÿtch
(...)

472 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
deviû
 << 
’dl
;

473  
çl£
;

476  
Œue
;

477 
	}
}

480 
boŞ
 
	gSoundSDL
::
	$§ve
(
S”Ÿliz”
& 
out
)

482 
¡ršg
 
deviû
 = "TIASound";

484 
Œy


486 
out
.
	`putSŒšg
(
deviû
);

488 
uIÁ8
 
»g1
 = 0, 
»g2
 = 0, 
»g3
 = 0, 
»g4
 = 0, 
»g5
 = 0, 
»g6
 = 0;

491 if(
myIsIn™ŸlizedFÏg
)

493 
»g1
 = 
myTIASound
.
	`g‘
(0x15);

494 
»g2
 = 
myTIASound
.
	`g‘
(0x16);

495 
»g3
 = 
myTIASound
.
	`g‘
(0x17);

496 
»g4
 = 
myTIASound
.
	`g‘
(0x18);

497 
»g5
 = 
myTIASound
.
	`g‘
(0x19);

498 
»g6
 = 
myTIASound
.
	`g‘
(0x1a);

501 
out
.
	`putIÁ
(
»g1
);

502 
out
.
	`putIÁ
(
»g2
);

503 
out
.
	`putIÁ
(
»g3
);

504 
out
.
	`putIÁ
(
»g4
);

505 
out
.
	`putIÁ
(
»g5
);

506 
out
.
	`putIÁ
(
»g6
);

508 
out
.
	`putIÁ
(
myLa¡Regi¡”S‘Cyşe
);

510 
	`ÿtch
(*
msg
)

512 
û¼
 << 
msg
 << 
’dl
;

513  
çl£
;

515 
	`ÿtch
(...)

517 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
deviû
 << 
’dl
;

518  
çl£
;

521  
Œue
;

522 
	}
}

525 
	gSoundSDL
::
RegWr™eQueue
::
	$RegWr™eQueue
(
uIÁ32
 
ÿ·c™y
)

526 : 
	`myC­ac™y
(
ÿ·c™y
),

527 
	`myBufãr
(0),

528 
	`mySize
(0),

529 
	`myH—d
(0),

530 
	$myTa
(0)

532 
myBufãr
 = 
Ãw
 
RegWr™e
[
myC­ac™y
];

533 
	}
}

536 
	gSoundSDL
::
RegWr™eQueue
::~
	$RegWr™eQueue
()

538 
d–‘e
[] 
myBufãr
;

539 
	}
}

542 
	gSoundSDL
::
RegWr™eQueue
::
	$ş—r
()

544 
myH—d
 = 
myTa
 = 
mySize
 = 0;

545 
	}
}

548 
	gSoundSDL
::
RegWr™eQueue
::
	$dequeue
()

550 if(
mySize
 > 0)

552 
myH—d
 = (myH—d + 1è% 
myC­ac™y
;

553 --
mySize
;

555 
	}
}

558 
	gSoundSDL
::
RegWr™eQueue
::
	$du¿tiÚ
()

560 
du¿tiÚ
 = 0.0;

561 
uIÁ32
 
i
 = 0; i < 
mySize
; ++i)

563 
du¿tiÚ
 +ğ
myBufãr
[(
myH—d
 + 
i
è% 
myC­ac™y
].
d–
;

565  
du¿tiÚ
;

566 
	}
}

569 
	gSoundSDL
::
RegWr™eQueue
::
	$’queue
(cÚ¡ 
RegWr™e
& 
šfo
)

573 if(
mySize
 =ğ
myC­ac™y
)

575 
	`grow
();

578 
myBufãr
[
myTa
] = 
šfo
;

579 
myTa
 = (myTa + 1è% 
myC­ac™y
;

580 ++
mySize
;

581 
	}
}

584 
	gSoundSDL
::
RegWr™e
& 
SoundSDL
::
RegWr™eQueue
::
	$äÚt
()

586 
	`as£¹
(
mySize
 != 0);

587  
myBufãr
[
myH—d
];

588 
	}
}

591 
uIÁ32
 
	gSoundSDL
::
RegWr™eQueue
::
	$size
() const

593  
mySize
;

594 
	}
}

597 
	gSoundSDL
::
RegWr™eQueue
::
	$grow
()

599 
RegWr™e
* 
bufãr
 = 
Ãw
 RegWr™e[
myC­ac™y
 * 2];

600 
uIÁ32
 
i
 = 0; i < 
mySize
; ++i)

602 
bufãr
[
i
] = 
myBufãr
[(
myH—d
 + iè% 
myC­ac™y
];

604 
myH—d
 = 0;

605 
myTa
 = 
mySize
;

606 
myC­ac™y
 = myCapacity * 2;

607 
d–‘e
[] 
myBufãr
;

608 
myBufãr
 = 
bufãr
;

609 
	}
}

	@common/SoundSDL.hxx

19 #iâdeà
SOUND_SDL_HXX


20 
	#SOUND_SDL_HXX


	)

22 #ifdeà
SOUND_SUPPORT


24 
şass
 
	gOSy¡em
;

26 
	~<SDL/SDL.h
>

28 
	~"Sound.hxx
"

29 
	~"b¥f.hxx
"

30 
	~"MedŸSrc.hxx
"

31 
	~"TIASnd.hxx
"

39 şas 
	cSoundSDL
 : 
public
 
Sound


41 
public
:

46 
SoundSDL
(
OSy¡em
* 
osy¡em
);

51 
	mvœtu®
 ~
SoundSDL
();

53 
	mpublic
:

59 
£tEÇbËd
(
boŞ
 
¡©e
);

67 
adju¡CyşeCouÁ”
(
IÁ32
 
amouÁ
);

74 
£tChªÃls
(
uIÁ32
 
chªÃls
);

82 
£tF¿meR©e
(
uIÁ32
 
äam”©e
);

88 
š™Ÿlize
();

94 
şo£
();

101 
boŞ
 
	$isSucûssfuÎyIn™Ÿlized
() const;

108 
	`mu‹
(
boŞ
 
¡©e
);

113 
	`»£t
();

122 
	`£t
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
, 
IÁ32
 
cyşe
);

131 
	`£tVŞume
(
IÁ32
 
³rûÁ
);

139 
	`adju¡VŞume
(
IÁ8
 
dœeùiÚ
);

141 
public
:

148 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

156 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

158 
´Ùeùed
:

165 
	`´oûssF¿gm’t
(
uIÁ8
* 
¡»am
, 
IÁ32
 
Ëngth
);

167 
´Ùeùed
:

169 
	sRegWr™e


171 
uIÁ16
 
addr
;

172 
uIÁ8
 
v®ue
;

173 
d–
;

180 şas 
	cRegWr™eQueue


182 
public
:

188 
	`RegWr™eQueue
(
uIÁ32
 
ÿ·c™y
 = 512);

193 
vœtu®
 ~
	`RegWr™eQueue
();

195 
public
:

199 
	`ş—r
();

204 
	`dequeue
();

209 
	`du¿tiÚ
();

214 
	`’queue
(cÚ¡ 
RegWr™e
& 
šfo
);

221 
RegWr™e
& 
	`äÚt
();

228 
uIÁ32
 
	`size
() const;

230 
´iv©e
:

232 
	`grow
();

234 
´iv©e
:

235 
uIÁ32
 
myC­ac™y
;

236 
RegWr™e
* 
myBufãr
;

237 
uIÁ32
 
mySize
;

238 
uIÁ32
 
myH—d
;

239 
uIÁ32
 
myTa
;

240 
	}
};

242 
	g´iv©e
:

244 
TIASound
 
myTIASound
;

247 
boŞ
 
	gmyIsEÇbËd
;

250 
boŞ
 
	gmyIsIn™ŸlizedFÏg
;

253 
IÁ32
 
	gmyLa¡Regi¡”S‘Cyşe
;

256 
uIÁ32
 
	gmyDi¥ÏyF¿meR©e
;

259 
uIÁ32
 
	gmyNumChªÃls
;

262 
	gmyF¿gm’tSizeLogBa£2
;

265 
boŞ
 
	gmyIsMu‹d
;

268 
uIÁ32
 
	gmyVŞume
;

271 
SDL_AudioS³c
 
	gmyH¬dw¬eS³c
;

274 
RegWr™eQueue
 
	gmyRegWr™eQueue
;

276 
	g´iv©e
:

278 
ÿÎback
(* 
ud©a
, 
uIÁ8
* 
¡»am
, 
Ën
);

	@common/Version.hxx

19 #iâdeà
VERSION_HXX


20 
	#VERSION_HXX


	)

22 
	#STELLA_BASE_VERSION
 "2.4.2"

	)

24 #ifdeà
NIGHTLY_BUILD


25 
	#STELLA_VERSION
 
STELLA_BASE_VERSION
 "´e-" 
NIGHTLY_BUILD


	)

27 
	#STELLA_VERSION
 
STELLA_BASE_VERSION


	)

	@common/VideoModeList.hxx

19 #iâdeà
VIDMODE_LIST_HXX


20 
	#VIDMODE_LIST_HXX


	)

22 
	~"A¼ay.hxx
"

23 
	~"b¥f.hxx
"

25 
	sVideoMode
 {

26 
uIÁ32
 
	mimage_x
, 
	mimage_y
, 
	mimage_w
, 
	mimage_h
;

27 
uIÁ32
 
	msü“n_w
, 
	msü“n_h
;

28 
uIÁ32
 
	mzoom
;

29 
¡ršg
 
	mÇme
;

38 şas 
	cVideoModeLi¡


40 
	mpublic
:

41 
	$VideoModeLi¡
(è: 
	`myIdx
(-1) { }

43 
	$add
(
VideoMode
 
mode
è{ 
myModeLi¡
.
	`push_back
(mode); 
	}
}

45 
	$ş—r
(è{ 
myModeLi¡
.
	`ş—r
(); 
	}
}

47 
boŞ
 
	$isEm±y
(ècÚ¡ {  
myModeLi¡
.
	`isEm±y
(); 
	}
}

49 
uIÁ32
 
	$size
(ècÚ¡ {  
myModeLi¡
.
	`size
(); 
	}
}

51 cÚ¡ 
	gVideoMode
& 
	$´evious
()

53 --
myIdx
;

54 if(
myIdx
 < 0èmyIdx = 
myModeLi¡
.
	`size
() - 1;

55  
	`cu¼’t
();

56 
	}
}

58 cÚ¡ 
	gVideoMode
& 
	$cu¼’t
() const

60  
myModeLi¡
[
myIdx
];

61 
	}
}

63 cÚ¡ 
	gVideoMode
& 
	$Ãxt
()

65 
myIdx
 = (myIdx + 1è% 
myModeLi¡
.
	`size
();

66  
	`cu¼’t
();

67 
	}
}

69 
	$£tByResŞutiÚ
(
uIÁ32
 
width
, uIÁ32 
height
)

72 
myIdx
 = 
myModeLi¡
.
	`size
() - 1;

73 
i
 = 0; i < 
myModeLi¡
.
	`size
(); ++i)

75 if(
width
 <ğ
myModeLi¡
[
i
].
sü“n_w
 && 
height
 <ğmyModeLi¡[i].
sü“n_h
)

77 
myIdx
 = 
i
;

81 
	}
}

83 
	$£tByZoom
(
uIÁ32
 
zoom
)

86 
myIdx
 = 0;

87 
i
 = 
myModeLi¡
.
	`size
() - 1; i; --i)

89 if(
myModeLi¡
[
i
].
zoom
 <= zoom)

91 
myIdx
 = 
i
;

95 
	}
}

97 
	g´iv©e
:

98 
CommÚ
::
A¼ay
<
VideoMode
> 
myModeLi¡
;

99 
	gmyIdx
;

	@common/export_screen.cpp

9 
	~<zlib.h
>

10 
	~<f¡»am
>

11 
	~<c¡ršg
>

12 
	~<s¡»am
>

13 
	~"OSy¡em.hxx
"

14 
	~"expÜt_sü“n.h
"

15 
	~"¿ndom_toŞs.h
"

16 
	~"veùÜ_m©rix_toŞs.h
"

18 
	gExpÜtSü“n
::
	$ExpÜtSü“n
(
OSy¡em
* 
osy¡em
) {

19 
p_osy¡em
 = 
osy¡em
;

20 
pi_·Ë‰e
 = 
NULL
;

21 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

22 
p_´İs
 = &
p_osy¡em
->
	`cÚsŞe
().
	`´İ”t›s
();

23 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

24 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

25 
	`š™_cu¡om_·Î‘e
();

26 
	}
}

32 
	gExpÜtSü“n
::
	$§ve_²g
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
, cÚ¡ 
¡ršg
& 
f’ame
) {

33 
uIÁ8
* 
bufãr
 = (uIÁ8*è
NULL
;

34 
uIÁ8
* 
compmem
 = (uIÁ8*è
NULL
;

35 
of¡»am
 
out
;

37 
Œy
 {

40 
out
.
	`İ’
(
f’ame
.
	`c_¡r
(), 
ios_ba£
::
bš¬y
);

41 if(!
out
)

42 
throw
 "Couldn't open PNG file";

45 
uIÁ8
 
h—d”
[8] = { 137, 80, 78, 71, 13, 10, 26, 10 };

46 
out
.
	`wr™e
((cÚ¡ *)
h—d”
, 8);

49 
uIÁ8
 
ihdr
[13];

50 
ihdr
[0] = 
i_sü“n_width
 >> 24;

51 
ihdr
[1] = 
i_sü“n_width
 >> 16;

52 
ihdr
[2] = 
i_sü“n_width
 >> 8;

53 
ihdr
[3] = 
i_sü“n_width
 & 0xFF;

54 
ihdr
[4] = 
i_sü“n_height
 >> 24;

55 
ihdr
[5] = 
i_sü“n_height
 >> 16;

56 
ihdr
[6] = 
i_sü“n_height
 >> 8;

57 
ihdr
[7] = 
i_sü“n_height
 & 0xFF;

58 
ihdr
[8] = 8;

59 
ihdr
[9] = 2;

60 
ihdr
[10] = 0;

61 
ihdr
[11] = 0;

62 
ihdr
[12] = 0;

63 
	`wr™ePNGChunk
(
out
, "IHDR", 
ihdr
, 13);

66 
rowby‹s
 = 
i_sü“n_width
 * 3;

67 
bufãr
 = 
Ãw
 
uIÁ8
[(
rowby‹s
 + 1è* 
i_sü“n_height
];

68 
uIÁ8
* 
buf_±r
 = 
bufãr
;

69 
i
 = 0; i < 
i_sü“n_height
; i++) {

70 *
buf_±r
++ = 0;

71 
j
 = 0; j < 
i_sü“n_width
; j++) {

72 
r
, 
g
, 
b
;

73 
	`g‘_rgb_äom_·Î‘e
((*
sü“n_m©rix
)[
i
][
j
], 
r
, 
g
, 
b
);

74 
buf_±r
[
j
 * 3 + 0] = 
r
;

75 
buf_±r
[
j
 * 3 + 1] = 
g
;

76 
buf_±r
[
j
 * 3 + 2] = 
b
;

78 
buf_±r
 +ğ
rowby‹s
;

82 
uLÚgf
 
compmemsize
 = (uLÚgf)((
i_sü“n_height
 * (
i_sü“n_width
 + 1)

84 
compmem
 = 
Ãw
 
uIÁ8
[
compmemsize
];

85 if(
compmem
 =ğ
NULL
 ||

86 (
	`com´ess
(
compmem
, &
compmemsize
, 
bufãr
, 
i_sü“n_height
 *

87 (
i_sü“n_width
 * 3 + 1)è!ğ
Z_OK
))

88 
throw
 "Error: Couldn't compress PNG";

91 
	`wr™ePNGChunk
(
out
, "IDAT", 
compmem
, 
compmemsize
);

94 
	`wr™ePNGText
(
out
, "ROM Name", 
p_´İs
->
	`g‘
(
C¬Œidge_Name
));

95 
	`wr™ePNGText
(
out
, "ROM MD5", 
p_´İs
->
	`g‘
(
C¬Œidge_MD5
));

96 
	`wr™ePNGText
(
out
, "Di¥Ïy FÜm©", 
p_´İs
->
	`g‘
(
Di¥Ïy_FÜm©
));

99 
	`wr™ePNGChunk
(
out
, "IEND", 0, 0);

102 if(
bufãr
è
d–‘e
[] buffer;

103 if(
compmem
è
d–‘e
[] compmem;

104 
out
.
	`şo£
();

107 
	`ÿtch
(cÚ¡ *
msg
)

109 if(
bufãr
è
d–‘e
[] buffer;

110 if(
compmem
è
d–‘e
[] compmem;

111 
out
.
	`şo£
();

112 
û¼
 << 
msg
 << 
’dl
;

114 
	}
}

120 
	gExpÜtSü“n
::
	$§ve_h—t_¶Ù
(
FlßtM©rix
* 
pm_m©rix
,

121 cÚ¡ 
¡ršg
& 
f’ame
) {

122 
uIÁ8
* 
bufãr
 = (uIÁ8*è
NULL
;

123 
uIÁ8
* 
compmem
 = (uIÁ8*è
NULL
;

124 
of¡»am
 
out
;

125 
height
 = ()
pm_m©rix
->
	`size
();

126 
	`as£¹
(
height
 > 0);

127 
width
 = (*
pm_m©rix
)[0].
	`size
();

128 
	`as£¹
(
width
 > 0);

129 
	`nÜm®ize_m©rix
(
pm_m©rix
);

131 
Œy
 {

132 
out
.
	`İ’
(
f’ame
.
	`c_¡r
(), 
ios_ba£
::
bš¬y
);

133 if(!
out
)

134 
throw
 "Couldn't open PNG file";

137 
uIÁ8
 
h—d”
[8] = { 137, 80, 78, 71, 13, 10, 26, 10 };

138 
out
.
	`wr™e
((cÚ¡ *)
h—d”
, 8);

141 
uIÁ8
 
ihdr
[13];

142 
ihdr
[0] = 
width
 >> 24;

143 
ihdr
[1] = 
width
 >> 16;

144 
ihdr
[2] = 
width
 >> 8;

145 
ihdr
[3] = 
width
 & 0xFF;

146 
ihdr
[4] = 
height
 >> 24;

147 
ihdr
[5] = 
height
 >> 16;

148 
ihdr
[6] = 
height
 >> 8;

149 
ihdr
[7] = 
height
 & 0xFF;

150 
ihdr
[8] = 8;

151 
ihdr
[9] = 2;

152 
ihdr
[10] = 0;

153 
ihdr
[11] = 0;

154 
ihdr
[12] = 0;

155 
	`wr™ePNGChunk
(
out
, "IHDR", 
ihdr
, 13);

158 
rowby‹s
 = 
width
 * 3;

159 
bufãr
 = 
Ãw
 
uIÁ8
[(
rowby‹s
 + 1è* 
height
];

160 
uIÁ8
* 
buf_±r
 = 
bufãr
;

161 
FlßtM©rix
::
™”©Ü
 
™_row
 = 
pm_m©rix
->
	`begš
();

162 
™_row
 !ğ
pm_m©rix
->
	`’d
(); ++it_row) {

163 *
buf_±r
++ = 0;

164 
j
 = 0;

165 
FlßtVeù
::
™”©Ü
 
™_cŞ
 = (*
™_row
).
	`begš
();

166 
™_cŞ
 !ğ(*
™_row
).
	`’d
(); ++it_col) {

167 
r
, 
g
, 
b
;

168 
v®
 = (*
™_cŞ
);

169 ià(
v®
 == 1313.0) {

170 
r
 = 255; 
g
 = 0; 
b
 = 0;

171 } ià(
v®
 == 1314.0) {

172 
r
 = 0; 
g
 = 0; 
b
 = 0;

174 
r
 = ()(255.0 * 
v®
);

175 
g
 = ()(255.0 * 
v®
);

176 
b
 = ()(255.0 * 
v®
);

178 
buf_±r
[
j
 * 3 + 0] = 
r
;

179 
buf_±r
[
j
 * 3 + 1] = 
g
;

180 
buf_±r
[
j
 * 3 + 2] = 
b
;

181 
j
++;

183 
buf_±r
 +ğ
rowby‹s
;

187 
uLÚgf
 
compmemsize
 = (uLÚgf)((
height
 * (
width
 + 1)

189 
compmem
 = 
Ãw
 
uIÁ8
[
compmemsize
];

190 if(
compmem
 =ğ
NULL
 ||

191 (
	`com´ess
(
compmem
, &
compmemsize
, 
bufãr
, 
height
 *

192 (
width
 * 3 + 1)è!ğ
Z_OK
))

193 
throw
 "Error: Couldn't compress PNG";

196 
	`wr™ePNGChunk
(
out
, "IDAT", 
compmem
, 
compmemsize
);

200 
	`wr™ePNGChunk
(
out
, "IEND", 0, 0);

203 if(
bufãr
è
d–‘e
[] buffer;

204 if(
compmem
è
d–‘e
[] compmem;

205 
out
.
	`şo£
();

208 
	`ÿtch
(cÚ¡ *
msg
)

210 if(
bufãr
è
d–‘e
[] buffer;

211 if(
compmem
è
d–‘e
[] compmem;

212 
out
.
	`şo£
();

213 
û¼
 << 
msg
 << 
’dl
;

215 
	}
}

220 
	gExpÜtSü“n
::
	$expÜt_ªy_m©rix
 (cÚ¡ 
IÁM©rix
* 
pm_m©rix
,

221 cÚ¡ 
¡ršg
& 
f’ame
) const {

222 
uIÁ8
* 
bufãr
 = (uIÁ8*è
NULL
;

223 
uIÁ8
* 
compmem
 = (uIÁ8*è
NULL
;

224 
of¡»am
 
out
;

225 
height
 = 
pm_m©rix
->
	`size
();

226 
width
 = (*
pm_m©rix
)[0].
	`size
();

228 
Œy
 {

231 
out
.
	`İ’
(
f’ame
.
	`c_¡r
(), 
ios_ba£
::
bš¬y
);

232 if(!
out
)

233 
throw
 "Couldn't open PNG file";

236 
uIÁ8
 
h—d”
[8] = { 137, 80, 78, 71, 13, 10, 26, 10 };

237 
out
.
	`wr™e
((cÚ¡ *)
h—d”
, 8);

240 
uIÁ8
 
ihdr
[13];

241 
ihdr
[0] = 
width
 >> 24;

242 
ihdr
[1] = 
width
 >> 16;

243 
ihdr
[2] = 
width
 >> 8;

244 
ihdr
[3] = 
width
 & 0xFF;

245 
ihdr
[4] = 
height
 >> 24;

246 
ihdr
[5] = 
height
 >> 16;

247 
ihdr
[6] = 
height
 >> 8;

248 
ihdr
[7] = 
height
 & 0xFF;

249 
ihdr
[8] = 8;

250 
ihdr
[9] = 2;

251 
ihdr
[10] = 0;

252 
ihdr
[11] = 0;

253 
ihdr
[12] = 0;

254 
	`wr™ePNGChunk
(
out
, "IHDR", 
ihdr
, 13);

257 
rowby‹s
 = 
width
 * 3;

258 
bufãr
 = 
Ãw
 
uIÁ8
[(
rowby‹s
 + 1è* 
height
];

259 
uIÁ8
* 
buf_±r
 = 
bufãr
;

260 
i
 = 0; i < 
height
; i++) {

261 *
buf_±r
++ = 0;

262 
j
 = 0; j < 
width
; j++) {

263 
r
, 
g
, 
b
;

264 
	`g‘_rgb_äom_·Î‘e
((*
pm_m©rix
)[
i
][
j
], 
r
, 
g
, 
b
);

265 
buf_±r
[
j
 * 3 + 0] = 
r
;

266 
buf_±r
[
j
 * 3 + 1] = 
g
;

267 
buf_±r
[
j
 * 3 + 2] = 
b
;

269 
buf_±r
 +ğ
rowby‹s
;

273 
uLÚgf
 
compmemsize
 = (uLÚgf)((
height
 * (
width
 + 1)

275 
compmem
 = 
Ãw
 
uIÁ8
[
compmemsize
];

276 if(
compmem
 =ğ
NULL
 ||

277 (
	`com´ess
(
compmem
, &
compmemsize
, 
bufãr
, 
height
 *

278 (
width
 * 3 + 1)è!ğ
Z_OK
))

279 
throw
 "Error: Couldn't compress PNG";

282 
	`wr™ePNGChunk
(
out
, "IDAT", 
compmem
, 
compmemsize
);

286 
	`wr™ePNGChunk
(
out
, "IEND", 0, 0);

289 if(
bufãr
è
d–‘e
[] buffer;

290 if(
compmem
è
d–‘e
[] compmem;

291 
out
.
	`şo£
();

294 
	`ÿtch
(cÚ¡ *
msg
)

296 if(
bufãr
è
d–‘e
[] buffer;

297 if(
compmem
è
d–‘e
[] compmem;

298 
out
.
	`şo£
();

299 
û¼
 << 
msg
 << 
’dl
;

301 
	}
}

307 
	gExpÜtSü“n
::
	$g‘_rgb_äom_·Î‘e
(
v®
, & 
r
, & 
g
, & 
b
) const {

308 
	`as£¹
 (
pi_·Ë‰e
);

309 ià(
v®
 < 256) {

311 
r
 = (
pi_·Ë‰e
[
v®
] >> 16) & 0xff;

312 
g
 = (
pi_·Ë‰e
[
v®
] >> 8) & 0xff;

313 
b
 = 
pi_·Ë‰e
[
v®
] & 0xff;

316 
v®
 = val - 256;

317 
	`as£¹
 (
v®
 <ğ
v_cu¡om_·Î‘e
.
	`size
());

318 
r
 = 
v_cu¡om_·Î‘e
[
v®
][0];

319 
g
 = 
v_cu¡om_·Î‘e
[
v®
][1];

320 
b
 = 
v_cu¡om_·Î‘e
[
v®
][2];

322 
	}
}

325 
	gExpÜtSü“n
::
	$wr™ePNGChunk
(
of¡»am
& 
out
, * 
ty³
, 
uIÁ8
* 
d©a
,

326 
size
) const {

328 
uIÁ8
 
‹mp
[8];

329 
‹mp
[0] = 
size
 >> 24;

330 
‹mp
[1] = 
size
 >> 16;

331 
‹mp
[2] = 
size
 >> 8;

332 
‹mp
[3] = 
size
;

333 
‹mp
[4] = 
ty³
[0];

334 
‹mp
[5] = 
ty³
[1];

335 
‹mp
[6] = 
ty³
[2];

336 
‹mp
[7] = 
ty³
[3];

339 
out
.
	`wr™e
((cÚ¡ *)
‹mp
, 8);

342 
uIÁ32
 
üc
 = 
	`üc32
(0, 
‹mp
 + 4, 4);

343 if(
size
 > 0)

345 
out
.
	`wr™e
((cÚ¡ *)
d©a
, 
size
);

346 
üc
 = 
	`üc32
(üc, 
d©a
, 
size
);

350 
‹mp
[0] = 
üc
 >> 24;

351 
‹mp
[1] = 
üc
 >> 16;

352 
‹mp
[2] = 
üc
 >> 8;

353 
‹mp
[3] = 
üc
;

354 
out
.
	`wr™e
((cÚ¡ *)
‹mp
, 4);

355 
	}
}

358 
	gExpÜtSü“n
::
	$wr™ePNGText
(
of¡»am
& 
out
, cÚ¡ 
¡ršg
& 
key
,

359 cÚ¡ 
¡ršg
& 
‹xt
) const

361 
Ëngth
 = 
key
.
	`Ëngth
(è+ 1 + 
‹xt
.length() + 1;

362 
uIÁ8
* 
d©a
 = 
Ãw
 uIÁ8[
Ëngth
];

364 
	`¡rıy
((*)
d©a
, 
key
.
	`c_¡r
());

365 
	`¡rıy
((*)
d©a
 + 
key
.
	`Ëngth
(è+ 1, 
‹xt
.
	`c_¡r
());

367 
	`wr™ePNGChunk
(
out
, "tEXt", 
d©a
, 
Ëngth
-1);

369 
d–‘e
[] 
d©a
;

370 
	}
}

375 
	gExpÜtSü“n
::
	$š™_cu¡om_·Î‘e
() {

377 
shades
[] = {0, 51, 102, 153, 204, 255};

378 
r
, 
g
, 
b
;

379 
i
 = 5; i >= 0; i--) {

380 
j
 = 5; j >= 0; j--) {

381 
k
 = 0; k < 6; k++) {

382 
r
 = 
shades
[
i
];

383 
g
 = 
shades
[
j
];

384 
b
 = 
shades
[
k
];

385 ià(
r
 =ğ0 && 
g
 =ğ0 && 
b
 == 0) {

388 
veùÜ
<> 
¿nd_cŞÜ
;

389 
¿nd_cŞÜ
.
	`push_back
(
r
);

390 
¿nd_cŞÜ
.
	`push_back
(
g
);

391 
¿nd_cŞÜ
.
	`push_back
(
b
);

392 
v_cu¡om_·Î‘e
.
	`push_back
(
¿nd_cŞÜ
);

396 
	`¿ndom_shufæe
(
v_cu¡om_·Î‘e
.
	`begš
(), v_cu¡om_·Î‘e.
	`’d
() );

398 
i
 = 0; i < 
CUSTOM_PALETTE_SIZE
; i++) {

399 
r
 = 
	`¿nd_¿nge
(0, 256);

400 
g
 = 
	`¿nd_¿nge
(0, 256);

401 
b
 = 
	`¿nd_¿nge
(0, 256);

402 
veùÜ
<> 
¿nd_cŞÜ
;

403 
¿nd_cŞÜ
.
	`push_back
(
r
);

404 
¿nd_cŞÜ
.
	`push_back
(
g
);

405 
¿nd_cŞÜ
.
	`push_back
(
b
);

406 
v_cu¡om_·Î‘e
.
	`push_back
(
¿nd_cŞÜ
);

408 
bÏck
[] = {0, 0, 0};

409 
v_cu¡om_·Î‘e
[
BLACK_COLOR_IND
] = 
veùÜ
<>(
bÏck
, black + 3);

410 
»d
[] = {255, 0, 0};

411 
v_cu¡om_·Î‘e
[
RED_COLOR_IND
] = 
veùÜ
<>(
»d
,„ed + 3);

412 
£ÿm_0
[] = {0, 0, 0};

413 
wh™e
[] = {255, 255, 255};

414 
v_cu¡om_·Î‘e
[
WHITE_COLOR_IND
] = 
veùÜ
<>(
wh™e
, white + 3);

417 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 0] = 
veùÜ
<>(
£ÿm_0
, secam_0 + 3);

418 
£ÿm_1
[] = {33, 33, 255};

419 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 1] = 
veùÜ
<>(
£ÿm_1
, secam_1 + 3);

420 
£ÿm_2
[] = {240, 60, 121};

421 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 2] = 
veùÜ
<>(
£ÿm_2
, secam_2 + 3);

422 
£ÿm_3
[] = {255, 80, 255};

423 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 3] = 
veùÜ
<>(
£ÿm_3
, secam_3 + 3);

424 
£ÿm_4
[] = {127, 255, 0};

425 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 4] = 
veùÜ
<>(
£ÿm_4
, secam_4 + 3);

426 
£ÿm_5
[] = {127, 255, 255};

427 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 5] = 
veùÜ
<>(
£ÿm_5
, secam_5 + 3);

428 
£ÿm_6
[] = {255, 255, 63};

429 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 6] = 
veùÜ
<>(
£ÿm_6
, secam_6 + 3);

430 
£ÿm_7
[] = {255, 255, 255};

431 
v_cu¡om_·Î‘e
[
SECAM_COLOR_IND
 + 7] = 
veùÜ
<>(
£ÿm_7
, secam_7 + 3);

432 
	}
}

	@common/export_screen.h

10 #iâdeà
EXPORT_SCREEN_H


11 
	#EXPORT_SCREEN_H


	)

13 
	~<veùÜ
>

14 
	~"Prİs.hxx
"

15 
	~"commÚ_cÚ¡ªts.h
"

17 
şass
 
	gOSy¡em
;

19 şas 
	cExpÜtSü“n
 {

33 
	mpublic
:

37 
ExpÜtSü“n
(
OSy¡em
* 
osy¡em
);

42 
	mvœtu®
 ~
	$ExpÜtSü“n
() {}

48 
vœtu®
 
	$£t_·Ë‰e
(cÚ¡ 
uIÁ32
* 
·Ë‰e
) {

49 
pi_·Ë‰e
 = 
·Ë‰e
;

50 
	}
}

55 
§ve_²g
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
, cÚ¡ 
¡ršg
& 
f’ame
);

60 
	$expÜt_ªy_m©rix
 ( cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

61 cÚ¡ 
¡ršg
& 
f’ame
) const;

65 
	`§ve_h—t_¶Ù
(
FlßtM©rix
* 
pm_m©rix
,

66 cÚ¡ 
¡ršg
& 
f’ame
);

68 
´Ùeùed
:

72 
	$g‘_rgb_äom_·Î‘e
(
v®
, & 
r
, & 
g
, & 
b
) const;

77 
	`š™_cu¡om_·Î‘e
();

78 
	$wr™ePNGChunk
(
of¡»am
& 
out
, * 
ty³
, 
uIÁ8
* 
d©a
, 
size
) const;

79 
	$wr™ePNGText
(
of¡»am
& 
out
, cÚ¡ 
¡ršg
& 
key
,

80 cÚ¡ 
¡ršg
& 
‹xt
) const;

82 cÚ¡ 
uIÁ32
* 
pi_·Ë‰e
;

83 cÚ¡ 
Prİ”t›s
* 
p_´İs
;

84 
OSy¡em
* 
p_osy¡em
;

85 
i_sü“n_width
;

86 
i_sü“n_height
;

87 
veùÜ
< veùÜ <> > 
v_cu¡om_·Î‘e
;

88 
	}
};

	@common/export_tools.h

7 #iâdeà
EXPORT_TOOLS_H


8 
	#EXPORT_TOOLS_H


	)

10 
	~<f¡»am
>

11 
	~<veùÜ
>

12 
	~<v®¬¿y
>

13 
	~<c¡dlib
>

14 
	~"b¥f.hxx
"

15 
	~"commÚ_cÚ¡ªts.h
"

22 
	g‹m¶©e
 <
şass
 
	gT
>

23 
šlše
 
expÜt_veùÜ
(cÚ¡ 
veùÜ
<
T
>* 
p_vec
, cÚ¡ 
¡ršg
& 
f’ame
,

24 
d–im™”
 = ',') {

25 
of¡»am
 
fe
;

26 
	gfe
.
İ’
(
f’ame
.
c_¡r
());

27 
	gi
 = 0; i < 
	gp_vec
->
size
(); i++) {

28 
	gfe
 << (*
	gp_vec
)[
i
] << 
	gd–im™”
;

30 
	gfe
 << 
	g’dl
;

31 
	gfe
.
şo£
();

38 
	g‹m¶©e
 <
şass
 
	gT
>

39 
šlše
 
expÜt_¬¿y
(cÚ¡ 
v®¬¿y
<
T
>* 
p_¬r
, cÚ¡ 
¡ršg
& 
f’ame
,

40 
d–im™”
 = ',') {

41 
of¡»am
 
fe
;

42 
	gfe
.
İ’
(
f’ame
.
c_¡r
());

43 
	gi
 = 0; i < 
	gp_¬r
->
size
(); i++) {

44 
	gfe
 << (*
	gp_¬r
)[
i
] << 
	gd–im™”
;

46 
	gfe
 << 
	g’dl
;

47 
	gfe
.
şo£
();

54 
	g‹m¶©e
 <
şass
 
	gT
>

55 
šlše
 
impÜt_veùÜ
(
veùÜ
<
T
>* 
p_vec
, cÚ¡ 
¡ršg
& 
f’ame
,

56 
d–im™”
 = ',') {

57 
if¡»am
 
šfe
;

58 
	gšfe
.
İ’
(
f’ame
.
c_¡r
());

59 ià(!
	gšfe
) {

60 
	gthrow
 "UÇbËØlßd‡ veùÜ fromhgiv’ fe:" + 
	gf’ame
;

62 
	gp_vec
->
ş—r
();

63 
	gšfe
) {

64 
T
 
	gÃw_v®
;

65 
	gšfe
 >> 
	gÃw_v®
;

66 
	gp_vec
->
push_back
(
Ãw_v®
);

67 
	gšfe
.
ignÜe
(
d–im™”
);

69 
	gšfe
.
şo£
();

78 
	g‹m¶©e
 <
şass
 
	gT
>

79 
šlše
 
impÜt_¬¿y
(
v®¬¿y
<
T
>* 
p_¬r
, cÚ¡ 
¡ršg
& 
f’ame
,

80 
d–im™”
 = ',') {

81 
if¡»am
 
šfe
;

82 
	gšfe
.
İ’
(
f’ame
.
c_¡r
());

83 ià(!
	gšfe
) {

84 
	gthrow
 "UÇbËØlßd‡ veùÜ fromhgiv’ fe:" + 
	gf’ame
;

86 
	gi
 = 0;

87 
	gŒue
) {

88 
T
 
	gÃw_v®
;

89 
	gd–im
;

90 ià(!(
	gšfe
 >> 
	gÃw_v®
)) {

93 
	gšfe
 >> 
	gd–im
;

94 (*
	gp_¬r
)[
i
] = 
Ãw_v®
;

95 
	gi
++;

97 
	gcout
 << "˜ğ" << 
	gi
 << " --- sizğ" << 
	gp_¬r
->
size
(è<< 
	g’dl
;

98 
as£¹
 (
i
 =ğ
p_¬r
->
size
());

99 
	gšfe
.
şo£
();

112 
	g‹m¶©e
 <
şass
 
	gT
>

113 
šlše
 
impÜt_m©rix
(
veùÜ
< veùÜ<
T
> >* 
pm_m©rix
, cÚ¡ 
¡ršg
& 
f’ame
){

114 
¡ršg
 
	g”r_¡r
 = "UÇbËØlßd‡ veùÜ fromhgiv’ fe:" + 
f’ame
;

115 
if¡»am
 
	gšfe
;

116 
	gšfe
.
İ’
(
f’ame
.
c_¡r
());

117 ià(!
	gšfe
) {

118 
throw
 
	g”r_¡r
.
c_¡r
();

120 
	gpm_m©rix
->
ş—r
();

121 
	gd–im
;

122 
	gwidth
, 
	gheight
;

123 
	gšfe
 >> 
	gwidth
;

124 
	gšfe
.
g‘
(
d–im
);

125 ià(
	gd–im
 != ',') {

126 
throw
 
”r_¡r
.
c_¡r
();

128 
	gšfe
 >> 
	gheight
;

129 
	gšfe
.
g‘
(
d–im
);

130 ià(
	gd–im
 != '\n') {

131 
throw
 
”r_¡r
.
c_¡r
();

133 ià(
	gwidth
 <ğ0 || 
height
 <= 0) {

134 
throw
 
”r_¡r
.
c_¡r
();

137 
	gš_v®
;

138 
	gi
 = 0; i < 
	gheight
; i++) {

139 
IÁVeù
 
	grow
;

140 
	gj
 = 0; j < 
	gwidth
; j++) {

141 
	gšfe
 >> 
	gš_v®
;

142 
	gšfe
.
g‘
(
d–im
);

143 ià((
	gj
 < (
	gwidth
 - 1è&& 
	gd–im
 != ',') ||

144 (
j
 =ğ(
width
 - 1è&& 
d–im
 != '\n')) {

145 
throw
 
”r_¡r
.
c_¡r
();

147 
	grow
.
push_back
(
š_v®
);

149 
	gpm_m©rix
->
push_back
(
row
);

162 
	g‹m¶©e
 <
şass
 
	gT
>

163 
šlše
 
expÜt_m©rix
Ğ
veùÜ
< veùÜ<
T
> >* 
pm_m©rix
,

164 cÚ¡ 
¡ršg
& 
f’ame
) {

165 
as£¹
 (
pm_m©rix
->
size
() > 0);

166 
of¡»am
 
	gfe
;

167 
	gfe
.
İ’
(
f’ame
.
c_¡r
());

168 
	gfe
 << (*
	gpm_m©rix
)[0].
size
(è<< "," <<…m_m©rix->size(è<< 
	g’dl
;

169 
	gi
 = 0; i < 
	gpm_m©rix
->
size
(); i++) {

170 
	gj
 = 0; j < (*
	gpm_m©rix
)[
i
].
size
(); j++) {

171 
	gfe
 << (*
	gpm_m©rix
)[
i
][
j
];

172 ià(
	gj
 < (*
	gpm_m©rix
)[
i
].
size
() - 1) {

173 
	gfe
 << ",";

177 
	gfe
 << 
	g’dl
;

179 
	gfe
.
şo£
();

	@common/misc_tools.h

6 #iâdeà
MISC_TOOLS_H


7 
	#MISC_TOOLS_H


	)

9 
	~"commÚ_cÚ¡ªts.h
"

16 
šlše
 
	$pow
(
x
, 
p
) {

17 if(
p
 == 0)  1;

18 if(
x
 =ğ0 && 
p
 > 0)  0;

19 if(
p
 < 0è{
	`as£¹
(
x
 == 1 || x == -1);  (-p % 2) ? x : 1;}

21 
r
 = 1;

23 if(
p
 & 1è
r
 *ğ
x
;

24 if((
p
 >>ğ1è=ğ0è 
r
;

25 
x
 *= x;

27 
	}
}

32 
šlše
 
	$bound
(& 
x
, 
low”_bound
, 
uµ”_bound
) {

33 ià(
x
 > 
uµ”_bound
) {

34 
x
 = 
uµ”_bound
;

36 ià(
x
 < 
low”_bound
) {

37 
x
 = 
low”_bound
;

39 
	}
}

	@common/random_tools.h

7 #iâdeà
RANDOM_TOOLS_H


8 
	#RANDOM_TOOLS_H


	)

10 
	~<veùÜ
>

11 
	~<c¡dlib
>

12 
	~"b¥f.hxx
"

18 
šlše
 
	$¿nd_¿nge
(
lowe¡
, 
highe¡
) {

19 
¿nge
 = 
highe¡
 - 
lowe¡
 + 1;

20  (
	`¿nd
(è% 
¿nge
è+ 
lowe¡
;

21 
	}
}

26 
	g‹m¶©e
 <
şass
 
	gT
>

27 
šlše
 
T
 
choiû
(cÚ¡ 
veùÜ
<T>* 
p_vec
) {

28 
as£¹
(
p_vec
->
size
() > 0);

29 
	gšdex
 = 
¿nd_¿nge
(0, 
p_vec
->
size
() - 1);

30 
as£¹
(
šdex
 >= 0);

31 
as£¹
(
šdex
 < 
p_vec
->
size
());

32  (*
	gp_vec
)[
šdex
];

	@common/vector_matrix_tools.cpp

7 
	~"veùÜ_m©rix_toŞs.h
"

12 
	$nÜm®ize_m©rix
(
FlßtM©rix
* 
pm_m©rix
) {

13 
mš_v®
 = (*
pm_m©rix
)[0][0];

14 
max_v®
 = (*
pm_m©rix
)[0][0];

15 
FlßtM©rix
::
™”©Ü
 
™_row
 = 
pm_m©rix
->
	`begš
();

16 
™_row
 !ğ
pm_m©rix
->
	`’d
(); ++it_row) {

17 
FlßtVeù
::
™”©Ü
 
™_cŞ
 = (*
™_row
).
	`begš
();

18 
™_cŞ
 !ğ(*
™_row
).
	`’d
(); ++it_col) {

19 
v®ue
 = (*
™_cŞ
);

20 ià(
v®ue
 == 1313.0 ||

21 
v®ue
 == 1314.0) {

24 ià(
v®ue
 < 
mš_v®
) {

25 
mš_v®
 = 
v®ue
;

27 ià(
v®ue
 > 
max_v®
) {

28 
max_v®
 = 
v®ue
;

32 
¿nge
 = 
max_v®
 - 
mš_v®
;

33 
	`as£¹
 (
¿nge
 >= 0.0);

34 ià(
¿nge
 == 0.0) {

38 
FlßtM©rix
::
™”©Ü
 
™_row
 = 
pm_m©rix
->
	`begš
();

39 
™_row
 !ğ
pm_m©rix
->
	`’d
(); ++it_row) {

40 
FlßtVeù
::
™”©Ü
 
™_cŞ
 = (*
™_row
).
	`begš
();

41 
™_cŞ
 !ğ(*
™_row
).
	`’d
(); ++it_col) {

42 ià((*
™_cŞ
) != 1313.0 &&

43 (*
™_cŞ
) != 1314.0) {

44 (*
™_cŞ
èğ(*™_cŞè- 
mš_v®
;

45 (*
™_cŞ
èğ(*™_cŞè/ 
¿nge
;

49 
	}
}

55 
	$sim¶e_wh”e
ĞcÚ¡ 
IÁM©rix
* 
pm_m©rix
, 
rg‘
,

56 
IÁVeù
* 
pv_row_šds
, IÁVeù* 
pv_cŞ_šds
) {

57 
pv_row_šds
->
	`ş—r
();

58 
pv_cŞ_šds
->
	`ş—r
();

59 
height
 = 
pm_m©rix
->
	`size
();

60 ià(
height
 == 0) {

63 
width
 = (*
pm_m©rix
)[0].
	`size
();

64 ià(
width
 == 0) {

67 
i
 = 0; i < 
height
; i++) {

68 
j
 = 0; j < 
width
; j++) {

69 iàĞ(*
pm_m©rix
)[
i
][
j
] =ğ
rg‘
 ) {

70 
pv_row_šds
->
	`push_back
(
i
);

71 
pv_cŞ_šds
->
	`push_back
(
j
);

75 
	}
}

80 
	$shršk_¬¿y
(
FlßtA¼
* 
pv_veùÜ
, 
sm®Ë¡_v®
) {

81 ià(
sm®Ë¡_v®
 == 0) {

82 
cout
 << "sm®Ë¡_v® = 0. CªnÙ shrškhveùÜ" << 
’dl
;

85 
	`as£¹
 (
sm®Ë¡_v®
 > 0);

86 
i
 = 0; i < 
pv_veùÜ
->
	`size
(); i++) {

87 ià(
	`abs
((*
pv_veùÜ
)[
i
]è< 
sm®Ë¡_v®
) {

88 (*
pv_veùÜ
)[
i
] = 0;

91 
	}
}

97 
	$shršk_¬¿y
(
FlßtA¼
* 
pv_veùÜ
, 
num_v®ues_to_k“p
) {

98 
FlßtVeù
* 
sÜ‹d_cİy
 = 
Ãw
 FloatVect;

99 
i
 = 0; i < 
pv_veùÜ
->
	`size
(); i++) {

100 
sÜ‹d_cİy
->
	`push_back
(
	`abs
((*
pv_veùÜ
)[
i
]));

102 
	`sÜt
(
sÜ‹d_cİy
->
	`begš
(), sÜ‹d_cİy->
	`’d
());

103 
	`»v”£
(
sÜ‹d_cİy
->
	`begš
(), sÜ‹d_cİy->
	`’d
());

104 
sm®Ë¡_v®
 = (*
sÜ‹d_cİy
)[
num_v®ues_to_k“p
 - 1];

105 
	`shršk_¬¿y
(
pv_veùÜ
, 
sm®Ë¡_v®
);

106 
d–‘e
 
sÜ‹d_cİy
;

107 
	}
}

	@common/vector_matrix_tools.h

6 #iâdeà
VECTOR_MATRIX_TOOLS_H


7 
	#VECTOR_MATRIX_TOOLS_H


	)

9 
	~"commÚ_cÚ¡ªts.h
"

14 
nÜm®ize_m©rix
(
FlßtM©rix
* 
pm_m©rix
);

21 
sim¶e_wh”e
ĞcÚ¡ 
IÁM©rix
* 
pm_m©rix
, 
rg‘
,

22 
IÁVeù
* 
pv_row_šds
, IÁVeù* 
pv_cŞ_šds
);

27 
shršk_¬¿y
(
FlßtA¼
* 
pv_veùÜ
, 
sm®Ë¡_v®
);

33 
shršk_¬¿y
(
FlßtA¼
* 
pv_veùÜ
, 
num_v®ues_to_k“p
);

39 
	g‹m¶©e
 <
şass
 
	gT
>

40 
veù_max
ĞcÚ¡ 
veùÜ
<
T
>* 
pv_veùÜ
, T& 
max_v®
, & 
max_šdex
) {

41 
as£¹
 (
pv_veùÜ
->
size
() > 0);

42 
	gmax_v®
 = (*
pv_veùÜ
)[0];

43 
	gmax_šdex
 = 0;

44 
	gi
 = 1; i < 
	gpv_veùÜ
->
size
(); i++) {

45 
T
 
	gv®
 = (*
pv_veùÜ
)[
i
];

46 ià(
	gv®
 > 
	gmax_v®
) {

47 
	gmax_v®
 = 
v®
;

48 
	gmax_šdex
 = 
i
;

56 
	g‹m¶©e
 <
şass
 
	gT
>

57 
veù_mš
ĞcÚ¡ 
veùÜ
<
T
>* 
pv_veùÜ
, T& 
mš_v®
, & 
mš_šdex
) {

58 
as£¹
 (
pv_veùÜ
->
size
() > 0);

59 
	gmš_v®
 = (*
pv_veùÜ
)[0];

60 
	gmš_šdex
 = 0;

61 
	gi
 = 1; i < 
	gpv_veùÜ
->
size
(); i++) {

62 
T
 
	gv®
 = (*
pv_veùÜ
)[
i
];

63 ià(
	gv®
 < 
	gmš_v®
) {

64 
	gmš_v®
 = 
v®
;

65 
	gmš_šdex
 = 
i
;

73 
	g‹m¶©e
 <
şass
 
	gT
>

74 
šlše
 
T
 
g‘_veùÜ_av”age
(cÚ¡ 
veùÜ
<T>* 
pv_veùÜ
, 
¡¬t
, 
’d
) {

75 
	gn
 = 
’d
 - 
¡¬t
;

76 
T
 
	gsum
 = (T)0.0;

77 
	gi
 = 
¡¬t
; i < 
	g’d
; i++) {

78 
	gsum
 +ğ(*
pv_veùÜ
)[
i
];

80  
	gsum
 / (
	gT
)
	gn
;

86 
	g‹m¶©e
 <
şass
 
	gT
>

87 
šlše
 
T
 
g‘_l2_di¡ªû
ĞcÚ¡ 
veùÜ
< veùÜ<T> >* 
pm_m©rix_a
,

88 cÚ¡ 
veùÜ
< veùÜ<
T
> >* 
pm_m©rix_b
) {

89 
	gm
 = 
pm_m©rix_a
->
size
();

90 
	gn
 = (*
pm_m©rix_a
)[0].
size
();

91 
as£¹
 ( 
m
 =ğ
pm_m©rix_b
->
size
());

92 
as£¹
 (
n
 =ğ(*
pm_m©rix_b
)[0].
size
());

93 
T
 
	gtÙ®_di¡
 = (T)0;

94 
	gi
 = 0; i < 
	gm
; i++) {

95 
	gj
 = 0; j < 
	gn
; j++) {

96 
T
 
	gdiff
 = (*
pm_m©rix_a
)[
i
][
j
] - (*
pm_m©rix_b
)[i][j];

97 
	gtÙ®_di¡
 +ğ
diff
 * diff;

100  
	gtÙ®_di¡
;

107 
	g‹m¶©e
 <
şass
 
	gT
>

108 
ş—r_li¡_of_poš‹rs
Ğ
veùÜ
 < 
T
* >* 
pv_veùÜ
) {

109 
	gi
 = 0; i < 
	gpv_veùÜ
->
size
(); i++) {

110 ià((*
	gpv_veùÜ
)[
i
]) {

111 
d–‘e
 (*
pv_veùÜ
)[
i
];

112 (*
	gpv_veùÜ
)[
i
] = 
NULL
;

	@control/fifo_controller.cpp

18 
	~"fifo_cÚŒŞËr.h
"

24 
	gFIFOCÚŒŞËr
::
	$FIFOCÚŒŞËr
(
OSy¡em
* 
_osy¡em
) :

25 
	$GameCÚŒŞËr
(
_osy¡em
) {

26 
p_fout
 = 
	`fİ’
("ale_fifo_out", "w");

27 
p_fš
 = 
	`fİ’
("ale_fifo_in", "r");

28 ià(
p_fout
 =ğ
NULL
 || 
p_fš
 == NULL) {

29 
û¼
 << "A.L.Eƒxpectswo FIFO…ipesoƒxist:\n";

30 
û¼
 << "\t‡le_fifo_out (A.L.E will send its output here)\n";

31 
û¼
 << "\t‡le_fifo_in (A.L.E will get its input from here)\n";

32 
	`ex™
(-1);

36 
out_bufãr
 [50];

37 
cout
 << "i_sü“n_width = " << 
i_sü“n_width
 << " - i_sü“n_heighˆ=" << 
i_sü“n_height
 << 
’dl
;

38 
	`¥rštf
 (
out_bufãr
, "%d-%d\n", 
i_sü“n_width
, 
i_sü“n_height
);

39 
	`åuts
(
out_bufãr
, 
p_fout
);

40 
	`fæush
 (
p_fout
);

42 
š_bufãr
 [50];

43 
û¼
<< "A.L.E: wa™šg fÜ‡„•ly ..." << 
’dl
;

44 
	`fg‘s
 (
š_bufãr
, 50, 
p_fš
);

45 * 
tok’
 = 
	`¡¹ok
 (
š_bufãr
,",\n");

46 
b_£nd_sü“n_m©rix
 = 
	`©oi
(
tok’
);

47 
tok’
 = 
	`¡¹ok
 (
NULL
,",\n");

48 
b_£nd_cÚsŞe_¿m
 = 
	`©oi
(
tok’
);

49 
tok’
 = 
	`¡¹ok
 (
NULL
,",\n");

50 
i_sk_äames_num
 = 
	`©oi
(
tok’
);

51 
i_sk_äames_couÁ”
 = 
i_sk_äames_num
;

52 
û¼
 << "A.L.E: s’d_sü“n_m©rix is: " << 
b_£nd_sü“n_m©rix
 << 
’dl
;

53 
û¼
 << "A.L.E: s’d_cÚsŞe_¿m is: " << 
b_£nd_cÚsŞe_¿m
 << 
’dl
;

54 
û¼
 << "A.L.E: i_sk_äames_num is: " << 
i_sk_äames_num
 << 
’dl
;

56 
pi_Şd_äame_bufãr
 = 
Ãw
 [
i_sü“n_width
 * 
i_sü“n_height
];

57 
i
 = 0; i < 
i_sü“n_width
 * 
i_sü“n_height
; i++) {

58 
pi_Şd_äame_bufãr
[
i
] = -1;

61 
	}
}

66 
	gFIFOCÚŒŞËr
::~
	$FIFOCÚŒŞËr
() {

67 ià(
pi_Şd_äame_bufãr
 !ğ
NULL
)

68 
d–‘e
 [] 
pi_Şd_äame_bufãr
;

69 ià(
p_fout
 !ğ
NULL
)

70 
	`fşo£
(
p_fout
);

71 ià(
p_fš
 !ğ
NULL
)

72 
	`fşo£
(
p_fš
);

74 
	}
}

81 
	gFIFOCÚŒŞËr
::
	$upd©e
() {

82 
AùiÚ
 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
;

84 ià(
i_sk_äames_couÁ”
 < 
i_sk_äames_num
) {

86 
i_sk_äames_couÁ”
++;

87 ià(
e_´evious_a_aùiÚ
 =ğ
RESET
 || 
e_´evious_b_aùiÚ
 == RESET ) {

88 
¶ay”_a_aùiÚ
 = 
PLAYER_A_NOOP
;

89 
¶ay”_b_aùiÚ
 = 
PLAYER_B_NOOP
;

90 
e_´evious_a_aùiÚ
 = 
PLAYER_A_NOOP
;

91 
e_´evious_b_aùiÚ
 = 
PLAYER_B_NOOP
;

93 
¶ay”_a_aùiÚ
 = 
e_´evious_a_aùiÚ
;

94 
¶ay”_b_aùiÚ
 = 
e_´evious_b_aùiÚ
;

98 
i_sk_äames_couÁ”
 = 0;

100 
¡ršg
 
fš®_¡r
 = "";

101 ià(
b_£nd_cÚsŞe_¿m
) {

103 
i
 = 0; i< 128; i++) {

104 
bufãr
[5];

105 
¿m_by‹
 = 
	`»ad_¿m
(
i
);

106 
	`¥rštf
 (
bufãr
, "%03i", 
¿m_by‹
);

107 
fš®_¡r
 +ğ
bufãr
;

110 ià(
b_£nd_sü“n_m©rix
) {

112 
i
 = 0; i < 
i_sü“n_width
 * 
i_sü“n_height
; i++) {

113 
uIÁ8
 
v
 = 
pi_cu¼_äame_bufãr
[
i
];

114 ià(
v
 !ğ
pi_Şd_äame_bufãr
[
i
]) {

115 
bufãr
[50];

116 
šd_j
 = 
i
 / 
i_sü“n_width
;

117 
šd_i
 = 
i
 - (
šd_j
 * 
i_sü“n_width
);

118 
	`¥rštf
 (
bufãr
, "%03i%03i%03i", 
šd_i
, 
šd_j
, 
v
);

119 
fš®_¡r
 +ğ
bufãr
;

120 
pi_Şd_äame_bufãr
[
i
] = 
v
;

124 
fš®_¡r
 += "NADA";

126 
fš®_¡r
 += "\n\0";

127 
	`åuts
(
fš®_¡r
.
	`c_¡r
(), 
p_fout
);

128 
	`fæush
 (
p_fout
);

132 
š_bufãr
 [50];

133 
	`fg‘s
 (
š_bufãr
, 50, 
p_fš
);

134 * 
tok’
 = 
	`¡¹ok
 (
š_bufãr
,",\n");

135 
¶ay”_a_aùiÚ
 = (
AùiÚ
)
	`©oi
(
tok’
);

136 
tok’
 = 
	`¡¹ok
 (
NULL
,",\n");

137 
¶ay”_b_aùiÚ
 = (
AùiÚ
)
	`©oi
(
tok’
);

139 
e_´evious_a_aùiÚ
 = 
¶ay”_a_aùiÚ
;

140 
e_´evious_b_aùiÚ
 = 
¶ay”_b_aùiÚ
;

141 
	`­¶y_aùiÚ
(
p_glob®_ev’t_obj
, 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
);

142 
	}
}

	@control/fifo_controller.h

18 #iâdeà
FIFO_CONTROLLER_H


19 
	#FIFO_CONTROLLER_H


	)

22 
	~"commÚ_cÚ¡ªts.h
"

23 
	~"game_cÚŒŞËr.h
"

25 şas 
	cFIFOCÚŒŞËr
 : 
public
 
GameCÚŒŞËr
 {

40 
public
:

44 
FIFOCÚŒŞËr
(
OSy¡em
* 
_osy¡em
);

49 
	mvœtu®
 ~
FIFOCÚŒŞËr
();

56 
vœtu®
 
upd©e
();

58 
	m´Ùeùed
:

59 * 
pi_Şd_äame_bufãr
;

61 
FILE
* 
	mp_fout
;

62 
FILE
* 
	mp_fš
;

	@control/game_controller.cpp

18 
	~"game_cÚŒŞËr.h
"

24 
	gGameCÚŒŞËr
::
	$GameCÚŒŞËr
(
OSy¡em
* 
_osy¡em
) {

25 
p_osy¡em
 = 
_osy¡em
;

26 
p_glob®_ev’t_obj
 = 
p_osy¡em
->
	`ev’t
();

27 
p_cÚsŞe
 = &(
p_osy¡em
->
	`cÚsŞe
());

28 
MedŸSourû
& 
medŸ¤c
 = 
p_cÚsŞe
->
	`medŸSourû
();

29 
pi_cu¼_äame_bufãr
 = 
medŸ¤c
.
	`cu¼’tF¿meBufãr
();

30 
p_emuÏtÜ_sy¡em
 = &(
p_cÚsŞe
->
	`sy¡em
());

31 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

32 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

35 
b_£nd_sü“n_m©rix
 = 
Œue
;

36 
b_£nd_cÚsŞe_¿m
 = 
Œue
;

37 
i_sk_äames_num
 = 0;

38 
i_sk_äames_couÁ”
 = 0;

39 
e_´evious_a_aùiÚ
 = 
PLAYER_A_NOOP
;

40 
e_´evious_b_aùiÚ
 = 
PLAYER_B_NOOP
;

41 
i_Ëá_·ddË_cu¼_x
 = ((
PADDLE_MAX
 - 
PADDLE_MIN
) / 2) + PADDLE_MIN;

42 
i_right_·ddË_cu¼_x
 = ((
PADDLE_MAX
 - 
PADDLE_MIN
) / 2) + PADDLE_MIN;

43 ià(
p_osy¡em
->
	`cÚsŞe
().
	`´İ”t›s
().
	`g‘
(
CÚŒŞËr_Leá
) == "PADDLES") {

44 
cout
 << "Leá…Ïy” usšg PaddËs" << 
’dl
;

45 
b_Ëá_¶ay”_·ddËs
 = 
Œue
;

46 
Ëá_»si¡ªû
 = 
	`ÿlc_·ddË_»si¡ªû
(
i_Ëá_·ddË_cu¼_x
);

47 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
PaddËZ”oResi¡ªû
, 
Ëá_»si¡ªû
);

49 
b_Ëá_¶ay”_·ddËs
 = 
çl£
;

51 ià(
p_osy¡em
->
	`cÚsŞe
().
	`´İ”t›s
().
	`g‘
(
CÚŒŞËr_Right
) == "PADDLES") {

52 
cout
 << "Righˆ¶ay” usšg PaddËs" << 
’dl
;

53 
b_right_¶ay”_·ddËs
 = 
Œue
;

54 
right_»si¡ªû
 = 
	`ÿlc_·ddË_»si¡ªû
(
i_right_·ddË_cu¼_x
);

55 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
PaddËOÃResi¡ªû
, 
right_»si¡ªû
);

57 
b_right_¶ay”_·ddËs
 = 
çl£
;

60 
	}
}

65 
	gGameCÚŒŞËr
::~
	$GameCÚŒŞËr
() {

66 
	}
}

73 
GameCÚŒŞËr
::
	$­¶y_aùiÚ
Ğ
Ev’t
* 
p_glob®_ev’t_obj
,

74 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
) {

75 
	`»£t_keys
(
p_glob®_ev’t_obj
);

76 
¶ay”_a_aùiÚ
) {

77 
PLAYER_A_NOOP
:

80 
PLAYER_A_FIRE
:

81 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

84 
PLAYER_A_UP
:

85 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

88 
PLAYER_A_RIGHT
:

89 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

92 
PLAYER_A_LEFT
:

93 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

96 
PLAYER_A_DOWN
:

97 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

100 
PLAYER_A_UPRIGHT
:

101 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

102 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

105 
PLAYER_A_UPLEFT
:

106 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

107 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

110 
PLAYER_A_DOWNRIGHT
:

111 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

112 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

115 
PLAYER_A_DOWNLEFT
:

116 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

117 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

120 
PLAYER_A_UPFIRE
:

121 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

122 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

125 
PLAYER_A_RIGHTFIRE
:

126 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

127 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

130 
PLAYER_A_LEFTFIRE
:

131 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

132 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

135 
PLAYER_A_DOWNFIRE
:

136 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

137 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

140 
PLAYER_A_UPRIGHTFIRE
:

141 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

142 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

143 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

146 
PLAYER_A_UPLEFTFIRE
:

147 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 1);

148 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

149 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

152 
PLAYER_A_DOWNRIGHTFIRE
:

153 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

154 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 1);

155 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

158 
PLAYER_A_DOWNLEFTFIRE
:

159 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 1);

160 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 1);

161 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 1);

163 
RESET
:

164 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
CÚsŞeRe£t
, 1);

165 
û¼
 << "S’dšg Re£t..." << 
’dl
;

168 
û¼
 << "Inv®id PÏy” A AùiÚ: " << 
¶ay”_a_aùiÚ
;

169 
	`ex™
(-1);

173 
¶ay”_b_aùiÚ
) {

174 
PLAYER_B_NOOP
:

177 
PLAYER_B_FIRE
:

178 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

181 
PLAYER_B_UP
:

182 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

185 
PLAYER_B_RIGHT
:

186 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

189 
PLAYER_B_LEFT
:

190 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

193 
PLAYER_B_DOWN
:

194 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

197 
PLAYER_B_UPRIGHT
:

198 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

199 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

202 
PLAYER_B_UPLEFT
:

203 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

204 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

207 
PLAYER_B_DOWNRIGHT
:

208 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

209 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

212 
PLAYER_B_DOWNLEFT
:

213 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

214 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

217 
PLAYER_B_UPFIRE
:

218 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

219 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

222 
PLAYER_B_RIGHTFIRE
:

223 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

224 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

227 
PLAYER_B_LEFTFIRE
:

228 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

229 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

232 
PLAYER_B_DOWNFIRE
:

233 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

234 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

237 
PLAYER_B_UPRIGHTFIRE
:

238 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

239 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

240 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

243 
PLAYER_B_UPLEFTFIRE
:

244 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 1);

245 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

246 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

249 
PLAYER_B_DOWNRIGHTFIRE
:

250 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

251 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 1);

252 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

255 
PLAYER_B_DOWNLEFTFIRE
:

256 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 1);

257 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 1);

258 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 1);

260 
RESET
:

261 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
CÚsŞeRe£t
, 1);

262 
û¼
 << "S’dšg Re£t..." << 
’dl
;

265 
û¼
 << "Inv®id PÏy” B AùiÚ: " << 
¶ay”_b_aùiÚ
 << 
’dl
;

266 
	`ex™
(-1);

268 
	}
}

274 
	gGameCÚŒŞËr
::
	$»£t_keys
(
Ev’t
* 
p_glob®_ev’t_obj
) {

276 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
CÚsŞeRe£t
, 0);

277 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oFœe
, 0);

278 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oUp
, 0);

279 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oDown
, 0);

280 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oRight
, 0);

281 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickZ”oLeá
, 0);

282 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃFœe
, 0);

283 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃUp
, 0);

284 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃDown
, 0);

285 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃRight
, 0);

286 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
Joy¡ickOÃLeá
, 0);

288 
	}
}

296 
	gGameCÚŒŞËr
::
	$»ad_¿m
(
off£t
) {

297 
off£t
 &= 0x7f;

298  
p_emuÏtÜ_sy¡em
->
	`³ek
(
off£t
 + 0x80);

299 
	}
}

304 
	gGameCÚŒŞËr
::
	$ÿlc_·ddË_»si¡ªû
(
x_v®
) {

305  
x_v®
;

306 
	}
}

312 
	gGameCÚŒŞËr
::
	$upd©e_·ddËs_pos™iÚs
(
d–_Ëá
, 
d–_right
){

313 ià(
d–_Ëá
 != 0) {

314 
i_Ëá_·ddË_cu¼_x
 +ğ
d–_Ëá
;

315 ià(
i_Ëá_·ddË_cu¼_x
 < 
PADDLE_MIN
) {

316 
i_Ëá_·ddË_cu¼_x
 = 
PADDLE_MIN
;

318 ià(
i_Ëá_·ddË_cu¼_x
 > 
PADDLE_MAX
) {

319 
i_Ëá_·ddË_cu¼_x
 = 
PADDLE_MAX
;

321 
Ëá_»si¡ªû
 = 
	`ÿlc_·ddË_»si¡ªû
(
i_Ëá_·ddË_cu¼_x
);

322 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
PaddËZ”oResi¡ªû
, 
Ëá_»si¡ªû
);

324 ià(
d–_right
 != 0) {

325 
i_right_·ddË_cu¼_x
 +ğ
d–_right
;

326 ià(
i_right_·ddË_cu¼_x
 < 
PADDLE_MIN
) {

327 
i_right_·ddË_cu¼_x
 = 
PADDLE_MIN
;

329 ià(
i_right_·ddË_cu¼_x
 > 
PADDLE_MAX
) {

330 
i_right_·ddË_cu¼_x
 = 
PADDLE_MAX
;

332 
right_»si¡ªû
 = 
	`ÿlc_·ddË_»si¡ªû
(
i_right_·ddË_cu¼_x
);

333 
p_glob®_ev’t_obj
->
	`£t
(
Ev’t
::
PaddËOÃResi¡ªû
, 
right_»si¡ªû
);

335 
	}
}

	@control/game_controller.h

17 #iâdeà
GAME_CONTROLLER_H


18 
	#GAME_CONTROLLER_H


	)

20 
	~"OSy¡em.hxx
"

21 
	~"Sy¡em.hxx
"

22 
	~"commÚ_cÚ¡ªts.h
"

23 
	~"expÜt_sü“n.h
"

25 
	#PADDLE_DELTA
 23000

	)

26 
	#PADDLE_MIN
 250000

	)

27 
	#PADDLE_MAX
 800000

	)

30 şas 
	cGameCÚŒŞËr
 {

55 
	mpublic
:

59 
GameCÚŒŞËr
(
OSy¡em
* 
_osy¡em
);

64 
	mvœtu®
 ~
GameCÚŒŞËr
();

71 
vœtu®
 
upd©e
() = 0;

76 
­¶y_aùiÚ
Ğ
Ev’t
* 
p_glob®_ev’t_obj
,

77 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
);

82 
»£t_keys
(
Ev’t
* 
p_glob®_ev’t_obj
);

89 
»ad_¿m
(
off£t
);

94 
	m´Ùeùed
:

98 
ÿlc_·ddË_»si¡ªû
(
x_v®
);

104 
upd©e_·ddËs_pos™iÚs
(
d–_Ëá
, 
d–_right
);

106 
OSy¡em
* 
	mp_osy¡em
;

107 
Ev’t
* 
	mp_glob®_ev’t_obj
;

109 
	mi_sü“n_width
;

110 
	mi_sü“n_height
;

111 
uIÁ8
* 
	mpi_cu¼_äame_bufãr
;

113 
CÚsŞe
* 
	mp_cÚsŞe
;

114 
Sy¡em
* 
	mp_emuÏtÜ_sy¡em
;

116 
boŞ
 
	mb_£nd_sü“n_m©rix
;

117 
boŞ
 
	mb_£nd_cÚsŞe_¿m
;

118 
	mi_sk_äames_num
;

120 
	mi_sk_äames_couÁ”
;

121 
AùiÚ
 
	me_´evious_a_aùiÚ
;

122 
AùiÚ
 
	me_´evious_b_aùiÚ
;

123 
boŞ
 
	mb_Ëá_¶ay”_·ddËs
;

124 
boŞ
 
	mb_right_¶ay”_·ddËs
;

125 
	mi_Ëá_·ddË_cu¼_x
;

126 
	mi_right_·ddË_cu¼_x
;

	@control/internal_controller.cpp

17 
	~<s¡»am
>

18 
	~"š‹º®_cÚŒŞËr.h
"

19 
	~"game_cÚŒŞËr.h
"

20 
	~"game_£‰šgs.h
"

21 
	~"¶ay”_ag’t.h
"

22 
	~"¿ndom_toŞs.h
"

23 
	~"S‘tšgs.hxx
"

29 
	gIÁ”ÇlCÚŒŞËr
::
	$IÁ”ÇlCÚŒŞËr
(
OSy¡em
* 
_osy¡em
) :

30 
	$GameCÚŒŞËr
(
_osy¡em
) {

31 
¡ršg
 
rom_fe
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("rom_file");

32 
p_game_£‰šgs
 = 
GameS‘tšgs
::
	`g’”©e_game_S‘tšgs_š¡ªû
(
rom_fe
);

33 
i_sk_äames_num
 = 
p_game_£‰šgs
->i_skip_frames_num;

34 
pm_sü“n_m©rix
 = 
NULL
;

35 ià(
b_£nd_sü“n_m©rix
) {

36 
pm_sü“n_m©rix
 = 
Ãw
 
IÁM©rix
;

37 
	`as£¹
(
i_sü“n_height
 > 0);

38 
	`as£¹
(
i_sü“n_width
 > 0);

39 
i
 = 0; i < 
i_sü“n_height
; i++) {

40 
IÁVeù
 
row
;

41 
j
 = 0; j < 
i_sü“n_width
; j++) {

42 
row
.
	`push_back
(-1);

44 
pm_sü“n_m©rix
->
	`push_back
(
row
);

47 
pv_¿m_cÚ‹Á
 = 
NULL
;

48 ià(
b_£nd_cÚsŞe_¿m
) {

49 
pv_¿m_cÚ‹Á
 = 
Ãw
 
	`IÁVeù
(
RAM_LENGTH
);

52 
p_¶ay”_ag’t_right
 = 
NULL
;

55 
p_¶ay”_ag’t_Ëá
 = 
PÏy”Ag’t
::
	`g’”©e_ag’t_š¡ªû
(
p_game_£‰šgs
,

56 
p_osy¡em
);

57 
i_äame_numb”
 = 0;

58 
	}
}

63 
	gIÁ”ÇlCÚŒŞËr
::~
	$IÁ”ÇlCÚŒŞËr
() {

64 ià(
p_game_£‰šgs
) {

65 
d–‘e
 
p_game_£‰šgs
;

67 ià(
p_¶ay”_ag’t_right
) {

68 
d–‘e
 
p_¶ay”_ag’t_right
;

70 ià(
p_¶ay”_ag’t_Ëá
) {

71 
d–‘e
 
p_¶ay”_ag’t_Ëá
;

73 ià(
pv_¿m_cÚ‹Á
) {

74 
d–‘e
 
pv_¿m_cÚ‹Á
;

76 ià(
pm_sü“n_m©rix
) {

77 
d–‘e
 
pm_sü“n_m©rix
;

79 
	}
}

87 
	gIÁ”ÇlCÚŒŞËr
::
	$upd©e
() {

88 
AùiÚ
 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
;

90 ià(
i_sk_äames_couÁ”
 < 
p_game_£‰šgs
->
i_sk_äames_num
) {

92 
i_sk_äames_couÁ”
++;

93 ià(
e_´evious_a_aùiÚ
 =ğ
RESET
 || 
e_´evious_b_aùiÚ
 == RESET ) {

94 
cout
 << "»£ˆ»³©ed!" <<
’dl
;

95 
¶ay”_a_aùiÚ
 = 
PLAYER_A_NOOP
;

96 
¶ay”_b_aùiÚ
 = 
PLAYER_B_NOOP
;

97 
e_´evious_a_aùiÚ
 = 
PLAYER_A_NOOP
;

98 
e_´evious_b_aùiÚ
 = 
PLAYER_B_NOOP
;

100 
¶ay”_a_aùiÚ
 = 
e_´evious_a_aùiÚ
;

101 
¶ay”_b_aùiÚ
 = 
e_´evious_b_aùiÚ
;

105 
i_sk_äames_couÁ”
 = 0;

106 
i_äame_numb”
++;

108 
	`cİy_äamebufãr
();

109 
	`cİy_¿m_cÚ‹Á
();

111 ià(
p_¶ay”_ag’t_Ëá
) {

112 
¶ay”_a_aùiÚ
 = 
p_¶ay”_ag’t_Ëá
->
	`ag’t_¡•
(
pm_sü“n_m©rix
,

113 
pv_¿m_cÚ‹Á
,

114 
i_äame_numb”
);

116 
¶ay”_a_aùiÚ
 = 
PLAYER_A_NOOP
;

118 ià(
p_¶ay”_ag’t_right
) {

119 
¶ay”_b_aùiÚ
 = 
p_¶ay”_ag’t_right
->
	`ag’t_¡•
(
pm_sü“n_m©rix
,

120 
pv_¿m_cÚ‹Á
,

121 
i_äame_numb”
);

123 
¶ay”_b_aùiÚ
 = 
PLAYER_B_NOOP
;

126 
e_´evious_a_aùiÚ
 = 
¶ay”_a_aùiÚ
;

127 
e_´evious_b_aùiÚ
 = 
¶ay”_b_aùiÚ
;

128 
	`­¶y_aùiÚ
(
p_glob®_ev’t_obj
, 
¶ay”_a_aùiÚ
, 
¶ay”_b_aùiÚ
);

129 
	}
}

136 
	gIÁ”ÇlCÚŒŞËr
::
	$cİy_äamebufãr
() {

137 ià(!
b_£nd_sü“n_m©rix
) {

141 
šd_i
, 
šd_j
;

142 
i
 = 0; i < 
i_sü“n_width
 * 
i_sü“n_height
; i++) {

143 
uIÁ8
 
v
 = 
pi_cu¼_äame_bufãr
[
i
];

144 
šd_i
 = 
i
 / 
i_sü“n_width
;

145 
šd_j
 = 
i
 - (
šd_i
 * 
i_sü“n_width
);

146 (*
pm_sü“n_m©rix
)[
šd_i
][
šd_j
] = 
v
;

148 
	}
}

153 
	gIÁ”ÇlCÚŒŞËr
::
	$cİy_¿m_cÚ‹Á
() {

154 ià(!
b_£nd_cÚsŞe_¿m
) {

157 
i
 = 0; i< 
RAM_LENGTH
; i++) {

158 (*
pv_¿m_cÚ‹Á
)[
i
] = 
	`»ad_¿m
(i);

160 
	}
}

	@control/internal_controller.h

17 #iâdeà
INTERNAL_CONTROLLER_H


18 
	#INTERNAL_CONTROLLER_H


	)

21 
	~"commÚ_cÚ¡ªts.h
"

22 
	~"game_cÚŒŞËr.h
"

23 
	~"¶ay”_ag’t.h
"

24 
	~"game_£‰šgs.h
"

27 şas 
	cIÁ”ÇlCÚŒŞËr
 : 
public
 
GameCÚŒŞËr
 {

43 
public
:

47 
IÁ”ÇlCÚŒŞËr
(
OSy¡em
* 
_osy¡em
);

52 
	mvœtu®
 ~
IÁ”ÇlCÚŒŞËr
();

59 
vœtu®
 
upd©e
();

63 
	m´Ùeùed
:

67 
cİy_äamebufãr
();

72 
cİy_¿m_cÚ‹Á
();

75 
IÁM©rix
* 
	mpm_sü“n_m©rix
;

76 
IÁVeù
* 
	mpv_¿m_cÚ‹Á
;

77 
PÏy”Ag’t
* 
	mp_¶ay”_ag’t_right
;

78 
PÏy”Ag’t
* 
	mp_¶ay”_ag’t_Ëá
;

79 
GameS‘tšgs
* 
	mp_game_£‰šgs
;

80 
	mi_äame_numb”
;

	@emucore/AtariVox.cxx

19 #ifdeà
ATARIVOX_SUPPORT


21 
	~"Ev’t.hxx
"

22 
	~"AriVox.hxx
"

23 
	~"S³akJ‘.hxx
"

25 
	#DEBUG_ATARIVOX
 0

	)

28 
	gAriVox
::
	$AriVox
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
)

29 : 
	`CÚŒŞËr
(
jack
, 
ev’t
),

30 
	`myS³akJ‘
(0),

31 
	`mySy¡em
(0),

32 
	`myPšS‹
(0),

33 
	`myShiáCouÁ
(0),

34 
	`myShiáRegi¡”
(0),

35 
	$myLa¡D©aWr™eCyşe
(0)

37 
myTy³
 = 
CÚŒŞËr
::
AriVox
;

38 
myS³akJ‘
 = 
Ãw
 
	`S³akJ‘
();

39 
	}
}

42 
	gAriVox
::~
	$AriVox
()

44 
	}
}

47 
AriVox
::
	$£tSy¡em
(
Sy¡em
 *
sy¡em
) {

48 
mySy¡em
 = 
sy¡em
;

49 
	}
}

52 
boŞ
 
	gAriVox
::
	$»ad
(
Dig™®Pš
 
pš
)

59  
Œue
;

60 
	}
}

63 
IÁ32
 
	gAriVox
::
	$»ad
(
AÇlogPš
)

66  
maximumResi¡ªû
;

67 
	}
}

70 
	gAriVox
::
	$şockD©aIn
(
boŞ
 
v®ue
)

73 
myPšS‹
 = (myPšS‹ & 0xãè| 
v®ue
;

75 
uIÁ32
 
cyşe
 = 
mySy¡em
->
	`cyşes
();

76 if(
DEBUG_ATARIVOX
)

77 
û¼
 << "AtariVox: value "

78 << 
v®ue


80 << 
mySy¡em
->
	`cyşes
()

82 << 
myLa¡D©aWr™eCyşe


84 << (
mySy¡em
->
	`cyşes
(è- 
myLa¡D©aWr™eCyşe
)

86 << 
’dl
;

88 if(
v®ue
 && (
myShiáCouÁ
 == 0)) {

89 if(
DEBUG_ATARIVOX
)

90 
û¼
 << "v®u&& (myShiáCouÁ =ğ0),„‘uºšg" << 
’dl
;

94 if(
cyşe
 < 
myLa¡D©aWr™eCyşe
 || cycle > myLastDataWriteCycle + 1000) {

97 
myShiáRegi¡”
 = 0;

98 
myShiáCouÁ
 = 0;

101 if(
cyşe
 < 
myLa¡D©aWr™eCyşe
 || cycle >= myLastDataWriteCycle + 62) {

104 if(
DEBUG_ATARIVOX
)

105 
û¼
 << "cycle >= myLastDataWriteCycle + 62, shiftIn("

106 << 
v®ue
 << ")" << 
’dl
;

107 
	`shiáIn
(
v®ue
);

110 
myLa¡D©aWr™eCyşe
 = 
cyşe
;

111 
	}
}

114 
	gAriVox
::
	$shiáIn
(
boŞ
 
v®ue
)

116 
myShiáRegi¡”
 >>= 1;

117 
myShiáRegi¡”
 |ğ(
v®ue
 << 15);

118 if(++
myShiáCouÁ
 == 10) {

119 
myShiáCouÁ
 = 0;

120 
myShiáRegi¡”
 >>= 6;

121 if(!(
myShiáRegi¡”
 & (1<<9)))

122 
û¼
 << "AriVox: bad s¹ b™" << 
’dl
;

123 if((
myShiáRegi¡”
 & 1))

124 
û¼
 << "AriVox: bad stİ b™" << 
’dl
;

127 
uIÁ8
 
d©a
 = ((
myShiáRegi¡”
 >> 1) & 0xff);

128 
û¼
 << "AriVox: ouuˆby‹ " << (()(
d©a
)è<< 
’dl
;

129 
myS³akJ‘
->
	`wr™e
(
d©a
);

131 
myShiáRegi¡”
 = 0;

133 
	}
}

136 
	gAriVox
::
	$wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
)

138 if(
DEBUG_ATARIVOX
)

139 
û¼
 << "AriVox: wr™tØSWCHA" << 
’dl
;

142 
pš
)

146 
OÃ
:

147 
	`şockD©aIn
(
v®ue
);

153 
Two
:

154 if(
DEBUG_ATARIVOX
)

155 
û¼
 << "AtariVox: value "

156 << 
v®ue


158 << 
mySy¡em
->
	`cyşes
()

159 << 
’dl
;

165 
Th»e
:

166 if(
DEBUG_ATARIVOX
)

167 
û¼
 << "AtariVox: value "

168 << 
v®ue


170 << 
mySy¡em
->
	`cyşes
()

171 << 
’dl
;

174 
Four
:

178 
	}
}

	@emucore/AtariVox.hxx

20 #ifdeà
ATARIVOX_SUPPORT


22 #iâdeà
ATARIVOX_HXX


23 
	#ATARIVOX_HXX


	)

25 
	~"CÚŒŞ.hxx
"

26 
	~"S³akJ‘.hxx
"

38 şas 
	cAriVox
 : 
public
 
CÚŒŞËr


40 
public
:

47 
AriVox
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
);

52 
	mvœtu®
 ~
AriVox
();

54 
	mpublic
:

61 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

72 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

82 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

84 
S³akJ‘
* 
	$g‘S³akJ‘
(è{  
myS³akJ‘
; }

86 
´iv©e
:

87 
	`şockD©aIn
(
boŞ
 
v®ue
);

88 
	`shiáIn
(
boŞ
 
v®ue
);

90 
´iv©e
:

94 ’um { 
TIMING_SLOP
 = 0 
	}
};

99 
S³akJ‘
 *
	gmyS³akJ‘
;

102 
uIÁ8
 
	gmyPšS‹
;

105 
uIÁ8
 
	gmyShiáCouÁ
;

111 
uIÁ16
 
	gmyShiáRegi¡”
;

117 
uIÁ32
 
	gmyLa¡D©aWr™eCyşe
;

	@emucore/Booster.cxx

19 
	~"Ev’t.hxx
"

20 
	~"Boo¡”.hxx
"

23 
	gBoo¡”Gr
::
	$Boo¡”Gr
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
)

24 : 
	$CÚŒŞËr
(
jack
, 
ev’t
, 
CÚŒŞËr
::
Boo¡”Gr
)

26 
	}
}

29 
Boo¡”Gr
::~
	$Boo¡”Gr
()

31 
	}
}

34 
boŞ
 
Boo¡”Gr
::
	$»ad
(
Dig™®Pš
 
pš
)

36 
pš
)

38 
OÃ
:

39  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oUp
) == 0) :

40 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃUp
) == 0);

42 
Two
:

43  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oDown
) == 0) :

44 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃDown
) == 0);

46 
Th»e
:

47  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oLeá
) == 0) :

48 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃLeá
) == 0);

50 
Four
:

51  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oRight
) == 0) :

52 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃRight
) == 0);

54 
Six
:

55  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oFœe
) == 0) :

56 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃFœe
) == 0);

59  
Œue
;

61 
	}
}

64 
IÁ32
 
	gBoo¡”Gr
::
	$»ad
(
AÇlogPš
 
pš
)

69 
pš
)

71 
Five
:

72 if(
myJack
 =ğ
Leá
)

74  (
myEv’t
.
	`g‘
(
Ev’t
::
Boo¡”GrZ”oBoo¡”
) != 0) ?

75 
mšimumResi¡ªû
 : 
maximumResi¡ªû
;

79  (
myEv’t
.
	`g‘
(
Ev’t
::
Boo¡”GrOÃBoo¡”
) != 0) ?

80 
mšimumResi¡ªû
 : 
maximumResi¡ªû
;

83 
Nše
:

84 if(
myJack
 =ğ
Leá
)

86  (
myEv’t
.
	`g‘
(
Ev’t
::
Boo¡”GrZ”oTrigg”
) != 0) ?

87 
mšimumResi¡ªû
 : 
maximumResi¡ªû
;

91  (
myEv’t
.
	`g‘
(
Ev’t
::
Boo¡”GrOÃTrigg”
) != 0) ?

92 
mšimumResi¡ªû
 : 
maximumResi¡ªû
;

96  
maximumResi¡ªû
;

98 
	}
}

101 
	gBoo¡”Gr
::
	$wr™e
(
Dig™®Pš
, 
boŞ
)

104 
	}
}

	@emucore/Booster.hxx

19 #iâdeà
BOOSTERGRIP_HXX


20 
	#BOOSTERGRIP_HXX


	)

22 
	~"b¥f.hxx
"

23 
	~"CÚŒŞ.hxx
"

33 şas 
	cBoo¡”Gr
 : 
public
 
CÚŒŞËr


35 
public
:

42 
Boo¡”Gr
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
);

47 
	mvœtu®
 ~
Boo¡”Gr
();

49 
	mpublic
:

56 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

65 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

75 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

	@emucore/Cart.cxx

19 
	~<¡ršg.h
>

21 
	~<ÿs£¹
>

22 
	~<s¡»am
>

24 
	~"b¥f.hxx
"

25 
	~"C¬t.hxx
"

26 
	~"C¬t0840.hxx
"

27 
	~"C¬t2K.hxx
"

28 
	~"C¬t3E.hxx
"

29 
	~"C¬t3F.hxx
"

30 
	~"C¬t4A50.hxx
"

31 
	~"C¬t4K.hxx
"

32 
	~"C¬tAR.hxx
"

33 
	~"C¬tDPC.hxx
"

34 
	~"C¬tE0.hxx
"

35 
	~"C¬tE7.hxx
"

36 
	~"C¬tF4.hxx
"

37 
	~"C¬tF4SC.hxx
"

38 
	~"C¬tF6.hxx
"

39 
	~"C¬tF6SC.hxx
"

40 
	~"C¬tF8.hxx
"

41 
	~"C¬tF8SC.hxx
"

42 
	~"C¬tFASC.hxx
"

43 
	~"C¬tFE.hxx
"

44 
	~"C¬tMC.hxx
"

45 
	~"C¬tMB.hxx
"

46 
	~"C¬tCV.hxx
"

47 
	~"C¬tUA.hxx
"

48 
	~"MD5.hxx
"

49 
	~"Prİs.hxx
"

50 
	~"S‘tšgs.hxx
"

53 
C¬Œidge
* 
	gC¬Œidge
::
	$ü—‹
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
,

54 cÚ¡ 
Prİ”t›s
& 
´İ”t›s
, cÚ¡ 
S‘tšgs
& 
£‰šgs
)

56 
C¬Œidge
* 
ÿ¹ridge
 = 0;

59 cÚ¡ 
¡ršg
& 
md5
 = 
´İ”t›s
.
	`g‘
(
C¬Œidge_MD5
);

60 
¡ršg
 
ty³
 = 
´İ”t›s
.
	`g‘
(
C¬Œidge_Ty³
);

64 if(
md5
 == "bc24440b59092559a1ec26055fd1270e" ||

65 
md5
 == "75ee371ccfc4f43e7d9b8f24e1266b55")

69 
ty³
 = "F8 swapped";

73 
o¡ršg¡»am
 
buf
;

74 
buf
 << " ROM Size: " << 
size
 << 
’dl


75 << " Bªksw™ch Ty³: " << 
ty³
;

79 if(
ty³
 =ğ"AUTO-DETECT" || 
£‰šgs
.
	`g‘BoŞ
("rominfo"))

81 
¡ršg
 
d‘eùed
 = 
	`autod‘eùTy³
(
image
, 
size
);

82 
buf
 << " ==> " << 
d‘eùed
;

83 if(
ty³
 !ğ"AUTO-DETECT" &&y³ !ğ
d‘eùed
)

84 
buf
 << " (auto-detection‚ot consistent)";

86 
ty³
 = 
d‘eùed
;

88 
buf
 << 
’dl
;

89 
myAboutSŒšg
 = 
buf
.
	`¡r
();

92 if(
ty³
 == "2K")

93 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge2K
(
image
);

94 if(
ty³
 == "3E")

95 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge3E
(
image
, 
size
);

96 if(
ty³
 == "3F")

97 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge3F
(
image
, 
size
);

98 if(
ty³
 == "4A50")

99 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge4A50
(
image
);

100 if(
ty³
 == "4K")

101 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge4K
(
image
);

102 if(
ty³
 == "AR")

103 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeAR
(
image
, 
size
, 
Œue
);

104 if(
ty³
 == "DPC")

105 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeDPC
(
image
, 
size
);

106 if(
ty³
 == "E0")

107 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeE0
(
image
);

108 if(
ty³
 == "E7")

109 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeE7
(
image
);

110 if(
ty³
 == "F4")

111 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF4
(
image
);

112 if(
ty³
 == "F4SC")

113 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF4SC
(
image
);

114 if(
ty³
 == "F6")

115 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF6
(
image
);

116 if(
ty³
 == "F6SC")

117 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF6SC
(
image
);

118 if(
ty³
 == "F8")

119 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF8
(
image
, 
çl£
);

120 if(
ty³
 == "F8 swapped")

121 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF8
(
image
, 
Œue
);

122 if(
ty³
 == "F8SC")

123 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeF8SC
(
image
);

124 if(
ty³
 == "FASC")

125 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeFASC
(
image
);

126 if(
ty³
 == "FE")

127 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeFE
(
image
);

128 if(
ty³
 == "MC")

129 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeMC
(
image
, 
size
);

130 if(
ty³
 == "MB")

131 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeMB
(
image
);

132 if(
ty³
 == "CV")

133 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeCV
(
image
, 
size
);

134 if(
ty³
 == "UA")

135 
ÿ¹ridge
 = 
Ãw
 
	`C¬ŒidgeUA
(
image
);

136 if(
ty³
 == "0840")

137 
ÿ¹ridge
 = 
Ãw
 
	`C¬Œidge0840
(
image
);

139 
û¼
 << "ERROR: Inv®id c¬Œidgty³ " << 
ty³
 << " ..." << 
’dl
;

141  
ÿ¹ridge
;

142 
	}
}

145 
	gC¬Œidge
::
	$C¬Œidge
()

147 
	`uÆockBªk
();

148 
	}
}

151 
	gC¬Œidge
::~
	$C¬Œidge
()

153 
	}
}

156 
boŞ
 
C¬Œidge
::
	$§ve
(
of¡»am
& 
out
)

158 
size
 = -1;

160 
uIÁ8
* 
image
 = 
	`g‘Image
(
size
);

161 if(
image
 =ğ0 || 
size
 <= 0)

163 
û¼
 << "§vnÙ suµÜ‹d" << 
’dl
;

164  
çl£
;

167 
i
=0; i<
size
; i++)

168 
out
 << 
image
[
i
];

170  
Œue
;

171 
	}
}

174 
¡ršg
 
	gC¬Œidge
::
	$autod‘eùTy³
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

177 cÚ¡ * 
ty³
 = 0;

179 if((
size
 % 8448) == 0)

181 
ty³
 = "AR";

183 if((
size
 == 2048) ||

184 (
size
 =ğ4096 && 
	`memcmp
(
image
, image + 2048, 2048) == 0))

186 if(
	`isProbablyCV
(
image
, 
size
))

187 
ty³
 = "CV";

189 
ty³
 = "2K";

191 if(
size
 == 4096)

193 if(
	`isProbablyCV
(
image
, 
size
))

194 
ty³
 = "CV";

196 
ty³
 = "4K";

198 if(
size
 == 8192)

200 if(
	`isProbablySC
(
image
, 
size
))

201 
ty³
 = "F8SC";

202 if(
	`memcmp
(
image
, image + 4096, 4096) == 0)

203 
ty³
 = "4K";

204 if(
	`isProbablyE0
(
image
, 
size
))

205 
ty³
 = "E0";

206 if(
	`isProbably3E
(
image
, 
size
))

207 
ty³
 = "3E";

208 if(
	`isProbably3F
(
image
, 
size
))

209 
ty³
 = "3F";

210 if(
	`isProbablyUA
(
image
, 
size
))

211 
ty³
 = "UA";

212 if(
	`isProbablyFE
(
image
, 
size
))

213 
ty³
 = "FE";

215 
ty³
 = "F8";

217 if((
size
 == 10495) || (size == 10496) || (size == 10240))

219 
ty³
 = "DPC";

221 if(
size
 == 12288)

227 
ty³
 = "FASC";

229 if(
size
 == 16384)

231 if(
	`isProbablySC
(
image
, 
size
))

232 
ty³
 = "F6SC";

233 if(
	`isProbablyE7
(
image
, 
size
))

234 
ty³
 = "E7";

235 if(
	`isProbably3E
(
image
, 
size
))

236 
ty³
 = "3E";

237 if(
	`isProbably3F
(
image
, 
size
))

238 
ty³
 = "3F";

240 
ty³
 = "F6";

242 if(
size
 == 32768)

244 if(
	`isProbablySC
(
image
, 
size
))

245 
ty³
 = "F4SC";

246 if(
	`isProbably3E
(
image
, 
size
))

247 
ty³
 = "3E";

248 if(
	`isProbably3F
(
image
, 
size
))

249 
ty³
 = "3F";

251 
ty³
 = "F4";

253 if(
size
 == 65536)

256 if(
	`isProbably3E
(
image
, 
size
))

257 
ty³
 = "3E";

258 if(
	`isProbably3F
(
image
, 
size
))

259 
ty³
 = "3F";

261 
ty³
 = "MB";

263 if(
size
 == 131072)

266 if(
	`isProbably3E
(
image
, 
size
))

267 
ty³
 = "3E";

268 if(
	`isProbably3F
(
image
, 
size
))

269 
ty³
 = "3F";

271 
ty³
 = "MC";

275 if(
	`isProbably3E
(
image
, 
size
))

276 
ty³
 = "3E";

277 if(
	`isProbably3F
(
image
, 
size
))

278 
ty³
 = "3F";

280 
ty³
 = "4K";

283  
ty³
;

284 
	}
}

287 
boŞ
 
	gC¬Œidge
::
	$£¬chFÜBy‹s
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
imagesize
,

288 cÚ¡ 
uIÁ8
* 
sigÇtu»
, 
uIÁ32
 
sigsize
,

289 
uIÁ32
 
mšh™s
)

291 
uIÁ32
 
couÁ
 = 0;

292 
uIÁ32
 
i
 = 0; i < 
imagesize
 - 
sigsize
; ++i)

294 
uIÁ32
 
m©ches
 = 0;

295 
uIÁ32
 
j
 = 0; j < 
sigsize
; ++j)

297 if(
image
[
i
+
j
] =ğ
sigÇtu»
[j])

298 ++
m©ches
;

302 if(
m©ches
 =ğ
sigsize
)

304 ++
couÁ
;

305 
i
 +ğ
sigsize
;

307 if(
couÁ
 >ğ
mšh™s
)

311  (
couÁ
 >ğ
mšh™s
);

312 
	}
}

315 
boŞ
 
	gC¬Œidge
::
	$isProbablySC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

320 
uIÁ32
 
bªks
 = 
size
 / 4096;

321 
uIÁ32
 
i
 = 0; i < 
bªks
; ++i)

323 
uIÁ8
 
fœ¡
 = 
image
[
i
*4096];

324 
uIÁ32
 
j
 = 0; j < 256; ++j)

326 if(
image
[
i
*4096+
j
] !ğ
fœ¡
)

327  
çl£
;

330  
Œue
;

331 
	}
}

334 
boŞ
 
	gC¬Œidge
::
	$isProbably3F
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

340 
uIÁ8
 
sigÇtu»
[] = { 0x85, 0x3F };

341  
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
, 2, 2);

342 
	}
}

345 
boŞ
 
	gC¬Œidge
::
	$isProbably3E
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

350 
uIÁ8
 
sigÇtu»
[] = { 0x85, 0x3E, 0xA9, 0x00 };

351  
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
, 4, 1);

352 
	}
}

355 
boŞ
 
	gC¬Œidge
::
	$isProbablyE0
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

363 
uIÁ8
 
sigÇtu»
[6][3] = {

371 
uIÁ32
 
i
 = 0; i < 6; ++i)

373 if(
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
[
i
], 3, 1))

374  
Œue
;

376  
çl£
;

377 
	}
}

380 
boŞ
 
	gC¬Œidge
::
	$isProbablyE7
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

391 
uIÁ8
 
fœ¡
 = 
image
[0x3800];

392 
uIÁ32
 
i
 = 0x3800; i < 0x3A00; ++i)

394 if(
fœ¡
 !ğ
image
[
i
])

395  
çl£
;

399 
uIÁ32
 
couÁ1
 = 0, 
couÁ2
 = 0;

400 
uIÁ32
 
i
 = 0x3800 - 32; i < 0x3800; ++i)

402 if(
fœ¡
 !ğ
image
[
i
])

403 ++
couÁ1
;

405 
uIÁ32
 
i
 = 0x3A00; i < 0x3A00 + 32; ++i)

407 if(
fœ¡
 !ğ
image
[
i
])

408 ++
couÁ2
;

411  (
couÁ1
 > 0 || 
couÁ2
 > 0);

412 
	}
}

415 
boŞ
 
	gC¬Œidge
::
	$isProbablyUA
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

419 
uIÁ8
 
sigÇtu»
[] = { 0x8D, 0x40, 0x02 };

420  
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
, 3, 1);

421 
	}
}

424 
boŞ
 
	gC¬Œidge
::
	$isProbablyCV
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

428 
uIÁ8
 
sigÇtu»
[2][3] = {

432 if(
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
[0], 3, 1))

433  
Œue
;

435  
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
[1], 3, 1);

436 
	}
}

439 
boŞ
 
	gC¬Œidge
::
	$isProbablyFE
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

444 
uIÁ8
 
sigÇtu»
[4][5] = {

450 
uIÁ32
 
i
 = 0; i < 4; ++i)

452 if(
	`£¬chFÜBy‹s
(
image
, 
size
, 
sigÇtu»
[
i
], 5, 1))

453  
Œue
;

455  
çl£
;

456 
	}
}

459 
	gC¬Œidge
::
	$C¬Œidge
(cÚ¡ 
C¬Œidge
&)

461 
	`as£¹
(
çl£
);

462 
	}
}

465 
	gC¬Œidge
& C¬Œidge::
İ”©Ü
 = (cÚ¡ 
C¬Œidge
&)

467 
as£¹
(
çl£
);

468  *
	gthis
;

472 
¡ršg
 
	gC¬Œidge
::
myAboutSŒšg
;

	@emucore/Cart.hxx

19 #iâdeà
CARTRIDGE_HXX


20 
	#CARTRIDGE_HXX


	)

22 
şass
 
	gC¬Œidge
;

23 
şass
 
	gSy¡em
;

24 
şass
 
	gPrİ”t›s
;

25 
şass
 
	gS‘tšgs
;

27 
	~<f¡»am
>

28 
	~"b¥f.hxx
"

29 
	~"Deviû.hxx
"

38 şas 
	cC¬Œidge
 : 
public
 
Deviû


40 
public
:

51 
C¬Œidge
* 
ü—‹
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
,

52 cÚ¡ 
Prİ”t›s
& 
´İs
, cÚ¡ 
S‘tšgs
& 
£‰šgs
);

57 
C¬Œidge
();

62 
	mvœtu®
 ~
C¬Œidge
();

67 cÚ¡ 
	m¡ršg
& 
	$about
(è{  
myAboutSŒšg
; }

74 
boŞ
 
	`§ve
(
of¡»am
& 
out
);

79 
	$lockBªk
(è{ 
bªkLocked
 = 
Œue
; 
	}
}

80 
	$uÆockBªk
(è{ 
bªkLocked
 = 
çl£
; 
	}
}

82 
	gpublic
:

90 
vœtu®
 
bªk
(
uIÁ16
 bank) = 0;

97 
vœtu®
 
bªk
() = 0;

102 
vœtu®
 
bªkCouÁ
() = 0;

111 
vœtu®
 
boŞ
 
·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
) = 0;

119 
vœtu®
 
uIÁ8
* 
g‘Image
(& 
size
) = 0;

121 
	g´Ùeùed
:

124 
boŞ
 
bªkLocked
;

126 
	g´iv©e
:

134 
¡ršg
 
autod‘eùTy³
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

147 
boŞ
 
£¬chFÜBy‹s
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
imagesize
,

148 cÚ¡ 
uIÁ8
* 
sigÇtu»
, 
uIÁ32
 
sigsize
,

149 
uIÁ32
 
mšh™s
);

154 
boŞ
 
isProbablySC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

159 
boŞ
 
isProbably3F
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

164 
boŞ
 
isProbably3E
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

169 
boŞ
 
isProbablyE0
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

174 
boŞ
 
isProbablyE7
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

179 
boŞ
 
isProbablyUA
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

184 
boŞ
 
isProbablyCV
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

189 
boŞ
 
isProbablyFE
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

191 
	g´iv©e
:

193 
¡ršg
 
myAboutSŒšg
;

196 
C¬Œidge
(const Cartridge&);

199 
	gC¬Œidge
& 
	gİ”©Ü
 = (cÚ¡ 
C¬Œidge
&);

	@emucore/Cart0840.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬t0840.hxx
"

27 
	gC¬Œidge0840
::
	$C¬Œidge0840
(cÚ¡ 
uIÁ8
* 
image
)

29 
	}
}

32 
C¬Œidge0840
::~
	$C¬Œidge0840
()

34 
	}
}

37 cÚ¡ * 
C¬Œidge0840
::
	$Çme
() const

40 
	}
}

43 
	gC¬Œidge0840
::
	$»£t
()

45 
	}
}

48 
C¬Œidge0840
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

50 
	}
}

53 
uIÁ8
 
C¬Œidge0840
::
	$³ek
(
uIÁ16
 
add»ss
)

56 
	}
}

59 
	gC¬Œidge0840
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

61 
	}
}

64 
boŞ
 
	gC¬Œidge0840
::
	$§ve
(
S”Ÿliz”
& 
out
)

66  
çl£
;

67 
	}
}

70 
boŞ
 
	gC¬Œidge0840
::
	$lßd
(
De£rŸliz”
& 
š
)

72  
çl£
;

73 
	}
}

76 
	gC¬Œidge0840
::
	$bªk
(
uIÁ16
 
bªk
)

78 
	}
}

81 
C¬Œidge0840
::
	$bªk
()

84 
	}
}

87 
	gC¬Œidge0840
::
	$bªkCouÁ
()

90 
	}
}

93 
boŞ
 
	gC¬Œidge0840
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

95  
çl£
;

96 
	}
}

99 
uIÁ8
* 
	gC¬Œidge0840
::
	$g‘Image
(& 
size
)

101 
size
 = 0;

103 
	}
}

	@emucore/Cart0840.hxx

19 #iâdeà
CARTRIDGE0840_HXX


20 
	#CARTRIDGE0840_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

35 şas 
	cC¬Œidge0840
 : 
public
 
C¬Œidge


37 
public
:

43 
C¬Œidge0840
(cÚ¡ 
uIÁ8
* 
image
);

48 
	mvœtu®
 ~
C¬Œidge0840
();

50 
	mpublic
:

56 
vœtu®
 cÚ¡ * 
	$Çme
() const;

61 
vœtu®
 
	`»£t
();

69 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

77 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

85 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

92 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

99 
vœtu®
 
	`bªk
();

104 
vœtu®
 
	`bªkCouÁ
();

113 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

121 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

123 
public
:

129 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

137 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

	@emucore/Cart2K.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬t2K.hxx
"

27 
	gC¬Œidge2K
::
	$C¬Œidge2K
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 2048; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬Œidge2K
::~
	$C¬Œidge2K
()

39 
	}
}

42 cÚ¡ * 
C¬Œidge2K
::
	$Çme
() const

45 
	}
}

48 
	gC¬Œidge2K
::
	$»£t
()

50 
	}
}

53 
C¬Œidge2K
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

55 
mySy¡em
 = &
sy¡em
;

56 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

57 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

60 
	`as£¹
((0x1000 & 
mask
) == 0);

62 
Sy¡em
::
PageAcûss
 
acûss
;

63 
acûss
.
dœeùPokeBa£
 = 0;

64 
acûss
.
deviû
 = 
this
;

67 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x2000;‡dd»s +ğ(1 << 
shiá
))

69 
acûss
.
dœeùP“kBa£
 = &
myImage
[
add»ss
 & 0x07FF];

70 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

72 
	}
}

75 
uIÁ8
 
	gC¬Œidge2K
::
	$³ek
(
uIÁ16
 
add»ss
)

77  
myImage
[
add»ss
 & 0x07FF];

78 
	}
}

81 
	gC¬Œidge2K
::
	$poke
(
uIÁ16
, 
uIÁ8
)

84 
	}
}

87 
boŞ
 
	gC¬Œidge2K
::
	$§ve
(
S”Ÿliz”
& 
out
)

89 
¡ršg
 
ÿ¹
 = 
	`Çme
();

91 
Œy


93 
out
.
	`putSŒšg
(
ÿ¹
);

95 
	`ÿtch
(cÚ¡ * 
msg
)

97 
û¼
 << 
msg
 << 
’dl
;

98  
çl£
;

100 
	`ÿtch
(...)

102 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

103  
çl£
;

106  
Œue
;

107 
	}
}

110 
boŞ
 
	gC¬Œidge2K
::
	$lßd
(
De£rŸliz”
& 
š
)

112 
¡ršg
 
ÿ¹
 = 
	`Çme
();

114 
Œy


116 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

117  
çl£
;

119 
	`ÿtch
(cÚ¡ * 
msg
)

121 
û¼
 << 
msg
 << 
’dl
;

122  
çl£
;

124 
	`ÿtch
(...)

126 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

127  
çl£
;

130  
Œue
;

131 
	}
}

134 
	gC¬Œidge2K
::
	$bªk
(
uIÁ16
 
bªk
)

137 
	}
}

140 
C¬Œidge2K
::
	$bªk
()

144 
	}
}

147 
	gC¬Œidge2K
::
	$bªkCouÁ
()

150 
	}
}

153 
boŞ
 
	gC¬Œidge2K
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

155 
myImage
[
add»ss
 & 0x07FF] = 
v®ue
;

156  
Œue
;

157 
	}
}

160 
uIÁ8
* 
	gC¬Œidge2K
::
	$g‘Image
(& 
size
)

162 
size
 = 2048;

163  &
myImage
[0];

164 
	}
}

	@emucore/Cart2K.hxx

19 #iâdeà
CARTRIDGE2K_HXX


20 
	#CARTRIDGE2K_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

37 şas 
	cC¬Œidge2K
 : 
public
 
C¬Œidge


39 
public
:

45 
C¬Œidge2K
(cÚ¡ 
uIÁ8
* 
image
);

50 
	mvœtu®
 ~
C¬Œidge2K
();

52 
	mpublic
:

58 
vœtu®
 cÚ¡ * 
	$Çme
() const;

63 
vœtu®
 
	`»£t
();

71 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

79 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

87 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

94 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

101 
vœtu®
 
	`bªk
();

106 
vœtu®
 
	`bªkCouÁ
();

115 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

123 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

125 
public
:

131 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

139 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

141 
´iv©e
:

143 
uIÁ8
 
myImage
[2048];

	@emucore/Cart3E.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"TIA.hxx
"

24 
	~"S”Ÿliz”.hxx
"

25 
	~"De£rŸliz”.hxx
"

26 
	~"C¬t3E.hxx
"

29 
	gC¬Œidge3E
::
	$C¬Œidge3E
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

30 : 
	$mySize
(
size
)

33 
myImage
 = 
Ãw
 
uIÁ8
[
mySize
];

36 
uIÁ32
 
addr
 = 0;‡dd¸< 
mySize
; ++addr)

38 
myImage
[
addr
] = 
image
[addr];

42 
şass
 
Rªdom
 
¿ndom
;

43 
uIÁ32
 
i
 = 0; i < 32768; ++i)

45 
myRam
[
i
] = 
¿ndom
.
	`Ãxt
();

47 
	}
}

50 
	gC¬Œidge3E
::~
	$C¬Œidge3E
()

52 
d–‘e
[] 
myImage
;

53 
	}
}

56 cÚ¡ * 
	gC¬Œidge3E
::
	$Çme
() const

59 
	}
}

62 
	gC¬Œidge3E
::
	$»£t
()

65 
	`bªk
(0);

66 
	}
}

69 
	gC¬Œidge3E
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

71 
mySy¡em
 = &
sy¡em
;

72 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

73 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

76 
	`as£¹
((0x1800 & 
mask
) == 0);

81 
Sy¡em
::
PageAcûss
 
acûss
;

82 
uIÁ32
 
i
 = 0x00; i < 0x40; i +ğ(1 << 
shiá
))

84 
acûss
.
dœeùP“kBa£
 = 0;

85 
acûss
.
dœeùPokeBa£
 = 0;

86 
acûss
.
deviû
 = 
this
;

87 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

91 
uIÁ32
 
j
 = 0x1800; j < 0x2000; j +ğ(1 << 
shiá
))

93 
acûss
.
deviû
 = 
this
;

94 
acûss
.
dœeùP“kBa£
 = &
myImage
[(
mySize
 - 2048è+ (
j
 & 0x07FF)];

95 
acûss
.
dœeùPokeBa£
 = 0;

96 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

100 
	`bªk
(0);

101 
	}
}

104 
uIÁ8
 
	gC¬Œidge3E
::
	$³ek
(
uIÁ16
 
add»ss
)

106 
add»ss
 =‡ddress & 0x0FFF;

108 if(
add»ss
 < 0x0800)

110 if(
myCu¼’tBªk
 < 256)

111  
myImage
[(
add»ss
 & 0x07FFè+ 
myCu¼’tBªk
 * 2048];

113  
myRam
[(
add»ss
 & 0x03FFè+ (
myCu¼’tBªk
 - 256) * 1024];

117  
myImage
[(
add»ss
 & 0x07FFè+ 
mySize
 - 2048];

119 
	}
}

122 
	gC¬Œidge3E
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

124 
add»ss
 =‡ddress & 0x0FFF;

128 if(
add»ss
 == 0x003F)

130 
	`bªk
(
v®ue
);

132 if(
add»ss
 == 0x003E)

134 
	`bªk
(
v®ue
 + 256);

141 
mySy¡em
->
	`tŸ
().
	`poke
(
add»ss
, 
v®ue
);

142 
	}
}

145 
boŞ
 
	gC¬Œidge3E
::
	$§ve
(
S”Ÿliz”
& 
out
)

147 
¡ršg
 
ÿ¹
 = 
	`Çme
();

149 
Œy


151 
out
.
	`putSŒšg
(
ÿ¹
);

152 
out
.
	`putIÁ
(
myCu¼’tBªk
);

155 
out
.
	`putIÁ
(32768);

156 
uIÁ32
 
addr
 = 0;‡ddr < 32768; ++addr)

157 
out
.
	`putIÁ
(
myRam
[
addr
]);

159 
	`ÿtch
(cÚ¡ * 
msg
)

161 
û¼
 << 
msg
 << 
’dl
;

162  
çl£
;

164 
	`ÿtch
(...)

166 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

167  
çl£
;

170  
Œue
;

171 
	}
}

174 
boŞ
 
	gC¬Œidge3E
::
	$lßd
(
De£rŸliz”
& 
š
)

176 
¡ršg
 
ÿ¹
 = 
	`Çme
();

178 
Œy


180 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

181  
çl£
;

183 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

186 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

187 
uIÁ32
 
addr
 = 0;‡dd¸< 
lim™
; ++addr)

188 
myRam
[
addr
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

190 
	`ÿtch
(cÚ¡ * 
msg
)

192 
û¼
 << 
msg
 << 
’dl
;

193  
çl£
;

195 
	`ÿtch
(...)

197 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

198  
çl£
;

202 
	`bªk
(
myCu¼’tBªk
);

204  
Œue
;

205 
	}
}

208 
	gC¬Œidge3E
::
	$bªk
(
uIÁ16
 
bªk
)

210 if(
bªkLocked
) ;

212 if(
bªk
 < 256)

215 if((
uIÁ32
)
bªk
 * 2048 < 
mySize
)

217 
myCu¼’tBªk
 = 
bªk
;

223 
myCu¼’tBªk
 = 
bªk
 % (
mySize
 / 2048);

226 
uIÁ32
 
off£t
 = 
myCu¼’tBªk
 * 2048;

227 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

230 
Sy¡em
::
PageAcûss
 
acûss
;

231 
acûss
.
deviû
 = 
this
;

232 
acûss
.
dœeùPokeBa£
 = 0;

235 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x1800;‡dd»s +ğ(1 << 
shiá
))

237 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x07FF)];

238 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

243 
bªk
 -= 256;

244 
bªk
 %= 32;

245 
myCu¼’tBªk
 = 
bªk
 + 256;

247 
uIÁ32
 
off£t
 = 
bªk
 * 1024;

248 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

249 
uIÁ32
 
add»ss
;

252 
Sy¡em
::
PageAcûss
 
acûss
;

253 
acûss
.
deviû
 = 
this
;

254 
acûss
.
dœeùPokeBa£
 = 0;

257 
add»ss
 = 0x1000;‡dd»s < 0x1400;‡dd»s +ğ(1 << 
shiá
))

259 
acûss
.
dœeùP“kBa£
 = &
myRam
[
off£t
 + (
add»ss
 & 0x03FF)];

260 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

263 
acûss
.
dœeùP“kBa£
 = 0;

266 
add»ss
 = 0x1400;‡dd»s < 0x1800;‡dd»s +ğ(1 << 
shiá
))

268 
acûss
.
dœeùPokeBa£
 = &
myRam
[
off£t
 + (
add»ss
 & 0x03FF)];

269 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

272 
	}
}

275 
	gC¬Œidge3E
::
	$bªk
()

277  
myCu¼’tBªk
;

278 
	}
}

281 
	gC¬Œidge3E
::
	$bªkCouÁ
()

283  
mySize
 / 2048;

284 
	}
}

287 
boŞ
 
	gC¬Œidge3E
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

289 
add»ss
 =‡ddress & 0x0FFF;

290 if(
add»ss
 < 0x0800)

292 if(
myCu¼’tBªk
 < 256)

293 
myImage
[(
add»ss
 & 0x07FFè+ 
myCu¼’tBªk
 * 2048] = 
v®ue
;

295 
myRam
[(
add»ss
 & 0x03FFè+ (
myCu¼’tBªk
 - 256è* 1024] = 
v®ue
;

299 
myImage
[(
add»ss
 & 0x07FFè+ 
mySize
 - 2048] = 
v®ue
;

301  
Œue
;

302 
	}
}

305 
uIÁ8
* 
	gC¬Œidge3E
::
	$g‘Image
(& 
size
)

307 
size
 = 
mySize
;

308  &
myImage
[0];

309 
	}
}

	@emucore/Cart3E.hxx

19 #iâdeà
CARTRIDGE3E_HXX


20 
	#CARTRIDGE3E_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

65 şas 
	cC¬Œidge3E
 : 
public
 
C¬Œidge


67 
public
:

74 
C¬Œidge3E
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

79 
	mvœtu®
 ~
C¬Œidge3E
();

81 
	mpublic
:

87 
vœtu®
 cÚ¡ * 
	$Çme
() const;

92 
vœtu®
 
	`»£t
();

100 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

108 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

116 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

123 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

130 
vœtu®
 
	`bªk
();

135 
vœtu®
 
	`bªkCouÁ
();

144 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

152 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

154 
public
:

160 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

168 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

170 
´iv©e
:

172 
uIÁ16
 
myCu¼’tBªk
;

175 
uIÁ8
* 
myImage
;

178 
uIÁ8
 
myRam
[32768];

181 
uIÁ32
 
mySize
;

	@emucore/Cart3F.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"TIA.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬t3F.hxx
"

28 
	gC¬Œidge3F
::
	$C¬Œidge3F
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

29 : 
	$mySize
(
size
)

32 
myImage
 = 
Ãw
 
uIÁ8
[
mySize
];

35 
uIÁ32
 
addr
 = 0;‡dd¸< 
mySize
; ++addr)

37 
myImage
[
addr
] = 
image
[addr];

39 
	}
}

42 
	gC¬Œidge3F
::~
	$C¬Œidge3F
()

44 
d–‘e
[] 
myImage
;

45 
	}
}

48 cÚ¡ * 
	gC¬Œidge3F
::
	$Çme
() const

51 
	}
}

54 
	gC¬Œidge3F
::
	$»£t
()

57 
	`bªk
(0);

58 
	}
}

61 
	gC¬Œidge3F
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

63 
mySy¡em
 = &
sy¡em
;

64 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

65 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

68 
	`as£¹
((0x1800 & 
mask
) == 0);

74 
Sy¡em
::
PageAcûss
 
acûss
;

75 
uIÁ32
 
i
 = 0x00; i < 0x40; i +ğ(1 << 
shiá
))

77 
acûss
.
dœeùP“kBa£
 = 0;

78 
acûss
.
dœeùPokeBa£
 = 0;

79 
acûss
.
deviû
 = 
this
;

80 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

84 
uIÁ32
 
j
 = 0x1800; j < 0x2000; j +ğ(1 << 
shiá
))

86 
acûss
.
deviû
 = 
this
;

87 
acûss
.
dœeùP“kBa£
 = &
myImage
[(
mySize
 - 2048è+ (
j
 & 0x07FF)];

88 
acûss
.
dœeùPokeBa£
 = 0;

89 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

93 
	`bªk
(0);

94 
	}
}

97 
uIÁ8
 
	gC¬Œidge3F
::
	$³ek
(
uIÁ16
 
add»ss
)

99 
add»ss
 =‡ddress & 0x0FFF;

101 if(
add»ss
 < 0x0800)

103  
myImage
[(
add»ss
 & 0x07FFè+ 
myCu¼’tBªk
 * 2048];

107  
myImage
[(
add»ss
 & 0x07FFè+ 
mySize
 - 2048];

109 
	}
}

112 
	gC¬Œidge3F
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

114 
add»ss
 =‡ddress & 0x0FFF;

117 if(
add»ss
 <= 0x003F)

119 
	`bªk
(
v®ue
);

122 
mySy¡em
->
	`tŸ
().
	`poke
(
add»ss
, 
v®ue
);

123 
	}
}

126 
boŞ
 
	gC¬Œidge3F
::
	$§ve
(
S”Ÿliz”
& 
out
)

128 
¡ršg
 
ÿ¹
 = 
	`Çme
();

130 
Œy


132 
out
.
	`putSŒšg
(
ÿ¹
);

133 
out
.
	`putIÁ
(
myCu¼’tBªk
);

135 
	`ÿtch
(cÚ¡ * 
msg
)

137 
û¼
 << 
msg
 << 
’dl
;

138  
çl£
;

140 
	`ÿtch
(...)

142 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

143  
çl£
;

146  
Œue
;

147 
	}
}

150 
boŞ
 
	gC¬Œidge3F
::
	$lßd
(
De£rŸliz”
& 
š
)

152 
¡ršg
 
ÿ¹
 = 
	`Çme
();

154 
Œy


156 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

157  
çl£
;

159 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

161 
	`ÿtch
(cÚ¡ * 
msg
)

163 
û¼
 << 
msg
 << 
’dl
;

164  
çl£
;

166 
	`ÿtch
(...)

168 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

169  
çl£
;

173 
	`bªk
(
myCu¼’tBªk
);

175  
Œue
;

176 
	}
}

179 
	gC¬Œidge3F
::
	$bªk
(
uIÁ16
 
bªk
)

181 if(
bªkLocked
) ;

184 if((
uIÁ32
)
bªk
 * 2048 < 
mySize
)

186 
myCu¼’tBªk
 = 
bªk
;

192 
myCu¼’tBªk
 = 
bªk
 % (
mySize
 / 2048);

195 
uIÁ32
 
off£t
 = 
myCu¼’tBªk
 * 2048;

196 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

199 
Sy¡em
::
PageAcûss
 
acûss
;

200 
acûss
.
deviû
 = 
this
;

201 
acûss
.
dœeùPokeBa£
 = 0;

204 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x1800;‡dd»s +ğ(1 << 
shiá
))

206 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x07FF)];

207 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

209 
	}
}

212 
	gC¬Œidge3F
::
	$bªk
()

214  
myCu¼’tBªk
;

215 
	}
}

218 
	gC¬Œidge3F
::
	$bªkCouÁ
()

220  
mySize
 / 2048;

221 
	}
}

224 
boŞ
 
	gC¬Œidge3F
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

226 
add»ss
 =‡ddress & 0x0FFF;

227 if(
add»ss
 < 0x0800)

229 
myImage
[(
add»ss
 & 0x07FFè+ 
myCu¼’tBªk
 * 2048] = 
v®ue
;

233 
myImage
[(
add»ss
 & 0x07FFè+ 
mySize
 - 2048] = 
v®ue
;

235  
Œue
;

236 
	}
}

239 
uIÁ8
* 
	gC¬Œidge3F
::
	$g‘Image
(& 
size
)

241 
size
 = 
mySize
;

242  &
myImage
[0];

243 
	}
}

	@emucore/Cart3F.hxx

19 #iâdeà
CARTRIDGE3F_HXX


20 
	#CARTRIDGE3F_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

42 şas 
	cC¬Œidge3F
 : 
public
 
C¬Œidge


44 
public
:

51 
C¬Œidge3F
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

56 
	mvœtu®
 ~
C¬Œidge3F
();

58 
	mpublic
:

64 
vœtu®
 cÚ¡ * 
	$Çme
() const;

69 
vœtu®
 
	`»£t
();

77 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

85 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

93 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

100 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

107 
vœtu®
 
	`bªk
();

112 
vœtu®
 
	`bªkCouÁ
();

121 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

129 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

131 
public
:

137 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

145 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

147 
´iv©e
:

149 
uIÁ16
 
myCu¼’tBªk
;

152 
uIÁ8
* 
myImage
;

155 
uIÁ32
 
mySize
;

	@emucore/Cart4A50.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬t4A50.hxx
"

27 
	gC¬Œidge4A50
::
	$C¬Œidge4A50
(cÚ¡ 
uIÁ8
* 
image
)

29 
	}
}

32 
C¬Œidge4A50
::~
	$C¬Œidge4A50
()

34 
	}
}

37 cÚ¡ * 
C¬Œidge4A50
::
	$Çme
() const

40 
	}
}

43 
	gC¬Œidge4A50
::
	$»£t
()

45 
	}
}

48 
C¬Œidge4A50
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

50 
	}
}

53 
uIÁ8
 
C¬Œidge4A50
::
	$³ek
(
uIÁ16
 
add»ss
)

56 
	}
}

59 
	gC¬Œidge4A50
::
	$poke
(
uIÁ16
, 
uIÁ8
)

61 
	}
}

64 
boŞ
 
	gC¬Œidge4A50
::
	$§ve
(
S”Ÿliz”
& 
out
)

66  
çl£
;

67 
	}
}

70 
boŞ
 
	gC¬Œidge4A50
::
	$lßd
(
De£rŸliz”
& 
š
)

72  
çl£
;

73 
	}
}

76 
	gC¬Œidge4A50
::
	$bªk
(
uIÁ16
 
b
)

78 
	}
}

81 
C¬Œidge4A50
::
	$bªk
()

84 
	}
}

87 
	gC¬Œidge4A50
::
	$bªkCouÁ
()

90 
	}
}

93 
boŞ
 
	gC¬Œidge4A50
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

95  
çl£
;

96 
	}
}

99 
uIÁ8
* 
	gC¬Œidge4A50
::
	$g‘Image
(& 
size
)

101 
size
 = 0;

103 
	}
}

	@emucore/Cart4A50.hxx

19 #iâdeà
CARTRIDGE4A50_HXX


20 
	#CARTRIDGE4A50_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬Œidge4A50
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬Œidge4A50
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬Œidge4A50
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

	@emucore/Cart4K.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬t4K.hxx
"

27 
	gC¬Œidge4K
::
	$C¬Œidge4K
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 4096; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬Œidge4K
::~
	$C¬Œidge4K
()

39 
	}
}

42 cÚ¡ * 
C¬Œidge4K
::
	$Çme
() const

45 
	}
}

48 
	gC¬Œidge4K
::
	$»£t
()

50 
	}
}

53 
C¬Œidge4K
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

55 
mySy¡em
 = &
sy¡em
;

56 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

57 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

60 
	`as£¹
((0x1000 & 
mask
) == 0);

62 
Sy¡em
::
PageAcûss
 
acûss
;

63 
acûss
.
dœeùPokeBa£
 = 0;

64 
acûss
.
deviû
 = 
this
;

67 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x2000;‡dd»s +ğ(1 << 
shiá
))

69 
acûss
.
dœeùP“kBa£
 = &
myImage
[
add»ss
 & 0x0FFF];

70 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> mySy¡em->
	`·geShiá
(), 
acûss
);

72 
	}
}

75 
uIÁ8
 
	gC¬Œidge4K
::
	$³ek
(
uIÁ16
 
add»ss
)

77  
myImage
[
add»ss
 & 0x0FFF];

78 
	}
}

81 
	gC¬Œidge4K
::
	$poke
(
uIÁ16
, 
uIÁ8
)

84 
	}
}

87 
boŞ
 
	gC¬Œidge4K
::
	$§ve
(
S”Ÿliz”
& 
out
)

89 
¡ršg
 
ÿ¹
 = 
	`Çme
();

91 
Œy


93 
out
.
	`putSŒšg
(
ÿ¹
);

95 
	`ÿtch
(cÚ¡ * 
msg
)

97 
û¼
 << 
msg
 << 
’dl
;

98  
çl£
;

100 
	`ÿtch
(...)

102 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

103  
çl£
;

106  
Œue
;

107 
	}
}

110 
boŞ
 
	gC¬Œidge4K
::
	$lßd
(
De£rŸliz”
& 
š
)

112 
¡ršg
 
ÿ¹
 = 
	`Çme
();

114 
Œy


116 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

117  
çl£
;

119 
	`ÿtch
(cÚ¡ * 
msg
)

121 
û¼
 << 
msg
 << 
’dl
;

122  
çl£
;

124 
	`ÿtch
(...)

126 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

127  
çl£
;

130  
Œue
;

131 
	}
}

134 
	gC¬Œidge4K
::
	$bªk
(
uIÁ16
 
bªk
)

137 
	}
}

140 
C¬Œidge4K
::
	$bªk
()

144 
	}
}

147 
	gC¬Œidge4K
::
	$bªkCouÁ
()

150 
	}
}

153 
boŞ
 
	gC¬Œidge4K
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

155 
myImage
[
add»ss
 & 0x0FFF] = 
v®ue
;

156  
Œue
;

157 
	}
}

160 
uIÁ8
* 
	gC¬Œidge4K
::
	$g‘Image
(& 
size
)

162 
size
 = 4096;

163  &
myImage
[0];

164 
	}
}

	@emucore/Cart4K.hxx

19 #iâdeà
CARTRIDGE4K_HXX


20 
	#CARTRIDGE4K_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬Œidge4K
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬Œidge4K
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬Œidge4K
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ8
 
myImage
[4096];

	@emucore/CartAR.cxx

19 
	~<¡ršg.h
>

21 
	~<ÿs£¹
>

23 
	~"M6502Hi.hxx
"

24 
	~"Rªdom.hxx
"

25 
	~"Sy¡em.hxx
"

26 
	~"S”Ÿliz”.hxx
"

27 
	~"De£rŸliz”.hxx
"

28 
	~"C¬tAR.hxx
"

31 
	gC¬ŒidgeAR
::
	$C¬ŒidgeAR
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
, 
boŞ
 
ç¡bios
)

32 : 
	$my6502
(0)

34 
uIÁ32
 
i
;

37 
myLßdImages
 = 
Ãw
 
uIÁ8
[
size
];

38 
myNumb”OfLßdImages
 = 
size
 / 8448;

39 
	`memıy
(
myLßdImages
, 
image
, 
size
);

42 
şass
 
Rªdom
 
¿ndom
;

43 
i
 = 0; i < 6 * 1024; ++i)

45 
myImage
[
i
] = 
¿ndom
.
	`Ãxt
();

49 
	`š™ŸlizeROM
(
ç¡bios
);

50 
	}
}

53 
	gC¬ŒidgeAR
::~
	$C¬ŒidgeAR
()

55 
d–‘e
[] 
myLßdImages
;

56 
	}
}

59 cÚ¡ * 
	gC¬ŒidgeAR
::
	$Çme
() const

62 
	}
}

65 
	gC¬ŒidgeAR
::
	$»£t
()

67 
myPow”
 = 
Œue
;

68 
myPow”RomCyşe
 = 
mySy¡em
->
	`cyşes
();

69 
myWr™eEÇbËd
 = 
çl£
;

71 
myD©aHŞdRegi¡”
 = 0;

72 
myNumb”OfDi¡šùAcûs£s
 = 0;

73 
myWr™eP’dšg
 = 
çl£
;

76 
	`bªkCÚfigu¿tiÚ
(0);

77 
	}
}

80 
	gC¬ŒidgeAR
::
	$sy¡emCyşesRe£t
()

83 
uIÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
();

86 
myPow”RomCyşe
 -ğ
cyşes
;

87 
	}
}

90 
	gC¬ŒidgeAR
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

92 
mySy¡em
 = &
sy¡em
;

93 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

94 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

96 
my6502
 = &(
M6502High
&)
mySy¡em
->
	`m6502
();

99 
	`as£¹
((0x1000 & 
mask
) == 0);

101 
Sy¡em
::
PageAcûss
 
acûss
;

102 
uIÁ32
 
i
 = 0x1000; i < 0x2000; i +ğ(1 << 
shiá
))

104 
acûss
.
dœeùP“kBa£
 = 0;

105 
acûss
.
dœeùPokeBa£
 = 0;

106 
acûss
.
deviû
 = 
this
;

107 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

110 
	`bªkCÚfigu¿tiÚ
(0);

111 
	}
}

114 
uIÁ8
 
	gC¬ŒidgeAR
::
	$³ek
(
uIÁ16
 
addr
)

117 if(((
addr
 & 0x1FFFè=ğ0x1850è&& (
myImageOff£t
[1] == (3 * 2048)))

120 
uIÁ8
 
lßd
 = 
mySy¡em
->
	`³ek
(0x0080);

123 
	`lßdIÁoRAM
(
lßd
);

125  
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[1]];

130 if(
myWr™eP’dšg
 &&

131 (
my6502
->
	`di¡šùAcûs£s
(è> 
myNumb”OfDi¡šùAcûs£s
 + 5))

133 
myWr™eP’dšg
 = 
çl£
;

137 if(!(
addr
 & 0x0F00è&& (!
myWr™eEÇbËd
 || !
myWr™eP’dšg
))

139 
myD©aHŞdRegi¡”
 = 
addr
;

140 
myNumb”OfDi¡šùAcûs£s
 = 
my6502
->
	`di¡šùAcûs£s
();

141 
myWr™eP’dšg
 = 
Œue
;

144 if((
addr
 & 0x1FFF) == 0x1FF8)

147 
myWr™eP’dšg
 = 
çl£
;

148 
	`bªkCÚfigu¿tiÚ
(
myD©aHŞdRegi¡”
);

151 if(
myWr™eEÇbËd
 && 
myWr™eP’dšg
 &&

152 (
my6502
->
	`di¡šùAcûs£s
(è=ğ(
myNumb”OfDi¡šùAcûs£s
 + 5)))

154 if((
addr
 & 0x0800) == 0)

155 
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[0]] = 
myD©aHŞdRegi¡”
;

156 if(
myImageOff£t
[1] != 3 * 2048)

157 
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[1]] = 
myD©aHŞdRegi¡”
;

158 
myWr™eP’dšg
 = 
çl£
;

161  
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[(addr & 0x0800) ? 1 : 0]];

162 
	}
}

165 
	gC¬ŒidgeAR
::
	$poke
(
uIÁ16
 
addr
, 
uIÁ8
)

169 if(
myWr™eP’dšg
 &&

170 (
my6502
->
	`di¡šùAcûs£s
(è> 
myNumb”OfDi¡šùAcûs£s
 + 5))

172 
myWr™eP’dšg
 = 
çl£
;

176 if(!(
addr
 & 0x0F00è&& (!
myWr™eEÇbËd
 || !
myWr™eP’dšg
))

178 
myD©aHŞdRegi¡”
 = 
addr
;

179 
myNumb”OfDi¡šùAcûs£s
 = 
my6502
->
	`di¡šùAcûs£s
();

180 
myWr™eP’dšg
 = 
Œue
;

183 if((
addr
 & 0x1FFF) == 0x1FF8)

186 
myWr™eP’dšg
 = 
çl£
;

187 
	`bªkCÚfigu¿tiÚ
(
myD©aHŞdRegi¡”
);

190 if(
myWr™eEÇbËd
 && 
myWr™eP’dšg
 &&

191 (
my6502
->
	`di¡šùAcûs£s
(è=ğ(
myNumb”OfDi¡šùAcûs£s
 + 5)))

193 if((
addr
 & 0x0800) == 0)

194 
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[0]] = 
myD©aHŞdRegi¡”
;

195 if(
myImageOff£t
[1] != 3 * 2048)

196 
myImage
[(
addr
 & 0x07FFè+ 
myImageOff£t
[1]] = 
myD©aHŞdRegi¡”
;

197 
myWr™eP’dšg
 = 
çl£
;

199 
	}
}

202 
	gC¬ŒidgeAR
::
	$bªkCÚfigu¿tiÚ
(
uIÁ8
 
cÚfigu¿tiÚ
)

222 
myCu¼’tBªk
 = 
cÚfigu¿tiÚ
 & 0x1f;

225 
myPow”
 = !(
cÚfigu¿tiÚ
 & 0x01);

227 if(
myPow”
)

229 
myPow”RomCyşe
 = 
mySy¡em
->
	`cyşes
();

232 
myWr™eEÇbËd
 = 
cÚfigu¿tiÚ
 & 0x02;

234 (
cÚfigu¿tiÚ
 >> 2) & 0x07)

238 
myImageOff£t
[0] = 2 * 2048;

239 
myImageOff£t
[1] = 3 * 2048;

245 
myImageOff£t
[0] = 0 * 2048;

246 
myImageOff£t
[1] = 3 * 2048;

252 
myImageOff£t
[0] = 2 * 2048;

253 
myImageOff£t
[1] = 0 * 2048;

259 
myImageOff£t
[0] = 0 * 2048;

260 
myImageOff£t
[1] = 2 * 2048;

266 
myImageOff£t
[0] = 2 * 2048;

267 
myImageOff£t
[1] = 3 * 2048;

273 
myImageOff£t
[0] = 1 * 2048;

274 
myImageOff£t
[1] = 3 * 2048;

280 
myImageOff£t
[0] = 2 * 2048;

281 
myImageOff£t
[1] = 1 * 2048;

287 
myImageOff£t
[0] = 1 * 2048;

288 
myImageOff£t
[1] = 2 * 2048;

292 
	}
}

295 
	gC¬ŒidgeAR
::
	$š™ŸlizeROM
(
boŞ
 
ç¡bios
)

297 
uIÁ8
 
dummyROMCode
[] = {

339 if(
ç¡bios
)

340 
dummyROMCode
[189] = 0x0;

342 
uIÁ32
 
size
 = (
dummyROMCode
);

345 
uIÁ32
 
i
 = 0; i < 2048; ++i)

347 
myImage
[3 * 2048 + 
i
] = 0x02;

351 
uIÁ32
 
j
 = 0; j < 
size
; ++j)

353 
myImage
[3 * 2048 + 
j
] = 
dummyROMCode
[j];

357 
myImage
[3 * 2048 + 2044] = 0x0A;

358 
myImage
[3 * 2048 + 2045] = 0xF8;

359 
myImage
[3 * 2048 + 2046] = 0x0A;

360 
myImage
[3 * 2048 + 2047] = 0xF8;

361 
	}
}

364 
uIÁ8
 
	gC¬ŒidgeAR
::
	$checksum
(
uIÁ8
* 
s
, 
uIÁ16
 
Ëngth
)

366 
uIÁ8
 
sum
 = 0;

368 
uIÁ32
 
i
 = 0; i < 
Ëngth
; ++i)

370 
sum
 +ğ
s
[
i
];

373  
sum
;

374 
	}
}

377 
	gC¬ŒidgeAR
::
	$lßdIÁoRAM
(
uIÁ8
 
lßd
)

379 
uIÁ16
 
image
;

382 
image
 = 0; imag< 
myNumb”OfLßdImages
; ++image)

385 if(
myLßdImages
[(
image
 * 8448è+ 8192 + 5] =ğ
lßd
)

388 
	`memıy
(
myH—d”
, 
myLßdImages
 + (
image
 * 8448) + 8192, 256);

391 if(
	`checksum
(
myH—d”
, 8) != 0x55)

393 
û¼
 << "WARNING: The Supercharger header checksum is invalid...\n";

397 
boŞ
 
šv®idPageChecksumS“n
 = 
çl£
;

398 
uIÁ32
 
j
 = 0; j < 
myH—d”
[3]; ++j)

400 
uIÁ32
 
bªk
 = 
myH—d”
[16 + 
j
] & 0x03;

401 
uIÁ32
 
·ge
 = (
myH—d”
[16 + 
j
] >> 2) & 0x07;

402 
uIÁ8
* 
¤c
 = 
myLßdImages
 + (
image
 * 8448è+ (
j
 * 256);

403 
uIÁ8
 
sum
 = 
	`checksum
(
¤c
, 256è+ 
myH—d”
[16 + 
j
] + myHeader[64 + j];

405 if(!
šv®idPageChecksumS“n
 && (
sum
 != 0x55))

407 
û¼
 << "WARNING: Some Supercharger…age checksums‡re invalid...\n";

408 
šv®idPageChecksumS“n
 = 
Œue
;

412 if(
bªk
 < 3)

414 
	`memıy
(
myImage
 + (
bªk
 * 2048è+ (
·ge
 * 256), 
¤c
, 256);

420 
mySy¡em
->
	`poke
(0xã, 
myH—d”
[0]);

421 
mySy¡em
->
	`poke
(0xff, 
myH—d”
[1]);

422 
mySy¡em
->
	`poke
(0x80, 
myH—d”
[2]);

430 
û¼
 << "ERROR: Supercharger†oad is missing from ROM image...\n";

431 
	}
}

434 
boŞ
 
	gC¬ŒidgeAR
::
	$§ve
(
S”Ÿliz”
& 
out
)

436 
¡ršg
 
ÿ¹
 = 
	`Çme
();

438 
Œy


440 
uIÁ32
 
i
;

442 
out
.
	`putSŒšg
(
ÿ¹
);

445 
out
.
	`putIÁ
(2);

446 
i
 = 0; i < 2; ++i)

447 
out
.
	`putIÁ
(
myImageOff£t
[
i
]);

450 
out
.
	`putIÁ
(8192);

451 
i
 = 0; i < 8192; ++i)

452 
out
.
	`putIÁ
(
myImage
[
i
]);

455 
out
.
	`putIÁ
(256);

456 
i
 = 0; i < 256; ++i)

457 
out
.
	`putIÁ
(
myH—d”
[
i
]);

461 
out
.
	`putIÁ
(
myNumb”OfLßdImages
 * 8448);

462 
i
 = 0; i < (
uIÁ32
è
myNumb”OfLßdImages
 * 8448; ++i)

463 
out
.
	`putIÁ
(
myLßdImages
[
i
]);

466 
out
.
	`putIÁ
(
myNumb”OfLßdImages
);

469 
out
.
	`putBoŞ
(
myWr™eEÇbËd
);

472 
out
.
	`putBoŞ
(
myPow”
);

475 
out
.
	`putIÁ
(
myPow”RomCyşe
);

478 
out
.
	`putIÁ
(
myD©aHŞdRegi¡”
);

481 
out
.
	`putIÁ
(
myNumb”OfDi¡šùAcûs£s
);

484 
out
.
	`putBoŞ
(
myWr™eP’dšg
);

486 
	`ÿtch
(cÚ¡ * 
msg
)

488 
û¼
 << 
msg
 << 
’dl
;

489  
çl£
;

491 
	`ÿtch
(...)

493 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

494  
çl£
;

497  
Œue
;

498 
	}
}

501 
boŞ
 
	gC¬ŒidgeAR
::
	$lßd
(
De£rŸliz”
& 
š
)

503 
¡ršg
 
ÿ¹
 = 
	`Çme
();

505 
Œy


507 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

508  
çl£
;

510 
uIÁ32
 
i
, 
lim™
;

513 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

514 
i
 = 0; i < 
lim™
; ++i)

515 
myImageOff£t
[
i
] = (
uIÁ32
è
š
.
	`g‘IÁ
();

518 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

519 
i
 = 0; i < 
lim™
; ++i)

520 
myImage
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

523 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

524 
i
 = 0; i < 
lim™
; ++i)

525 
myH—d”
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

529 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

530 
i
 = 0; i < 
lim™
; ++i)

531 
myLßdImages
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

534 
myNumb”OfLßdImages
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

537 
myWr™eEÇbËd
 = 
š
.
	`g‘BoŞ
();

540 
myPow”
 = 
š
.
	`g‘BoŞ
();

543 
myPow”RomCyşe
 = (
IÁ32
è
š
.
	`g‘IÁ
();

546 
myD©aHŞdRegi¡”
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

549 
myNumb”OfDi¡šùAcûs£s
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

552 
myWr™eP’dšg
 = 
š
.
	`g‘BoŞ
();

554 
	`ÿtch
(cÚ¡ * 
msg
)

556 
û¼
 << 
msg
 << 
’dl
;

557  
çl£
;

559 
	`ÿtch
(...)

561 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

562  
çl£
;

565  
Œue
;

566 
	}
}

569 
	gC¬ŒidgeAR
::
	$bªk
(
uIÁ16
 
bªk
)

571 if(
bªkLocked
) ;

573 
	`bªkCÚfigu¿tiÚ
(
bªk
);

574 
	}
}

577 
	gC¬ŒidgeAR
::
	$bªk
()

579  
myCu¼’tBªk
;

580 
	}
}

583 
	gC¬ŒidgeAR
::
	$bªkCouÁ
()

586 
	}
}

589 
boŞ
 
	gC¬ŒidgeAR
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

592  
çl£
;

593 
	}
}

596 
uIÁ8
* 
	gC¬ŒidgeAR
::
	$g‘Image
(& 
size
)

598 
size
 = 
myNumb”OfLßdImages
 * 8448;

599  &
myLßdImages
[0];

600 
	}
}

	@emucore/CartAR.hxx

19 #iâdeà
CARTRIDGEAR_HXX


20 
	#CARTRIDGEAR_HXX


	)

22 
şass
 
	gM6502High
;

23 
şass
 
	gSy¡em
;

24 
şass
 
	gS”Ÿliz”
;

25 
şass
 
	gDe£rŸliz”
;

27 
	~"b¥f.hxx
"

28 
	~"C¬t.hxx
"

42 şas 
	cC¬ŒidgeAR
 : 
public
 
C¬Œidge


44 
public
:

52 
C¬ŒidgeAR
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
, 
boŞ
 
ç¡bios
);

57 
	mvœtu®
 ~
C¬ŒidgeAR
();

59 
	mpublic
:

65 
vœtu®
 cÚ¡ * 
	$Çme
() const;

70 
vœtu®
 
	`»£t
();

77 
vœtu®
 
	`sy¡emCyşesRe£t
();

85 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

93 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

101 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

108 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

115 
vœtu®
 
	`bªk
();

120 
vœtu®
 
	`bªkCouÁ
();

129 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

137 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

139 
public
:

145 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

153 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

155 
´iv©e
:

157 
	`bªkCÚfigu¿tiÚ
(
uIÁ8
 
cÚfigu¿tiÚ
);

160 
uIÁ8
 
	`checksum
(uIÁ8* 
s
, 
uIÁ16
 
Ëngth
);

163 
	`lßdIÁoRAM
(
uIÁ8
 
lßd
);

166 
	`š™ŸlizeROM
(
boŞ
 
ç¡bios
);

168 
´iv©e
:

170 
M6502High
* 
my6502
;

173 
uIÁ32
 
myImageOff£t
[2];

176 
uIÁ8
 
myImage
[8192];

179 
uIÁ8
 
myH—d”
[256];

182 
uIÁ8
* 
myLßdImages
;

185 
uIÁ8
 
myNumb”OfLßdImages
;

188 
boŞ
 
myWr™eEÇbËd
;

191 
boŞ
 
myPow”
;

194 
IÁ32
 
myPow”RomCyşe
;

197 
uIÁ8
 
myD©aHŞdRegi¡”
;

200 
uIÁ32
 
myNumb”OfDi¡šùAcûs£s
;

203 
boŞ
 
myWr™eP’dšg
;

205 
uIÁ16
 
myCu¼’tBªk
;

	@emucore/CartCV.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tCV.hxx
"

28 
	gC¬ŒidgeCV
::
	$C¬ŒidgeCV
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

30 
uIÁ32
 
addr
;

31 if(
size
 == 2048)

34 
uIÁ32
 
addr
 = 0;‡ddr < 2048; ++addr)

36 
myImage
[
addr
] = 
image
[addr];

40 
şass
 
Rªdom
 
¿ndom
;

41 
uIÁ32
 
i
 = 0; i < 1024; ++i)

43 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

46 if(
size
 == 4096)

52 
addr
 = 0;‡ddr < 2048; ++addr)

54 
myImage
[
addr
] = 
image
[addr + 2048];

58 
addr
 = 0;‡ddr < 1024; ++addr)

60 
myRAM
[
addr
] = 
image
[addr];

64 
	}
}

67 
	gC¬ŒidgeCV
::~
	$C¬ŒidgeCV
()

69 
	}
}

72 cÚ¡ * 
C¬ŒidgeCV
::
	$Çme
() const

75 
	}
}

78 
	gC¬ŒidgeCV
::
	$»£t
()

80 
	}
}

83 
C¬ŒidgeCV
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

85 
mySy¡em
 = &
sy¡em
;

86 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

87 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

90 
	`as£¹
((0x1800 & 
mask
) == 0);

92 
Sy¡em
::
PageAcûss
 
acûss
;

93 
acûss
.
dœeùPokeBa£
 = 0;

94 
acûss
.
deviû
 = 
this
;

97 
uIÁ32
 
add»ss
 = 0x1800;‡dd»s < 0x2000;‡dd»s +ğ(1 << 
shiá
))

99 
acûss
.
dœeùP“kBa£
 = &
myImage
[
add»ss
 & 0x07FF];

100 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> mySy¡em->
	`·geShiá
(), 
acûss
);

104 
uIÁ32
 
j
 = 0x1400; j < 0x1800; j +ğ(1 << 
shiá
))

106 
acûss
.
deviû
 = 
this
;

107 
acûss
.
dœeùP“kBa£
 = 0;

108 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x03FF];

109 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

113 
uIÁ32
 
k
 = 0x1000; k < 0x1400; k +ğ(1 << 
shiá
))

115 
acûss
.
deviû
 = 
this
;

116 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x03FF];

117 
acûss
.
dœeùPokeBa£
 = 0;

118 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

120 
	}
}

123 
uIÁ8
 
	gC¬ŒidgeCV
::
	$³ek
(
uIÁ16
 
add»ss
)

125  
myImage
[
add»ss
 & 0x07FF];

126 
	}
}

129 
	gC¬ŒidgeCV
::
	$poke
(
uIÁ16
, 
uIÁ8
)

132 
	}
}

135 
boŞ
 
	gC¬ŒidgeCV
::
	$§ve
(
S”Ÿliz”
& 
out
)

137 
¡ršg
 
ÿ¹
 = 
	`Çme
();

139 
Œy


141 
out
.
	`putSŒšg
(
ÿ¹
);

144 
out
.
	`putIÁ
(1024);

145 
uIÁ32
 
addr
 = 0;‡ddr < 1024; ++addr)

146 
out
.
	`putIÁ
(
myRAM
[
addr
]);

148 
	`ÿtch
(cÚ¡ * 
msg
)

150 
û¼
 << 
msg
 << 
’dl
;

151  
çl£
;

153 
	`ÿtch
(...)

155 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

156  
çl£
;

159  
Œue
;

160 
	}
}

163 
boŞ
 
	gC¬ŒidgeCV
::
	$lßd
(
De£rŸliz”
& 
š
)

165 
¡ršg
 
ÿ¹
 = 
	`Çme
();

167 
Œy


169 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

170  
çl£
;

173 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

174 
uIÁ32
 
addr
 = 0;‡dd¸< 
lim™
; ++addr)

175 
myRAM
[
addr
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

177 
	`ÿtch
(cÚ¡ * 
msg
)

179 
û¼
 << 
msg
 << 
’dl
;

180  
çl£
;

182 
	`ÿtch
(...)

184 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

185  
çl£
;

188  
Œue
;

189 
	}
}

192 
	gC¬ŒidgeCV
::
	$bªk
(
uIÁ16
 
bªk
)

195 
	}
}

198 
C¬ŒidgeCV
::
	$bªk
()

202 
	}
}

205 
	gC¬ŒidgeCV
::
	$bªkCouÁ
()

208 
	}
}

211 
boŞ
 
	gC¬ŒidgeCV
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

213 
myImage
[
add»ss
 & 0x07FF] = 
v®ue
;

214  
Œue
;

215 
	}
}

218 
uIÁ8
* 
	gC¬ŒidgeCV
::
	$g‘Image
(& 
size
)

220 
size
 = 2048;

221  &
myImage
[0];

222 
	}
}

	@emucore/CartCV.hxx

19 #iâdeà
CARTRIDGECV_HXX


20 
	#CARTRIDGECV_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

39 şas 
	cC¬ŒidgeCV
 : 
public
 
C¬Œidge


41 
public
:

47 
C¬ŒidgeCV
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

52 
	mvœtu®
 ~
C¬ŒidgeCV
();

54 
	mpublic
:

60 
vœtu®
 cÚ¡ * 
	$Çme
() const;

65 
vœtu®
 
	`»£t
();

73 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

81 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

89 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

96 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

103 
vœtu®
 
	`bªk
();

108 
vœtu®
 
	`bªkCouÁ
();

117 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

125 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

127 
public
:

133 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

141 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

143 
´iv©e
:

145 
uIÁ8
 
myImage
[2048];

148 
uIÁ8
 
myRAM
[1024];

	@emucore/CartDPC.cxx

19 
	~<as£¹.h
>

20 
	~<io¡»am
>

21 
	~"C¬tDPC.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

27 
	gC¬ŒidgeDPC
::
	$C¬ŒidgeDPC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

29 
uIÁ32
 
addr
;

33 
addr
 = 0;‡dd¸< 
size
; ++addr)

34 
myImageCİy
[
addr
] = 
image
[addr];

37 
addr
 = 0;‡ddr < 8192; ++addr)

39 
myProg¿mImage
[
addr
] = 
image
[addr];

43 
addr
 = 0;‡ddr < 2048; ++addr)

45 
myDi¥ÏyImage
[
addr
] = 
image
[8192 +‡ddr];

49 
uIÁ16
 
i
 = 0; i < 8; ++i)

51 
myTİs
[
i
] = 
myBÙtoms
[i] = 
myCouÁ”s
[i] = 
myFÏgs
[i] = 0;

55 
myMusicMode
[0] = myMusicMode[1] = myMusicMode[2] = 
çl£
;

58 
myRªdomNumb”
 = 1;

61 
mySy¡emCyşes
 = 0;

62 
myF¿ùiÚ®Clocks
 = 0.0;

63 
	}
}

66 
	gC¬ŒidgeDPC
::~
	$C¬ŒidgeDPC
()

68 
	}
}

71 cÚ¡ * 
C¬ŒidgeDPC
::
	$Çme
() const

74 
	}
}

77 
	gC¬ŒidgeDPC
::
	$»£t
()

80 
mySy¡emCyşes
 = 
mySy¡em
->
	`cyşes
();

81 
myF¿ùiÚ®Clocks
 = 0.0;

84 
	`bªk
(1);

85 
	}
}

88 
	gC¬ŒidgeDPC
::
	$sy¡emCyşesRe£t
()

91 
uIÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
();

94 
mySy¡emCyşes
 -ğ
cyşes
;

95 
	}
}

98 
	gC¬ŒidgeDPC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

100 
mySy¡em
 = &
sy¡em
;

101 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

102 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

105 
	`as£¹
(((0x1080 & 
mask
) == 0) && ((0x1100 & mask) == 0));

108 
Sy¡em
::
PageAcûss
 
acûss
;

109 
uIÁ32
 
i
 = (0x1FF8 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

111 
acûss
.
dœeùP“kBa£
 = 0;

112 
acûss
.
dœeùPokeBa£
 = 0;

113 
acûss
.
deviû
 = 
this
;

114 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

118 
uIÁ32
 
j
 = 0x1000; j < 0x1080; j +ğ(1 << 
shiá
))

120 
acûss
.
dœeùP“kBa£
 = 0;

121 
acûss
.
dœeùPokeBa£
 = 0;

122 
acûss
.
deviû
 = 
this
;

123 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

127 
	`bªk
(1);

128 
	}
}

131 
šlše
 
	gC¬ŒidgeDPC
::
	$şockRªdomNumb”G’”©Ü
()

135 cÚ¡ 
uIÁ8
 
f
[16] = {

141 
uIÁ8
 
b™
 = 
f
[((
myRªdomNumb”
 >> 3) & 0x07) |

142 ((
myRªdomNumb”
 & 0x80) ? 0x08 : 0x00)];

145 
myRªdomNumb”
 = (myRªdomNumb” << 1è| 
b™
;

146 
	}
}

149 
šlše
 
	gC¬ŒidgeDPC
::
	$upd©eMusicModeD©aF‘ch”s
()

152 
IÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
(è- 
mySy¡emCyşes
;

153 
mySy¡emCyşes
 = 
mySy¡em
->
	`cyşes
();

156 
şocks
 = ((15750.0 * 
cyşes
è/ 1193191.66666667è+ 
myF¿ùiÚ®Clocks
;

157 
IÁ32
 
whŞeClocks
 = (IÁ32)
şocks
;

158 
myF¿ùiÚ®Clocks
 = 
şocks
 - ()
whŞeClocks
;

160 if(
whŞeClocks
 <= 0)

166 
x
 = 5; x <= 7; ++x)

169 if(
myMusicMode
[
x
 - 5])

171 
IÁ32
 
tİ
 = 
myTİs
[
x
] + 1;

172 
IÁ32
 
ÃwLow
 = (IÁ32)(
myCouÁ”s
[
x
] & 0x00ff);

174 if(
myTİs
[
x
] != 0)

176 
ÃwLow
 -ğ(
whŞeClocks
 % 
tİ
);

177 if(
ÃwLow
 < 0)

179 
ÃwLow
 +ğ
tİ
;

184 
ÃwLow
 = 0;

188 if(
ÃwLow
 <ğ
myBÙtoms
[
x
])

190 
myFÏgs
[
x
] = 0x00;

192 if(
ÃwLow
 <ğ
myTİs
[
x
])

194 
myFÏgs
[
x
] = 0xff;

197 
myCouÁ”s
[
x
] = (myCouÁ”s[x] & 0x0700è| (
uIÁ16
)
ÃwLow
;

200 
	}
}

203 
uIÁ8
 
	gC¬ŒidgeDPC
::
	$³ek
(
uIÁ16
 
add»ss
)

205 
add»ss
 =‡ddress & 0x0FFF;

210 
	`şockRªdomNumb”G’”©Ü
();

212 if(
add»ss
 < 0x0040)

214 
uIÁ8
 
»suÉ
 = 0;

217 
uIÁ32
 
šdex
 = 
add»ss
 & 0x07;

218 
uIÁ32
 
funùiÚ
 = (
add»ss
 >> 3) & 0x07;

221 if((
myCouÁ”s
[
šdex
] & 0x00ffè=ğ
myTİs
[index])

223 
myFÏgs
[
šdex
] = 0xff;

225 if((
myCouÁ”s
[
šdex
] & 0x00ffè=ğ
myBÙtoms
[index])

227 
myFÏgs
[
šdex
] = 0x00;

230 
funùiÚ
)

235 if(
šdex
 < 4)

237 
»suÉ
 = 
myRªdomNumb”
;

242 cÚ¡ 
uIÁ8
 
musicAm¶™udes
[8] = {

247 
	`upd©eMusicModeD©aF‘ch”s
();

249 
uIÁ8
 
i
 = 0;

250 if(
myMusicMode
[0] && 
myFÏgs
[5])

252 
i
 |= 0x01;

254 if(
myMusicMode
[1] && 
myFÏgs
[6])

256 
i
 |= 0x02;

258 if(
myMusicMode
[2] && 
myFÏgs
[7])

260 
i
 |= 0x04;

263 
»suÉ
 = 
musicAm¶™udes
[
i
];

271 
»suÉ
 = 
myDi¥ÏyImage
[2047 - 
myCouÁ”s
[
šdex
]];

278 
»suÉ
 = 
myDi¥ÏyImage
[2047 - 
myCouÁ”s
[
šdex
]] & 
myFÏgs
[index];

285 
»suÉ
 = 
myFÏgs
[
šdex
];

291 
»suÉ
 = 0;

296 if((
šdex
 < 5è|| ((šdex >ğ5è&& (!
myMusicMode
[index - 5])))

298 
myCouÁ”s
[
šdex
] = (myCounters[index] - 1) & 0x07ff;

301  
»suÉ
;

306 
add»ss
)

310 
	`bªk
(0);

315 
	`bªk
(1);

321  
myProg¿mImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

323 
	}
}

326 
	gC¬ŒidgeDPC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

328 
add»ss
 =‡ddress & 0x0FFF;

333 
	`şockRªdomNumb”G’”©Ü
();

335 if((
add»ss
 >= 0x0040) && (address < 0x0080))

338 
uIÁ32
 
šdex
 = 
add»ss
 & 0x07;

339 
uIÁ32
 
funùiÚ
 = (
add»ss
 >> 3) & 0x07;

341 
funùiÚ
)

346 
myTİs
[
šdex
] = 
v®ue
;

347 
myFÏgs
[
šdex
] = 0x00;

354 
myBÙtoms
[
šdex
] = 
v®ue
;

361 if((
šdex
 >ğ5è&& 
myMusicMode
[index - 5])

365 
myCouÁ”s
[
šdex
] = (myCounters[index] & 0x0700) |

366 (
uIÁ16
)
myTİs
[
šdex
];

373 
myCouÁ”s
[
šdex
] = (myCouÁ”s[šdex] & 0x0700è| (
uIÁ16
)
v®ue
;

381 
myCouÁ”s
[
šdex
] = (((
uIÁ16
)
v®ue
 & 0x07) << 8) |

382 (
myCouÁ”s
[
šdex
] & 0x00ff);

385 if(
šdex
 >= 5)

387 
myMusicMode
[
šdex
 - 5] = (
v®ue
 & 0x10);

399 
myRªdomNumb”
 = 1;

412 
add»ss
)

416 
	`bªk
(0);

421 
	`bªk
(1);

428 
	}
}

431 
boŞ
 
	gC¬ŒidgeDPC
::
	$§ve
(
S”Ÿliz”
& 
out
)

433 
¡ršg
 
ÿ¹
 = 
	`Çme
();

435 
Œy


437 
uIÁ32
 
i
;

439 
out
.
	`putSŒšg
(
ÿ¹
);

442 
out
.
	`putIÁ
(
myCu¼’tBªk
);

445 
out
.
	`putIÁ
(8);

446 
i
 = 0; i < 8; ++i)

447 
out
.
	`putIÁ
(
myTİs
[
i
]);

450 
out
.
	`putIÁ
(8);

451 
i
 = 0; i < 8; ++i)

452 
out
.
	`putIÁ
(
myBÙtoms
[
i
]);

455 
out
.
	`putIÁ
(8);

456 
i
 = 0; i < 8; ++i)

457 
out
.
	`putIÁ
(
myCouÁ”s
[
i
]);

460 
out
.
	`putIÁ
(8);

461 
i
 = 0; i < 8; ++i)

462 
out
.
	`putIÁ
(
myFÏgs
[
i
]);

465 
out
.
	`putIÁ
(3);

466 
i
 = 0; i < 3; ++i)

467 
out
.
	`putBoŞ
(
myMusicMode
[
i
]);

470 
out
.
	`putIÁ
(
myRªdomNumb”
);

472 
out
.
	`putIÁ
(
mySy¡emCyşes
);

473 
out
.
	`putIÁ
((
uIÁ32
)(
myF¿ùiÚ®Clocks
 * 100000000.0));

475 
	`ÿtch
(cÚ¡ * 
msg
)

477 
û¼
 << 
msg
 << 
’dl
;

478  
çl£
;

480 
	`ÿtch
(...)

482 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

483  
çl£
;

486  
Œue
;

487 
	}
}

490 
boŞ
 
	gC¬ŒidgeDPC
::
	$lßd
(
De£rŸliz”
& 
š
)

492 
¡ršg
 
ÿ¹
 = 
	`Çme
();

494 
Œy


496 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

497  
çl£
;

499 
uIÁ32
 
i
, 
lim™
;

502 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

505 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

506 
i
 = 0; i < 
lim™
; ++i)

507 
myTİs
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

510 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

511 
i
 = 0; i < 
lim™
; ++i)

512 
myBÙtoms
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

515 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

516 
i
 = 0; i < 
lim™
; ++i)

517 
myCouÁ”s
[
i
] = (
uIÁ16
è
š
.
	`g‘IÁ
();

520 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

521 
i
 = 0; i < 
lim™
; ++i)

522 
myFÏgs
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

525 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

526 
i
 = 0; i < 
lim™
; ++i)

527 
myMusicMode
[
i
] = 
š
.
	`g‘BoŞ
();

530 
myRªdomNumb”
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

533 
mySy¡emCyşes
 = 
š
.
	`g‘IÁ
();

534 
myF¿ùiÚ®Clocks
 = ()
š
.
	`g‘IÁ
() / 100000000.0;

536 
	`ÿtch
(cÚ¡ * 
msg
)

538 
û¼
 << 
msg
 << 
’dl
;

539  
çl£
;

541 
	`ÿtch
(...)

543 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

544  
çl£
;

548 
	`bªk
(
myCu¼’tBªk
);

550  
Œue
;

551 
	}
}

554 
	gC¬ŒidgeDPC
::
	$bªk
(
uIÁ16
 
bªk
)

556 if(
bªkLocked
) ;

559 
myCu¼’tBªk
 = 
bªk
;

560 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

561 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

562 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

565 
Sy¡em
::
PageAcûss
 
acûss
;

566 
acûss
.
deviû
 = 
this
;

567 
acûss
.
dœeùPokeBa£
 = 0;

570 
uIÁ32
 
add»ss
 = 0x1080;‡dd»s < (0x1FF8U & ~
mask
);

571 
add»ss
 +ğ(1 << 
shiá
))

573 
acûss
.
dœeùP“kBa£
 = &
myProg¿mImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

574 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

576 
	}
}

579 
	gC¬ŒidgeDPC
::
	$bªk
()

581  
myCu¼’tBªk
;

582 
	}
}

585 
	gC¬ŒidgeDPC
::
	$bªkCouÁ
()

588 
	}
}

591 
boŞ
 
	gC¬ŒidgeDPC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

593 
add»ss
 =‡ddress & 0x0FFF;

594 
myProg¿mImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

595  
Œue
;

596 
	}
}

599 
uIÁ8
* 
	gC¬ŒidgeDPC
::
	$g‘Image
(& 
size
)

601 
size
 = 8192 + 2048 + 255;

603 
i
;

604 
i
 = 0; i < 8192; i++)

605 
myImageCİy
[
i
] = 
myProg¿mImage
[i];

607 
i
 = 0; i < 2048; i++)

608 
myImageCİy
[
i
 + 8192] = 
myDi¥ÏyImage
[i];

610  &
myImageCİy
[0];

611 
	}
}

	@emucore/CartDPC.hxx

19 #iâdeà
CARTRIDGEDCP_HXX


20 
	#CARTRIDGEDCP_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

37 şas 
	cC¬ŒidgeDPC
 : 
public
 
C¬Œidge


39 
public
:

45 
C¬ŒidgeDPC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

50 
	mvœtu®
 ~
C¬ŒidgeDPC
();

52 
	mpublic
:

58 
vœtu®
 cÚ¡ * 
	$Çme
() const;

63 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`sy¡emCyşesRe£t
();

78 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

86 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

94 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

101 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

108 
vœtu®
 
	`bªk
();

113 
vœtu®
 
	`bªkCouÁ
();

122 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

130 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

132 
public
:

138 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

146 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

148 
´iv©e
:

152 
	`şockRªdomNumb”G’”©Ü
();

158 
	`upd©eMusicModeD©aF‘ch”s
();

160 
´iv©e
:

162 
uIÁ16
 
myCu¼’tBªk
;

165 
uIÁ8
 
myProg¿mImage
[8192];

168 
uIÁ8
 
myDi¥ÏyImage
[2048];

171 
uIÁ8
 
myImageCİy
[8192 + 2048 + 255];

174 
uIÁ8
 
myTİs
[8];

177 
uIÁ8
 
myBÙtoms
[8];

180 
uIÁ16
 
myCouÁ”s
[8];

183 
uIÁ8
 
myFÏgs
[8];

186 
boŞ
 
myMusicMode
[3];

189 
uIÁ8
 
myRªdomNumb”
;

192 
IÁ32
 
mySy¡emCyşes
;

195 
myF¿ùiÚ®Clocks
;

	@emucore/CartE0.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tE0.hxx
"

27 
	gC¬ŒidgeE0
::
	$C¬ŒidgeE0
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 8192; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬ŒidgeE0
::~
	$C¬ŒidgeE0
()

39 
	}
}

42 cÚ¡ * 
C¬ŒidgeE0
::
	$Çme
() const

45 
	}
}

48 
	gC¬ŒidgeE0
::
	$»£t
()

51 
	`£gm’tZ”o
(4);

52 
	`£gm’tOÃ
(5);

53 
	`£gm’tTwo
(6);

54 
	}
}

57 
	gC¬ŒidgeE0
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

59 
mySy¡em
 = &
sy¡em
;

60 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

61 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

64 
	`as£¹
(((0x1000 & 
mask
) == 0) && ((0x1400 & mask) == 0) &&

65 ((0x1800 & 
mask
) == 0) && ((0x1C00 & mask) == 0));

68 
Sy¡em
::
PageAcûss
 
acûss
;

69 
acûss
.
dœeùPokeBa£
 = 0;

70 
acûss
.
deviû
 = 
this
;

71 
uIÁ32
 
i
 = 0x1C00; i < (0x1FE0U & ~
mask
); i +ğ(1 << 
shiá
))

73 
acûss
.
dœeùP“kBa£
 = &
myImage
[7168 + (
i
 & 0x03FF)];

74 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

76 
myCu¼’tSliû
[3] = 7;

79 
acûss
.
dœeùP“kBa£
 = 0;

80 
acûss
.
dœeùPokeBa£
 = 0;

81 
acûss
.
deviû
 = 
this
;

82 
uIÁ32
 
j
 = (0x1FE0 & ~
mask
); j < 0x2000; j +ğ(1 << 
shiá
))

84 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

88 
	`£gm’tZ”o
(4);

89 
	`£gm’tOÃ
(5);

90 
	`£gm’tTwo
(6);

91 
	}
}

94 
uIÁ8
 
	gC¬ŒidgeE0
::
	$³ek
(
uIÁ16
 
add»ss
)

96 
add»ss
 =‡ddress & 0x0FFF;

98 if(!
bªkLocked
) {

100 if((
add»ss
 >= 0x0FE0) && (address <= 0x0FE7))

102 
	`£gm’tZ”o
(
add»ss
 & 0x0007);

104 if((
add»ss
 >= 0x0FE8) && (address <= 0x0FEF))

106 
	`£gm’tOÃ
(
add»ss
 & 0x0007);

108 if((
add»ss
 >= 0x0FF0) && (address <= 0x0FF7))

110 
	`£gm’tTwo
(
add»ss
 & 0x0007);

114  
myImage
[(
myCu¼’tSliû
[
add»ss
 >> 10] << 10) + (address & 0x03FF)];

115 
	}
}

118 
	gC¬ŒidgeE0
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

120 
add»ss
 =‡ddress & 0x0FFF;

122 if(!
bªkLocked
) {

124 if((
add»ss
 >= 0x0FE0) && (address <= 0x0FE7))

126 
	`£gm’tZ”o
(
add»ss
 & 0x0007);

128 if((
add»ss
 >= 0x0FE8) && (address <= 0x0FEF))

130 
	`£gm’tOÃ
(
add»ss
 & 0x0007);

132 if((
add»ss
 >= 0x0FF0) && (address <= 0x0FF7))

134 
	`£gm’tTwo
(
add»ss
 & 0x0007);

137 
	}
}

140 
	gC¬ŒidgeE0
::
	$£gm’tZ”o
(
uIÁ16
 
¦iû
)

143 
myCu¼’tSliû
[0] = 
¦iû
;

144 
uIÁ16
 
off£t
 = 
¦iû
 << 10;

145 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

148 
Sy¡em
::
PageAcûss
 
acûss
;

149 
acûss
.
deviû
 = 
this
;

150 
acûss
.
dœeùPokeBa£
 = 0;

152 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x1400;‡dd»s +ğ(1 << 
shiá
))

154 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x03FF)];

155 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

157 
	}
}

160 
	gC¬ŒidgeE0
::
	$£gm’tOÃ
(
uIÁ16
 
¦iû
)

163 
myCu¼’tSliû
[1] = 
¦iû
;

164 
uIÁ16
 
off£t
 = 
¦iû
 << 10;

165 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

168 
Sy¡em
::
PageAcûss
 
acûss
;

169 
acûss
.
deviû
 = 
this
;

170 
acûss
.
dœeùPokeBa£
 = 0;

172 
uIÁ32
 
add»ss
 = 0x1400;‡dd»s < 0x1800;‡dd»s +ğ(1 << 
shiá
))

174 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x03FF)];

175 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

177 
	}
}

180 
	gC¬ŒidgeE0
::
	$£gm’tTwo
(
uIÁ16
 
¦iû
)

183 
myCu¼’tSliû
[2] = 
¦iû
;

184 
uIÁ16
 
off£t
 = 
¦iû
 << 10;

185 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

188 
Sy¡em
::
PageAcûss
 
acûss
;

189 
acûss
.
deviû
 = 
this
;

190 
acûss
.
dœeùPokeBa£
 = 0;

192 
uIÁ32
 
add»ss
 = 0x1800;‡dd»s < 0x1C00;‡dd»s +ğ(1 << 
shiá
))

194 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x03FF)];

195 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

197 
	}
}

200 
boŞ
 
	gC¬ŒidgeE0
::
	$§ve
(
S”Ÿliz”
& 
out
)

202 
¡ršg
 
ÿ¹
 = 
	`Çme
();

204 
Œy


206 
out
.
	`putSŒšg
(
ÿ¹
);

208 
out
.
	`putIÁ
(4);

209 
uIÁ32
 
i
 = 0; i < 4; ++i)

210 
out
.
	`putIÁ
(
myCu¼’tSliû
[
i
]);

212 
	`ÿtch
(cÚ¡ * 
msg
)

214 
û¼
 << 
msg
 << 
’dl
;

215  
çl£
;

217 
	`ÿtch
(...)

219 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

220  
çl£
;

223  
Œue
;

224 
	}
}

227 
boŞ
 
	gC¬ŒidgeE0
::
	$lßd
(
De£rŸliz”
& 
š
)

229 
¡ršg
 
ÿ¹
 = 
	`Çme
();

231 
Œy


233 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

234  
çl£
;

236 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

237 
uIÁ32
 
i
 = 0; i < 
lim™
; ++i)

238 
myCu¼’tSliû
[
i
] = (
uIÁ16
è
š
.
	`g‘IÁ
();

240 
	`ÿtch
(cÚ¡ * 
msg
)

242 
û¼
 << 
msg
 << 
’dl
;

243  
çl£
;

245 
	`ÿtch
(...)

247 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

248  
çl£
;

251  
Œue
;

252 
	}
}

255 
	gC¬ŒidgeE0
::
	$bªk
(
uIÁ16
 
bªk
)

258 
	}
}

261 
C¬ŒidgeE0
::
	$bªk
()

265 
	}
}

268 
	gC¬ŒidgeE0
::
	$bªkCouÁ
()

272 
	}
}

275 
boŞ
 
	gC¬ŒidgeE0
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

277 
add»ss
 =‡ddress & 0x0FFF;

278 
myImage
[(
myCu¼’tSliû
[
add»ss
 >> 10] << 10è+ (add»s & 0x03FF)] = 
v®ue
;

279  
Œue
;

280 
	}
}

283 
uIÁ8
* 
	gC¬ŒidgeE0
::
	$g‘Image
(& 
size
)

285 
size
 = 8192;

286  &
myImage
[0];

287 
	}
}

	@emucore/CartE0.hxx

19 #iâdeà
CARTRIDGEE0_HXX


20 
	#CARTRIDGEE0_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

41 şas 
	cC¬ŒidgeE0
 : 
public
 
C¬Œidge


43 
public
:

49 
C¬ŒidgeE0
(cÚ¡ 
uIÁ8
* 
image
);

54 
	mvœtu®
 ~
C¬ŒidgeE0
();

56 
	mpublic
:

62 
vœtu®
 cÚ¡ * 
	$Çme
() const;

67 
vœtu®
 
	`»£t
();

75 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

83 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

91 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

98 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

105 
vœtu®
 
	`bªk
();

110 
vœtu®
 
	`bªkCouÁ
();

119 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

127 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

129 
public
:

135 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

143 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

145 
´iv©e
:

151 
	`£gm’tZ”o
(
uIÁ16
 
¦iû
);

158 
	`£gm’tOÃ
(
uIÁ16
 
¦iû
);

165 
	`£gm’tTwo
(
uIÁ16
 
¦iû
);

167 
´iv©e
:

169 
uIÁ16
 
myCu¼’tSliû
[4];

172 
uIÁ8
 
myImage
[8192];

	@emucore/CartE7.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tE7.hxx
"

28 
	gC¬ŒidgeE7
::
	$C¬ŒidgeE7
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 16384; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

37 
şass
 
Rªdom
 
¿ndom
;

38 
uIÁ32
 
i
 = 0; i < 2048; ++i)

40 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

42 
	}
}

45 
	gC¬ŒidgeE7
::~
	$C¬ŒidgeE7
()

47 
	}
}

50 cÚ¡ * 
C¬ŒidgeE7
::
	$Çme
() const

53 
	}
}

56 
	gC¬ŒidgeE7
::
	$»£t
()

59 
	`bªkRAM
(0);

60 
	`bªk
(0);

61 
	}
}

64 
	gC¬ŒidgeE7
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

66 
mySy¡em
 = &
sy¡em
;

67 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

68 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

71 
	`as£¹
(((0x1400 & 
mask
) == 0) && ((0x1800 & mask) == 0) &&

72 ((0x1900 & 
mask
) == 0) && ((0x1A00 & mask) == 0));

75 
Sy¡em
::
PageAcûss
 
acûss
;

76 
uIÁ32
 
i
 = (0x1FE0 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

78 
acûss
.
dœeùP“kBa£
 = 0;

79 
acûss
.
dœeùPokeBa£
 = 0;

80 
acûss
.
deviû
 = 
this
;

81 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

85 
uIÁ32
 
j
 = 0x1A00; j < (0x1FE0U & ~
mask
); j +ğ(1 << 
shiá
))

87 
acûss
.
deviû
 = 
this
;

88 
acûss
.
dœeùP“kBa£
 = &
myImage
[7 * 2048 + (
j
 & 0x07FF)];

89 
acûss
.
dœeùPokeBa£
 = 0;

90 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

92 
myCu¼’tSliû
[1] = 7;

95 
	`bªkRAM
(0);

96 
	`bªk
(0);

97 
	}
}

100 
uIÁ8
 
	gC¬ŒidgeE7
::
	$³ek
(
uIÁ16
 
add»ss
)

102 
add»ss
 =‡ddress & 0x0FFF;

105 if((
add»ss
 >= 0x0FE0) && (address <= 0x0FE7))

107 
	`bªk
(
add»ss
 & 0x0007);

109 if((
add»ss
 >= 0x0FE8) && (address <= 0x0FEB))

111 
	`bªkRAM
(
add»ss
 & 0x0003);

117  
myImage
[(
myCu¼’tSliû
[
add»ss
 >> 11] << 11) + (address & 0x07FF)];

118 
	}
}

121 
	gC¬ŒidgeE7
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

123 
add»ss
 =‡ddress & 0x0FFF;

126 if((
add»ss
 >= 0x0FE0) && (address <= 0x0FE7))

128 
	`bªk
(
add»ss
 & 0x0007);

130 if((
add»ss
 >= 0x0FE8) && (address <= 0x0FEB))

132 
	`bªkRAM
(
add»ss
 & 0x0003);

138 
	}
}

141 
	gC¬ŒidgeE7
::
	$bªkRAM
(
uIÁ16
 
bªk
)

144 
myCu¼’tRAM
 = 
bªk
;

145 
uIÁ16
 
off£t
 = 
bªk
 << 8;

146 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

149 
Sy¡em
::
PageAcûss
 
acûss
;

150 
acûss
.
deviû
 = 
this
;

153 
acûss
.
dœeùP“kBa£
 = 0;

154 
acûss
.
dœeùPokeBa£
 = 0;

155 
uIÁ32
 
j
 = 0x1800; j < 0x1900; j +ğ(1 << 
shiá
))

157 
acûss
.
dœeùPokeBa£
 = &
myRAM
[1024 + 
off£t
 + (
j
 & 0x00FF)];

158 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

162 
acûss
.
dœeùP“kBa£
 = 0;

163 
acûss
.
dœeùPokeBa£
 = 0;

164 
uIÁ32
 
k
 = 0x1900; k < 0x1A00; k +ğ(1 << 
shiá
))

166 
acûss
.
dœeùP“kBa£
 = &
myRAM
[1024 + 
off£t
 + (
k
 & 0x00FF)];

167 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

169 
	}
}

172 
boŞ
 
	gC¬ŒidgeE7
::
	$§ve
(
S”Ÿliz”
& 
out
)

174 
¡ršg
 
ÿ¹
 = 
	`Çme
();

176 
Œy


178 
uIÁ32
 
i
;

180 
out
.
	`putSŒšg
(
ÿ¹
);

182 
out
.
	`putIÁ
(2);

183 
i
 = 0; i < 2; ++i)

184 
out
.
	`putIÁ
(
myCu¼’tSliû
[
i
]);

186 
out
.
	`putIÁ
(
myCu¼’tRAM
);

189 
out
.
	`putIÁ
(2048);

190 
i
 = 0; i < 2048; ++i)

191 
out
.
	`putIÁ
(
myRAM
[
i
]);

193 
	`ÿtch
(cÚ¡ * 
msg
)

195 
û¼
 << 
msg
 << 
’dl
;

196  
çl£
;

198 
	`ÿtch
(...)

200 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

201  
çl£
;

204  
Œue
;

205 
	}
}

208 
boŞ
 
	gC¬ŒidgeE7
::
	$lßd
(
De£rŸliz”
& 
š
)

210 
¡ršg
 
ÿ¹
 = 
	`Çme
();

212 
Œy


214 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

215  
çl£
;

217 
uIÁ32
 
i
, 
lim™
;

219 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

220 
i
 = 0; i < 
lim™
; ++i)

221 
myCu¼’tSliû
[
i
] = (
uIÁ16
è
š
.
	`g‘IÁ
();

223 
myCu¼’tRAM
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

226 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

227 
i
 = 0; i < 
lim™
; ++i)

228 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

230 
	`ÿtch
(cÚ¡ * 
msg
)

232 
û¼
 << 
msg
 << 
’dl
;

233  
çl£
;

235 
	`ÿtch
(...)

237 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

238  
çl£
;

242 
	`bªkRAM
(
myCu¼’tRAM
);

243 
	`bªk
(
myCu¼’tSliû
[0]);

245  
Œue
;

246 
	}
}

249 
	gC¬ŒidgeE7
::
	$bªk
(
uIÁ16
 
¦iû
)

251 if(
bªkLocked
) ;

254 
myCu¼’tSliû
[0] = 
¦iû
;

255 
uIÁ16
 
off£t
 = 
¦iû
 << 11;

256 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

259 if(
¦iû
 != 7)

261 
Sy¡em
::
PageAcûss
 
acûss
;

262 
acûss
.
deviû
 = 
this
;

263 
acûss
.
dœeùPokeBa£
 = 0;

266 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x1800;‡dd»s +ğ(1 << 
shiá
))

268 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x07FF)];

269 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

274 
Sy¡em
::
PageAcûss
 
acûss
;

275 
acûss
.
deviû
 = 
this
;

278 
acûss
.
dœeùP“kBa£
 = 0;

279 
acûss
.
dœeùPokeBa£
 = 0;

280 
uIÁ32
 
j
 = 0x1000; j < 0x1400; j +ğ(1 << 
shiá
))

282 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x03FF];

283 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

287 
acûss
.
dœeùP“kBa£
 = 0;

288 
acûss
.
dœeùPokeBa£
 = 0;

289 
uIÁ32
 
k
 = 0x1400; k < 0x1800; k +ğ(1 << 
shiá
))

291 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x03FF];

292 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

295 
	}
}

298 
	gC¬ŒidgeE7
::
	$bªk
()

300  
myCu¼’tSliû
[0];

301 
	}
}

304 
	gC¬ŒidgeE7
::
	$bªkCouÁ
()

307 
	}
}

310 
boŞ
 
	gC¬ŒidgeE7
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

312 
add»ss
 =‡ddress & 0x0FFF;

313 
myImage
[(
myCu¼’tSliû
[
add»ss
 >> 11] << 11è+ (add»s & 0x07FF)] = 
v®ue
;

314 
	`bªk
(
myCu¼’tSliû
[0]);

315  
Œue
;

316 
	}
}

319 
uIÁ8
* 
	gC¬ŒidgeE7
::
	$g‘Image
(& 
size
)

321 
size
 = 16384;

322  &
myImage
[0];

323 
	}
}

	@emucore/CartE7.hxx

19 #iâdeà
CARTRIDGEE7_HXX


20 
	#CARTRIDGEE7_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

58 şas 
	cC¬ŒidgeE7
 : 
public
 
C¬Œidge


60 
public
:

66 
C¬ŒidgeE7
(cÚ¡ 
uIÁ8
* 
image
);

71 
	mvœtu®
 ~
C¬ŒidgeE7
();

73 
	mpublic
:

79 
vœtu®
 cÚ¡ * 
	$Çme
() const;

84 
vœtu®
 
	`»£t
();

92 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

100 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

108 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

115 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

122 
vœtu®
 
	`bªk
();

127 
vœtu®
 
	`bªkCouÁ
();

136 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

144 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

146 
public
:

152 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

160 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

162 
´iv©e
:

168 
	`bªkRAM
(
uIÁ16
 
bªk
);

170 
´iv©e
:

172 
uIÁ16
 
myCu¼’tSliû
[2];

175 
uIÁ16
 
myCu¼’tRAM
;

178 
uIÁ8
 
myImage
[16384];

181 
uIÁ8
 
myRAM
[2048];

	@emucore/CartF4.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tF4.hxx
"

28 
	gC¬ŒidgeF4
::
	$C¬ŒidgeF4
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 32768; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

35 
	}
}

38 
	gC¬ŒidgeF4
::~
	$C¬ŒidgeF4
()

40 
	}
}

43 cÚ¡ * 
C¬ŒidgeF4
::
	$Çme
() const

46 
	}
}

49 
	gC¬ŒidgeF4
::
	$»£t
()

52 
	`bªk
(0);

53 
	}
}

56 
	gC¬ŒidgeF4
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

58 
mySy¡em
 = &
sy¡em
;

59 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

60 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

63 
	`as£¹
((0x1000 & 
mask
) == 0);

66 
Sy¡em
::
PageAcûss
 
acûss
;

67 
uIÁ32
 
i
 = (0x1FF4 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

69 
acûss
.
dœeùP“kBa£
 = 0;

70 
acûss
.
dœeùPokeBa£
 = 0;

71 
acûss
.
deviû
 = 
this
;

72 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

76 
	`bªk
(0);

77 
	}
}

80 
uIÁ8
 
	gC¬ŒidgeF4
::
	$³ek
(
uIÁ16
 
add»ss
)

82 
add»ss
 =‡ddress & 0x0FFF;

85 if((
add»ss
 >= 0x0FF4) && (address <= 0x0FFB))

87 
	`bªk
(
add»ss
 - 0x0FF4);

90  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

91 
	}
}

94 
	gC¬ŒidgeF4
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

96 
add»ss
 =‡ddress & 0x0FFF;

99 if((
add»ss
 >= 0x0FF4) && (address <= 0x0FFB))

101 
	`bªk
(
add»ss
 - 0x0FF4);

103 
	}
}

106 
boŞ
 
	gC¬ŒidgeF4
::
	$§ve
(
S”Ÿliz”
& 
out
)

108 
¡ršg
 
ÿ¹
 = 
	`Çme
();

110 
Œy


112 
out
.
	`putSŒšg
(
ÿ¹
);

113 
out
.
	`putIÁ
(
myCu¼’tBªk
);

115 
	`ÿtch
(cÚ¡ * 
msg
)

117 
û¼
 << 
msg
 << 
’dl
;

118  
çl£
;

120 
	`ÿtch
(...)

122 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

123  
çl£
;

126  
Œue
;

127 
	}
}

130 
boŞ
 
	gC¬ŒidgeF4
::
	$lßd
(
De£rŸliz”
& 
š
)

132 
¡ršg
 
ÿ¹
 = 
	`Çme
();

134 
Œy


136 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

138  
çl£
;

141 
myCu¼’tBªk
 = (
uIÁ16
)
š
.
	`g‘IÁ
();

143 
	`ÿtch
(cÚ¡ * 
msg
)

145 
û¼
 << 
msg
 << 
’dl
;

146  
çl£
;

148 
	`ÿtch
(...)

150 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

151  
çl£
;

155 
	`bªk
(
myCu¼’tBªk
);

157  
Œue
;

158 
	}
}

161 
	gC¬ŒidgeF4
::
	$bªk
(
uIÁ16
 
bªk
)

163 if(
bªkLocked
) ;

166 
myCu¼’tBªk
 = 
bªk
;

167 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

168 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

169 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

172 
Sy¡em
::
PageAcûss
 
acûss
;

173 
acûss
.
deviû
 = 
this
;

174 
acûss
.
dœeùPokeBa£
 = 0;

177 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < (0x1FF4U & ~
mask
);

178 
add»ss
 +ğ(1 << 
shiá
))

180 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

181 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

183 
	}
}

186 
	gC¬ŒidgeF4
::
	$bªk
()

188  
myCu¼’tBªk
;

189 
	}
}

192 
	gC¬ŒidgeF4
::
	$bªkCouÁ
()

195 
	}
}

198 
boŞ
 
	gC¬ŒidgeF4
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

200 
add»ss
 =‡ddress & 0x0FFF;

201 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

202  
Œue
;

203 
	}
}

206 
uIÁ8
* 
	gC¬ŒidgeF4
::
	$g‘Image
(& 
size
)

208 
size
 = 32768;

209  &
myImage
[0];

210 
	}
}

	@emucore/CartF4.hxx

19 #iâdeà
CARTRIDGEF4_HXX


20 
	#CARTRIDGEF4_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF4
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeF4
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeF4
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[32768];

	@emucore/CartF4SC.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tF4SC.hxx
"

28 
	gC¬ŒidgeF4SC
::
	$C¬ŒidgeF4SC
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 32768; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

37 
şass
 
Rªdom
 
¿ndom
;

38 
uIÁ32
 
i
 = 0; i < 128; ++i)

40 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

42 
	}
}

45 
	gC¬ŒidgeF4SC
::~
	$C¬ŒidgeF4SC
()

47 
	}
}

50 cÚ¡ * 
C¬ŒidgeF4SC
::
	$Çme
() const

53 
	}
}

56 
	gC¬ŒidgeF4SC
::
	$»£t
()

59 
	`bªk
(0);

60 
	}
}

63 
	gC¬ŒidgeF4SC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

65 
mySy¡em
 = &
sy¡em
;

66 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

67 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

70 
	`as£¹
(((0x1080 & 
mask
) == 0) && ((0x1100 & mask) == 0));

73 
Sy¡em
::
PageAcûss
 
acûss
;

74 
uIÁ32
 
i
 = (0x1FF4 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

76 
acûss
.
dœeùP“kBa£
 = 0;

77 
acûss
.
dœeùPokeBa£
 = 0;

78 
acûss
.
deviû
 = 
this
;

79 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

83 
uIÁ32
 
j
 = 0x1000; j < 0x1080; j +ğ(1 << 
shiá
))

85 
acûss
.
deviû
 = 
this
;

86 
acûss
.
dœeùP“kBa£
 = 0;

87 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x007F];

88 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

92 
uIÁ32
 
k
 = 0x1080; k < 0x1100; k +ğ(1 << 
shiá
))

94 
acûss
.
deviû
 = 
this
;

95 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x007F];

96 
acûss
.
dœeùPokeBa£
 = 0;

97 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

101 
	`bªk
(0);

102 
	}
}

105 
uIÁ8
 
	gC¬ŒidgeF4SC
::
	$³ek
(
uIÁ16
 
add»ss
)

107 
add»ss
 =‡ddress & 0x0FFF;

110 if((
add»ss
 >= 0x0FF4) && (address <= 0x0FFB))

112 
	`bªk
(
add»ss
 - 0x0FF4);

118  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

119 
	}
}

122 
	gC¬ŒidgeF4SC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

125 if((
add»ss
 >= 0x0FF4) && (address <= 0x0FFB))

127 
	`bªk
(
add»ss
 - 0x0FF4);

133 
	}
}

136 
boŞ
 
	gC¬ŒidgeF4SC
::
	$§ve
(
S”Ÿliz”
& 
out
)

138 
¡ršg
 
ÿ¹
 = 
	`Çme
();

140 
Œy


142 
out
.
	`putSŒšg
(
ÿ¹
);

144 
out
.
	`putIÁ
(
myCu¼’tBªk
);

147 
out
.
	`putIÁ
(128);

148 
uIÁ32
 
i
 = 0; i < 128; ++i)

149 
out
.
	`putIÁ
(
myRAM
[
i
]);

151 
	`ÿtch
(cÚ¡ * 
msg
)

153 
û¼
 << 
msg
 << 
’dl
;

154  
çl£
;

156 
	`ÿtch
(...)

158 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

159  
çl£
;

162  
Œue
;

163 
	}
}

166 
boŞ
 
	gC¬ŒidgeF4SC
::
	$lßd
(
De£rŸliz”
& 
š
)

168 
¡ršg
 
ÿ¹
 = 
	`Çme
();

170 
Œy


172 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

173  
çl£
;

175 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

177 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

178 
uIÁ32
 
i
 = 0; i < 
lim™
; ++i)

179 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

181 
	`ÿtch
(cÚ¡ * 
msg
)

183 
û¼
 << 
msg
 << 
’dl
;

184  
çl£
;

186 
	`ÿtch
(...)

188 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

189  
çl£
;

193 
	`bªk
(
myCu¼’tBªk
);

195  
Œue
;

196 
	}
}

199 
	gC¬ŒidgeF4SC
::
	$bªk
(
uIÁ16
 
bªk
)

201 if(
bªkLocked
) ;

204 
myCu¼’tBªk
 = 
bªk
;

205 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

206 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

207 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

210 
Sy¡em
::
PageAcûss
 
acûss
;

211 
acûss
.
deviû
 = 
this
;

212 
acûss
.
dœeùPokeBa£
 = 0;

215 
uIÁ32
 
add»ss
 = 0x1100;‡dd»s < (0x1FF4U & ~
mask
);

216 
add»ss
 +ğ(1 << 
shiá
))

218 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

219 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

221 
	}
}

224 
	gC¬ŒidgeF4SC
::
	$bªk
()

226  
myCu¼’tBªk
;

227 
	}
}

230 
	gC¬ŒidgeF4SC
::
	$bªkCouÁ
()

233 
	}
}

236 
boŞ
 
	gC¬ŒidgeF4SC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

238 
add»ss
 =‡ddress & 0x0FFF;

239 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

240  
Œue
;

241 
	}
}

244 
uIÁ8
* 
	gC¬ŒidgeF4SC
::
	$g‘Image
(& 
size
)

246 
size
 = 32768;

247  &
myImage
[0];

248 
	}
}

	@emucore/CartF4SC.hxx

19 #iâdeà
CARTRIDGEF4SC_HXX


20 
	#CARTRIDGEF4SC_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF4SC
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeF4SC
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeF4SC
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[32768];

148 
uIÁ8
 
myRAM
[128];

	@emucore/CartF6.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tF6.hxx
"

27 
	gC¬ŒidgeF6
::
	$C¬ŒidgeF6
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 16384; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬ŒidgeF6
::~
	$C¬ŒidgeF6
()

39 
	}
}

42 cÚ¡ * 
C¬ŒidgeF6
::
	$Çme
() const

45 
	}
}

48 
	gC¬ŒidgeF6
::
	$»£t
()

51 
	`bªk
(0);

52 
	}
}

55 
	gC¬ŒidgeF6
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

57 
mySy¡em
 = &
sy¡em
;

58 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

59 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

62 
	`as£¹
((0x1000 & 
mask
) == 0);

65 
Sy¡em
::
PageAcûss
 
acûss
;

66 
uIÁ32
 
i
 = (0x1FF6 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

68 
acûss
.
dœeùP“kBa£
 = 0;

69 
acûss
.
dœeùPokeBa£
 = 0;

70 
acûss
.
deviû
 = 
this
;

71 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

75 
	`bªk
(0);

76 
	}
}

79 
uIÁ8
 
	gC¬ŒidgeF6
::
	$³ek
(
uIÁ16
 
add»ss
)

81 
add»ss
 =‡ddress & 0x0FFF;

84 
add»ss
)

88 
	`bªk
(0);

93 
	`bªk
(1);

98 
	`bªk
(2);

103 
	`bªk
(3);

110  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

111 
	}
}

114 
	gC¬ŒidgeF6
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

116 
add»ss
 =‡ddress & 0x0FFF;

119 
add»ss
)

123 
	`bªk
(0);

128 
	`bªk
(1);

133 
	`bªk
(2);

138 
	`bªk
(3);

144 
	}
}

147 
boŞ
 
	gC¬ŒidgeF6
::
	$§ve
(
S”Ÿliz”
& 
out
)

149 
¡ršg
 
ÿ¹
 = 
	`Çme
();

151 
Œy


153 
out
.
	`putSŒšg
(
ÿ¹
);

155 
out
.
	`putIÁ
(
myCu¼’tBªk
);

157 
	`ÿtch
(cÚ¡ * 
msg
)

159 
û¼
 << 
msg
 << 
’dl
;

160  
çl£
;

162 
	`ÿtch
(...)

164 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

165  
çl£
;

168  
Œue
;

169 
	}
}

172 
boŞ
 
	gC¬ŒidgeF6
::
	$lßd
(
De£rŸliz”
& 
š
)

174 
¡ršg
 
ÿ¹
 = 
	`Çme
();

176 
Œy


178 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

179  
çl£
;

181 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

183 
	`ÿtch
(cÚ¡ * 
msg
)

185 
û¼
 << 
msg
 << 
’dl
;

186  
çl£
;

188 
	`ÿtch
(...)

190 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

191  
çl£
;

195 
	`bªk
(
myCu¼’tBªk
);

197  
Œue
;

198 
	}
}

201 
	gC¬ŒidgeF6
::
	$bªk
(
uIÁ16
 
bªk
)

203 if(
bªkLocked
) ;

206 
myCu¼’tBªk
 = 
bªk
;

207 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

208 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

209 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

212 
Sy¡em
::
PageAcûss
 
acûss
;

213 
acûss
.
deviû
 = 
this
;

214 
acûss
.
dœeùPokeBa£
 = 0;

217 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < (0x1FF6U & ~
mask
);

218 
add»ss
 +ğ(1 << 
shiá
))

220 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

221 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

223 
	}
}

226 
	gC¬ŒidgeF6
::
	$bªk
()

228  
myCu¼’tBªk
;

229 
	}
}

232 
	gC¬ŒidgeF6
::
	$bªkCouÁ
()

235 
	}
}

238 
boŞ
 
	gC¬ŒidgeF6
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

240 
add»ss
 =‡ddress & 0x0FFF;

241 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

242  
Œue
;

243 
	}
}

246 
uIÁ8
* 
	gC¬ŒidgeF6
::
	$g‘Image
(& 
size
)

248 
size
 = 16384;

249  &
myImage
[0];

250 
	}
}

	@emucore/CartF6.hxx

19 #iâdeà
CARTRIDGEF6_HXX


20 
	#CARTRIDGEF6_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF6
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeF6
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeF6
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[16384];

	@emucore/CartF6SC.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tF6SC.hxx
"

28 
	gC¬ŒidgeF6SC
::
	$C¬ŒidgeF6SC
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 16384; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

37 
şass
 
Rªdom
 
¿ndom
;

38 
uIÁ32
 
i
 = 0; i < 128; ++i)

40 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

42 
	}
}

45 
	gC¬ŒidgeF6SC
::~
	$C¬ŒidgeF6SC
()

47 
	}
}

50 cÚ¡ * 
C¬ŒidgeF6SC
::
	$Çme
() const

53 
	}
}

56 
	gC¬ŒidgeF6SC
::
	$»£t
()

59 
	`bªk
(0);

60 
	}
}

63 
	gC¬ŒidgeF6SC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

65 
mySy¡em
 = &
sy¡em
;

66 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

67 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

70 
	`as£¹
(((0x1080 & 
mask
) == 0) && ((0x1100 & mask) == 0));

73 
Sy¡em
::
PageAcûss
 
acûss
;

74 
uIÁ32
 
i
 = (0x1FF6 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

76 
acûss
.
dœeùP“kBa£
 = 0;

77 
acûss
.
dœeùPokeBa£
 = 0;

78 
acûss
.
deviû
 = 
this
;

79 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

83 
uIÁ32
 
j
 = 0x1000; j < 0x1080; j +ğ(1 << 
shiá
))

85 
acûss
.
deviû
 = 
this
;

86 
acûss
.
dœeùP“kBa£
 = 0;

87 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x007F];

88 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

92 
uIÁ32
 
k
 = 0x1080; k < 0x1100; k +ğ(1 << 
shiá
))

94 
acûss
.
deviû
 = 
this
;

95 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x007F];

96 
acûss
.
dœeùPokeBa£
 = 0;

97 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

101 
	`bªk
(0);

102 
	}
}

105 
uIÁ8
 
	gC¬ŒidgeF6SC
::
	$³ek
(
uIÁ16
 
add»ss
)

107 
add»ss
 =‡ddress & 0x0FFF;

110 
add»ss
)

114 
	`bªk
(0);

119 
	`bªk
(1);

124 
	`bªk
(2);

129 
	`bªk
(3);

139  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

140 
	}
}

143 
	gC¬ŒidgeF6SC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

145 
add»ss
 =‡ddress & 0x0FFF;

148 
add»ss
)

152 
	`bªk
(0);

157 
	`bªk
(1);

162 
	`bªk
(2);

167 
	`bªk
(3);

177 
	}
}

180 
boŞ
 
	gC¬ŒidgeF6SC
::
	$§ve
(
S”Ÿliz”
& 
out
)

182 
¡ršg
 
ÿ¹
 = 
	`Çme
();

184 
Œy


186 
out
.
	`putSŒšg
(
ÿ¹
);

188 
out
.
	`putIÁ
(
myCu¼’tBªk
);

191 
out
.
	`putIÁ
(128);

192 
uIÁ32
 
i
 = 0; i < 128; ++i)

193 
out
.
	`putIÁ
(
myRAM
[
i
]);

196 
	`ÿtch
(cÚ¡ * 
msg
)

198 
û¼
 << 
msg
 << 
’dl
;

199  
çl£
;

201 
	`ÿtch
(...)

203 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

204  
çl£
;

207  
Œue
;

208 
	}
}

211 
boŞ
 
	gC¬ŒidgeF6SC
::
	$lßd
(
De£rŸliz”
& 
š
)

213 
¡ršg
 
ÿ¹
 = 
	`Çme
();

215 
Œy


217 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

218  
çl£
;

220 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

223 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

224 
uIÁ32
 
i
 = 0; i < 
lim™
; ++i)

225 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

227 
	`ÿtch
(cÚ¡ * 
msg
)

229 
û¼
 << 
msg
 << 
’dl
;

230  
çl£
;

232 
	`ÿtch
(...)

234 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

235  
çl£
;

239 
	`bªk
(
myCu¼’tBªk
);

241  
Œue
;

242 
	}
}

245 
	gC¬ŒidgeF6SC
::
	$bªk
(
uIÁ16
 
bªk
)

247 if(
bªkLocked
) ;

250 
myCu¼’tBªk
 = 
bªk
;

251 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

252 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

253 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

256 
Sy¡em
::
PageAcûss
 
acûss
;

257 
acûss
.
deviû
 = 
this
;

258 
acûss
.
dœeùPokeBa£
 = 0;

261 
uIÁ32
 
add»ss
 = 0x1100;‡dd»s < (0x1FF6U & ~
mask
);

262 
add»ss
 +ğ(1 << 
shiá
))

264 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

265 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

267 
	}
}

270 
	gC¬ŒidgeF6SC
::
	$bªk
()

272  
myCu¼’tBªk
;

273 
	}
}

276 
	gC¬ŒidgeF6SC
::
	$bªkCouÁ
()

279 
	}
}

282 
boŞ
 
	gC¬ŒidgeF6SC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

284 
add»ss
 =‡ddress & 0x0FFF;

285 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

286  
Œue
;

287 
	}
}

290 
uIÁ8
* 
	gC¬ŒidgeF6SC
::
	$g‘Image
(& 
size
)

292 
size
 = 16384;

293  &
myImage
[0];

294 
	}
}

	@emucore/CartF6SC.hxx

19 #iâdeà
CARTRIDGEF6SC_HXX


20 
	#CARTRIDGEF6SC_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF6SC
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeF6SC
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeF6SC
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[16384];

148 
uIÁ8
 
myRAM
[128];

	@emucore/CartF8.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tF8.hxx
"

27 
	gC¬ŒidgeF8
::
	$C¬ŒidgeF8
(cÚ¡ 
uIÁ8
* 
image
, 
boŞ
 
sw­bªks
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 8192; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

37 
myRe£tBªk
 = 
sw­bªks
 ? 0 : 1;

38 
	}
}

41 
	gC¬ŒidgeF8
::~
	$C¬ŒidgeF8
()

43 
	}
}

46 cÚ¡ * 
C¬ŒidgeF8
::
	$Çme
() const

49 
	}
}

52 
	gC¬ŒidgeF8
::
	$»£t
()

55 
	`bªk
(
myRe£tBªk
);

56 
	}
}

59 
	gC¬ŒidgeF8
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

61 
mySy¡em
 = &
sy¡em
;

62 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

63 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

66 
	`as£¹
((0x1000 & 
mask
) == 0);

69 
Sy¡em
::
PageAcûss
 
acûss
;

70 
uIÁ32
 
i
 = (0x1FF8 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

72 
acûss
.
dœeùP“kBa£
 = 0;

73 
acûss
.
dœeùPokeBa£
 = 0;

74 
acûss
.
deviû
 = 
this
;

75 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

79 
	`bªk
(1);

80 
	}
}

83 
uIÁ8
 
	gC¬ŒidgeF8
::
	$³ek
(
uIÁ16
 
add»ss
)

85 
add»ss
 =‡ddress & 0x0FFF;

88 
add»ss
)

92 
	`bªk
(0);

97 
	`bªk
(1);

104  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

105 
	}
}

108 
	gC¬ŒidgeF8
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

110 
add»ss
 =‡ddress & 0x0FFF;

113 
add»ss
)

117 
	`bªk
(0);

122 
	`bªk
(1);

128 
	}
}

131 
boŞ
 
	gC¬ŒidgeF8
::
	$§ve
(
S”Ÿliz”
& 
out
)

133 
¡ršg
 
ÿ¹
 = 
	`Çme
();

135 
Œy


137 
out
.
	`putSŒšg
(
ÿ¹
);

139 
out
.
	`putIÁ
(
myCu¼’tBªk
);

141 
	`ÿtch
(cÚ¡ * 
msg
)

143 
û¼
 << 
msg
 << 
’dl
;

144  
çl£
;

146 
	`ÿtch
(...)

148 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

149  
çl£
;

152  
Œue
;

153 
	}
}

156 
boŞ
 
	gC¬ŒidgeF8
::
	$lßd
(
De£rŸliz”
& 
š
)

158 
¡ršg
 
ÿ¹
 = 
	`Çme
();

160 
Œy


162 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

163  
çl£
;

165 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

167 
	`ÿtch
(cÚ¡ * 
msg
)

169 
û¼
 << 
msg
 << 
’dl
;

170  
çl£
;

172 
	`ÿtch
(...)

174 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

175  
çl£
;

179 
	`bªk
(
myCu¼’tBªk
);

181  
Œue
;

182 
	}
}

185 
	gC¬ŒidgeF8
::
	$bªk
(
uIÁ16
 
bªk
)

187 if(
bªkLocked
) ;

190 
myCu¼’tBªk
 = 
bªk
;

191 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

192 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

193 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

196 
Sy¡em
::
PageAcûss
 
acûss
;

197 
acûss
.
deviû
 = 
this
;

198 
acûss
.
dœeùPokeBa£
 = 0;

201 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < (0x1FF8U & ~
mask
);

202 
add»ss
 +ğ(1 << 
shiá
))

204 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

205 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

207 
	}
}

210 
	gC¬ŒidgeF8
::
	$bªk
()

212  
myCu¼’tBªk
;

213 
	}
}

216 
	gC¬ŒidgeF8
::
	$bªkCouÁ
()

219 
	}
}

222 
boŞ
 
	gC¬ŒidgeF8
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

224 
add»ss
 &= 0xfff;

225 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

226 
	`bªk
(
myCu¼’tBªk
);

227  
Œue
;

228 
	}
}

231 
uIÁ8
* 
	gC¬ŒidgeF8
::
	$g‘Image
(& 
size
)

233 
size
 = 8192;

234  &
myImage
[0];

235 
	}
}

	@emucore/CartF8.hxx

19 #iâdeà
CARTRIDGEF8_HXX


20 
	#CARTRIDGEF8_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF8
 : 
public
 
C¬Œidge


38 
public
:

45 
C¬ŒidgeF8
(cÚ¡ 
uIÁ8
* 
image
, 
boŞ
 
sw­bªks
);

50 
	mvœtu®
 ~
C¬ŒidgeF8
();

52 
	mpublic
:

58 
vœtu®
 cÚ¡ * 
	$Çme
() const;

63 
vœtu®
 
	`»£t
();

71 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

79 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

87 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

94 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

101 
vœtu®
 
	`bªk
();

106 
vœtu®
 
	`bªkCouÁ
();

115 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

123 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

125 
public
:

131 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

139 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

141 
´iv©e
:

143 
uIÁ16
 
myCu¼’tBªk
;

146 
uIÁ16
 
myRe£tBªk
;

149 
uIÁ8
 
myImage
[8192];

	@emucore/CartF8SC.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tF8SC.hxx
"

28 
	gC¬ŒidgeF8SC
::
	$C¬ŒidgeF8SC
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 8192; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

37 
şass
 
Rªdom
 
¿ndom
;

38 
uIÁ32
 
i
 = 0; i < 128; ++i)

40 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

42 
	}
}

45 
	gC¬ŒidgeF8SC
::~
	$C¬ŒidgeF8SC
()

47 
	}
}

50 cÚ¡ * 
C¬ŒidgeF8SC
::
	$Çme
() const

53 
	}
}

56 
	gC¬ŒidgeF8SC
::
	$»£t
()

59 
	`bªk
(1);

60 
	}
}

63 
	gC¬ŒidgeF8SC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

65 
mySy¡em
 = &
sy¡em
;

66 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

67 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

70 
	`as£¹
(((0x1080 & 
mask
) == 0) && ((0x1100 & mask) == 0));

73 
Sy¡em
::
PageAcûss
 
acûss
;

74 
uIÁ32
 
i
 = (0x1FF8 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

76 
acûss
.
dœeùP“kBa£
 = 0;

77 
acûss
.
dœeùPokeBa£
 = 0;

78 
acûss
.
deviû
 = 
this
;

79 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

83 
uIÁ32
 
j
 = 0x1000; j < 0x1080; j +ğ(1 << 
shiá
))

85 
acûss
.
deviû
 = 
this
;

86 
acûss
.
dœeùP“kBa£
 = 0;

87 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x007F];

88 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

92 
uIÁ32
 
k
 = 0x1080; k < 0x1100; k +ğ(1 << 
shiá
))

94 
acûss
.
deviû
 = 
this
;

95 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x007F];

96 
acûss
.
dœeùPokeBa£
 = 0;

97 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

101 
	`bªk
(1);

102 
	}
}

105 
uIÁ8
 
	gC¬ŒidgeF8SC
::
	$³ek
(
uIÁ16
 
add»ss
)

107 
add»ss
 =‡ddress & 0x0FFF;

109 if(!
bªkLocked
) {

111 
add»ss
)

115 
	`bªk
(0);

120 
	`bªk
(1);

131  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

132 
	}
}

135 
	gC¬ŒidgeF8SC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

137 
add»ss
 =‡ddress & 0x0FFF;

139 if(!
bªkLocked
) {

141 
add»ss
)

145 
	`bªk
(0);

150 
	`bªk
(1);

161 
	}
}

164 
boŞ
 
	gC¬ŒidgeF8SC
::
	$§ve
(
S”Ÿliz”
& 
out
)

166 
¡ršg
 
ÿ¹
 = 
	`Çme
();

168 
Œy


170 
out
.
	`putSŒšg
(
ÿ¹
);

172 
out
.
	`putIÁ
(
myCu¼’tBªk
);

175 
out
.
	`putIÁ
(128);

176 
uIÁ32
 
i
 = 0; i < 128; ++i)

177 
out
.
	`putIÁ
(
myRAM
[
i
]);

179 
	`ÿtch
(cÚ¡ * 
msg
)

181 
û¼
 << 
msg
 << 
’dl
;

182  
çl£
;

184 
	`ÿtch
(...)

186 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

187  
çl£
;

190  
Œue
;

191 
	}
}

194 
boŞ
 
	gC¬ŒidgeF8SC
::
	$lßd
(
De£rŸliz”
& 
š
)

196 
¡ršg
 
ÿ¹
 = 
	`Çme
();

198 
Œy


200 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

201  
çl£
;

203 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

205 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

206 
uIÁ32
 
i
 = 0; i < 
lim™
; ++i)

207 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

209 
	`ÿtch
(cÚ¡ * 
msg
)

211 
û¼
 << 
msg
 << 
’dl
;

212  
çl£
;

214 
	`ÿtch
(...)

216 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

217  
çl£
;

221 
	`bªk
(
myCu¼’tBªk
);

223  
Œue
;

224 
	}
}

227 
	gC¬ŒidgeF8SC
::
	$bªk
(
uIÁ16
 
bªk
)

229 if(
bªkLocked
) ;

232 
myCu¼’tBªk
 = 
bªk
;

233 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 << 12;

234 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

235 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

238 
Sy¡em
::
PageAcûss
 
acûss
;

239 
acûss
.
deviû
 = 
this
;

240 
acûss
.
dœeùPokeBa£
 = 0;

243 
uIÁ32
 
add»ss
 = 0x1100;‡dd»s < (0x1FF8U & ~
mask
);

244 
add»ss
 +ğ(1 << 
shiá
))

246 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

247 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

249 
	}
}

252 
	gC¬ŒidgeF8SC
::
	$bªk
()

254  
myCu¼’tBªk
;

255 
	}
}

258 
	gC¬ŒidgeF8SC
::
	$bªkCouÁ
()

261 
	}
}

264 
boŞ
 
	gC¬ŒidgeF8SC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

266 
add»ss
 =‡ddress & 0x0FFF;

267 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

268  
Œue
;

269 
	}
}

272 
uIÁ8
* 
	gC¬ŒidgeF8SC
::
	$g‘Image
(& 
size
)

274 
size
 = 8192;

275  &
myImage
[0];

276 
	}
}

	@emucore/CartF8SC.hxx

19 #iâdeà
CARTRIDGEF8SC_HXX


20 
	#CARTRIDGEF8SC_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeF8SC
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeF8SC
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeF8SC
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[8192];

148 
uIÁ8
 
myRAM
[128];

	@emucore/CartFASC.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tFASC.hxx
"

28 
	gC¬ŒidgeFASC
::
	$C¬ŒidgeFASC
(cÚ¡ 
uIÁ8
* 
image
)

31 
uIÁ32
 
addr
 = 0;‡ddr < 12288; ++addr)

33 
myImage
[
addr
] = 
image
[addr];

37 
şass
 
Rªdom
 
¿ndom
;

38 
uIÁ32
 
i
 = 0; i < 256; ++i)

40 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

42 
	}
}

45 
	gC¬ŒidgeFASC
::~
	$C¬ŒidgeFASC
()

47 
	}
}

50 cÚ¡ * 
C¬ŒidgeFASC
::
	$Çme
() const

53 
	}
}

56 
	gC¬ŒidgeFASC
::
	$»£t
()

59 
	`bªk
(2);

60 
	}
}

63 
	gC¬ŒidgeFASC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

65 
mySy¡em
 = &
sy¡em
;

66 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

67 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

70 
	`as£¹
(((0x1100 & 
mask
) == 0) && ((0x1200 & mask) == 0));

73 
Sy¡em
::
PageAcûss
 
acûss
;

74 
uIÁ32
 
i
 = (0x1FF8 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

76 
acûss
.
dœeùP“kBa£
 = 0;

77 
acûss
.
dœeùPokeBa£
 = 0;

78 
acûss
.
deviû
 = 
this
;

79 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

83 
uIÁ32
 
j
 = 0x1000; j < 0x1100; j +ğ(1 << 
shiá
))

85 
acûss
.
deviû
 = 
this
;

86 
acûss
.
dœeùP“kBa£
 = 0;

87 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
j
 & 0x00FF];

88 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

92 
uIÁ32
 
k
 = 0x1100; k < 0x1200; k +ğ(1 << 
shiá
))

94 
acûss
.
deviû
 = 
this
;

95 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
k
 & 0x00FF];

96 
acûss
.
dœeùPokeBa£
 = 0;

97 
mySy¡em
->
	`£tPageAcûss
(
k
 >> 
shiá
, 
acûss
);

101 
	`bªk
(2);

102 
	}
}

105 
uIÁ8
 
	gC¬ŒidgeFASC
::
	$³ek
(
uIÁ16
 
add»ss
)

107 
add»ss
 =‡ddress & 0x0FFF;

110 
add»ss
)

114 
	`bªk
(0);

119 
	`bªk
(1);

124 
	`bªk
(2);

134  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

135 
	}
}

138 
	gC¬ŒidgeFASC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

140 
add»ss
 =‡ddress & 0x0FFF;

143 
add»ss
)

147 
	`bªk
(0);

152 
	`bªk
(1);

157 
	`bªk
(2);

167 
	}
}

170 
boŞ
 
	gC¬ŒidgeFASC
::
	$§ve
(
S”Ÿliz”
& 
out
)

172 
¡ršg
 
ÿ¹
 = 
	`Çme
();

174 
Œy


176 
out
.
	`putSŒšg
(
ÿ¹
);

178 
out
.
	`putIÁ
(
myCu¼’tBªk
);

181 
out
.
	`putIÁ
(256);

182 
uIÁ32
 
i
 = 0; i < 256; ++i)

183 
out
.
	`putIÁ
(
myRAM
[
i
]);

185 
	`ÿtch
(cÚ¡ * 
msg
)

187 
û¼
 << 
msg
 << 
’dl
;

188  
çl£
;

190 
	`ÿtch
(...)

192 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

193  
çl£
;

196  
Œue
;

197 
	}
}

200 
boŞ
 
	gC¬ŒidgeFASC
::
	$lßd
(
De£rŸliz”
& 
š
)

202 
¡ršg
 
ÿ¹
 = 
	`Çme
();

204 
Œy


206 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

207  
çl£
;

209 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

211 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

212 
uIÁ32
 
i
 = 0; i < 
lim™
; ++i)

213 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

215 
	`ÿtch
(cÚ¡ * 
msg
)

217 
û¼
 << 
msg
 << 
’dl
;

218  
çl£
;

220 
	`ÿtch
(...)

222 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

223  
çl£
;

227 
	`bªk
(
myCu¼’tBªk
);

229  
Œue
;

230 
	}
}

233 
	gC¬ŒidgeFASC
::
	$bªk
(
uIÁ16
 
bªk
)

235 if(
bªkLocked
) ;

238 
myCu¼’tBªk
 = 
bªk
;

239 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

240 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

241 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

244 
Sy¡em
::
PageAcûss
 
acûss
;

245 
acûss
.
deviû
 = 
this
;

246 
acûss
.
dœeùPokeBa£
 = 0;

249 
uIÁ32
 
add»ss
 = 0x1200;‡dd»s < (0x1FF8U & ~
mask
);

250 
add»ss
 +ğ(1 << 
shiá
))

252 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

253 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

255 
	}
}

258 
	gC¬ŒidgeFASC
::
	$bªk
()

260  
myCu¼’tBªk
;

261 
	}
}

264 
	gC¬ŒidgeFASC
::
	$bªkCouÁ
()

267 
	}
}

270 
boŞ
 
	gC¬ŒidgeFASC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

272 
add»ss
 =‡ddress & 0x0FFF;

273 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

274  
Œue
;

275 
	}
}

278 
uIÁ8
* 
	gC¬ŒidgeFASC
::
	$g‘Image
(& 
size
)

280 
size
 = 12288;

281  &
myImage
[0];

282 
	}
}

	@emucore/CartFASC.hxx

19 #iâdeà
CARTRIDGEFASC_HXX


20 
	#CARTRIDGEFASC_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

36 şas 
	cC¬ŒidgeFASC
 : 
public
 
C¬Œidge


38 
public
:

44 
C¬ŒidgeFASC
(cÚ¡ 
uIÁ8
* 
image
);

49 
	mvœtu®
 ~
C¬ŒidgeFASC
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

70 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

78 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

86 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

93 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

100 
vœtu®
 
	`bªk
();

105 
vœtu®
 
	`bªkCouÁ
();

114 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

122 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

124 
public
:

130 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

138 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

140 
´iv©e
:

142 
uIÁ16
 
myCu¼’tBªk
;

145 
uIÁ8
 
myImage
[12288];

148 
uIÁ8
 
myRAM
[256];

	@emucore/CartFE.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tFE.hxx
"

27 
	gC¬ŒidgeFE
::
	$C¬ŒidgeFE
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 8192; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬ŒidgeFE
::~
	$C¬ŒidgeFE
()

39 
	}
}

42 cÚ¡ * 
C¬ŒidgeFE
::
	$Çme
() const

45 
	}
}

48 
	gC¬ŒidgeFE
::
	$»£t
()

50 
	}
}

53 
C¬ŒidgeFE
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

55 
mySy¡em
 = &
sy¡em
;

56 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

57 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

60 
	`as£¹
((0x1000 & 
mask
) == 0);

63 
Sy¡em
::
PageAcûss
 
acûss
;

64 
uIÁ32
 
i
 = 0x1000; i < 0x2000; i +ğ(1 << 
shiá
))

66 
acûss
.
dœeùP“kBa£
 = 0;

67 
acûss
.
dœeùPokeBa£
 = 0;

68 
acûss
.
deviû
 = 
this
;

69 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

71 
	}
}

74 
uIÁ8
 
	gC¬ŒidgeFE
::
	$³ek
(
uIÁ16
 
add»ss
)

77  
myImage
[(
add»ss
 & 0x0FFF) + (((address & 0x2000) == 0) ? 4096 : 0)];

78 
	}
}

81 
	gC¬ŒidgeFE
::
	$poke
(
uIÁ16
, 
uIÁ8
)

83 
	}
}

86 
boŞ
 
	gC¬ŒidgeFE
::
	$§ve
(
S”Ÿliz”
& 
out
)

88 
¡ršg
 
ÿ¹
 = 
	`Çme
();

90 
Œy


92 
out
.
	`putSŒšg
(
ÿ¹
);

94 
	`ÿtch
(cÚ¡ * 
msg
)

96 
û¼
 << 
msg
 << 
’dl
;

97  
çl£
;

99 
	`ÿtch
(...)

101 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

102  
çl£
;

105  
Œue
;

106 
	}
}

109 
boŞ
 
	gC¬ŒidgeFE
::
	$lßd
(
De£rŸliz”
& 
š
)

111 
¡ršg
 
ÿ¹
 = 
	`Çme
();

113 
Œy


115 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

116  
çl£
;

118 
	`ÿtch
(cÚ¡ * 
msg
)

120 
û¼
 << 
msg
 << 
’dl
;

121  
çl£
;

123 
	`ÿtch
(...)

125 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

126  
çl£
;

129  
Œue
;

130 
	}
}

133 
	gC¬ŒidgeFE
::
	$bªk
(
uIÁ16
 
b
)

136 
	}
}

139 
C¬ŒidgeFE
::
	$bªk
()

143 
	}
}

146 
	gC¬ŒidgeFE
::
	$bªkCouÁ
()

149 
	}
}

152 
boŞ
 
	gC¬ŒidgeFE
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

154 
myImage
[(
add»ss
 & 0x0FFFè+ ((×dd»s & 0x2000è=ğ0è? 4096 : 0)] = 
v®ue
;

155  
Œue
;

156 
	}
}

159 
uIÁ8
* 
	gC¬ŒidgeFE
::
	$g‘Image
(& 
size
)

161 
size
 = 8192;

162  &
myImage
[0];

163 
	}
}

	@emucore/CartFE.hxx

19 #iâdeà
CARTRIDGEFE_HXX


20 
	#CARTRIDGEFE_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

48 şas 
	cC¬ŒidgeFE
 : 
public
 
C¬Œidge


50 
public
:

56 
C¬ŒidgeFE
(cÚ¡ 
uIÁ8
* 
image
);

61 
	mvœtu®
 ~
C¬ŒidgeFE
();

63 
	mpublic
:

69 
vœtu®
 cÚ¡ * 
	$Çme
() const;

74 
vœtu®
 
	`»£t
();

82 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

90 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

98 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

105 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

112 
vœtu®
 
	`bªk
();

117 
vœtu®
 
	`bªkCouÁ
();

126 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

134 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

136 
public
:

142 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

150 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

152 
´iv©e
:

154 
uIÁ8
 
myImage
[8192];

	@emucore/CartMB.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tMB.hxx
"

27 
	gC¬ŒidgeMB
::
	$C¬ŒidgeMB
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 65536; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬ŒidgeMB
::~
	$C¬ŒidgeMB
()

39 
	}
}

42 cÚ¡ * 
C¬ŒidgeMB
::
	$Çme
() const

45 
	}
}

48 
	gC¬ŒidgeMB
::
	$»£t
()

51 
myCu¼’tBªk
 = 0;

52 
	`šcbªk
();

53 
	}
}

56 
	gC¬ŒidgeMB
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

58 
mySy¡em
 = &
sy¡em
;

59 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

60 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

63 
	`as£¹
((0x1000 & 
mask
) == 0);

66 
Sy¡em
::
PageAcûss
 
acûss
;

67 
uIÁ32
 
i
 = (0x1FF0 & ~
mask
); i < 0x2000; i +ğ(1 << 
shiá
))

69 
acûss
.
dœeùP“kBa£
 = 0;

70 
acûss
.
dœeùPokeBa£
 = 0;

71 
acûss
.
deviû
 = 
this
;

72 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

76 
myCu¼’tBªk
 = 0;

77 
	`šcbªk
();

78 
	}
}

81 
uIÁ8
 
	gC¬ŒidgeMB
::
	$³ek
(
uIÁ16
 
add»ss
)

83 
add»ss
 =‡ddress & 0x0FFF;

86 if(
add»ss
 =ğ0x0FF0è
	`šcbªk
();

88  
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
];

89 
	}
}

92 
	gC¬ŒidgeMB
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
)

94 
add»ss
 =‡ddress & 0x0FFF;

97 if(
add»ss
 =ğ0x0FF0è
	`šcbªk
();

98 
	}
}

101 
	gC¬ŒidgeMB
::
	$šcbªk
()

103 if(
bªkLocked
) ;

106 
myCu¼’tBªk
 ++;

107 
myCu¼’tBªk
 &= 0x0F;

108 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

109 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

110 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

113 
Sy¡em
::
PageAcûss
 
acûss
;

114 
acûss
.
deviû
 = 
this
;

115 
acûss
.
dœeùPokeBa£
 = 0;

118 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < (0x1FF0U & ~
mask
);

119 
add»ss
 +ğ(1 << 
shiá
))

121 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

122 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

124 
	}
}

127 
boŞ
 
	gC¬ŒidgeMB
::
	$§ve
(
S”Ÿliz”
& 
out
)

129 
¡ršg
 
ÿ¹
 = 
	`Çme
();

131 
Œy


133 
out
.
	`putSŒšg
(
ÿ¹
);

135 
out
.
	`putIÁ
(
myCu¼’tBªk
);

137 
	`ÿtch
(cÚ¡ * 
msg
)

139 
û¼
 << 
msg
 << 
’dl
;

140  
çl£
;

142 
	`ÿtch
(...)

144 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

145  
çl£
;

148  
Œue
;

149 
	}
}

152 
boŞ
 
	gC¬ŒidgeMB
::
	$lßd
(
De£rŸliz”
& 
š
)

154 
¡ršg
 
ÿ¹
 = 
	`Çme
();

156 
Œy


158 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

159  
çl£
;

161 
myCu¼’tBªk
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

163 
	`ÿtch
(cÚ¡ * 
msg
)

165 
û¼
 << 
msg
 << 
’dl
;

166  
çl£
;

168 
	`ÿtch
(...)

170 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

171  
çl£
;

175 --
myCu¼’tBªk
;

176 
	`šcbªk
();

178  
Œue
;

179 
	}
}

182 
	gC¬ŒidgeMB
::
	$bªk
(
uIÁ16
 
bªk
)

184 if(
bªkLocked
) ;

186 
myCu¼’tBªk
 = (
bªk
 - 1);

187 
	`šcbªk
();

188 
	}
}

191 
	gC¬ŒidgeMB
::
	$bªk
()

193  
myCu¼’tBªk
;

194 
	}
}

197 
	gC¬ŒidgeMB
::
	$bªkCouÁ
()

200 
	}
}

203 
boŞ
 
	gC¬ŒidgeMB
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

205 
add»ss
 =‡ddress & 0x0FFF;

206 
myImage
[
myCu¼’tBªk
 * 4096 + 
add»ss
] = 
v®ue
;

207  
Œue
;

208 
	}
}

211 
uIÁ8
* 
	gC¬ŒidgeMB
::
	$g‘Image
(& 
size
)

213 
size
 = 65536;

214  &
myImage
[0];

215 
	}
}

	@emucore/CartMB.hxx

19 #iâdeà
CARTRIDGEMB_HXX


20 
	#CARTRIDGEMB_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

37 şas 
	cC¬ŒidgeMB
 : 
public
 
C¬Œidge


39 
public
:

45 
C¬ŒidgeMB
(cÚ¡ 
uIÁ8
* 
image
);

50 
	mvœtu®
 ~
C¬ŒidgeMB
();

52 
	mpublic
:

58 
vœtu®
 cÚ¡ * 
	$Çme
() const;

63 
vœtu®
 
	`»£t
();

71 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

79 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

87 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

94 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

101 
vœtu®
 
	`bªk
();

106 
vœtu®
 
	`bªkCouÁ
();

115 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

123 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

125 
public
:

131 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

139 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

141 
´iv©e
:

145 
	`šcbªk
();

147 
´iv©e
:

149 
uIÁ16
 
myCu¼’tBªk
;

152 
uIÁ8
 
myImage
[65536];

	@emucore/CartMC.cxx

19 
	~<ÿs£¹
>

21 
	~"Rªdom.hxx
"

22 
	~"Sy¡em.hxx
"

23 
	~"S”Ÿliz”.hxx
"

24 
	~"De£rŸliz”.hxx
"

25 
	~"C¬tMC.hxx
"

28 
	gC¬ŒidgeMC
::
	$C¬ŒidgeMC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
)

29 : 
	$mySlÙ3Locked
(
çl£
)

31 
uIÁ32
 
i
;

34 
	`as£¹
(
size
 <= 128 * 1024);

37 
myRAM
 = 
Ãw
 
uIÁ8
[32 * 1024];

40 
şass
 
Rªdom
 
¿ndom
;

41 
i
 = 0; i < 32 * 1024; ++i)

43 
myRAM
[
i
] = 
¿ndom
.
	`Ãxt
();

47 
myImage
 = 
Ãw
 
uIÁ8
[128 * 1024];

50 
i
 = 0; i < 128 * 1024; ++i)

52 
myImage
[
i
] = 0;

56 
i
 = 0; i < 
size
; ++i)

58 
myImage
[128 * 1024 - 
size
 + 
i
] = 
image
[i];

60 
	}
}

63 
	gC¬ŒidgeMC
::~
	$C¬ŒidgeMC
()

65 
d–‘e
[] 
myRAM
;

66 
d–‘e
[] 
myImage
;

67 
	}
}

70 cÚ¡ * 
	gC¬ŒidgeMC
::
	$Çme
() const

73 
	}
}

76 
	gC¬ŒidgeMC
::
	$»£t
()

78 
	}
}

81 
C¬ŒidgeMC
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

83 
mySy¡em
 = &
sy¡em
;

84 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

85 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

88 
	`as£¹
(((0x1000 & 
mask
) == 0) && ((0x1400 & mask) == 0) &&

89 ((0x1800 & 
mask
) == 0) && ((0x1C00 & mask) == 0));

98 
Sy¡em
::
PageAcûss
 
acûss
;

99 
uIÁ32
 
i
 = 0x00; i < 0x40; i +ğ(1 << 
shiá
))

101 
acûss
.
dœeùP“kBa£
 = 0;

102 
acûss
.
dœeùPokeBa£
 = 0;

103 
acûss
.
deviû
 = 
this
;

104 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

108 
uIÁ32
 
j
 = 0x1000; j < 0x2000; j +ğ(1 << 
shiá
))

110 
acûss
.
deviû
 = 
this
;

111 
acûss
.
dœeùP“kBa£
 = 0;

112 
acûss
.
dœeùPokeBa£
 = 0;

113 
mySy¡em
->
	`£tPageAcûss
(
j
 >> 
shiá
, 
acûss
);

115 
	}
}

118 
uIÁ8
 
	gC¬ŒidgeMC
::
	$³ek
(
uIÁ16
 
add»ss
)

120 
add»ss
 =‡ddress & 0x1FFF;

123 if((
add»ss
 == 0x1FFC) || (address == 0x1FFD))

126 
mySlÙ3Locked
 = 
Œue
;

129 if(
mySlÙ3Locked
 && (
add»ss
 >= 0x1000) && (address <= 0x1BFF))

132 
mySlÙ3Locked
 = 
çl£
;

136 if(
add»ss
 < 0x1000)

142 
uIÁ8
 
block
;

144 if(
mySlÙ3Locked
 && ((
add»ss
 & 0x0C00) == 0x0C00))

146 
block
 = 0xFF;

150 
block
 = 
myCu¼’tBlock
[(
add»ss
 & 0x0C00) >> 10];

154 if(
block
 & 0x80)

157  
myImage
[(
uIÁ32
)(
block
 & 0x7Fè* 1024 + (
add»ss
 & 0x03FF)];

162 if(
add»ss
 & 0x0200)

165  
myRAM
[(
uIÁ32
)(
block
 & 0x3Fè* 512 + (
add»ss
 & 0x01FF)];

170 
myRAM
[(
uIÁ32
)(
block
 & 0x3Fè* 512 + (
add»ss
 & 0x01FF)] = 0;

175 
	}
}

178 
	gC¬ŒidgeMC
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

180 
add»ss
 =‡ddress & 0x1FFF;

183 if((
add»ss
 == 0x1FFC) || (address == 0x1FFD))

186 
mySlÙ3Locked
 = 
Œue
;

189 if(
mySlÙ3Locked
 && (
add»ss
 >= 0x1000) && (address <= 0x1BFF))

192 
mySlÙ3Locked
 = 
çl£
;

196 if((
add»ss
 >= 0x003C) && (address <= 0x003F))

198 
myCu¼’tBlock
[
add»ss
 - 0x003C] = 
v®ue
;

202 
uIÁ8
 
block
;

204 if(
mySlÙ3Locked
 && ((
add»ss
 & 0x0C00) == 0x0C00))

206 
block
 = 0xFF;

210 
block
 = 
myCu¼’tBlock
[(
add»ss
 & 0x0C00) >> 10];

214 if(!(
block
 & 0x80è&& !(
add»ss
 & 0x0200))

217 
myRAM
[(
uIÁ32
)(
block
 & 0x3Fè* 512 + (
add»ss
 & 0x01FF)] = 
v®ue
;

220 
	}
}

223 
boŞ
 
	gC¬ŒidgeMC
::
	$§ve
(
S”Ÿliz”
& 
out
)

225 
uIÁ32
 
i
;

226 
¡ršg
 
ÿ¹
 = 
	`Çme
();

228 
Œy


230 
out
.
	`putSŒšg
(
ÿ¹
);

233 
out
.
	`putIÁ
(4);

234 
i
 = 0; i < 4; ++i)

235 
out
.
	`putIÁ
(
myCu¼’tBlock
[
i
]);

238 
out
.
	`putIÁ
(32 * 1024);

239 
i
 = 0; i < 32 * 1024; ++i)

240 
out
.
	`putIÁ
(
myRAM
[
i
]);

242 
	`ÿtch
(cÚ¡ * 
msg
)

244 
û¼
 << 
msg
 << 
’dl
;

245  
çl£
;

247 
	`ÿtch
(...)

249 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

250  
çl£
;

253  
Œue
;

254 
	}
}

257 
boŞ
 
	gC¬ŒidgeMC
::
	$lßd
(
De£rŸliz”
& 
š
)

259 
uIÁ32
 
i
;

260 
¡ršg
 
ÿ¹
 = 
	`Çme
();

262 
Œy


264 
uIÁ32
 
lim™
;

266 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

267  
çl£
;

270 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

271 
i
 = 0; i < 
lim™
; ++i)

272 
myCu¼’tBlock
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

275 
lim™
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

276 
i
 = 0; i < 
lim™
; ++i)

277 
myRAM
[
i
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

279 
	`ÿtch
(cÚ¡ * 
msg
)

281 
û¼
 << 
msg
 << 
’dl
;

282  
çl£
;

284 
	`ÿtch
(...)

286 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

287  
çl£
;

290  
Œue
;

291 
	}
}

294 
	gC¬ŒidgeMC
::
	$bªk
(
uIÁ16
 
b
)

297 
	}
}

300 
C¬ŒidgeMC
::
	$bªk
()

304 
	}
}

307 
	gC¬ŒidgeMC
::
	$bªkCouÁ
()

311 
	}
}

314 
boŞ
 
	gC¬ŒidgeMC
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

317  
çl£
;

318 
	}
}

321 
uIÁ8
* 
	gC¬ŒidgeMC
::
	$g‘Image
(& 
size
)

323 
size
 = 128 * 1024;

324  &
myImage
[0];

325 
	}
}

	@emucore/CartMC.hxx

19 #iâdeà
CARTRIDGEMC_HXX


20 
	#CARTRIDGEMC_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

140 şas 
	cC¬ŒidgeMC
 : 
public
 
C¬Œidge


142 
public
:

151 
C¬ŒidgeMC
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
);

156 
	mvœtu®
 ~
C¬ŒidgeMC
();

158 
	mpublic
:

164 
vœtu®
 cÚ¡ * 
	$Çme
() const;

169 
vœtu®
 
	`»£t
();

177 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

185 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

193 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

200 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

207 
vœtu®
 
	`bªk
();

212 
vœtu®
 
	`bªkCouÁ
();

221 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

229 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

231 
public
:

237 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

245 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

247 
´iv©e
:

249 
uIÁ8
 
myCu¼’tBlock
[4];

252 
boŞ
 
mySlÙ3Locked
;

255 
uIÁ8
* 
myRAM
;

258 
uIÁ8
* 
myImage
;

	@emucore/CartUA.cxx

19 
	~<ÿs£¹
>

21 
	~"Sy¡em.hxx
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"C¬tUA.hxx
"

27 
	gC¬ŒidgeUA
::
	$C¬ŒidgeUA
(cÚ¡ 
uIÁ8
* 
image
)

30 
uIÁ32
 
addr
 = 0;‡ddr < 8192; ++addr)

32 
myImage
[
addr
] = 
image
[addr];

34 
	}
}

37 
	gC¬ŒidgeUA
::~
	$C¬ŒidgeUA
()

39 
	}
}

42 cÚ¡ * 
C¬ŒidgeUA
::
	$Çme
() const

45 
	}
}

48 
	gC¬ŒidgeUA
::
	$»£t
()

51 
	`bªk
(0);

52 
	}
}

55 
	gC¬ŒidgeUA
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

57 
mySy¡em
 = &
sy¡em
;

58 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

59 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

62 
	`as£¹
((0x1000 & 
mask
) == 0);

66 
myHÙSpÙPageAcûss
 = 
mySy¡em
->
	`g‘PageAcûss
(0x0220 >> 
shiá
);

69 
Sy¡em
::
PageAcûss
 
acûss
;

70 
acûss
.
dœeùP“kBa£
 = 0;

71 
acûss
.
dœeùPokeBa£
 = 0;

72 
acûss
.
deviû
 = 
this
;

73 
mySy¡em
->
	`£tPageAcûss
(0x0220 >> 
shiá
, 
acûss
);

74 
mySy¡em
->
	`£tPageAcûss
(0x0240 >> 
shiá
, 
acûss
);

77 
	`bªk
(0);

78 
	}
}

81 
uIÁ8
 
	gC¬ŒidgeUA
::
	$³ek
(
uIÁ16
 
add»ss
)

83 
add»ss
 =‡ddress & 0x1FFF;

86 
add»ss
)

90 
	`bªk
(0);

95 
	`bªk
(1);

102 if(!(
add»ss
 & 0x1000))

104  
myHÙSpÙPageAcûss
.
deviû
->
	`³ek
(
add»ss
);

110 
	}
}

113 
	gC¬ŒidgeUA
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

115 
add»ss
 =‡ddress & 0x1FFF;

118 
add»ss
)

122 
	`bªk
(0);

127 
	`bªk
(1);

134 if(!(
add»ss
 & 0x1000))

136 
myHÙSpÙPageAcûss
.
deviû
->
	`poke
(
add»ss
, 
v®ue
);

138 
	}
}

141 
boŞ
 
	gC¬ŒidgeUA
::
	$§ve
(
S”Ÿliz”
& 
out
)

143 
¡ršg
 
ÿ¹
 = 
	`Çme
();

145 
Œy


147 
out
.
	`putSŒšg
(
ÿ¹
);

149 
out
.
	`putIÁ
(
myCu¼’tBªk
);

151 
	`ÿtch
(cÚ¡ * 
msg
)

153 
û¼
 << 
msg
 << 
’dl
;

154  
çl£
;

156 
	`ÿtch
(...)

158 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
ÿ¹
 << 
’dl
;

159  
çl£
;

162  
Œue
;

163 
	}
}

166 
boŞ
 
	gC¬ŒidgeUA
::
	$lßd
(
De£rŸliz”
& 
š
)

168 
¡ršg
 
ÿ¹
 = 
	`Çme
();

170 
Œy


172 if(
š
.
	`g‘SŒšg
(è!ğ
ÿ¹
)

173  
çl£
;

175 
myCu¼’tBªk
 = (
uIÁ16
)
š
.
	`g‘IÁ
();

177 
	`ÿtch
(cÚ¡ * 
msg
)

179 
û¼
 << 
msg
 << 
’dl
;

180  
çl£
;

182 
	`ÿtch
(...)

184 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
ÿ¹
 << 
’dl
;

185  
çl£
;

189 
	`bªk
(
myCu¼’tBªk
);

191  
Œue
;

192 
	}
}

195 
	gC¬ŒidgeUA
::
	$bªk
(
uIÁ16
 
bªk
)

197 if(
bªkLocked
) ;

200 
myCu¼’tBªk
 = 
bªk
;

201 
uIÁ16
 
off£t
 = 
myCu¼’tBªk
 * 4096;

202 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

206 
Sy¡em
::
PageAcûss
 
acûss
;

207 
acûss
.
deviû
 = 
this
;

208 
acûss
.
dœeùPokeBa£
 = 0;

211 
uIÁ32
 
add»ss
 = 0x1000;‡dd»s < 0x2000;‡dd»s +ğ(1 << 
shiá
))

213 
acûss
.
dœeùP“kBa£
 = &
myImage
[
off£t
 + (
add»ss
 & 0x0FFF)];

214 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

216 
	}
}

219 
	gC¬ŒidgeUA
::
	$bªk
()

221  
myCu¼’tBªk
;

222 
	}
}

225 
	gC¬ŒidgeUA
::
	$bªkCouÁ
()

228 
	}
}

231 
boŞ
 
	gC¬ŒidgeUA
::
	$·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

233 
add»ss
 &= 0x0fff;

234 
myImage
[
myCu¼’tBªk
 * 4096] = 
v®ue
;

235 
	`bªk
(
myCu¼’tBªk
);

236  
Œue
;

237 
	}
}

240 
uIÁ8
* 
	gC¬ŒidgeUA
::
	$g‘Image
(& 
size
)

242 
size
 = 8192;

243  &
myImage
[0];

244 
	}
}

	@emucore/CartUA.hxx

19 #iâdeà
CARTRIDGEUA_HXX


20 
	#CARTRIDGEUA_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"C¬t.hxx
"

28 
	~"Sy¡em.hxx
"

37 şas 
	cC¬ŒidgeUA
 : 
public
 
C¬Œidge


39 
public
:

45 
C¬ŒidgeUA
(cÚ¡ 
uIÁ8
* 
image
);

50 
	mvœtu®
 ~
C¬ŒidgeUA
();

52 
	mpublic
:

58 
vœtu®
 cÚ¡ * 
	$Çme
() const;

63 
vœtu®
 
	`»£t
();

71 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

79 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

87 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

94 
vœtu®
 
	`bªk
(
uIÁ16
 
bªk
);

101 
vœtu®
 
	`bªk
();

106 
vœtu®
 
	`bªkCouÁ
();

115 
vœtu®
 
boŞ
 
	`·tch
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

123 
vœtu®
 
uIÁ8
* 
	`g‘Image
(& 
size
);

125 
public
:

131 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

139 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

141 
´iv©e
:

143 
uIÁ16
 
myCu¼’tBªk
;

146 
uIÁ8
 
myImage
[8192];

149 
Sy¡em
::
PageAcûss
 
myHÙSpÙPageAcûss
;

	@emucore/Console.cxx

19 
	~<ÿs£¹
>

20 
	~<io¡»am
>

21 
	~<s¡»am
>

22 
	~<f¡»am
>

24 
	~"AriVox.hxx
"

25 
	~"Boo¡”.hxx
"

26 
	~"C¬t.hxx
"

27 
	~"CÚsŞe.hxx
"

28 
	~"CÚŒŞ.hxx
"

29 
	~"Drivšg.hxx
"

30 
	~"Ev’t.hxx
"

32 
	~"Joy¡ick.hxx
"

33 
	~"Keybßrd.hxx
"

34 
	~"M6502Hi.hxx
"

35 
	~"M6502Low.hxx
"

36 
	~"M6532.hxx
"

37 
	~"MedŸSrc.hxx
"

38 
	~"PaddËs.hxx
"

39 
	~"Prİs.hxx
"

40 
	~"PrİsS‘.hxx
"

41 
	~"S‘tšgs.hxx
"

43 
	~"Sw™ches.hxx
"

44 
	~"Sy¡em.hxx
"

45 
	~"TIA.hxx
"

47 
	~"OSy¡em.hxx
"

50 
	~"V”siÚ.hxx
"

51 
	~"game_cÚŒŞËr.h
"

52 #ifdeà
DEBUGGER_SUPPORT


53 
	~"Debugg”.hxx
"

56 #ifdeà
CHEATCODE_SUPPORT


57 
	~"Ch—tMªag”.hxx
"

61 
	gCÚsŞe
::
	$CÚsŞe
(
OSy¡em
* 
osy¡em
, 
C¬Œidge
* 
ÿ¹
, cÚ¡ 
Prİ”t›s
& 
´İs
)

62 : 
	`myOSy¡em
(
osy¡em
),

63 
	`myPrİ”t›s
(
´İs
),

64 
	$myU£rP®‘‹Defšed
(
çl£
)

66 
myCÚŒŞËrs
[0] = 0;

67 
myCÚŒŞËrs
[1] = 0;

68 
myMedŸSourû
 = 0;

69 
mySw™ches
 = 0;

70 
mySy¡em
 = 0;

71 
myEv’t
 = 0;

75 
myEv’t
 = 
myOSy¡em
->
	`ev’t
();

78 
	`lßdU£rP®‘‹
();

81 cÚ¡ 
¡ršg
& 
Ëá
 = 
myPrİ”t›s
.
	`g‘
(
CÚŒŞËr_Leá
);

82 cÚ¡ 
¡ršg
& 
right
 = 
myPrİ”t›s
.
	`g‘
(
CÚŒŞËr_Right
);

85 
ËáPÜt
, 
rightPÜt
;

86 if(
myPrİ”t›s
.
	`g‘
(
CÚsŞe_Sw­PÜts
) == "NO")

88 
ËáPÜt
 = 0; 
rightPÜt
 = 1;

92 
ËáPÜt
 = 1; 
rightPÜt
 = 0;

96 
boŞ
 
sw­PaddËs
 = 
myPrİ”t›s
.
	`g‘
(
CÚŒŞËr_Sw­PaddËs
) == "YES";

99 if(
Ëá
 == "BOOSTER-GRIP")

101 
myCÚŒŞËrs
[
ËáPÜt
] = 
Ãw
 
	`Boo¡”Gr
(
CÚŒŞËr
::
Leá
, *
myEv’t
);

103 if(
Ëá
 == "DRIVING")

105 
myCÚŒŞËrs
[
ËáPÜt
] = 
Ãw
 
	`Drivšg
(
CÚŒŞËr
::
Leá
, *
myEv’t
);

107 if((
Ëá
 == "KEYBOARD") || (left == "KEYPAD"))

109 
myCÚŒŞËrs
[
ËáPÜt
] = 
Ãw
 
	`Keybßrd
(
CÚŒŞËr
::
Leá
, *
myEv’t
);

111 if(
Ëá
 == "PADDLES")

113 
myCÚŒŞËrs
[
ËáPÜt
] = 
Ãw
 
	`PaddËs
(
CÚŒŞËr
::
Leá
, *
myEv’t
, 
sw­PaddËs
);

117 
myCÚŒŞËrs
[
ËáPÜt
] = 
Ãw
 
	`Joy¡ick
(
CÚŒŞËr
::
Leá
, *
myEv’t
);

121 if(
right
 == "BOOSTER-GRIP")

123 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`Boo¡”Gr
(
CÚŒŞËr
::
Right
, *
myEv’t
);

125 if(
right
 == "DRIVING")

127 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`Drivšg
(
CÚŒŞËr
::
Right
, *
myEv’t
);

129 if((
right
 == "KEYBOARD") || (right == "KEYPAD"))

131 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`Keybßrd
(
CÚŒŞËr
::
Right
, *
myEv’t
);

133 if(
right
 == "PADDLES")

135 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`PaddËs
(
CÚŒŞËr
::
Right
, *
myEv’t
, 
sw­PaddËs
);

137 #ifdeà
ATARIVOX_SUPPORT


138 if(
right
 == "ATARIVOX")

140 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`AriVox
(
CÚŒŞËr
::
Right
, *
myEv’t
);

145 
myCÚŒŞËrs
[
rightPÜt
] = 
Ãw
 
	`Joy¡ick
(
CÚŒŞËr
::
Right
, *
myEv’t
);

149 
mySw™ches
 = 
Ãw
 
	`Sw™ches
(*
myEv’t
, 
myPrİ”t›s
);

152 
mySy¡em
 = 
Ãw
 
	`Sy¡em
(13, 6);

155 
myCÚŒŞËrs
[0]->
	`£tSy¡em
(
mySy¡em
);

156 
myCÚŒŞËrs
[1]->
	`£tSy¡em
(
mySy¡em
);

158 
M6502
* 
m6502
;

159 if(
myOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("cpu") == "low")

160 
m6502
 = 
Ãw
 
	`M6502Low
(1);

162 
m6502
 = 
Ãw
 
	`M6502High
(1);

163 #ifdeà
DEBUGGER_SUPPORT


164 
m6502
->
	`©ch
(
myOSy¡em
->
	`debugg”
());

167 
M6532
* 
m6532
 = 
Ãw
 
	`M6532
(*
this
);

168 
TIA
 *
tŸ
 = 
Ãw
 
	`TIA
(*
this
, 
myOSy¡em
->
	`£‰šgs
());

169 
tŸ
->
	`£tSound
(
myOSy¡em
->
	`sound
());

171 
mySy¡em
->
	`©ch
(
m6502
);

172 
mySy¡em
->
	`©ch
(
m6532
);

173 
mySy¡em
->
	`©ch
(
tŸ
);

174 
mySy¡em
->
	`©ch
(
ÿ¹
);

177 
myMedŸSourû
 = 
tŸ
;

178 
myC¬t
 = 
ÿ¹
;

179 
myRiÙ
 = 
m6532
;

182 
o¡ršg¡»am
 
buf
;

183 
buf
 << " C¬ˆName: " << 
myPrİ”t›s
.
	`g‘
(
C¬Œidge_Name
è<< 
’dl


184 << " C¬ˆMD5: " << 
myPrİ”t›s
.
	`g‘
(
C¬Œidge_MD5
è<< 
’dl
;

187 
myDi¥ÏyFÜm©
 = 
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_FÜm©
);

188 
buf
 << " Di¥Ïy FÜm©: " << 
myDi¥ÏyFÜm©
;

189 if(
myDi¥ÏyFÜm©
 == "AUTO-DETECT" ||

190 
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("rominfo"))

197 
mySy¡em
->
	`»£t
();

198 
·lCouÁ
 = 0;

199 
i
 = 0; i < 60; ++i)

201 
myMedŸSourû
->
	`upd©e
();

202 if(
i
 >ğ30 && 
myMedŸSourû
->
	`sÿÆšes
() > 285)

203 ++
·lCouÁ
;

206 
myDi¥ÏyFÜm©
 = (
·lCouÁ
 >= 15) ? "PAL" : "NTSC";

207 if(
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_FÜm©
) == "AUTO-DETECT")

208 
buf
 << " ==> " << 
myDi¥ÏyFÜm©
;

210 
buf
 << 
’dl
 << 
ÿ¹
->
	`about
();

213 if((
myDi¥ÏyFÜm©
 == "PAL" || myDisplayFormat == "SECAM") &&

214 
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_Height
) == "210")

215 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_Height
, "250");

218 
mySy¡em
->
	`»£t
();

226 
myAboutSŒšg
 = 
buf
.
	`¡r
();

227 
	}
}

230 
	gCÚsŞe
::~
	$CÚsŞe
()

232 
d–‘e
 
mySy¡em
;

233 
d–‘e
 
mySw™ches
;

234 
d–‘e
 
myCÚŒŞËrs
[0];

235 
d–‘e
 
myCÚŒŞËrs
[1];

236 
	}
}

239 
	gCÚsŞe
::
	$toggËFÜm©
()

241 
äam”©e
 = 60;

242 if(
myDi¥ÏyFÜm©
 == "NTSC")

244 
myDi¥ÏyFÜm©
 = "PAL";

245 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_FÜm©
, 
myDi¥ÏyFÜm©
);

246 
mySy¡em
->
	`»£t
();

248 
äam”©e
 = 50;

250 if(
myDi¥ÏyFÜm©
 == "PAL")

252 
myDi¥ÏyFÜm©
 = "PAL60";

253 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_FÜm©
, 
myDi¥ÏyFÜm©
);

254 
mySy¡em
->
	`»£t
();

256 
äam”©e
 = 60;

258 if(
myDi¥ÏyFÜm©
 == "PAL60")

260 
myDi¥ÏyFÜm©
 = "SECAM";

261 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_FÜm©
, 
myDi¥ÏyFÜm©
);

262 
mySy¡em
->
	`»£t
();

264 
äam”©e
 = 50;

266 if(
myDi¥ÏyFÜm©
 == "SECAM")

268 
myDi¥ÏyFÜm©
 = "NTSC";

269 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_FÜm©
, 
myDi¥ÏyFÜm©
);

270 
mySy¡em
->
	`»£t
();

272 
äam”©e
 = 60;

275 
	`£tP®‘‹
(
myOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("palette"));

276 
myOSy¡em
->
	`£tF¿m”©e
(
äam”©e
);

277 
myOSy¡em
->
	`sound
().
	`£tF¿meR©e
(
äam”©e
);

278 
	}
}

281 
	gCÚsŞe
::
	$toggËCŞÜLoss
()

283 
boŞ
 
cŞÜloss
 = !
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("colorloss");

284 
myOSy¡em
->
	`£‰šgs
().
	`£tBoŞ
("cŞÜloss", 
cŞÜloss
);

285 
	`£tCŞÜLossP®‘‹
(
cŞÜloss
);

286 
	`£tP®‘‹
(
myOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("palette"));

288 
¡ršg
 
mes§ge
 = 
	`¡ršg
("PAL color-loss ") +

289 (
cŞÜloss
 ? "enabled" : "disabled");

291 
	}
}

294 
	gCÚsŞe
::
	$toggËP®‘‹
()

296 
¡ršg
 
·Ë‰e
, 
mes§ge
;

297 
·Ë‰e
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("palette");

299 if(
·Ë‰e
 == "standard")

301 
·Ë‰e
 = "z26";

302 
mes§ge
 = "Z26…alette";

304 if(
·Ë‰e
 == "z26")

308 if(
myU£rP®‘‹Defšed
)

310 
·Ë‰e
 = "user";

311 
mes§ge
 = "User-defined…alette";

315 
·Ë‰e
 = "standard";

316 
mes§ge
 = "Standard Stella…alette";

319 if(
·Ë‰e
 == "user")

321 
·Ë‰e
 = "standard";

322 
mes§ge
 = "Standard Stella…alette";

326 
·Ë‰e
 = "standard";

327 
mes§ge
 = "Standard Stella…alette";

330 
myOSy¡em
->
	`£‰šgs
().
	`£tSŒšg
("·Ë‰e", 
·Ë‰e
);

333 
	`£tP®‘‹
(
·Ë‰e
);

334 
	}
}

337 
	gCÚsŞe
::
	$£tP®‘‹
(cÚ¡ 
¡ršg
& 
ty³
)

341 
uIÁ32
* 
·Ë‰es
[3][3] = {

342 { &
ourNTSCP®‘‹
[0], &
ourPALP®‘‹
[0], &
ourSECAMP®‘‹
[0] },

343 { &
ourNTSCP®‘‹Z26
[0], &
ourPALP®‘‹Z26
[0], &
ourSECAMP®‘‹Z26
[0] },

346 if(
myU£rP®‘‹Defšed
)

348 
·Ë‰es
[2][0] = &
ourU£rNTSCP®‘‹
[0];

349 
·Ë‰es
[2][1] = &
ourU£rPALP®‘‹
[0];

350 
·Ë‰es
[2][2] = &
ourU£rSECAMP®‘‹
[0];

354 
·Ë‰eNum
 = 0;

355 if(
ty³
 == "standard")

356 
·Ë‰eNum
 = 0;

357 if(
ty³
 == "z26")

358 
·Ë‰eNum
 = 1;

359 if(
ty³
 =ğ"u£r" && 
myU£rP®‘‹Defšed
)

360 
·Ë‰eNum
 = 2;

363 cÚ¡ 
uIÁ32
* 
·Ë‰e
 =

364 (
myDi¥ÏyFÜm©
.
	`com·»
(0, 3, "PAL"è=ğ0è? 
·Ë‰es
[
·Ë‰eNum
][1] :

365 (
myDi¥ÏyFÜm©
.
	`com·»
(0, 5, "SECAM"è=ğ0è? 
·Ë‰es
[
·Ë‰eNum
][2] :

366 
·Ë‰es
[
·Ë‰eNum
][0];

369 
myOSy¡em
->
p_expÜt_sü“n
->
	`£t_·Ë‰e
(
·Ë‰e
);

370 
	}
}

373 
	gCÚsŞe
::
	$toggËPho¥hÜ
()

375 cÚ¡ 
¡ršg
& 
pho¥hÜ
 = 
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_Pho¥hÜ
);

377 
boŞ
 
’abË
;

378 if(
pho¥hÜ
 == "YES")

380 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_Pho¥hÜ
, "No");

381 
’abË
 = 
çl£
;

386 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_Pho¥hÜ
, "Yes");

387 
’abË
 = 
Œue
;

392 
	}
}

395 
	gCÚsŞe
::
	$£tPrİ”t›s
(cÚ¡ 
Prİ”t›s
& 
´İs
)

397 
myPrİ”t›s
 = 
´İs
;

398 
	}
}

401 
	gCÚsŞe
::
	$š™ŸlizeVideo
(
boŞ
 
fuÎ
)

403 if(
fuÎ
)

405 
¡ršg
 
t™Ë
 = 
	`¡ršg
("S‹Î¨"è+ 
STELLA_VERSION
 +

406 ": \"" + 
myPrİ”t›s
.
	`g‘
(
C¬Œidge_Name
) + "\"";

415 
	`£tCŞÜLossP®‘‹
(
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("colorloss"));

416 
	`£tP®‘‹
(
myOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("palette"));

418 
myOSy¡em
->
	`£tF¿m”©e
(
	`g‘F¿meR©e
());

419 
	}
}

422 
	gCÚsŞe
::
	$š™ŸlizeAudio
()

427 cÚ¡ 
¡ršg
& 
sound
 = 
myPrİ”t›s
.
	`g‘
(
C¬Œidge_Sound
);

428 
uIÁ32
 
chªÃls
 = (
sound
 == "STEREO" ? 2 : 1);

430 
myOSy¡em
->
	`sound
().
	`şo£
();

431 
myOSy¡em
->
	`sound
().
	`£tChªÃls
(
chªÃls
);

432 
myOSy¡em
->
	`sound
().
	`£tF¿meR©e
(
	`g‘F¿meR©e
());

433 
myOSy¡em
->
	`sound
().
	`š™Ÿlize
();

434 
	}
}

456 
	gCÚsŞe
::
	$äy
() const

458 
ZPmem
=0; ZPmem<0x100; ZPmem +ğ
	`¿nd
() % 4)

459 
mySy¡em
->
	`poke
(
ZPmem
, mySy¡em->
	`³ek
(ZPmemè& (
uIÁ8
)
	`¿nd
() % 256);

460 
	}
}

463 
	gCÚsŞe
::
	$chªgeYS¹
(
dœeùiÚ
)

465 
IÁ32
 
y¡¬t
 = 
	`©oi
(
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_YS¹
).
	`c_¡r
());

466 
o¡ršg¡»am
 
¡rv®
;

467 
¡ršg
 
mes§ge
;

469 if(
dœeùiÚ
 == +1)

471 
y¡¬t
++;

472 if(
y¡¬t
 > 64)

478 if(
dœeùiÚ
 == -1)

480 
y¡¬t
--;

481 if(
y¡¬t
 < 0)

490 
¡rv®
 << 
y¡¬t
;

491 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_YS¹
, 
¡rv®
.
	`¡r
());

492 ((
TIA
*)
myMedŸSourû
)->
	`äameRe£t
();

495 
mes§ge
 = "YStart ";

496 
mes§ge
 +ğ
¡rv®
.
	`¡r
();

498 
	}
}

501 
	gCÚsŞe
::
	$chªgeHeight
(
dœeùiÚ
)

503 
IÁ32
 
height
 = 
	`©oi
(
myPrİ”t›s
.
	`g‘
(
Di¥Ïy_Height
).
	`c_¡r
());

504 
o¡ršg¡»am
 
¡rv®
;

505 
¡ršg
 
mes§ge
;

507 if(
dœeùiÚ
 == +1)

509 
height
++;

510 if(
height
 > 256)

516 if(
dœeùiÚ
 == -1)

518 
height
--;

519 if(
height
 < 200)

528 
¡rv®
 << 
height
;

529 
myPrİ”t›s
.
	`£t
(
Di¥Ïy_Height
, 
¡rv®
.
	`¡r
());

530 ((
TIA
*)
myMedŸSourû
)->
	`äameRe£t
();

531 
	`š™ŸlizeVideo
();

533 
mes§ge
 = "Height ";

534 
mes§ge
 +ğ
¡rv®
.
	`¡r
();

536 
	}
}

539 
	gCÚsŞe
::
	$toggËTIAB™
(
TIA
::
TIAB™
 
b™
, cÚ¡ 
¡ršg
& 
b™Çme
, 
boŞ
 
show
) const

541 
boŞ
 
»suÉ
 = ((
TIA
*)
myMedŸSourû
)->
	`toggËB™
(
b™
);

542 
¡ršg
 
mes§ge
 = 
b™Çme
 + (
»suÉ
 ? "ƒnabled" : " disabled");

544 
	}
}

547 
	gCÚsŞe
::
	$’abËB™s
(
boŞ
 
’abË
) const

549 ((
TIA
*)
myMedŸSourû
)->
	`’abËB™s
(
’abË
);

550 
¡ršg
 
mes§ge
 = 
	`¡ršg
("TIA b™s"è+ (
’abË
 ? "ƒnabled" : " disabled");

552 
	}
}

555 
	gCÚsŞe
::
	$lßdU£rP®‘‹
()

557 cÚ¡ 
¡ršg
& 
·Ë‰e
 = 
myOSy¡em
->
	`·Ë‰eFe
();

558 
if¡»am
 
	`š
(
·Ë‰e
.
	`c_¡r
(), 
ios
::
bš¬y
);

559 if(!
š
)

565 
š
.
	`£ekg
(0, 
ios
::
’d
);

566 
¡»ampos
 
Ëngth
 = 
š
.
	`‹Îg
();

567 
š
.
	`£ekg
(0, 
ios
::
beg
);

568 if(
Ëngth
 < 128 * 3 * 2 + 8 * 3)

570 
š
.
	`şo£
();

571 
û¼
 << "ERROR: inv®id…®‘‹ f" << 
·Ë‰e
 << 
’dl
;

576 
uIÁ8
 
pixbuf
[3];

578 
i
 = 0; i < 128; i++)

580 
š
.
	`»ad
((*)
pixbuf
, 3);

581 
uIÁ32
 
pix–
 = (()
pixbuf
[0] << 16) + (()pixbuf[1] << 8) + ()pixbuf[2];

582 
ourU£rNTSCP®‘‹
[(
i
<<1)] = 
pix–
;

584 
i
 = 0; i < 128; i++)

586 
š
.
	`»ad
((*)
pixbuf
, 3);

587 
uIÁ32
 
pix–
 = (()
pixbuf
[0] << 16) + (()pixbuf[1] << 8) + ()pixbuf[2];

588 
ourU£rPALP®‘‹
[(
i
<<1)] = 
pix–
;

591 
uIÁ32
 
£ÿm
[16];

592 
i
 = 0; i < 8; i++)

594 
š
.
	`»ad
((*)
pixbuf
, 3);

595 
uIÁ32
 
pix–
 = (()
pixbuf
[0] << 16) + (()pixbuf[1] << 8) + ()pixbuf[2];

596 
£ÿm
[(
i
<<1)] = 
pix–
;

597 
£ÿm
[(
i
<<1)+1] = 0;

599 
uIÁ32
* 
±r
 = 
ourU£rSECAMP®‘‹
;

600 
i
 = 0; i < 16; ++i)

602 
uIÁ32
* 
s
 = 
£ÿm
;

603 
j
 = 0; j < 16; ++j)

604 *
±r
++ = *
s
++;

607 
š
.
	`şo£
();

608 
myU£rP®‘‹Defšed
 = 
Œue
;

609 
	}
}

612 
	gCÚsŞe
::
	$£tCŞÜLossP®‘‹
(
boŞ
 
loss
)

616 
uIÁ32
* 
·Ë‰e
[9] = {

617 &
ourNTSCP®‘‹
[0], &
ourPALP®‘‹
[0], &
ourSECAMP®‘‹
[0],

618 &
ourNTSCP®‘‹Z26
[0], &
ourPALP®‘‹Z26
[0], &
ourSECAMP®‘‹Z26
[0],

621 if(
myU£rP®‘‹Defšed
)

623 
·Ë‰e
[6] = &
ourU£rNTSCP®‘‹
[0];

624 
·Ë‰e
[7] = &
ourU£rPALP®‘‹
[0];

625 
·Ë‰e
[8] = &
ourU£rSECAMP®‘‹
[0];

628 
i
 = 0; i < 9; ++i)

630 if(
·Ë‰e
[
i
] == 0)

636 
j
 = 0; j < 128; ++j)

638 
uIÁ32
 
pix–
 = 
·Ë‰e
[
i
][(
j
<<1)];

639 if(
loss
)

641 
uIÁ8
 
r
 = (
pix–
 >> 16) & 0xff;

642 
uIÁ8
 
g
 = (
pix–
 >> 8) & 0xff;

643 
uIÁ8
 
b
 = (
pix–
 >> 0) & 0xff;

644 
uIÁ8
 
sum
 = (uIÁ8è((()
r
 * 0.2989) +

645 (()
g
 * 0.5870) +

646 (()
b
 * 0.1140));

647 
pix–
 = (
sum
 << 16) + (sum << 8) + sum;

649 
·Ë‰e
[
i
][(
j
<<1)+1] = 
pix–
;

652 
	}
}

655 
uIÁ32
 
	gCÚsŞe
::
	$g‘F¿meR©e
() const

661 
äam”©e
 = 
myOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("framerate");

662 if(
äam”©e
 == -1)

664 if(
myDi¥ÏyFÜm©
 == "NTSC" || myDisplayFormat == "PAL60")

665 
äam”©e
 = 60;

666 if(
myDi¥ÏyFÜm©
 == "PAL" || myDisplayFormat == "SECAM")

667 
äam”©e
 = 50;

669 
äam”©e
 = 60;

672  
äam”©e
;

673 
	}
}

676 
uIÁ32
 
	gCÚsŞe
::
ourNTSCP®‘‹
[256] = {

712 
uIÁ32
 
	gCÚsŞe
::
ourPALP®‘‹
[256] = {

748 
uIÁ32
 
	gCÚsŞe
::
ourSECAMP®‘‹
[256] = {

784 
uIÁ32
 
	gCÚsŞe
::
ourNTSCP®‘‹Z26
[256] = {

820 
uIÁ32
 
	gCÚsŞe
::
ourPALP®‘‹Z26
[256] = {

856 
uIÁ32
 
	gCÚsŞe
::
ourSECAMP®‘‹Z26
[256] = {

892 
uIÁ32
 
	gCÚsŞe
::
ourU£rNTSCP®‘‹
[256] = { 0 };

895 
uIÁ32
 
	gCÚsŞe
::
ourU£rPALP®‘‹
[256] = { 0 };

898 
uIÁ32
 
	gCÚsŞe
::
ourU£rSECAMP®‘‹
[256] = { 0 };

901 
	gCÚsŞe
::
	$CÚsŞe
(cÚ¡ 
CÚsŞe
& 
cÚsŞe
)

902 : 
	$myOSy¡em
(
cÚsŞe
.
myOSy¡em
)

905 
	`as£¹
(
çl£
);

906 
	}
}

909 
	gCÚsŞe
& CÚsŞe::
İ”©Ü
 = (cÚ¡ 
CÚsŞe
&)

912 
as£¹
(
çl£
);

914  *
	gthis
;

	@emucore/Console.hxx

19 #iâdeà
CONSOLE_HXX


20 
	#CONSOLE_HXX


	)

22 
şass
 
	gCÚsŞe
;

23 
şass
 
	gCÚŒŞËr
;

24 
şass
 
	gEv’t
;

25 
şass
 
	gMedŸSourû
;

26 
şass
 
	gSw™ches
;

27 
şass
 
	gSy¡em
;

29 
	~"b¥f.hxx
"

30 
	~"CÚŒŞ.hxx
"

31 
	~"Prİs.hxx
"

32 
	~"TIA.hxx
"

33 
	~"C¬t.hxx
"

34 
	~"M6532.hxx
"

35 
	~"AriVox.hxx
"

43 şas 
	cCÚsŞe


45 
	mpublic
:

54 
CÚsŞe
(
OSy¡em
* 
osy¡em
, 
C¬Œidge
* 
ÿ¹
, cÚ¡ 
Prİ”t›s
& 
´İs
);

61 
CÚsŞe
(cÚ¡ CÚsŞe& 
cÚsŞe
);

66 
	mvœtu®
 ~
CÚsŞe
();

68 
	mpublic
:

74 
CÚŒŞËr
& 
	$cÚŒŞËr
(
CÚŒŞËr
::
Jack
 
jack
) const

76  (
jack
 =ğ
CÚŒŞËr
::
Leá
è? *
myCÚŒŞËrs
[0] : *myControllers[1];

84 
MedŸSourû
& 
	$medŸSourû
(ècÚ¡ {  *
myMedŸSourû
; 
	}
}

91 cÚ¡ 
	gPrİ”t›s
& 
	$´İ”t›s
(ècÚ¡ {  
myPrİ”t›s
; 
	}
}

98 
	gSw™ches
& 
	$sw™ches
(ècÚ¡ {  *
mySw™ches
; 
	}
}

105 
	gSy¡em
& 
	$sy¡em
(ècÚ¡ {  *
mySy¡em
; 
	}
}

112 
	gC¬Œidge
& 
	$ÿ¹ridge
(ècÚ¡ {  *
myC¬t
; 
	}
}

119 
	gM6532
& 
	$riÙ
(ècÚ¡ {  *
myRiÙ
; 
	}
}

126 
£tPrİ”t›s
(cÚ¡ 
Prİ”t›s
& 
´İs
);

131 cÚ¡ 
	g¡ršg
& 
	$about
(ècÚ¡ {  
myAboutSŒšg
; 
	}
}

133 
	gpublic
:

140 
CÚsŞe
& 
İ”©Ü
 = (cÚ¡ CÚsŞe& 
cÚsŞe
);

142 
	gpublic
:

146 
toggËFÜm©
();

151 
¡ršg
 
	$g‘FÜm©
(ècÚ¡ {  
myDi¥ÏyFÜm©
; 
	}
}

156 
toggËP®‘‹
();

163 
£tP®‘‹
(cÚ¡ 
¡ršg
& 
·Ë‰e
);

168 
toggËPho¥hÜ
();

173 
toggËCŞÜLoss
();

182 
š™ŸlizeVideo
(
boŞ
 
fuÎ
 = 
Œue
);

188 
š™ŸlizeAudio
();

193 
	$äy
() const;

200 
	`chªgeYS¹
(
dœeùiÚ
);

207 
	`chªgeHeight
(
dœeùiÚ
);

212 
	$toggËP0B™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
P0
, "P0"); 
	}
}

213 
	$toggËP1B™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
P1
, "P1"); 
	}
}

214 
	$toggËM0B™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
M0
, "M0"); 
	}
}

215 
	$toggËM1B™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
M1
, "M1"); 
	}
}

216 
	$toggËBLB™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
BL
, "BL"); 
	}
}

217 
	$toggËPFB™
(ècÚ¡ { 
	`toggËTIAB™
(
TIA
::
PF
, "PF"); 
	}
}

218 
	$’abËB™s
(
boŞ
 
’abË
) const;

220 #ifdeà
ATARIVOX_SUPPORT


221 
AriVox
 *
	$©¬iVox
(è{  
vox
; 
	}
}

224 
	g´iv©e
:

225 
	$toggËTIAB™
(
TIA
::
TIAB™
 
b™
, cÚ¡ 
¡ršg
& 
b™Çme
, 
boŞ
 
show
 = 
Œue
) const;

231 
	`lßdU£rP®‘‹
();

237 
	`£tCŞÜLossP®‘‹
(
boŞ
 
¡©e
);

243 cÚ¡ 
uIÁ32
* 
	$g‘P®‘‹
(
dœeùiÚ
) const;

249 
uIÁ32
 
	$g‘F¿meR©e
() const;

251 
´iv©e
:

253 
OSy¡em
* 
myOSy¡em
;

256 
CÚŒŞËr
* 
myCÚŒŞËrs
[2];

259 
Ev’t
* 
myEv’t
;

262 
MedŸSourû
* 
myMedŸSourû
;

265 
Prİ”t›s
 
myPrİ”t›s
;

268 
Sw™ches
* 
mySw™ches
;

271 
Sy¡em
* 
mySy¡em
;

274 
C¬Œidge
 *
myC¬t
;

278 
M6532
 *
myRiÙ
;

280 #ifdeà
ATARIVOX_SUPPORT


281 
AriVox
 *
vox
;

285 
¡ršg
 
myDi¥ÏyFÜm©
;

289 
boŞ
 
myU£rP®‘‹Defšed
;

292 
¡ršg
 
myAboutSŒšg
;

295 
uIÁ32
 
ourNTSCP®‘‹
[256];

296 
uIÁ32
 
ourPALP®‘‹
[256];

297 
uIÁ32
 
ourSECAMP®‘‹
[256];

300 
uIÁ32
 
ourNTSCP®‘‹Z26
[256];

301 
uIÁ32
 
ourPALP®‘‹Z26
[256];

302 
uIÁ32
 
ourSECAMP®‘‹Z26
[256];

305 
uIÁ32
 
ourU£rNTSCP®‘‹
[256];

306 
uIÁ32
 
ourU£rPALP®‘‹
[256];

307 
uIÁ32
 
ourU£rSECAMP®‘‹
[256];

308 
	}
};

	@emucore/Control.cxx

19 
	~<as£¹.h
>

20 
	~"CÚŒŞ.hxx
"

23 
	gCÚŒŞËr
::
	$CÚŒŞËr
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
, 
Ty³
 
ty³
)

24 : 
	`myJack
(
jack
),

25 
	`myEv’t
(
ev’t
),

26 
	$myTy³
(
ty³
)

28 
	}
}

31 
	gCÚŒŞËr
::~
	$CÚŒŞËr
()

33 
	}
}

36 cÚ¡ 
CÚŒŞËr
::
Ty³
 CÚŒŞËr::
	$ty³
()

38  
myTy³
;

39 
	}
}

42 cÚ¡ 
IÁ32
 
	gCÚŒŞËr
::
maximumResi¡ªû
 = 0x7FFFFFFF;

45 cÚ¡ 
IÁ32
 
	gCÚŒŞËr
::
mšimumResi¡ªû
 = 0x00000000;

48 
	gCÚŒŞËr
::
	$CÚŒŞËr
(cÚ¡ 
CÚŒŞËr
& 
c
)

49 : 
	`myJack
(
c
.
myJack
),

50 
	`myEv’t
(
c
.
myEv’t
),

51 
	$myTy³
(
c
.
myTy³
)

53 
	`as£¹
(
çl£
);

54 
	}
}

57 
	gCÚŒŞËr
& CÚŒŞËr::
İ”©Ü
 = (cÚ¡ 
CÚŒŞËr
&)

59 
as£¹
(
çl£
);

60  *
	gthis
;

	@emucore/Control.hxx

19 #iâdeà
CONTROLLER_HXX


20 
	#CONTROLLER_HXX


	)

22 
şass
 
	gCÚŒŞËr
;

23 
şass
 
	gEv’t
;

24 
şass
 
	gSy¡em
;

26 
	~"b¥f.hxx
"

61 şas 
	cCÚŒŞËr


63 
	mpublic
:

67 
	eJack


69 
Leá
, 
	mRight


75 
	eTy³


77 
	gBoo¡”Gr
, 
	gDrivšg
, 
	gKeybßrd
, 
	gPaddËs
, 
	gJoy¡ick
,

78 
	gT¿kB®l
, 
	gAriVox


81 
	gpublic
:

89 
CÚŒŞËr
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
, 
Ty³
 
ty³
);

94 
	gvœtu®
 ~
CÚŒŞËr
();

99 cÚ¡ 
Ty³
 
ty³
();

104 
	$£tSy¡em
(
Sy¡em
* 
sy¡em
è{ 
mySy¡em
 = sy¡em; 
	}
}

106 
	gpublic
:

110 
	eDig™®Pš


112 
OÃ
, 
	gTwo
, 
	gTh»e
, 
	gFour
, 
	gSix


118 
	eAÇlogPš


120 
	gFive
, 
	gNše


123 
	gpublic
:

130 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
) = 0;

139 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
) = 0;

149 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
) = 0;

151 
	gpublic
:

153 cÚ¡ 
IÁ32
 
maximumResi¡ªû
;

156 cÚ¡ 
IÁ32
 
	gmšimumResi¡ªû
;

158 
	g´Ùeùed
:

160 cÚ¡ 
Jack
 
myJack
;

163 cÚ¡ 
	gEv’t
& 
	gmyEv’t
;

166 cÚ¡ 
Ty³
 
	gmyTy³
;

169 
Sy¡em
* 
	gmySy¡em
;

171 
	g´Ùeùed
:

173 
CÚŒŞËr
(const Controller&);

176 
	gCÚŒŞËr
& 
	gİ”©Ü
 = (cÚ¡ 
CÚŒŞËr
&);

	@emucore/DefProps.hxx

1 #iâdeà
DEF_PROPS_HXX


2 
	#DEF_PROPS_HXX


	)

11 
	#DEF_PROPS_SIZE
 2722

	)

13 cÚ¡ * 
	gDefPrİs
[
DEF_PROPS_SIZE
][21] = {

	@emucore/Deserializer.cxx

19 
	~"De£rŸliz”.hxx
"

20 
	~<s¡»am
>

23 
	gDe£rŸliz”
::
	$De£rŸliz”
(cÚ¡ 
¡ršg
 
¡»am_¡r
):

24 
	$mySŒ—m
(
¡»am_¡r
) {

26 
	}
}

32 
De£rŸliz”
::
	$şo£
()

34 
mySŒ—m
.
	`ş—r
();

35 
	}
}

40 
	gDe£rŸliz”
::
	$g‘IÁ
()

42 if(
mySŒ—m
.
	`eof
())

43 
throw
 "Deserializer:ƒnd of file";

45 
v®
 = 0;

46 
buf
[4];

47 
mySŒ—m
.
	`»ad
((*)
buf
, 4);

48 
i
 = 0; i < 4; ++i)

49 
v®
 +ğ()(
buf
[
i
]) << (i<<3);

51  
v®
;

52 
	}
}

55 
¡ršg
 
	gDe£rŸliz”
::
	$g‘SŒšg
()

57 
Ën
 = 
	`g‘IÁ
();

58 
¡ršg
 
¡r
;

59 
¡r
.
	`»size
((
¡ršg
::
size_ty³
)
Ën
);

60 
mySŒ—m
.
	`»ad
(&
¡r
[0], (
¡»amsize
)
Ën
);

62 if(
mySŒ—m
.
	`bad
())

63 
throw
 "Deserializer: file„ead failed";

65  
¡r
;

66 
	}
}

69 
boŞ
 
	gDe£rŸliz”
::
	$g‘BoŞ
()

71 
boŞ
 
»suÉ
 = 
çl£
;

73 
b
 = 
	`g‘IÁ
();

74 if(
b
 =ğ()
TrueP©‹º
)

75 
»suÉ
 = 
Œue
;

76 if(
b
 =ğ()
F®£P©‹º
)

77 
»suÉ
 = 
çl£
;

79 
throw
 "Deserializer: data corruption";

81  
»suÉ
;

82 
	}
}

	@emucore/Deserializer.hxx

19 #iâdeà
DESERIALIZER_HXX


20 
	#DESERIALIZER_HXX


	)

22 
	~<s¡»am
>

23 
	~"b¥f.hxx
"

41 şas 
	cDe£rŸliz”
 {

42 
	mpublic
:

46 
De£rŸliz”
(cÚ¡ 
¡ršg
 
¡»am_¡r
);

48 
şo£
();

55 
g‘IÁ
();

62 
¡ršg
 
g‘SŒšg
();

69 
boŞ
 
g‘BoŞ
();

71 
boŞ
 
	$isO³n
(è{ 
Œue
;}

72 
´iv©e
:

74 
¡ršg¡»am
 
mySŒ—m
;

77 
TrueP©‹º
 = 0xfab1fab2,

78 
F®£P©‹º
 = 0xbad1bad2

79 
	}
};

	@emucore/Driving.cxx

19 
	~<ÿs£¹
>

21 
	~"Ev’t.hxx
"

22 
	~"Drivšg.hxx
"

23 
	~"Sy¡em.hxx
"

26 
	gDrivšg
::
	$Drivšg
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
)

27 : 
	`CÚŒŞËr
(
jack
, 
ev’t
, 
CÚŒŞËr
::
Drivšg
),

28 
	$myCouÁ”
(0)

30 
	}
}

33 
	gDrivšg
::~
	$Drivšg
()

35 
	}
}

38 
boŞ
 
Drivšg
::
	$»ad
(
Dig™®Pš
 
pš
)

41 cÚ¡ 
uIÁ8
 
şockwi£
[] = { 0x03, 0x01, 0x00, 0x02 };

44 cÚ¡ 
uIÁ8
 
couÁ”şockwi£
[] = { 0x03, 0x02, 0x00, 0x01 };

47 cÚ¡ 
uIÁ32
 
d–ay
 = 20;

49 
pš
)

51 
OÃ
:

52 ++
myCouÁ”
;

54 if(
myJack
 =ğ
Leá
)

56 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oCouÁ”Clockwi£
) != 0)

58  (
couÁ”şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x01) != 0;

60 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oClockwi£
) != 0)

62  (
şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x01) != 0;

65 (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oV®ue
) & 0x01);

69 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃCouÁ”Clockwi£
) != 0)

71  (
couÁ”şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x01) != 0;

73 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃClockwi£
) != 0)

75  (
şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x01) != 0;

78 (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃV®ue
) & 0x01);

81 
Two
:

82 if(
myJack
 =ğ
Leá
)

84 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oCouÁ”Clockwi£
) != 0)

86  (
couÁ”şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x02) != 0;

88 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oClockwi£
) != 0)

90  (
şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x02) != 0;

93 (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oV®ue
) & 0x02);

97 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃCouÁ”Clockwi£
) != 0)

99  (
couÁ”şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x02) != 0;

101 if(
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃClockwi£
) != 0)

103  (
şockwi£
[(
myCouÁ”
 / 
d–ay
) & 0x03] & 0x02) != 0;

106 (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃV®ue
) & 0x02);

109 
Th»e
:

110  
Œue
;

112 
Four
:

113  
Œue
;

115 
Six
:

116  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgZ”oFœe
) == 0) :

117 (
myEv’t
.
	`g‘
(
Ev’t
::
DrivšgOÃFœe
) == 0);

120  
Œue
;

122 
	}
}

125 
IÁ32
 
	gDrivšg
::
	$»ad
(
AÇlogPš
)

129  
maximumResi¡ªû
;

130 
	}
}

133 
	gDrivšg
::
	$wr™e
(
Dig™®Pš
, 
boŞ
)

136 
	}
}

	@emucore/Driving.hxx

19 #iâdeà
DRIVING_HXX


20 
	#DRIVING_HXX


	)

22 
şass
 
	gDrivšg
;

23 
şass
 
	gSy¡em
;

25 
	~"b¥f.hxx
"

26 
	~"CÚŒŞ.hxx
"

34 şas 
	cDrivšg
 : 
public
 
CÚŒŞËr


36 
public
:

44 
Drivšg
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
);

49 
	mvœtu®
 ~
Drivšg
();

51 
	mpublic
:

58 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

67 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

77 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

79 
	m´iv©e
:

81 
uIÁ32
 
myCouÁ”
;

	@emucore/Event.cxx

19 
	~"Ev’t.hxx
"

20 
	~"Ev’tSŒ—m”.hxx
"

23 
	gEv’t
::
	$Ev’t
(
Ev’tSŒ—m”
* 
ev
)

24 : 
	$myNumb”OfTy³s
(
Ev’t
::
La¡Ty³
)

30 
	`ş—r
();

32 
myV®ues
[
PaddËZ”oResi¡ªû
] =

33 
myV®ues
[
PaddËOÃResi¡ªû
] =

34 
myV®ues
[
PaddËTwoResi¡ªû
] =

35 
myV®ues
[
PaddËTh»eResi¡ªû
] = 0;

36 
	}
}

39 
	gEv’t
::~
	$Ev’t
()

41 
	}
}

44 
IÁ32
 
Ev’t
::
	$g‘
(
Ty³
 
ty³
) const

46  
myV®ues
[
ty³
];

47 
	}
}

50 
	gEv’t
::
	$£t
(
Ty³
 
ty³
, 
IÁ32
 
v®ue
)

52 
myV®ues
[
ty³
] = 
v®ue
;

59 
	}
}

62 
	gEv’t
::
	$ş—r
()

64 
i
 = 0; i < 
myNumb”OfTy³s
; ++i)

66 if(
i
 !ğ
PaddËZ”oResi¡ªû
 && i !ğ
PaddËOÃResi¡ªû
 &&

67 
i
 !ğ
PaddËTwoResi¡ªû
 && i !ğ
PaddËTh»eResi¡ªû
)

68 
myV®ues
[
i
] = 0;

70 
	}
}

	@emucore/Event.hxx

19 #iâdeà
EVENT_HXX


20 
	#EVENT_HXX


	)

22 
	~"b¥f.hxx
"

24 
şass
 
	gEv’t
;

25 
şass
 
	gEv’tSŒ—m”
;

31 şas 
	cEv’t


33 
	mpublic
:

39 
	eTy³


41 
NoTy³
,

42 
	mCÚsŞeOn
, 
	mCÚsŞeOff
, 
	mCÚsŞeCŞÜ
, 
	mCÚsŞeBÏckWh™e
,

43 
	mCÚsŞeLeáDifficuÉyA
, 
	mCÚsŞeLeáDifficuÉyB
,

44 
	mCÚsŞeRightDifficuÉyA
, 
	mCÚsŞeRightDifficuÉyB
,

45 
	mCÚsŞeS–eù
, 
	mCÚsŞeRe£t
,

47 
	mJoy¡ickZ”oUp
, 
	mJoy¡ickZ”oDown
, 
	mJoy¡ickZ”oLeá
,

48 
	mJoy¡ickZ”oRight
, 
	mJoy¡ickZ”oFœe
,

49 
	mJoy¡ickOÃUp
, 
	mJoy¡ickOÃDown
, 
	mJoy¡ickOÃLeá
,

50 
	mJoy¡ickOÃRight
, 
	mJoy¡ickOÃFœe
,

52 
	mBoo¡”GrZ”oTrigg”
, 
	mBoo¡”GrZ”oBoo¡”
,

53 
	mBoo¡”GrOÃTrigg”
, 
	mBoo¡”GrOÃBoo¡”
,

55 
	mPaddËZ”oResi¡ªû
, 
	mPaddËZ”oFœe
,

56 
	mPaddËZ”oDeü—£
, 
	mPaddËZ”oInü—£
, 
	mPaddËZ”oAÇlog
,

57 
	mPaddËOÃResi¡ªû
, 
	mPaddËOÃFœe
,

58 
	mPaddËOÃDeü—£
, 
	mPaddËOÃInü—£
, 
	mPaddËOÃAÇlog
,

59 
	mPaddËTwoResi¡ªû
, 
	mPaddËTwoFœe
,

60 
	mPaddËTwoDeü—£
, 
	mPaddËTwoInü—£
, 
	mPaddËTwoAÇlog
,

61 
	mPaddËTh»eResi¡ªû
, 
	mPaddËTh»eFœe
,

62 
	mPaddËTh»eDeü—£
, 
	mPaddËTh»eInü—£
, 
	mPaddËTh»eAÇlog
,

64 
	mKeybßrdZ”o1
, 
	mKeybßrdZ”o2
, 
	mKeybßrdZ”o3
,

65 
	mKeybßrdZ”o4
, 
	mKeybßrdZ”o5
, 
	mKeybßrdZ”o6
,

66 
	mKeybßrdZ”o7
, 
	mKeybßrdZ”o8
, 
	mKeybßrdZ”o9
,

67 
	mKeybßrdZ”oSr
, 
	mKeybßrdZ”o0
, 
	mKeybßrdZ”oPound
,

69 
	mKeybßrdOÃ1
, 
	mKeybßrdOÃ2
, 
	mKeybßrdOÃ3
,

70 
	mKeybßrdOÃ4
, 
	mKeybßrdOÃ5
, 
	mKeybßrdOÃ6
,

71 
	mKeybßrdOÃ7
, 
	mKeybßrdOÃ8
, 
	mKeybßrdOÃ9
,

72 
	mKeybßrdOÃSr
, 
	mKeybßrdOÃ0
, 
	mKeybßrdOÃPound
,

74 
	mDrivšgZ”oClockwi£
, 
	mDrivšgZ”oCouÁ”Clockwi£
, 
	mDrivšgZ”oV®ue
,

75 
	mDrivšgZ”oFœe
,

76 
	mDrivšgOÃClockwi£
, 
	mDrivšgOÃCouÁ”Clockwi£
, 
	mDrivšgOÃV®ue
,

77 
	mDrivšgOÃFœe
,

79 
	mChªgeS‹
, 
	mLßdS‹
, 
	mSaveS‹
, 
	mTakeSÇpshÙ
, 
	mQu™
,

80 
	mPau£Mode
, 
	mM’uMode
, 
	mCmdM’uMode
, 
	mDebugg”Mode
, 
	mLaunch”Mode
,

81 
	mFry
, 
	mVŞumeDeü—£
, 
	mVŞumeInü—£
,

83 
	mUIUp
, 
	mUIDown
, 
	mUILeá
, 
	mUIRight
, 
	mUIHome
, 
	mUIEnd
, 
	mUIPgUp
, 
	mUIPgDown
,

84 
	mUIS–eù
, 
	mUINavP»v
, 
	mUINavNext
, 
	mUIOK
, 
	mUICªûl
,

86 
	mLa¡Ty³


89 
	gpublic
:

93 
Ev’t
(
Ev’tSŒ—m”
* 
ev
);

98 
	gvœtu®
 ~
Ev’t
();

100 
	gpublic
:

104 
vœtu®
 
IÁ32
 
	$g‘
(
Ty³
 
ty³
) const;

109 
vœtu®
 
	`£t
(
Ty³
 
ty³
, 
IÁ32
 
v®ue
);

114 
vœtu®
 
	`ş—r
();

116 
´Ùeùed
:

118 cÚ¡ 
IÁ32
 
myNumb”OfTy³s
;

121 
IÁ32
 
myV®ues
[
La¡Ty³
];

125 
	}
};

	@emucore/EventStreamer.cxx

19 
	~"b¥f.hxx
"

21 
	~"OSy¡em.hxx
"

22 
	~"Ev’t.hxx
"

24 
	~"Ev’tSŒ—m”.hxx
"

25 
	~"Sy¡em.hxx
"

28 
	gEv’tSŒ—m”
::
	$Ev’tSŒ—m”
(
OSy¡em
* 
osy¡em
)

29 : 
	`myOSy¡em
(
osy¡em
),

30 
	`myEv’tWr™eFÏg
(
çl£
),

31 
	`myEv’tR—dFÏg
(
çl£
),

32 
	`myF¿meCouÁ”
(-1),

33 
	$myEv’tPos
(0)

35 
	}
}

38 
	gEv’tSŒ—m”
::~
	$Ev’tSŒ—m”
()

40 
	`¡İRecÜdšg
();

42 
myEv’tHi¡Üy
.
	`ş—r
();

43 
mySŒ—mR—d”
.
	`şo£
();

44 
mySŒ—mWr™”
.
	`şo£
();

45 
	}
}

48 
	gEv’tSŒ—m”
::
	$»£t
()

51 
myEv’tWr™eFÏg
 = 
çl£
;

52 
myEv’tR—dFÏg
 = 
çl£
;

53 
myF¿meCouÁ”
 = -1;

54 
myEv’tPos
 = 0;

55 
	}
}

58 
boŞ
 
	gEv’tSŒ—m”
::
	$¡¬tRecÜdšg
()

60 
¡ršg
 
ev’tfe
 = "test.inp";

61 if(!
mySŒ—mWr™”
.
	`İ’
(
ev’tfe
))

62  
çl£
;

65 
¡ršg
 
md5
 = 
myOSy¡em
->
	`cÚsŞe
().
	`´İ”t›s
().
	`g‘
(
C¬Œidge_MD5
);

66 if(!
myOSy¡em
->
	`cÚsŞe
().
	`sy¡em
().
	`§veS‹
(
md5
, 
mySŒ—mWr™”
))

67  
çl£
;

68 
myEv’tHi¡Üy
.
	`ş—r
();

70 
	`»£t
();

71  
myEv’tWr™eFÏg
 = 
Œue
;

72 
	}
}

75 
boŞ
 
	gEv’tSŒ—m”
::
	$¡İRecÜdšg
()

77 if(!
mySŒ—mWr™”
.
	`isO³n
(è|| !
myEv’tWr™eFÏg
)

78  
çl£
;

81 
size
 = 
myEv’tHi¡Üy
.
	`size
();

83 
Œy


85 
mySŒ—mWr™”
.
	`putSŒšg
("EventStream");

86 
mySŒ—mWr™”
.
	`putIÁ
(
size
);

87 
i
 = 0; i < 
size
; ++i)

88 
mySŒ—mWr™”
.
	`putIÁ
(
myEv’tHi¡Üy
[
i
]);

90 
	`ÿtch
(*
msg
)

92 
û¼
 << 
msg
 << 
’dl
;

93  
çl£
;

95 
	`ÿtch
(...)

97 
û¼
 << "E¼Ü savšgƒv’t¡»am" << 
’dl
;

98  
çl£
;

101 
mySŒ—mWr™”
.
	`şo£
();

102  
Œue
;

103 
	}
}

106 
boŞ
 
	gEv’tSŒ—m”
::
	$lßdRecÜdšg
()

108 
û¼
 << "EventStreamer::loadRecording()\n";

109 
¡ršg
 
ev’tfe
 = "test.inp";

110 if(!
mySŒ—mR—d”
.
	`İ’
(
ev’tfe
))

111  
çl£
;

114 
¡ršg
 
md5
 = 
myOSy¡em
->
	`cÚsŞe
().
	`´İ”t›s
().
	`g‘
(
C¬Œidge_MD5
);

115 if(!
myOSy¡em
->
	`cÚsŞe
().
	`sy¡em
().
	`lßdS‹
(
md5
, 
mySŒ—mR—d”
))

116  
çl£
;

118 
Œy


120 if(
mySŒ—mR—d”
.
	`g‘SŒšg
() != "EventStream")

121  
çl£
;

124 
myEv’tHi¡Üy
.
	`ş—r
();

125 
size
 = 
mySŒ—mR—d”
.
	`g‘IÁ
();

126 
i
 = 0; i < 
size
; ++i)

127 
myEv’tHi¡Üy
.
	`push_back
(
mySŒ—mR—d”
.
	`g‘IÁ
());

129 
	`ÿtch
(*
msg
)

131 
û¼
 << 
msg
 << 
’dl
;

132  
çl£
;

134 
	`ÿtch
(...)

136 
û¼
 << "E¼Ü†ßdšgƒv’t¡»am" << 
’dl
;

137  
çl£
;

140 
	`»£t
();

141 
myEv’tR—dFÏg
 = 
myEv’tHi¡Üy
.
	`size
() > 0;

143  
Œue
;

144 
	}
}

147 
	gEv’tSŒ—m”
::
	$addEv’t
(
ty³
, 
v®ue
)

149 if(
myEv’tWr™eFÏg
)

151 
myEv’tHi¡Üy
.
	`push_back
(
ty³
);

152 
myEv’tHi¡Üy
.
	`push_back
(
v®ue
);

154 
	}
}

157 
boŞ
 
	gEv’tSŒ—m”
::
	$pŞlEv’t
(& 
ty³
, & 
v®ue
)

159 if(!
myEv’tR—dFÏg
)

160  
çl£
;

162 
boŞ
 
¡©us
 = 
çl£
;

166 ++
myF¿meCouÁ”
;

167 if(
myF¿meCouÁ”
 >= 0)

169 
fœ¡
 = 
myEv’tHi¡Üy
[
myEv’tPos
++];

170 if(
fœ¡
 < 0)

172 
myF¿meCouÁ”
 = 
fœ¡
;

173 
û¼
 << "wa™ " << -
myF¿meCouÁ”
 << " frames\n";

175 if(
myEv’tPos
 < ()
myEv’tHi¡Üy
.
	`size
())

177 
ty³
 = 
fœ¡
;

178 
v®ue
 = 
myEv’tHi¡Üy
[
myEv’tPos
++];

179 
û¼
 << "ty³ = " << 
ty³
 << ", v®uğ" << 
v®ue
 << 
’dl
;

180 
¡©us
 = 
Œue
;

184 
myEv’tR—dFÏg
 = 
myEv’tPos
 < ()
myEv’tHi¡Üy
.
	`size
() - 2;

185  
¡©us
;

186 
	}
}

189 
	gEv’tSŒ—m”
::
	$ÃxtF¿me
()

191 if(
myEv’tWr™eFÏg
)

193 
idx
 = 
myEv’tHi¡Üy
.
	`size
() - 1;

194 if(
idx
 >ğ0 && 
myEv’tHi¡Üy
[idx] < 0)

195 --
myEv’tHi¡Üy
[
idx
];

197 
myEv’tHi¡Üy
.
	`push_back
(-1);

199 
	}
}

	@emucore/EventStreamer.hxx

19 #iâdeà
EVENTSTREAMER_HXX


20 
	#EVENTSTREAMER_HXX


	)

22 
	~"A¼ay.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~"S”Ÿliz”.hxx
"

26 
şass
 
	gOSy¡em
;

53 şas 
	cEv’tSŒ—m”


55 
	mpublic
:

59 
Ev’tSŒ—m”
(
OSy¡em
* 
osy¡em
);

64 
	mvœtu®
 ~
Ev’tSŒ—m”
();

66 
	mpublic
:

70 
boŞ
 
¡¬tRecÜdšg
();

75 
boŞ
 
¡İRecÜdšg
();

80 
boŞ
 
lßdRecÜdšg
();

85 
addEv’t
(
ty³
, 
v®ue
);

90 
boŞ
 
pŞlEv’t
(& 
ty³
, & 
v®ue
);

95 
boŞ
 
	$isRecÜdšg
(è{  
myEv’tWr™eFÏg
; }

100 
	`ÃxtF¿me
();

105 
	`»£t
();

107 
´iv©e
:

109 
´iv©e
:

111 
OSy¡em
* 
myOSy¡em
;

114 
boŞ
 
myEv’tWr™eFÏg
;

115 
boŞ
 
myEv’tR—dFÏg
;

118 
myF¿meCouÁ”
;

121 
myEv’tPos
;

124 
IÁA¼ay
 
myEv’tHi¡Üy
;

127 
S”Ÿliz”
 
mySŒ—mWr™”
;

128 
De£rŸliz”
 
mySŒ—mR—d”
;

129 
	}
};

	@emucore/FSNode.cxx

22 
	~"FSNode.hxx
"

23 
	~"b¥f.hxx
"

27 
	gFSLi¡
::
	$sÜt
()

30 
IÁ32
 
i
 = 0; i < 
_size
-1; i++)

32 
IÁ32
 
mš
 = 
i
;

33 
IÁ32
 
j
 = 
i
+1; j < 
_size
; j++)

35 ià(
_d©a
[
j
] < _d©a[
mš
])

36 
mš
 = 
j
;

38 ià(
mš
 !ğ
i
)

39 
	`BSPF_sw­
(
_d©a
[
mš
], _d©a[
i
]);

41 
	}
}

44 
Fesy¡emNode
 
	gAb¡¿ùFesy¡emNode
::
	$w¿p
(
Ab¡¿ùFesy¡emNode
 *
node
)

46 
Fesy¡emNode
 
w¿µ”
;

47 
w¿µ”
.
_»®Node
 = 
node
;

49  
w¿µ”
;

50 
	}
}

53 
	gFesy¡emNode
::
	$Fesy¡emNode
()

55 
_»®Node
 = 
	`g‘RoÙ
();

56 
_»fCouÁ
 = 
Ãw
 (1);

57 
	}
}

60 
	gFesy¡emNode
::
	$Fesy¡emNode
(cÚ¡ 
Fesy¡emNode
 &
node
)

61 : 
	$Ab¡¿ùFesy¡emNode
()

63 
_»®Node
 = 
node
._realNode;

64 
_»fCouÁ
 = 
node
._refCount;

65 ++(*
_»fCouÁ
);

66 
	}
}

69 
	gFesy¡emNode
::
	$Fesy¡emNode
(cÚ¡ 
¡ršg
& 
p
)

71 
_»®Node
 = 
	`g‘NodeFÜP©h
(
p
);

72 
_»fCouÁ
 = 
Ãw
 (1);

73 
	}
}

76 
	gFesy¡emNode
::~
	$Fesy¡emNode
()

78 
	`decRefCouÁ
();

79 
	}
}

82 
	gFesy¡emNode
::
	$decRefCouÁ
()

84 --(*
_»fCouÁ
);

85 ià(*
_»fCouÁ
 <= 0)

87 
d–‘e
 
_»fCouÁ
;

88 
d–‘e
 
_»®Node
;

90 
	}
}

93 
	gFesy¡emNode
 &Fesy¡emNode::
İ”©Ü
 =(cÚ¡ 
Fesy¡emNode
 &
node
)

95 ++(*
node
.
_»fCouÁ
);

97 
decRefCouÁ
();

99 
	g_»®Node
 = 
node
.
_»®Node
;

100 
	g_»fCouÁ
 = 
node
.
_»fCouÁ
;

102  *
	gthis
;

106 
Fesy¡emNode
 
	gFesy¡emNode
::
	$g‘P¬’t
() const

108 
Ab¡¿ùFesy¡emNode
 *
node
 = 
_»®Node
->
	`·»Á
();

110 if(
node
 == 0)

111  *
this
;

113  
Ab¡¿ùFesy¡emNode
::
	`w¿p
(
node
);

114 
	}
}

117 
boŞ
 
	gFesy¡emNode
::
	$hasP¬’t
() const

119  
_»®Node
->
	`·»Á
() != 0;

120 
	}
}

	@emucore/FSNode.hxx

22 #iâdeà
FS_NODE_HXX


23 
	#FS_NODE_HXX


	)

25 
	~<®gÜ™hm
>

57 
	~"A¼ay.hxx
"

59 
şass
 
	gFesy¡emNode
;

64 
şass
 
	gFSLi¡
 : 
public
 
CommÚ
::
A¼ay
<
Fesy¡emNode
>

66 
public
:

67 
sÜt
();

74 şas 
	cAb¡¿ùFesy¡emNode


76 
	mpublic
:

81 
kLi¡FesOÆy
 = 1,

82 
	mkLi¡DœeùÜ›sOÆy
 = 2,

83 
	mkLi¡AÎ
 = 3

84 } 
	tLi¡Mode
;

86 
	gvœtu®
 ~
	$Ab¡¿ùFesy¡emNode
(è{
	}
}

93 
vœtu®
 
¡ršg
 
	$di¥ÏyName
() const = 0;

98 
vœtu®
 
boŞ
 
	$isV®id
() const = 0;

103 
vœtu®
 
boŞ
 
	$isDœeùÜy
() const = 0;

108 
vœtu®
 
¡ršg
 
	$·th
() const = 0;

114 
vœtu®
 
FSLi¡
 
	$li¡Dœ
(
Li¡Mode
 
mode
 = 
kLi¡DœeùÜ›sOÆy
) const = 0;

119 
vœtu®
 
boŞ
 
İ”©Ü
< (cÚ¡ 
Ab¡¿ùFesy¡emNode
& 
node
) const

121 
¡ršg
 
fœ¡
 = 
	`di¥ÏyName
();

122 
¡ršg
 
£cÚd
 = 
node
.
	`di¥ÏyName
();

123 
	`ŒªsfÜm
(
fœ¡
.
	`begš
(), fœ¡.
	`’d
(), fœ¡.begš(), ((*)()è
tŞow”
);

124 
	`ŒªsfÜm
(
£cÚd
.
	`begš
(), secÚd.
	`’d
(), secÚd.begš(), ((*)()è
tŞow”
);

125  
fœ¡
 < 
£cÚd
;

126 
	}
}

131 
boŞ
 
feExi¡s
(cÚ¡ 
¡ršg
& 
·th
);

136 
boŞ
 
dœExi¡s
(cÚ¡ 
¡ršg
& 
·th
);

141 
boŞ
 
makeDœ
(cÚ¡ 
¡ršg
& 
·th
);

148 
	g´Ùeùed
:

149 
ä›nd
 
şass
 
Fesy¡emNode
;

155 
vœtu®
 
Ab¡¿ùFesy¡emNode
 *
	$·»Á
() const = 0;

165 
Fesy¡emNode
 
	`w¿p
(
Ab¡¿ùFesy¡emNode
 *
node
);

166 
	}
};

169 şas 
	cFesy¡emNode
 : 
public
 
Ab¡¿ùFesy¡emNode


171 
ä›nd
 
şass
 
Ab¡¿ùFesy¡emNode
;

173 
	mpublic
:

174 
Fesy¡emNode
();

175 
Fesy¡emNode
(cÚ¡ Fesy¡emNode& 
node
);

176 
Fesy¡emNode
(cÚ¡ 
¡ršg
& 
·th
);

177 ~
Fesy¡emNode
();

179 
	mFesy¡emNode
 &
	mİ”©Ü
 =(cÚ¡ 
Fesy¡emNode
 &
node
);

181 
Fesy¡emNode
 
	$g‘P¬’t
() const;

182 
boŞ
 
	$hasP¬’t
() const;

184 
vœtu®
 
¡ršg
 
	$di¥ÏyName
(ècÚ¡ {  
_»®Node
->
	`di¥ÏyName
(); }

185 
vœtu®
 
boŞ
 
	$isV®id
(ècÚ¡ {  
_»®Node
->
	`isV®id
(); 
	}
}

186 
vœtu®
 
boŞ
 
	$isDœeùÜy
(ècÚ¡ {  
_»®Node
->
	`isDœeùÜy
(); 
	}
}

187 
vœtu®
 
¡ršg
 
	$·th
(ècÚ¡ {  
_»®Node
->
	`·th
(); 
	}
}

189 
vœtu®
 
FSLi¡
 
	$li¡Dœ
(
Li¡Mode
 
mode
 = 
kLi¡DœeùÜ›sOÆy
) const

190 {  
_»®Node
->
	`li¡Dœ
(
mode
); 
	}
}

192 
	g´Ùeùed
:

193 
decRefCouÁ
();

195 
vœtu®
 
Ab¡¿ùFesy¡emNode
* 
	$·»Á
(ècÚ¡ {  0; 
	}
}

197 
	g´iv©e
:

198 
Ab¡¿ùFesy¡emNode
 *
_»®Node
;

199 *
	g_»fCouÁ
;

207 
Ab¡¿ùFesy¡emNode
* 
g‘RoÙ
();

215 
Ab¡¿ùFesy¡emNode
* 
g‘NodeFÜP©h
(cÚ¡ 
¡ršg
& 
·th
);

	@emucore/Joystick.cxx

19 
	~<as£¹.h
>

20 
	~"Ev’t.hxx
"

21 
	~"Joy¡ick.hxx
"

24 
	gJoy¡ick
::
	$Joy¡ick
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
)

25 : 
	$CÚŒŞËr
(
jack
, 
ev’t
, 
CÚŒŞËr
::
Joy¡ick
)

27 
	}
}

30 
Joy¡ick
::~
	$Joy¡ick
()

32 
	}
}

35 
boŞ
 
Joy¡ick
::
	$»ad
(
Dig™®Pš
 
pš
)

37 
pš
)

39 
OÃ
:

40  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oUp
) == 0) :

41 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃUp
) == 0);

43 
Two
:

44  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oDown
) == 0) :

45 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃDown
) == 0);

47 
Th»e
:

48  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oLeá
) == 0) :

49 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃLeá
) == 0);

51 
Four
:

52  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oRight
) == 0) :

53 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃRight
) == 0);

55 
Six
:

56  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickZ”oFœe
) == 0) :

57 (
myEv’t
.
	`g‘
(
Ev’t
::
Joy¡ickOÃFœe
) == 0);

60  
Œue
;

62 
	}
}

65 
IÁ32
 
	gJoy¡ick
::
	$»ad
(
AÇlogPš
)

68  
maximumResi¡ªû
;

69 
	}
}

72 
	gJoy¡ick
::
	$wr™e
(
Dig™®Pš
, 
boŞ
)

75 
	}
}

	@emucore/Joystick.hxx

19 #iâdeà
JOYSTICK_HXX


20 
	#JOYSTICK_HXX


	)

22 
	~"b¥f.hxx
"

23 
	~"CÚŒŞ.hxx
"

31 şas 
	cJoy¡ick
 : 
public
 
CÚŒŞËr


33 
public
:

40 
Joy¡ick
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
);

45 
	mvœtu®
 ~
Joy¡ick
();

47 
	mpublic
:

54 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

63 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

73 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

	@emucore/Keyboard.cxx

19 
	~"Ev’t.hxx
"

20 
	~"Keybßrd.hxx
"

23 
	gKeybßrd
::
	$Keybßrd
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
)

24 : 
	`CÚŒŞËr
(
jack
, 
ev’t
, 
CÚŒŞËr
::
Keybßrd
),

25 
	$myPšS‹
(0)

27 
	}
}

30 
	gKeybßrd
::~
	$Keybßrd
()

32 
	}
}

35 
boŞ
 
Keybßrd
::
	$»ad
(
Dig™®Pš
 
pš
)

37 
pš
)

39 
OÃ
:

40  (
myPšS‹
 & 0x01);

42 
Two
:

43  (
myPšS‹
 & 0x02);

45 
Th»e
:

46  (
myPšS‹
 & 0x04);

48 
Four
:

49  (
myPšS‹
 & 0x08);

51 
Six
:

52 if((
myPšS‹
 & 0x01) == 0)

54  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o3
) == 0) :

55 (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ3
) == 0);

57 if((
myPšS‹
 & 0x02) == 0)

59  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o6
) == 0) :

60 (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ6
) == 0);

62 if((
myPšS‹
 & 0x04) == 0)

64  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o9
) == 0) :

65 (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ9
) == 0);

67 if((
myPšS‹
 & 0x08) == 0)

69  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”oPound
) == 0) :

70 (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃPound
) == 0);

75  
Œue
;

76 
	}
}

79 
IÁ32
 
	gKeybßrd
::
	$»ad
(
AÇlogPš
 
pš
)

83 if(
pš
 =ğ
Nše
)

85 if(
myJack
 =ğ
Leá
)

87 if(!(
myPšS‹
 & 0x01è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o1
) != 0))

89  
maximumResi¡ªû
;

91 if(!(
myPšS‹
 & 0x02è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o4
) != 0))

93  
maximumResi¡ªû
;

95 if(!(
myPšS‹
 & 0x04è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o7
) != 0))

97  
maximumResi¡ªû
;

99 if(!(
myPšS‹
 & 0x08è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”oSr
) != 0))

101  
maximumResi¡ªû
;

105  
mšimumResi¡ªû
;

110 if(!(
myPšS‹
 & 0x01è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ1
) != 0))

112  
maximumResi¡ªû
;

114 if(!(
myPšS‹
 & 0x02è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ4
) != 0))

116  
maximumResi¡ªû
;

118 if(!(
myPšS‹
 & 0x04è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ7
) != 0))

120  
maximumResi¡ªû
;

122 if(!(
myPšS‹
 & 0x08è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃSr
) != 0))

124  
maximumResi¡ªû
;

128  
mšimumResi¡ªû
;

134 if(
myJack
 =ğ
Leá
)

136 if(!(
myPšS‹
 & 0x01è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o2
) != 0))

138  
maximumResi¡ªû
;

140 if(!(
myPšS‹
 & 0x02è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o5
) != 0))

142  
maximumResi¡ªû
;

144 if(!(
myPšS‹
 & 0x04è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o8
) != 0))

146  
maximumResi¡ªû
;

148 if(!(
myPšS‹
 & 0x08è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdZ”o0
) != 0))

150  
maximumResi¡ªû
;

154  
mšimumResi¡ªû
;

159 if(!(
myPšS‹
 & 0x01è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ2
) != 0))

161  
maximumResi¡ªû
;

163 if(!(
myPšS‹
 & 0x02è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ5
) != 0))

165  
maximumResi¡ªû
;

167 if(!(
myPšS‹
 & 0x04è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ8
) != 0))

169  
maximumResi¡ªû
;

171 if(!(
myPšS‹
 & 0x08è&& (
myEv’t
.
	`g‘
(
Ev’t
::
KeybßrdOÃ0
) != 0))

173  
maximumResi¡ªû
;

177  
mšimumResi¡ªû
;

182  
mšimumResi¡ªû
;

183 
	}
}

186 
	gKeybßrd
::
	$wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
)

189 
pš
)

191 
OÃ
:

192 
myPšS‹
 = (myPšS‹ & 0x0Eè| (
v®ue
 ? 0x01 : 0x00);

195 
Two
:

196 
myPšS‹
 = (myPšS‹ & 0x0Dè| (
v®ue
 ? 0x02 : 0x00);

199 
Th»e
:

200 
myPšS‹
 = (myPšS‹ & 0x0Bè| (
v®ue
 ? 0x04 : 0x00);

203 
Four
:

204 
myPšS‹
 = (myPšS‹ & 0x07è| (
v®ue
 ? 0x08 : 0x00);

210 
	}
}

	@emucore/Keyboard.hxx

19 #iâdeà
KEYBOARD_HXX


20 
	#KEYBOARD_HXX


	)

22 
	~"b¥f.hxx
"

23 
	~"CÚŒŞ.hxx
"

31 şas 
	cKeybßrd
 : 
public
 
CÚŒŞËr


33 
public
:

40 
Keybßrd
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
);

45 
	mvœtu®
 ~
Keybßrd
();

47 
	mpublic
:

54 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

63 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

73 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

75 
	m´iv©e
:

77 
uIÁ8
 
myPšS‹
;

	@emucore/M6532.cxx

19 
	~<as£¹.h
>

20 
	~"CÚsŞe.hxx
"

21 
	~"M6532.hxx
"

22 
	~"Rªdom.hxx
"

23 
	~"Sw™ches.hxx
"

24 
	~"Sy¡em.hxx
"

25 
	~"S”Ÿliz”.hxx
"

26 
	~"De£rŸliz”.hxx
"

27 
	~<io¡»am
>

30 
	gM6532
::
	$M6532
(cÚ¡ 
CÚsŞe
& 
cÚsŞe
)

31 : 
	$myCÚsŞe
(
cÚsŞe
)

34 
şass
 
Rªdom
 
¿ndom
;

36 
uIÁ32
 
t
 = 0; < 128; ++t)

38 
myRAM
[
t
] = 
¿ndom
.
	`Ãxt
();

42 
	`»£t
();

43 
	}
}

46 
	gM6532
::~
	$M6532
()

48 
	}
}

51 cÚ¡ * 
M6532
::
	$Çme
() const

54 
	}
}

57 
	gM6532
::
	$»£t
()

59 
şass
 
Rªdom
 
¿ndom
;

61 
myTim”
 = 25 + (
¿ndom
.
	`Ãxt
() % 75);

62 
myIÁ”v®Shiá
 = 6;

63 
myCyşesWh’Tim”S‘
 = 0;

64 
myCyşesWh’IÁ”ru±Re£t
 = 0;

65 
myTim”R—dAá”IÁ”ru±
 = 
çl£
;

68 
myDDRA
 = 0x00;

69 
myDDRB
 = 0x00;

70 
	}
}

73 
	gM6532
::
	$sy¡emCyşesRe£t
()

77 
myCyşesWh’Tim”S‘
 -ğ
mySy¡em
->
	`cyşes
();

78 
myCyşesWh’IÁ”ru±Re£t
 -ğ
mySy¡em
->
	`cyşes
();

79 
	}
}

82 
	gM6532
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

85 
mySy¡em
 = &
sy¡em
;

87 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

88 
uIÁ16
 
mask
 = 
mySy¡em
->
	`·geMask
();

91 
	`as£¹
((0x1080 & 
mask
) == 0);

94 
Sy¡em
::
PageAcûss
 
acûss
;

95 
acûss
.
deviû
 = 
this
;

98 
add»ss
 = 0;‡dd»s < 8192;‡dd»s +ğ(1 << 
shiá
))

100 if((
add»ss
 & 0x1080) == 0x0080)

102 if((
add»ss
 & 0x0200) == 0x0000)

104 
acûss
.
dœeùP“kBa£
 = &
myRAM
[
add»ss
 & 0x007f];

105 
acûss
.
dœeùPokeBa£
 = &
myRAM
[
add»ss
 & 0x007f];

106 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

110 
acûss
.
dœeùP“kBa£
 = 0;

111 
acûss
.
dœeùPokeBa£
 = 0;

112 
mySy¡em
->
	`£tPageAcûss
(
add»ss
 >> 
shiá
, 
acûss
);

116 
	}
}

119 
uIÁ8
 
	gM6532
::
	$³ek
(
uIÁ16
 
addr
)

121 
addr
 & 0x07)

125 
uIÁ8
 
v®ue
 = 0x00;

127 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
OÃ
))

128 
v®ue
 |= 0x10;

129 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Two
))

130 
v®ue
 |= 0x20;

131 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Th»e
))

132 
v®ue
 |= 0x40;

133 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Four
))

134 
v®ue
 |= 0x80;

136 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
OÃ
))

137 
v®ue
 |= 0x01;

138 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Two
))

139 
v®ue
 |= 0x02;

140 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Th»e
))

141 
v®ue
 |= 0x04;

142 if(
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Four
))

143 
v®ue
 |= 0x08;

145  
v®ue
;

150  
myDDRA
;

155  
myCÚsŞe
.
	`sw™ches
().
	`»ad
();

160  
myDDRB
;

166 
uIÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
() - 1;

167 
uIÁ32
 
d–
 = 
cyşes
 - 
myCyşesWh’Tim”S‘
;

168 
IÁ32
 
tim”
 = (IÁ32)
myTim”
 - (IÁ32)(
d–
 >> 
myIÁ”v®Shiá
) - 1;

171 if(
tim”
 >= 0)

173  (
uIÁ8
)
tim”
;

177 
tim”
 = (
IÁ32
)(
myTim”
 << 
myIÁ”v®Shiá
è- (IÁ32)
d–
 - 1;

179 if((
tim”
 <ğ-2è&& !
myTim”R—dAá”IÁ”ru±
)

182 
myTim”R—dAá”IÁ”ru±
 = 
Œue
;

183 
myCyşesWh’IÁ”ru±Re£t
 = 
mySy¡em
->
	`cyşes
();

186 if(
myTim”R—dAá”IÁ”ru±
)

188 
IÁ32
 
off£t
 = 
myCyşesWh’IÁ”ru±Re£t
 -

189 (
myCyşesWh’Tim”S‘
 + (
myTim”
 << 
myIÁ”v®Shiá
));

191 
tim”
 = (
IÁ32
)
myTim”
 - (IÁ32)(
d–
 >> 
myIÁ”v®Shiá
è- 
off£t
;

194  (
uIÁ8
)
tim”
;

201 
uIÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
() - 1;

202 
uIÁ32
 
d–
 = 
cyşes
 - 
myCyşesWh’Tim”S‘
;

203 
IÁ32
 
tim”
 = (IÁ32)
myTim”
 - (IÁ32)(
d–
 >> 
myIÁ”v®Shiá
) - 1;

205 if((
tim”
 >ğ0è|| 
myTim”R—dAá”IÁ”ru±
)

213 #ifdeà
DEBUG_ACCESSES


214 
û¼
 << "BAD M6532 P“k: " << 
hex
 << 
addr
 << 
’dl
;

219 
	}
}

222 
	gM6532
::
	$poke
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
)

224 if((
addr
 & 0x07) == 0x00)

226 
uIÁ8
 
a
 = 
v®ue
 & 
myDDRA
;

228 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`wr™e
(CÚŒŞËr::
OÃ
, 
a
 & 0x10);

229 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`wr™e
(CÚŒŞËr::
Two
, 
a
 & 0x20);

230 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`wr™e
(CÚŒŞËr::
Th»e
, 
a
 & 0x40);

231 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`wr™e
(CÚŒŞËr::
Four
, 
a
 & 0x80);

233 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`wr™e
(CÚŒŞËr::
OÃ
, 
a
 & 0x01);

234 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`wr™e
(CÚŒŞËr::
Two
, 
a
 & 0x02);

235 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`wr™e
(CÚŒŞËr::
Th»e
, 
a
 & 0x04);

236 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`wr™e
(CÚŒŞËr::
Four
, 
a
 & 0x08);

238 if((
addr
 & 0x07) == 0x01)

240 
myDDRA
 = 
v®ue
;

241 #ifdeà
ATARIVOX_SUPPORT


259 
CÚŒŞËr
 &
c
 = 
myCÚsŞe
.
	`cÚŒŞËr
(CÚŒŞËr::
Right
);

260 if(
c
.
	`ty³
(è=ğ
CÚŒŞËr
::
AriVox
) {

261 
c
.
	`wr™e
(
CÚŒŞËr
::
OÃ
, !(
v®ue
 & 0x01));

262 
c
.
	`wr™e
(
CÚŒŞËr
::
Two
, !(
v®ue
 & 0x02));

263 
c
.
	`wr™e
(
CÚŒŞËr
::
Th»e
, !(
v®ue
 & 0x04));

264 
c
.
	`wr™e
(
CÚŒŞËr
::
Four
, !(
v®ue
 & 0x08));

268 if((
addr
 & 0x07) == 0x02)

272 if((
addr
 & 0x07) == 0x03)

277 if((
addr
 & 0x17) == 0x14)

279 
myTim”
 = 
v®ue
;

280 
myIÁ”v®Shiá
 = 0;

281 
myCyşesWh’Tim”S‘
 = 
mySy¡em
->
	`cyşes
();

282 
myTim”R—dAá”IÁ”ru±
 = 
çl£
;

284 if((
addr
 & 0x17) == 0x15)

286 
myTim”
 = 
v®ue
;

287 
myIÁ”v®Shiá
 = 3;

288 
myCyşesWh’Tim”S‘
 = 
mySy¡em
->
	`cyşes
();

289 
myTim”R—dAá”IÁ”ru±
 = 
çl£
;

291 if((
addr
 & 0x17) == 0x16)

293 
myTim”
 = 
v®ue
;

294 
myIÁ”v®Shiá
 = 6;

295 
myCyşesWh’Tim”S‘
 = 
mySy¡em
->
	`cyşes
();

296 
myTim”R—dAá”IÁ”ru±
 = 
çl£
;

298 if((
addr
 & 0x17) == 0x17)

300 
myTim”
 = 
v®ue
;

301 
myIÁ”v®Shiá
 = 10;

302 
myCyşesWh’Tim”S‘
 = 
mySy¡em
->
	`cyşes
();

303 
myTim”R—dAá”IÁ”ru±
 = 
çl£
;

305 if((
addr
 & 0x14) == 0x04)

307 #ifdeà
DEBUG_ACCESSES


308 
û¼
 << "M6532 Poke (Write Edge Detect): "

309 << ((
addr
 & 0x02) ? "PA7ƒnabled" : "PA7 disabled")

311 << ((
addr
 & 0x01) ? "Positiveƒdge" : "Negativeƒdge")

312 << 
’dl
;

317 #ifdeà
DEBUG_ACCESSES


318 
û¼
 << "BAD M6532 Poke: " << 
hex
 << 
addr
 << 
’dl
;

321 
	}
}

324 
boŞ
 
	gM6532
::
	$§ve
(
S”Ÿliz”
& 
out
)

326 
¡ršg
 
deviû
 = 
	`Çme
();

328 
Œy


330 
out
.
	`putSŒšg
(
deviû
);

333 
out
.
	`putIÁ
(128);

334 
uIÁ32
 
t
 = 0; < 128; ++t)

335 
out
.
	`putIÁ
(
myRAM
[
t
]);

337 
out
.
	`putIÁ
(
myTim”
);

338 
out
.
	`putIÁ
(
myIÁ”v®Shiá
);

339 
out
.
	`putIÁ
(
myCyşesWh’Tim”S‘
);

340 
out
.
	`putIÁ
(
myCyşesWh’IÁ”ru±Re£t
);

341 
out
.
	`putBoŞ
(
myTim”R—dAá”IÁ”ru±
);

342 
out
.
	`putIÁ
(
myDDRA
);

343 
out
.
	`putIÁ
(
myDDRB
);

345 
	`ÿtch
(*
msg
)

347 
û¼
 << 
msg
 << 
’dl
;

348  
çl£
;

350 
	`ÿtch
(...)

352 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
deviû
 << 
’dl
;

353  
çl£
;

356  
Œue
;

357 
	}
}

360 
boŞ
 
	gM6532
::
	$lßd
(
De£rŸliz”
& 
š
)

362 
¡ršg
 
deviû
 = 
	`Çme
();

364 
Œy


366 if(
š
.
	`g‘SŒšg
(è!ğ
deviû
)

367  
çl£
;

370 
uIÁ32
 
lim™
 = (uIÁ32è
š
.
	`g‘IÁ
();

371 
uIÁ32
 
t
 = 0; < 
lim™
; ++t)

372 
myRAM
[
t
] = (
uIÁ8
è
š
.
	`g‘IÁ
();

374 
myTim”
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

375 
myIÁ”v®Shiá
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

376 
myCyşesWh’Tim”S‘
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

377 
myCyşesWh’IÁ”ru±Re£t
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

378 
myTim”R—dAá”IÁ”ru±
 = 
š
.
	`g‘BoŞ
();

380 
myDDRA
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

381 
myDDRB
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

383 
	`ÿtch
(*
msg
)

385 
û¼
 << 
msg
 << 
’dl
;

386  
çl£
;

388 
	`ÿtch
(...)

390 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
deviû
 << 
’dl
;

391  
çl£
;

394  
Œue
;

395 
	}
}

399 
	gM6532
::
	$M6532
(cÚ¡ 
M6532
& 
c
)

400 : 
	$myCÚsŞe
(
c
.
myCÚsŞe
)

402 
	`as£¹
(
çl£
);

403 
	}
}

406 
	gM6532
& M6532::
İ”©Ü
 = (cÚ¡ 
M6532
&)

408 
as£¹
(
çl£
);

410  *
	gthis
;

	@emucore/M6532.hxx

19 #iâdeà
M6532_HXX


20 
	#M6532_HXX


	)

22 
şass
 
	gCÚsŞe
;

23 
şass
 
	gSy¡em
;

24 
şass
 
	gS”Ÿliz”
;

25 
şass
 
	gDe£rŸliz”
;

27 
	~"b¥f.hxx
"

28 
	~"Deviû.hxx
"

36 şas 
	cM6532
 : 
public
 
Deviû


38 
public
:

44 
M6532
(cÚ¡ 
CÚsŞe
& 
cÚsŞe
);

49 
	mvœtu®
 ~
M6532
();

51 
	mpublic
:

57 
vœtu®
 cÚ¡ * 
	$Çme
() const;

62 
vœtu®
 
	`»£t
();

69 
vœtu®
 
	`sy¡emCyşesRe£t
();

77 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

85 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

93 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

95 
public
:

101 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

109 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

111 
´iv©e
:

113 cÚ¡ 
CÚsŞe
& 
myCÚsŞe
;

116 
uIÁ8
 
myRAM
[128];

119 
uIÁ32
 
myTim”
;

122 
uIÁ32
 
myIÁ”v®Shiá
;

125 
IÁ32
 
myCyşesWh’Tim”S‘
;

128 
IÁ32
 
myCyşesWh’IÁ”ru±Re£t
;

131 
boŞ
 
myTim”R—dAá”IÁ”ru±
;

134 
uIÁ8
 
myDDRA
;

137 
uIÁ8
 
myDDRB
;

139 
´iv©e
:

141 
	`M6532
(cÚ¡ 
M6532
&);

144 
M6532
& 
İ”©Ü
 = (const M6532&);

	@emucore/MD5.cxx

22 
	~"MD5.hxx
"

48 * 
	tPOINTER
;

49 
uIÁ16
 
	tUINT2
;

50 
uIÁ32
 
	tUINT4
;

55 
UINT4
 
	m¡©e
[4];

56 
UINT4
 
	mcouÁ
[2];

57 
	mbufãr
[64];

58 } 
	tMD5_CTX
;

61 
	#S11
 7

	)

62 
	#S12
 12

	)

63 
	#S13
 17

	)

64 
	#S14
 22

	)

65 
	#S21
 5

	)

66 
	#S22
 9

	)

67 
	#S23
 14

	)

68 
	#S24
 20

	)

69 
	#S31
 4

	)

70 
	#S32
 11

	)

71 
	#S33
 16

	)

72 
	#S34
 23

	)

73 
	#S41
 6

	)

74 
	#S42
 10

	)

75 
	#S43
 15

	)

76 
	#S44
 21

	)

78 
MD5In™
(
MD5_CTX
*);

79 
MD5Upd©e
(
MD5_CTX
*, const *, );

80 
MD5Fš®
([16], 
MD5_CTX
*);

81 
MD5T¿nsfÜm
(
UINT4
 [4], const [64]);

82 
Encode
(*, 
UINT4
*, );

83 
Decode
(
UINT4
*, const *, );

84 
MD5_memıy
(
POINTER
, POINTER, );

85 
MD5_mem£t
(
POINTER
, , );

87 
	gPADDING
[64] = {

94 
	#F
(
x
, 
y
, 
z
è(((xè& (y)è| ((~xè& (z)))

	)

95 
	#G
(
x
, 
y
, 
z
è(((xè& (z)è| ((yè& (~z)))

	)

96 
	#H
(
x
, 
y
, 
z
è((xè^ (yè^ (z))

	)

97 
	#I
(
x
, 
y
, 
z
è((yè^ ((xè| (~z)))

	)

100 
	#ROTATE_LEFT
(
x
, 
n
è(((xè<< (n)è| ((xè>> (32-Ò))))

	)

104 
	#FF
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) { \

105 (
a
è+ğ
	`F
 ((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

106 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

107 (
a
è+ğ(
b
); \

108 }

	)

109 
	#GG
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) { \

110 (
a
è+ğ
	`G
 ((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

111 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

112 (
a
è+ğ(
b
); \

113 }

	)

114 
	#HH
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) { \

115 (
a
è+ğ
	`H
 ((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

116 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

117 (
a
è+ğ(
b
); \

118 }

	)

119 
	#II
(
a
, 
b
, 
c
, 
d
, 
x
, 
s
, 
ac
) { \

120 (
a
è+ğ
	`I
 ((
b
), (
c
), (
d
)è+ (
x
è+ (
UINT4
)(
ac
); \

121 (
a
èğ
	`ROTATE_LEFT
 (×), (
s
)); \

122 (
a
è+ğ(
b
); \

123 }

	)

126 
	$MD5In™
(
MD5_CTX
* 
cÚ‹xt
)

128 
cÚ‹xt
->
couÁ
[0] = context->count[1] = 0;

130 
cÚ‹xt
->
¡©e
[0] = 0x67452301;

131 
cÚ‹xt
->
¡©e
[1] = 0xefcdab89;

132 
cÚ‹xt
->
¡©e
[2] = 0x98badcfe;

133 
cÚ‹xt
->
¡©e
[3] = 0x10325476;

134 
	}
}

139 
	$MD5Upd©e
(
MD5_CTX
* 
cÚ‹xt
, cÚ¡ * 
šput
,

140 
šputL’
)

142 
i
, 
šdex
, 
·¹L’
;

145 
šdex
 = ()((
cÚ‹xt
->
couÁ
[0] >> 3) & 0x3F);

148 ià((
cÚ‹xt
->
couÁ
[0] +ğ((
UINT4
)
šputL’
 << 3))

149 < ((
UINT4
)
šputL’
 << 3))

150 
cÚ‹xt
->
couÁ
[1]++;

151 
cÚ‹xt
->
couÁ
[1] +ğ((
UINT4
)
šputL’
 >> 29);

153 
·¹L’
 = 64 - 
šdex
;

156 ià(
šputL’
 >ğ
·¹L’
) {

157 
	`MD5_memıy
 ((
POINTER
)&
cÚ‹xt
->
bufãr
[
šdex
], (POINTER)
šput
, 
·¹L’
);

158 
	`MD5T¿nsfÜm
 (
cÚ‹xt
->
¡©e
, cÚ‹xt->
bufãr
);

160 
i
 = 
·¹L’
; i + 63 < 
šputL’
; i += 64)

161 
	`MD5T¿nsfÜm
 (
cÚ‹xt
->
¡©e
, &
šput
[
i
]);

163 
šdex
 = 0;

166 
i
 = 0;

169 
	`MD5_memıy
((
POINTER
)&
cÚ‹xt
->
bufãr
[
šdex
], (POINTER)&
šput
[
i
], 
šputL’
-i);

170 
	}
}

174 
	$MD5Fš®
(
dige¡
[16], 
MD5_CTX
* 
cÚ‹xt
)

176 
b™s
[8];

177 
šdex
, 
·dL’
;

180 
	`Encode
 (
b™s
, 
cÚ‹xt
->
couÁ
, 8);

183 
šdex
 = ()((
cÚ‹xt
->
couÁ
[0] >> 3) & 0x3f);

184 
·dL’
 = (
šdex
 < 56) ? (56 - index) : (120 - index);

185 
	`MD5Upd©e
 (
cÚ‹xt
, 
PADDING
, 
·dL’
);

188 
	`MD5Upd©e
 (
cÚ‹xt
, 
b™s
, 8);

190 
	`Encode
 (
dige¡
, 
cÚ‹xt
->
¡©e
, 16);

193 
	`MD5_mem£t
 ((
POINTER
)
cÚ‹xt
, 0,  (*context));

194 
	}
}

197 
	$MD5T¿nsfÜm
(
UINT4
 
¡©e
[4], cÚ¡ 
block
[64])

199 
UINT4
 
a
 = 
¡©e
[0], 
b
 = s‹[1], 
c
 = s‹[2], 
d
 = s‹[3], 
x
[16];

201 
	`Decode
 (
x
, 
block
, 64);

204 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 0], 
S11
, 0xd76aa478);

205 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 1], 
S12
, 0xe8c7b756);

206 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[ 2], 
S13
, 0x242070db);

207 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[ 3], 
S14
, 0xc1bdceee);

208 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 4], 
S11
, 0xf57c0faf);

209 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 5], 
S12
, 0x4787c62a);

210 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[ 6], 
S13
, 0xa8304613);

211 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[ 7], 
S14
, 0xfd469501);

212 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[ 8], 
S11
, 0x698098d8);

213 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[ 9], 
S12
, 0x8b44f7af);

214 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[10], 
S13
, 0xffff5bb1);

215 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[11], 
S14
, 0x895cd7be);

216 
	`FF
 (
a
, 
b
, 
c
, 
d
, 
x
[12], 
S11
, 0x6b901122);

217 
	`FF
 (
d
, 
a
, 
b
, 
c
, 
x
[13], 
S12
, 0xfd987193);

218 
	`FF
 (
c
, 
d
, 
a
, 
b
, 
x
[14], 
S13
, 0xa679438e);

219 
	`FF
 (
b
, 
c
, 
d
, 
a
, 
x
[15], 
S14
, 0x49b40821);

222 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 1], 
S21
, 0xf61e2562);

223 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 6], 
S22
, 0xc040b340);

224 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[11], 
S23
, 0x265e5a51);

225 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[ 0], 
S24
, 0xe9b6c7aa);

226 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 5], 
S21
, 0xd62f105d);

227 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[10], 
S22
, 0x2441453);

228 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[15], 
S23
, 0xd8a1e681);

229 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[ 4], 
S24
, 0xe7d3fbc8);

230 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[ 9], 
S21
, 0x21e1cde6);

231 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[14], 
S22
, 0xc33707d6);

232 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[ 3], 
S23
, 0xf4d50d87);

233 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[ 8], 
S24
, 0x455a14ed);

234 
	`GG
 (
a
, 
b
, 
c
, 
d
, 
x
[13], 
S21
, 0xa9e3e905);

235 
	`GG
 (
d
, 
a
, 
b
, 
c
, 
x
[ 2], 
S22
, 0xfcefa3f8);

236 
	`GG
 (
c
, 
d
, 
a
, 
b
, 
x
[ 7], 
S23
, 0x676f02d9);

237 
	`GG
 (
b
, 
c
, 
d
, 
a
, 
x
[12], 
S24
, 0x8d2a4c8a);

240 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 5], 
S31
, 0xfffa3942);

241 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[ 8], 
S32
, 0x8771f681);

242 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[11], 
S33
, 0x6d9d6122);

243 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[14], 
S34
, 0xfde5380c);

244 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 1], 
S31
, 0xa4beea44);

245 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[ 4], 
S32
, 0x4bdecfa9);

246 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 7], 
S33
, 0xf6bb4b60);

247 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[10], 
S34
, 0xbebfbc70);

248 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[13], 
S31
, 0x289b7ec6);

249 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[ 0], 
S32
, 0xeaa127fa);

250 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[ 3], 
S33
, 0xd4ef3085);

251 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[ 6], 
S34
, 0x4881d05);

252 
	`HH
 (
a
, 
b
, 
c
, 
d
, 
x
[ 9], 
S31
, 0xd9d4d039);

253 
	`HH
 (
d
, 
a
, 
b
, 
c
, 
x
[12], 
S32
, 0xe6db99e5);

254 
	`HH
 (
c
, 
d
, 
a
, 
b
, 
x
[15], 
S33
, 0x1fa27cf8);

255 
	`HH
 (
b
, 
c
, 
d
, 
a
, 
x
[ 2], 
S34
, 0xc4ac5665);

258 
	`II
 (
a
, 
b
, 
c
, 
d
, 
x
[ 0], 
S41
, 0xf4292244);

259 
	`II
 (
d
, 
a
, 
b
, 
c
, 
x
[ 7], 
S42
, 0x432aff97);

260 
	`II
 (
c
, 
d
, 
a
, 
b
, 
x
[14], 
S43
, 0xab9423a7);

261 
	`II
 (
b
, 
c
, 
d
, 
a
, 
x
[ 5], 
S44
, 0xfc93a039);

262 
	`II
 (
a
, 
b
, 
c
, 
d
, 
x
[12], 
S41
, 0x655b59c3);

263 
	`II
 (
d
, 
a
, 
b
, 
c
, 
x
[ 3], 
S42
, 0x8f0ccc92);

264 
	`II
 (
c
, 
d
, 
a
, 
b
, 
x
[10], 
S43
, 0xffeff47d);

265 
	`II
 (
b
, 
c
, 
d
, 
a
, 
x
[ 1], 
S44
, 0x85845dd1);

266 
	`II
 (
a
, 
b
, 
c
, 
d
, 
x
[ 8], 
S41
, 0x6fa87e4f);

267 
	`II
 (
d
, 
a
, 
b
, 
c
, 
x
[15], 
S42
, 0xfe2ce6e0);

268 
	`II
 (
c
, 
d
, 
a
, 
b
, 
x
[ 6], 
S43
, 0xa3014314);

269 
	`II
 (
b
, 
c
, 
d
, 
a
, 
x
[13], 
S44
, 0x4e0811a1);

270 
	`II
 (
a
, 
b
, 
c
, 
d
, 
x
[ 4], 
S41
, 0xf7537e82);

271 
	`II
 (
d
, 
a
, 
b
, 
c
, 
x
[11], 
S42
, 0xbd3af235);

272 
	`II
 (
c
, 
d
, 
a
, 
b
, 
x
[ 2], 
S43
, 0x2ad7d2bb);

273 
	`II
 (
b
, 
c
, 
d
, 
a
, 
x
[ 9], 
S44
, 0xeb86d391);

275 
¡©e
[0] +ğ
a
;

276 
¡©e
[1] +ğ
b
;

277 
¡©e
[2] +ğ
c
;

278 
¡©e
[3] +ğ
d
;

281 
	`MD5_mem£t
 ((
POINTER
)
x
, 0,  (x));

282 
	}
}

286 
	$Encode
(* 
ouut
, 
UINT4
* 
šput
, 
Ën
)

288 
i
, 
j
;

290 
i
 = 0, 
j
 = 0; j < 
Ën
; i++, j += 4) {

291 
ouut
[
j
] = ()(
šput
[
i
] & 0xff);

292 
ouut
[
j
+1] = ()((
šput
[
i
] >> 8) & 0xff);

293 
ouut
[
j
+2] = ()((
šput
[
i
] >> 16) & 0xff);

294 
ouut
[
j
+3] = ()((
šput
[
i
] >> 24) & 0xff);

296 
	}
}

300 
	$Decode
(
UINT4
* 
ouut
, cÚ¡ * 
šput
, 
Ën
)

302 
i
, 
j
;

304 
i
 = 0, 
j
 = 0; j < 
Ën
; i++, j += 4)

305 
ouut
[
i
] = ((
UINT4
)
šput
[
j
]) | (((UINT4)input[j+1]) << 8) |

306 (((
UINT4
)
šput
[
j
+2]) << 16) | (((UINT4)input[j+3]) << 24);

307 
	}
}

310 
	$MD5_memıy
(
POINTER
 
ouut
, POINTER 
šput
, 
Ën
)

312 
i
;

314 
i
 = 0; i < 
Ën
; i++)

315 
ouut
[
i
] = 
šput
[i];

316 
	}
}

319 
	$MD5_mem£t
(
POINTER
 
ouut
, 
v®ue
, 
Ën
)

321 
i
;

323 
i
 = 0; i < 
Ën
; i++)

324 ((*)
ouut
)[
i
] = ()
v®ue
;

325 
	}
}

328 
¡ršg
 
	$MD5
(cÚ¡ 
uIÁ8
* 
bufãr
, 
uIÁ32
 
Ëngth
)

330 
hex
[] = "0123456789abcdef";

331 
MD5_CTX
 
cÚ‹xt
;

332 
md5
[16];

334 
	`MD5In™
(&
cÚ‹xt
);

335 
	`MD5Upd©e
(&
cÚ‹xt
, 
bufãr
, 
Ëngth
);

336 
	`MD5Fš®
(
md5
, &
cÚ‹xt
);

338 
¡ršg
 
»suÉ
;

339 
t
 = 0; < 16; ++t)

341 
»suÉ
 +ğ
hex
[(
md5
[
t
] >> 4) & 0x0f];

342 
»suÉ
 +ğ
hex
[
md5
[
t
] & 0x0f];

345  
»suÉ
;

346 
	}
}

	@emucore/MD5.hxx

19 #iâdeà
MD5_HXX


20 
	#MD5_HXX


	)

22 
	~"b¥f.hxx
"

32 
¡ršg
 
MD5
(cÚ¡ 
uIÁ8
* 
bufãr
, 
uIÁ32
 
Ëngth
);

	@emucore/MediaSrc.cxx

19 
	~<as£¹.h
>

20 
	~"MedŸSrc.hxx
"

23 
	gMedŸSourû
::
	$MedŸSourû
()

25 
	}
}

28 
MedŸSourû
::~
	$MedŸSourû
()

30 
	}
}

33 
MedŸSourû
::
	$MedŸSourû
(cÚ¡ 
MedŸSourû
&)

35 
	}
}

38 
MedŸSourû
& MedŸSourû::
İ”©Ü
 = (const MediaSource&)

40 
as£¹
(
çl£
);

42  *
	gthis
;

	@emucore/MediaSrc.hxx

19 #iâdeà
MEDIASOURCE_HXX


20 
	#MEDIASOURCE_HXX


	)

23 
şass
 
	gMedŸSourû
;

24 
şass
 
	gSound
;

26 
	~"b¥f.hxx
"

34 şas 
	cMedŸSourû


36 
	mpublic
:

40 
MedŸSourû
();

45 
	mvœtu®
 ~
MedŸSourû
();

47 
	mpublic
:

54 
vœtu®
 
upd©e
() = 0;

61 
vœtu®
 
uIÁ8
* 
	$cu¼’tF¿meBufãr
() const = 0;

68 
vœtu®
 
uIÁ8
* 
	$´eviousF¿meBufãr
() const = 0;

70 #ifdeà
DEBUGGER_SUPPORT


76 
vœtu®
 
	`upd©eSÿÆše
() = 0;

83 
vœtu®
 
	`upd©eSÿÆšeByS‹p
() = 0;

90 
vœtu®
 
	`upd©eSÿÆšeByT¿û
(
rg‘
) = 0;

93 
public
:

99 
vœtu®
 
uIÁ32
 
	$height
() const = 0;

106 
vœtu®
 
uIÁ32
 
	$width
() const = 0;

108 
public
:

115 
vœtu®
 
uIÁ32
 
	$sÿÆšes
() const = 0;

120 
vœtu®
 
	`£tSound
(
Sound
& 
sound
) = 0;

122 
´iv©e
:

124 
	`MedŸSourû
(cÚ¡ 
MedŸSourû
&);

127 
MedŸSourû
& 
İ”©Ü
 = (const MediaSource&);

	@emucore/OSystem.cxx

19 
	~<ÿs£¹
>

20 
	~<s¡»am
>

21 
	~<f¡»am
>

22 
	~<io¡»am
>

23 
	~<zlib.h
>

28 #ifdeà
DEBUGGER_SUPPORT


29 
	~"Debugg”.hxx
"

32 #ifdeà
CHEATCODE_SUPPORT


33 
	~"Ch—tMªag”.hxx
"

36 
	~"FSNode.hxx
"

37 
	~"unz.h
"

38 
	~"MD5.hxx
"

39 
	~"S‘tšgs.hxx
"

40 
	~"PrİsS‘.hxx
"

42 
	~"Ev’t.hxx
"

43 
	~"Ev’tSŒ—m”.hxx
"

50 
	~"OSy¡em.hxx
"

51 
	~"game_cÚŒŞËr.h
"

53 
	#MAX_ROM_SIZE
 512 * 1024

	)

55 
	~<time.h
>

56 
	~<sys/time.h
>

57 
	~"b¥f.hxx
"

58 
	gticks
 = 0;

59 
size_t
 
	gtime_¡¬t
;

60 
size_t
 
	gtime_’d
;

64 
	gOSy¡em
::
	$OSy¡em
()

66 
	`myEv’t
(
NULL
),

68 
	`myGameCÚŒŞËr
(
NULL
),

69 
	`p_expÜt_sü“n
(
NULL
),

71 
	`mySound
(
NULL
),

72 
	`myS‘tšgs
(
NULL
),

73 
	`myPrİS‘
(
NULL
),

74 
	`myCÚsŞe
(
NULL
),

80 
	`myQu™Loİ
(
çl£
),

81 
	`myRomFe
(""),

82 
	`myF—tu»s
("")

86 #ifdeà
DISPLAY_OPENGL


87 
myF—tu»s
 += "OpenGL ";

89 #ifdeà
SOUND_SUPPORT


90 
myF—tu»s
 += "Sound ";

92 #ifdeà
JOYSTICK_SUPPORT


93 
myF—tu»s
 += "Joystick ";

95 #ifdeà
DEBUGGER_SUPPORT


96 
myF—tu»s
 += "Debugger ";

98 #ifdeà
CHEATCODE_SUPPORT


99 
myF—tu»s
 += "Cheats";

102 
	}
}

105 
	gOSy¡em
::~
	$OSy¡em
()

114 
	`d–‘eCÚsŞe
();

119 
d–‘e
 
mySound
;

124 #ifdeà
DEBUGGER_SUPPORT


125 
d–‘e
 
myDebugg”
;

127 #ifdeà
CHEATCODE_SUPPORT


128 
d–‘e
 
myCh—tMªag”
;

131 
d–‘e
 
myPrİS‘
;

134 
d–‘e
 
myEv’t
;

135 ià(
p_expÜt_sü“n
) {

136 
d–‘e
 
p_expÜt_sü“n
;

140 
	}
}

143 
boŞ
 
	gOSy¡em
::
	$ü—‹
()

146 
	`£tCÚfigP©hs
();

165 
myEv’t
 = 
Ãw
 
	`Ev’t
(
NULL
);

167 
myPrİS‘
 = 
Ãw
 
	`Prİ”t›sS‘
(
this
);

169 #ifdeà
CHEATCODE_SUPPORT


170 
myCh—tMªag”
 = 
Ãw
 
	`Ch—tMªag”
(
this
);

171 
myCh—tMªag”
->
	`lßdCh—tD©aba£
();

178 #ifdeà
DEBUGGER_SUPPORT


179 
myDebugg”
 = 
Ãw
 
	`Debugg”
(
this
);

185 
	`ü—‹Sound
();

189  
Œue
;

190 
	}
}

193 
	gOSy¡em
::
	$£tCÚfigP©hs
()

195 
myS‹Dœ
 = 
myS‘tšgs
->
	`g‘SŒšg
("statedir");

196 if(
myS‹Dœ
 == "")

197 
myS‹Dœ
 = 
myBa£Dœ
 + 
BSPF_PATH_SEPARATOR
 + "state";

198 if(!
Fesy¡emNode
::
	`dœExi¡s
(
myS‹Dœ
))

199 
Fesy¡emNode
::
	`makeDœ
(
myS‹Dœ
);

200 
myS‘tšgs
->
	`£tSŒšg
("¡©edœ", 
myS‹Dœ
);

202 
myGameLi¡CacheFe
 = 
myBa£Dœ
 + 
BSPF_PATH_SEPARATOR
 + "stella.cache";

204 
myCh—tFe
 = 
myS‘tšgs
->
	`g‘SŒšg
("cheatfile");

205 if(
myCh—tFe
 == "")

206 
myCh—tFe
 = 
myBa£Dœ
 + 
BSPF_PATH_SEPARATOR
 + "stella.cht";

207 
myS‘tšgs
->
	`£tSŒšg
("ch—tfe", 
myCh—tFe
);

209 
myP®‘‹Fe
 = 
myS‘tšgs
->
	`g‘SŒšg
("palettefile");

210 if(
myP®‘‹Fe
 == "")

211 
myP®‘‹Fe
 = 
myBa£Dœ
 + 
BSPF_PATH_SEPARATOR
 + "stella.pal";

212 
myS‘tšgs
->
	`£tSŒšg
("·Ë‰efe", 
myP®‘‹Fe
);

214 
myPrİ”t›sFe
 = 
myS‘tšgs
->
	`g‘SŒšg
("propsfile");

215 if(
myPrİ”t›sFe
 == "")

216 
myPrİ”t›sFe
 = 
myBa£Dœ
 + 
BSPF_PATH_SEPARATOR
 + "stella.pro";

217 
myS‘tšgs
->
	`£tSŒšg
("´İsfe", 
myPrİ”t›sFe
);

218 
	}
}

232 
	gOSy¡em
::
	$£tBa£Dœ
(cÚ¡ 
¡ršg
& 
ba£dœ
)

234 
myBa£Dœ
 = 
ba£dœ
;

235 if(!
Fesy¡emNode
::
	`dœExi¡s
(
myBa£Dœ
))

236 
Fesy¡emNode
::
	`makeDœ
(
myBa£Dœ
);

237 
	}
}

240 
	gOSy¡em
::
	$£tF¿m”©e
(
uIÁ32
 
äam”©e
)

242 
myDi¥ÏyF¿meR©e
 = 
äam”©e
;

243 
myTimeP”F¿me
 = (
uIÁ32
)(1000000.0 / ()
myDi¥ÏyF¿meR©e
);

244 
	}
}

340 
	gOSy¡em
::
	$ü—‹Sound
()

342 
d–‘e
 
mySound
; mySound = 
NULL
;

344 
mySound
 = 
Ãw
 
	`SoundNuÎ
(
this
);

345 #iâdeà
SOUND_SUPPORT


346 
myS‘tšgs
->
	`£tBoŞ
("sound", 
çl£
);

348 
	}
}

352 
boŞ
 
	gOSy¡em
::
	$ü—‹CÚsŞe
(cÚ¡ 
¡ršg
& 
romfe
)

355 if(
myCÚsŞe
è
	`d–‘eCÚsŞe
();

357 
boŞ
 
»tv®
 = 
çl£
, 
showmes§ge
 = false;

360 if(
romfe
 == "")

362 
showmes§ge
 = 
Œue
;

363 if(
myRomFe
 == "")

365 
û¼
 << "ERROR: Rom fnÙ s³cif›d ..." << 
’dl
;

366  
çl£
;

370 
myRomFe
 = 
romfe
;

373 
uIÁ8
* 
image
;

374 
size
 = -1;

375 
¡ršg
 
md5
;

376 if(
	`İ’ROM
(
myRomFe
, 
md5
, &
image
, &
size
))

379 
C¬Œidge
* 
ÿ¹
 = (C¬Œidge*è
NULL
;

380 
Prİ”t›s
 
´İs
;

381 if(
	`qu”yCÚsŞeInfo
(
image
, 
size
, 
md5
, &
ÿ¹
, 
´İs
))

384 
myCÚsŞe
 = 
Ãw
 
	`CÚsŞe
(
this
, 
ÿ¹
, 
´İs
);

385 #ifdeà
CHEATCODE_SUPPORT


386 
myCh—tMªag”
->
	`lßdCh—ts
(
md5
);

391 #ifdeà
DEBUGGER_SUPPORT


392 
myDebugg”
->
	`£tCÚsŞe
(
myCÚsŞe
);

393 
myDebugg”
->
	`š™Ÿlize
();

398 if(
myS‘tšgs
->
	`g‘BoŞ
("showinfo") || 1)

399 
û¼
 << "GamcÚsŞü—‹d:" << 
’dl


400 << " ROM fe: " << 
myRomFe
 << 
’dl


401 << 
myCÚsŞe
->
	`about
(è<< 
’dl
;

404 
	`»£tLoİTimšg
();

407 
»tv®
 = 
Œue
;

411 
û¼
 << "ERROR: Couldn'ˆü—‹ cÚsŞfÜ " << 
myRomFe
 << " ..." << 
’dl
;

412 
»tv®
 = 
çl£
;

417 
û¼
 << "ERROR: Couldn'ˆİ’ " << 
myRomFe
 << " ..." << 
’dl
;

418 
»tv®
 = 
çl£
;

422 if(
size
 != -1) {

423 
d–‘e
[] 
image
;

425 
p_expÜt_sü“n
 = 
Ãw
 
	`ExpÜtSü“n
(
this
);

426  
»tv®
;

427 
	}
}

430 
	gOSy¡em
::
	$d–‘eCÚsŞe
()

432 if(
myCÚsŞe
)

434 
mySound
->
	`şo£
();

435 #ifdeà
CHEATCODE_SUPPORT


436 
myCh—tMªag”
->
	`§veCh—ts
(
myCÚsŞe
->
	`´İ”t›s
().
	`g‘
(
C¬Œidge_MD5
));

438 if(
myS‘tšgs
->
	`g‘BoŞ
("showinfo"))

440 
executiÚTime
 = (è
myTimšgInfo
.
tÙ®Time
 / 1000000.0;

441 
äamesP”SecÚd
 = (è
myTimšgInfo
.
tÙ®F¿mes
 / 
executiÚTime
;

442 
cout
 << "GamcÚsŞ¡©s:" << 
’dl


443 << " TÙ® f¿me d¿wn: " << 
myTimšgInfo
.
tÙ®F¿mes
 << 
’dl


444 << " TÙ®im(£c): " << 
executiÚTime
 << 
’dl


445 << " F¿me ³¸£cÚd: " << 
äamesP”SecÚd
 << 
’dl


446 << 
’dl
;

448 
d–‘e
 
myCÚsŞe
;

449 
myCÚsŞe
 = 
NULL
;

451 ià(
p_expÜt_sü“n
) {

452 
d–‘e
 
p_expÜt_sü“n
;

453 
p_expÜt_sü“n
 = 
NULL
;

455 
	}
}

473 
boŞ
 
	gOSy¡em
::
	$İ’ROM
(cÚ¡ 
¡ršg
& 
rom
, sŒšg& 
md5
, 
uIÁ8
** 
image
, * 
size
)

477 
unzFe
 
tz
;

478 if((
tz
 = 
	`unzO³n
(
rom
.
	`c_¡r
())è!ğ
NULL
)

480 if(
	`unzGoToFœ¡Fe
(
tz
è=ğ
UNZ_OK
)

482 
unz_fe_šfo
 
ufo
;

488 
f’ame
[1024];

490 
	`unzG‘Cu¼’tFeInfo
(
tz
, &
ufo
, 
f’ame
, 1024, 0, 0, 0, 0);

491 
f’ame
[1023] = '\0';

493 if(
	`¡¾’
(
f’ame
) >= 4)

496 * 
ext
 = 
f’ame
 + 
	`¡¾’
(filename) - 4;

498 if(!
	`BSPF_¡rÿ£cmp
(
ext
, ".bin") || !BSPF_strcasecmp(ext, ".a26"))

503 if(
	`unzGoToNextFe
(
tz
è!ğ
UNZ_OK
)

508 if(
ufo
.
uncom´es£d_size
 <= 0)

510 
	`unzClo£
(
tz
);

511  
çl£
;

513 *
size
 = 
ufo
.
uncom´es£d_size
;

514 *
image
 = 
Ãw
 
uIÁ8
[*
size
];

519 
	`unzO³nCu¼’tFe
(
tz
);

520 
	`unzR—dCu¼’tFe
(
tz
, *
image
, *
size
);

521 
	`unzClo£Cu¼’tFe
(
tz
);

522 
	`unzClo£
(
tz
);

526 
	`unzClo£
(
tz
);

527  
çl£
;

533 
gzFe
 
f
 = 
	`gzİ’
(
rom
.
	`c_¡r
(), "rb");

534 if(!
f
)

535  
çl£
;

537 *
image
 = 
Ãw
 
uIÁ8
[
MAX_ROM_SIZE
];

538 *
size
 = 
	`gz»ad
(
f
, *
image
, 
MAX_ROM_SIZE
);

539 
	`gzşo£
(
f
);

544 
md5
 = 
	`MD5
(*
image
, *
size
);

549 
Prİ”t›s
 
´İs
;

550 
myPrİS‘
->
	`g‘MD5
(
md5
, 
´İs
);

552 
¡ršg
 
Çme
 = 
´İs
.
	`g‘
(
C¬Œidge_Name
);

553 if(
Çme
 == "Untitled")

556 
¡ršg
::
size_ty³
 
pos
 = 
rom
.
	`fšd_Ï¡_of
(
BSPF_PATH_SEPARATOR
);

557 if(
pos
+1 !ğ
¡ršg
::
Åos
)

559 
Çme
 = 
rom
.
	`sub¡r
(
pos
+1);

560 
´İs
.
	`£t
(
C¬Œidge_MD5
, 
md5
);

561 
´İs
.
	`£t
(
C¬Œidge_Name
, 
Çme
);

562 
myPrİS‘
->
	`š£¹
(
´İs
, 
çl£
);

566  
Œue
;

567 
	}
}

570 
¡ršg
 
	gOSy¡em
::
	$g‘ROMInfo
(cÚ¡ 
¡ršg
& 
romfe
)

572 
o¡ršg¡»am
 
buf
;

575 
uIÁ8
* 
image
;

576 
size
 = -1;

577 
¡ršg
 
md5
;

578 if(
	`İ’ROM
(
romfe
, 
md5
, &
image
, &
size
))

581 
C¬Œidge
* 
ÿ¹
 = (C¬Œidge*è
NULL
;

582 
Prİ”t›s
 
´İs
;

583 if(
	`qu”yCÚsŞeInfo
(
image
, 
size
, 
md5
, &
ÿ¹
, 
´İs
))

585 
CÚsŞe
* 
cÚsŞe
 = 
Ãw
 
	`CÚsŞe
(
this
, 
ÿ¹
, 
´İs
);

586 if(
cÚsŞe
)

587 
buf
 << 
cÚsŞe
->
	`about
();

589 
buf
 << "ERROR: Couldn'ˆg‘ ROM infØfÜ " << 
romfe
 << " ..." << 
’dl
;

591 
d–‘e
 
cÚsŞe
;

594 
buf
 << "ERROR: Couldn'ˆİ’ " << 
romfe
 << " ..." << 
’dl
;

597 if(
size
 != -1)

598 
d–‘e
[] 
image
;

600  
buf
.
	`¡r
();

601 
	}
}

604 
boŞ
 
	gOSy¡em
::
	$qu”yCÚsŞeInfo
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
,

605 cÚ¡ 
¡ršg
& 
md5
,

606 
C¬Œidge
** 
ÿ¹
, 
Prİ”t›s
& 
´İs
)

609 
¡ršg
 
s
;

610 
myPrİS‘
->
	`g‘MD5
(
md5
, 
´İs
);

613 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("type");

614 if(
s
 !ğ""è
´İs
.
	`£t
(
C¬Œidge_Ty³
, s);

615 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("channels");

616 if(
s
 !ğ""è
´İs
.
	`£t
(
C¬Œidge_Sound
, s);

617 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("ld");

618 ià(
s
 == "A") {

619 
cout
 << "S‘tšg Leá PÏy”' DiffuştyØmode: A" << 
’dl
;

621 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚsŞe_LeáDifficuÉy
, s);

622 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("rd");

623 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚsŞe_RightDifficuÉy
, s);

624 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("tv");

625 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚsŞe_T–evisiÚTy³
, s);

626 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("sp");

627 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚsŞe_Sw­PÜts
, s);

628 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("lc");

629 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚŒŞËr_Leá
, s);

630 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("rc");

631 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚŒŞËr_Right
, s);

632 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("bc");

633 if(
s
 !ğ""è{ 
´İs
.
	`£t
(
CÚŒŞËr_Leá
, s);…rİs.£t(
CÚŒŞËr_Right
, s); }

634 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("cp");

635 if(
s
 !ğ""è
´İs
.
	`£t
(
CÚŒŞËr_Sw­PaddËs
, s);

636 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("format");

637 if(
s
 !ğ""è
´İs
.
	`£t
(
Di¥Ïy_FÜm©
, s);

638 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("ystart");

639 if(
s
 !ğ""è
´İs
.
	`£t
(
Di¥Ïy_YS¹
, s);

640 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("height");

641 if(
s
 !ğ""è
´İs
.
	`£t
(
Di¥Ïy_Height
, s);

642 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("pp");

643 if(
s
 !ğ""è
´İs
.
	`£t
(
Di¥Ïy_Pho¥hÜ
, s);

644 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("ppblend");

645 if(
s
 !ğ""è
´İs
.
	`£t
(
Di¥Ïy_PPBËnd
, s);

646 
s
 = 
myS‘tšgs
->
	`g‘SŒšg
("hmove");

647 if(
s
 !ğ""è
´İs
.
	`£t
(
EmuÏtiÚ_HmoveBÏnks
, s);

649 *
ÿ¹
 = 
C¬Œidge
::
	`ü—‹
(
image
, 
size
, 
´İs
, *
myS‘tšgs
);

650 if(!*
ÿ¹
)

651  
çl£
;

653  
Œue
;

654 
	}
}

657 
	gOSy¡em
::
	$»£tLoİTimšg
()

659 
	`mem£t
(&
myTimšgInfo
, 0, (
TimšgInfo
));

660 
myTimšgInfo
.
¡¬t
 = 
	`g‘Ticks
();

661 
myTimšgInfo
.
vœt
 = 
	`g‘Ticks
();

662 
	}
}

728 
	gOSy¡em
::
	$mašLoİ
()

733 
	`as£¹
(
myGameCÚŒŞËr
 !ğ
NULL
);

734 
myGameCÚŒŞËr
->
	`upd©e
();

735 
MedŸSourû
& 
medŸ¤c
 = 
	`cÚsŞe
().
	`medŸSourû
();

738 
myTimšgInfo
.
¡¬t
 = 
	`g‘Ticks
();

740 if(
myQu™Loİ
) ;

742 
medŸ¤c
.
	`upd©e
();

744 
myTimšgInfo
.
cu¼’t
 = 
	`g‘Ticks
();

745 
myTimšgInfo
.
vœt
 +ğ
myTimeP”F¿me
;

747 
myTimšgInfo
.
tÙ®Time
 +ğ(
	`g‘Ticks
(è- myTimšgInfo.
¡¬t
);

748 
myTimšgInfo
.
tÙ®F¿mes
++;

750 ià(
ticks
 == 0)

751 
time_¡¬t
 = 
	`time
(
NULL
);

753 
ticks
++;

754 ià(
ticks
 % 1000 == 0)

756 
time_’d
 = 
	`time
(
NULL
);

757 
avg
 = (()
ticks
)/(
time_’d
 - 
time_¡¬t
);

758 
û¼
 << "Av”agmaš†oİ i‹¿tiÚ ³¸£øğ" << 
avg
 << 
’dl
;

762 
	}
}

865 
	gOSy¡em
::
	$OSy¡em
(cÚ¡ 
OSy¡em
& 
osy¡em
)

867 
	}
}

870 
OSy¡em
& OSy¡em::
İ”©Ü
 = (const OSystem&)

872 
as£¹
(
çl£
);

874  *
	gthis
;

	@emucore/OSystem.hxx

19 #iâdeà
OSYSTEM_HXX


20 
	#OSYSTEM_HXX


	)

22 
şass
 
	gPrİ”t›sS‘
;

23 
şass
 
	gGameCÚŒŞËr
;

24 
şass
 
	gM’u
;

25 
şass
 
	gCommªdM’u
;

26 
şass
 
	gLaunch”
;

27 
şass
 
	gDebugg”
;

28 
şass
 
	gCh—tMªag”
;

29 
şass
 
	gVideoDŸlog
;

30 
	~"A¼ay.hxx
"

33 
	~"Sound.hxx
"

34 
	~"SoundNuÎ.hxx
"

35 
	~"S‘tšgs.hxx
"

36 
	~"CÚsŞe.hxx
"

37 
	~"Ev’t.hxx
"

39 
	~"b¥f.hxx
"

40 
	~"expÜt_sü“n.h
"

41 
şass
 
	gEv’tSŒ—m”
;

43 
	sResŞutiÚ
 {

44 
uIÁ32
 
	mwidth
;

45 
uIÁ32
 
	mheight
;

46 
¡ršg
 
	mÇme
;

48 
	gCommÚ
::
	tA¼ay
<
	tResŞutiÚ
> 
	tResŞutiÚLi¡
;

58 şas 
	cOSy¡em


63 
	mpublic
:

67 
OSy¡em
();

72 
	mvœtu®
 ~
OSy¡em
();

77 
vœtu®
 
boŞ
 
ü—‹
();

79 
	mpublic
:

85 
	$©ch
(
S‘tšgs
* 
£‰šgs
è{ 
myS‘tšgs
 = settings; }

99 
šlše
 
Ev’t
* 
	$ev’t
(ècÚ¡ {  
myEv’t
; 
	}
}

113 
šlše
 
	gSound
& 
	$sound
(ècÚ¡ {  *
mySound
; 
	}
}

120 
šlše
 
	gS‘tšgs
& 
	$£‰šgs
(ècÚ¡ {  *
myS‘tšgs
; 
	}
}

127 
šlše
 
	gPrİ”t›sS‘
& 
	$´İS‘
(ècÚ¡ {  *
myPrİS‘
; 
	}
}

134 
šlše
 
	gCÚsŞe
& 
	$cÚsŞe
(ècÚ¡ {  *
myCÚsŞe
; 
	}
}

157 #ifdeà
DEBUGGER_SUPPORT


163 
šlše
 
	gDebugg”
& 
	$debugg”
(ècÚ¡ {  *
myDebugg”
; 
	}
}

166 #ifdeà
CHEATCODE_SUPPORT


172 
šlše
 
	gCh—tMªag”
& 
	$ch—t
(ècÚ¡ {  *
myCh—tMªag”
; 
	}
}

202 
vœtu®
 
£tF¿m”©e
(
uIÁ32
 
äam”©e
);

207 
£tCÚfigP©hs
();

219 
šlše
 
uIÁ32
 
	$äameR©e
(ècÚ¡ {  
myDi¥ÏyF¿meR©e
; 
	}
}

224 cÚ¡ 
uIÁ32
 
	$desktİWidth
(ècÚ¡ {  
myDesktİWidth
; 
	}
}

225 cÚ¡ 
uIÁ32
 
	$desktİHeight
(ècÚ¡ {  
myDesktİHeight
; 
	}
}

232 cÚ¡ 
	gResŞutiÚLi¡
& 
	$suµÜ‹dResŞutiÚs
(ècÚ¡ {  
myResŞutiÚs
; 
	}
}

237 cÚ¡ 
	g¡ršg
& 
	$ba£Dœ
(ècÚ¡ {  
myBa£Dœ
; 
	}
}

242 cÚ¡ 
	g¡ršg
& 
	$¡©eDœ
(ècÚ¡ {  
myS‹Dœ
; 
	}
}

250 cÚ¡ 
	g¡ršg
& 
	$ÿcheFe
(ècÚ¡ {  
myGameLi¡CacheFe
; 
	}
}

257 cÚ¡ 
	g¡ršg
& 
	$ch—tFe
(ècÚ¡ {  
myCh—tFe
; 
	}
}

264 cÚ¡ 
	g¡ršg
& 
	$cÚfigFe
(ècÚ¡ {  
myCÚfigFe
; 
	}
}

272 cÚ¡ 
	g¡ršg
& 
	$·Ë‰eFe
(ècÚ¡ {  
myP®‘‹Fe
; 
	}
}

280 cÚ¡ 
	g¡ršg
& 
	$´İ”t›sFe
(ècÚ¡ {  
myPrİ”t›sFe
; 
	}
}

288 cÚ¡ 
	g¡ršg
& 
	$romFe
(ècÚ¡ {  
myRomFe
; 
	}
}

301 
boŞ
 
ü—‹CÚsŞe
(cÚ¡ 
¡ršg
& 
romfe
 = "");

307 
d–‘eCÚsŞe
();

321 
¡ršg
 
g‘ROMInfo
(cÚ¡ sŒšg& 
romfe
);

328 cÚ¡ 
	g¡ršg
& 
	$ã©u»s
(ècÚ¡ {  
myF—tu»s
; 
	}
}

340 
boŞ
 
İ’ROM
(cÚ¡ 
¡ršg
& 
rom
, sŒšg& 
md5
, 
uIÁ8
** 
image
, * 
size
);

345 
	$qu™
(è{ 
myQu™Loİ
 = 
Œue
; 
	}
}

347 
	gpublic
:

357 
vœtu®
 
uIÁ32
 
g‘Ticks
() = 0;

369 
vœtu®
 
mašLoİ
();

406 
	$£tGameCÚŒŞËr
(
GameCÚŒŞËr
* 
game_cÚŒŞËr
) {

407 
myGameCÚŒŞËr
 = 
game_cÚŒŞËr
;

408 
	}
}

410 
šlše
 
GameCÚŒŞËr
* 
	$g‘GameCÚŒŞËr
(è{ 
myGameCÚŒŞËr
;
	}
}

414 
	g´Ùeùed
:

424 
£tBa£Dœ
(cÚ¡ 
¡ršg
& 
ba£dœ
);

429 
	$£tCacheFe
(cÚ¡ 
¡ršg
& 
ÿchefe
è{ 
myGameLi¡CacheFe
 = cachefe; 
	}
}

434 
	$£tCÚfigFe
(cÚ¡ 
¡ršg
& 
fe
è{ 
myCÚfigFe
 = fe; 
	}
}

438 
	g´Ùeùed
:

442 
Ev’t
* 
myEv’t
;

444 
GameCÚŒŞËr
* 
	gmyGameCÚŒŞËr
;

454 
Sound
* 
	gmySound
;

457 
S‘tšgs
* 
	gmyS‘tšgs
;

460 
Prİ”t›sS‘
* 
	gmyPrİS‘
;

463 
CÚsŞe
* 
	gmyCÚsŞe
;

486 
uIÁ32
 
	gmyDesktİWidth
, 
	gmyDesktİHeight
;

489 
ResŞutiÚLi¡
 
	gmyResŞutiÚs
;

492 
uIÁ32
 
	gmyDi¥ÏyF¿meR©e
;

495 
boŞ
 
	gmyQu™Loİ
;

497 
	g´iv©e
:

498 ’um { 
kNumUIP®‘‹s
 = 2 };

499 
¡ršg
 
	gmyBa£Dœ
;

500 
¡ršg
 
	gmyS‹Dœ
;

502 
¡ršg
 
	gmyCh—tFe
;

503 
¡ršg
 
	gmyCÚfigFe
;

504 
¡ršg
 
	gmyP®‘‹Fe
;

505 
¡ršg
 
	gmyPrİ”t›sFe
;

507 
¡ršg
 
	gmyGameLi¡CacheFe
;

508 
¡ršg
 
	gmyRomFe
;

510 
¡ršg
 
	gmyF—tu»s
;

521 
	gpublic
:

523 
uIÁ32
 
myTimeP”F¿me
;

526 
	sTimšgInfo
 {

527 
uIÁ32
 
	g¡¬t
;

528 
uIÁ32
 
	gcu¼’t
;

529 
uIÁ32
 
	gvœt
;

530 
uIÁ32
 
	gtÙ®Time
;

531 
uIÁ32
 
	gtÙ®F¿mes
;

533 
TimšgInfo
 
	gmyTimšgInfo
;

537 
	gpublic
:

538 
ExpÜtSü“n
* 
p_expÜt_sü“n
;

539 
	g´iv©e
:

552 
ü—‹Sound
();

559 
boŞ
 
qu”yCÚsŞeInfo
(cÚ¡ 
uIÁ8
* 
image
, 
uIÁ32
 
size
, cÚ¡ 
¡ršg
& 
md5
,

560 
C¬Œidge
** 
ÿ¹
, 
Prİ”t›s
& 
´İs
);

566 
»£tLoİTimšg
();

569 
OSy¡em
(const OSystem&);

572 
	gOSy¡em
& 
	gİ”©Ü
 = (cÚ¡ 
OSy¡em
&);

	@emucore/Paddles.cxx

19 
	~"Ev’t.hxx
"

20 
	~"PaddËs.hxx
"

23 
	gPaddËs
::
	$PaddËs
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
, 
boŞ
 
sw­
)

24 : 
	$CÚŒŞËr
(
jack
, 
ev’t
, 
CÚŒŞËr
::
PaddËs
)

27 if(!
sw­
)

30 
myPšEv’ts
[0][0] = 
Ev’t
::
PaddËOÃFœe
;

31 
myPšEv’ts
[0][1] = 
Ev’t
::
PaddËTh»eFœe
;

34 
myPšEv’ts
[1][0] = 
Ev’t
::
PaddËZ”oFœe
;

35 
myPšEv’ts
[1][1] = 
Ev’t
::
PaddËTwoFœe
;

38 
myPšEv’ts
[2][0] = 
Ev’t
::
PaddËOÃResi¡ªû
;

39 
myPšEv’ts
[2][1] = 
Ev’t
::
PaddËTh»eResi¡ªû
;

42 
myPšEv’ts
[3][0] = 
Ev’t
::
PaddËZ”oResi¡ªû
;

43 
myPšEv’ts
[3][1] = 
Ev’t
::
PaddËTwoResi¡ªû
;

48 
myPšEv’ts
[0][0] = 
Ev’t
::
PaddËZ”oFœe
;

49 
myPšEv’ts
[0][1] = 
Ev’t
::
PaddËTwoFœe
;

52 
myPšEv’ts
[1][0] = 
Ev’t
::
PaddËOÃFœe
;

53 
myPšEv’ts
[1][1] = 
Ev’t
::
PaddËTh»eFœe
;

56 
myPšEv’ts
[2][0] = 
Ev’t
::
PaddËZ”oResi¡ªû
;

57 
myPšEv’ts
[2][1] = 
Ev’t
::
PaddËTwoResi¡ªû
;

60 
myPšEv’ts
[3][0] = 
Ev’t
::
PaddËOÃResi¡ªû
;

61 
myPšEv’ts
[3][1] = 
Ev’t
::
PaddËTh»eResi¡ªû
;

63 
	}
}

66 
	gPaddËs
::~
	$PaddËs
()

68 
	}
}

71 
boŞ
 
PaddËs
::
	$»ad
(
Dig™®Pš
 
pš
)

73 
pš
)

75 
Th»e
:

76  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
myPšEv’ts
[0][0]) == 0) :

77 (
myEv’t
.
	`g‘
(
myPšEv’ts
[0][1]) == 0);

79 
Four
:

80  (
myJack
 =ğ
Leá
è? (
myEv’t
.
	`g‘
(
myPšEv’ts
[1][0]) == 0) :

81 (
myEv’t
.
	`g‘
(
myPšEv’ts
[1][1]) == 0);

85  
Œue
;

87 
	}
}

90 
IÁ32
 
	gPaddËs
::
	$»ad
(
AÇlogPš
 
pš
)

92 
pš
)

94 
Five
:

95  (
myJack
 =ğ
Leá
è? 
myEv’t
.
	`g‘
(
myPšEv’ts
[2][0]) :

96 
myEv’t
.
	`g‘
(
myPšEv’ts
[2][1]);

98 
Nše
:

99  (
myJack
 =ğ
Leá
è? 
myEv’t
.
	`g‘
(
myPšEv’ts
[3][0]) :

100 
myEv’t
.
	`g‘
(
myPšEv’ts
[3][1]);

103  
maximumResi¡ªû
;

105 
	}
}

108 
	gPaddËs
::
	$wr™e
(
Dig™®Pš
, 
boŞ
)

111 
	}
}

	@emucore/Paddles.hxx

19 #iâdeà
PADDLES_HXX


20 
	#PADDLES_HXX


	)

22 
	~"b¥f.hxx
"

23 
	~"CÚŒŞ.hxx
"

31 şas 
	cPaddËs
 : 
public
 
CÚŒŞËr


33 
public
:

41 
PaddËs
(
Jack
 
jack
, cÚ¡ 
Ev’t
& 
ev’t
, 
boŞ
 
sw­
);

46 
	mvœtu®
 ~
PaddËs
();

48 
	mpublic
:

55 
vœtu®
 
boŞ
 
»ad
(
Dig™®Pš
 
pš
);

64 
vœtu®
 
IÁ32
 
»ad
(
AÇlogPš
 
pš
);

74 
vœtu®
 
wr™e
(
Dig™®Pš
 
pš
, 
boŞ
 
v®ue
);

76 
	m´iv©e
:

79 
Ev’t
::
Ty³
 
myPšEv’ts
[4][2];

	@emucore/Props.cxx

19 
	~<cùy³
>

20 
	~<®gÜ™hm
>

21 
	~<s¡»am
>

23 
	~"GuiUts.hxx
"

24 
	~"Prİs.hxx
"

27 
	gPrİ”t›s
::
	$Prİ”t›s
()

29 
	`£tDeçuÉs
();

30 
	}
}

33 
	gPrİ”t›s
::
	$Prİ”t›s
(cÚ¡ 
Prİ”t›s
& 
´İ”t›s
)

35 
	`cİy
(
´İ”t›s
);

36 
	}
}

39 
	gPrİ”t›s
::~
	$Prİ”t›s
()

41 
	}
}

44 cÚ¡ 
¡ršg
& 
Prİ”t›s
::
	$g‘
(
Prİ”tyTy³
 
key
) const

46 if(
key
 >ğ0 && key < 
La¡PrİTy³
)

47  
myPrİ”t›s
[
key
];

49  
Em±ySŒšg
;

50 
	}
}

53 
	gPrİ”t›s
::
	$£t
(
Prİ”tyTy³
 
key
, cÚ¡ 
¡ršg
& 
v®ue
)

55 if(
key
 >ğ0 && key < 
La¡PrİTy³
)

57 
myPrİ”t›s
[
key
] = 
v®ue
;

59 
key
)

61 
C¬Œidge_Sound
:

62 
C¬Œidge_Ty³
:

63 
CÚsŞe_LeáDifficuÉy
:

64 
CÚsŞe_RightDifficuÉy
:

65 
CÚsŞe_T–evisiÚTy³
:

66 
CÚsŞe_Sw­PÜts
:

67 
CÚŒŞËr_Leá
:

68 
CÚŒŞËr_Right
:

69 
CÚŒŞËr_Sw­PaddËs
:

70 
Di¥Ïy_FÜm©
:

71 
Di¥Ïy_Pho¥hÜ
:

72 
EmuÏtiÚ_HmoveBÏnks
:

74 
	`ŒªsfÜm
(
myPrİ”t›s
[
key
].
	`begš
(), myPrİ”t›s[key].
	`’d
(),

75 
myPrİ”t›s
[
key
].
	`begš
(), ((*)()è
touµ”
);

79 
Di¥Ïy_PPBËnd
:

81 
bËnd
 = 
	`©oi
(
myPrİ”t›s
[
key
].
	`c_¡r
());

82 if(
bËnd
 < 0 || blend > 100) blend = 77;

83 
o¡ršg¡»am
 
buf
;

84 
buf
 << 
bËnd
;

85 
myPrİ”t›s
[
key
] = 
buf
.
	`¡r
();

93 
	}
}

96 
	gPrİ”t›s
::
	$lßd
(
i¡»am
& 
š
)

98 
	`£tDeçuÉs
();

100 
¡ršg
 
lše
, 
key
, 
v®ue
;

101 
¡ršg
::
size_ty³
 
Úe
, 
two
, 
th»e
, 
four
, 
g¬bage
;

104 
	`g‘lše
(
š
, 
lše
))

107 (
g¬bage
 = 
lše
.
	`fšd
("\t")è!ğ
¡ršg
::
Åos
)

108 
lše
.
	`”a£
(
g¬bage
, 1);

111 if((
lše
.
	`Ëngth
() == 0) || (line[0] == ';'))

115 if(
lše
 == "\"\"")

118 
Úe
 = 
lše
.
	`fšd
("\"", 0);

119 
two
 = 
lše
.
	`fšd
("\"", 
Úe
 + 1);

120 
th»e
 = 
lše
.
	`fšd
("\"", 
two
 + 1);

121 
four
 = 
lše
.
	`fšd
("\"", 
th»e
 + 1);

124 if((
Úe
 =ğ
¡ršg
::
Åos
è|| (
two
 == string::npos) ||

125 (
th»e
 =ğ
¡ršg
::
Åos
è|| (
four
 == string::npos))

129 
key
 = 
lše
.
	`sub¡r
(
Úe
 + 1, 
two
 - one - 1);

130 
v®ue
 = 
lše
.
	`sub¡r
(
th»e
 + 1, 
four
 -hree - 1);

133 
Prİ”tyTy³
 
ty³
 = 
	`g‘Prİ”tyTy³
(
key
);

134 
	`£t
(
ty³
, 
v®ue
);

136 
	}
}

139 
	gPrİ”t›s
::
	$§ve
(
o¡»am
& 
out
) const

142 
boŞ
 
chªged
 = 
çl£
;

143 
i
 = 0; i < 
La¡PrİTy³
; ++i)

146 if(
myPrİ”t›s
[
i
] !ğ
ourDeçuÉPrİ”t›s
[i])

148 
	`wr™eQuÙedSŒšg
(
out
, 
ourPrİ”tyNames
[
i
]);

149 
out
.
	`put
(' ');

150 
	`wr™eQuÙedSŒšg
(
out
, 
myPrİ”t›s
[
i
]);

151 
out
.
	`put
('\n');

152 
chªged
 = 
Œue
;

156 if(
chªged
)

159 
	`wr™eQuÙedSŒšg
(
out
, "");

160 
out
.
	`put
('\n');

161 
out
.
	`put
('\n');

163 
	}
}

166 
¡ršg
 
	gPrİ”t›s
::
	$»adQuÙedSŒšg
(
i¡»am
& 
š
)

168 
c
;

171 
š
.
	`g‘
(
c
))

173 if(
c
 == '"')

180 
¡ršg
 
s
;

181 
š
.
	`g‘
(
c
))

183 if((
c
 =ğ'\\'è&& (
š
.
	`³ek
() == '"'))

185 
š
.
	`g‘
(
c
);

187 if((
c
 =ğ'\\'è&& (
š
.
	`³ek
() == '\\'))

189 
š
.
	`g‘
(
c
);

191 if(
c
 == '"')

195 if(
c
 == '\r')

200 
s
 +ğ
c
;

203  
s
;

204 
	}
}

207 
	gPrİ”t›s
::
	$wr™eQuÙedSŒšg
(
o¡»am
& 
out
, cÚ¡ 
¡ršg
& 
s
)

209 
out
.
	`put
('"');

210 
uIÁ32
 
i
 = 0; i < 
s
.
	`Ëngth
(); ++i)

212 if(
s
[
i
] == '\\')

214 
out
.
	`put
('\\');

215 
out
.
	`put
('\\');

217 if(
s
[
i
] == '\"')

219 
out
.
	`put
('\\');

220 
out
.
	`put
('"');

224 
out
.
	`put
(
s
[
i
]);

227 
out
.
	`put
('"');

228 
	}
}

231 
	gPrİ”t›s
& Prİ”t›s::
İ”©Ü
 = (cÚ¡ 
Prİ”t›s
& 
´İ”t›s
)

234 if(
this
 !ğ&
´İ”t›s
)

237 
cİy
(
´İ”t›s
);

240  *
	gthis
;

244 
	gPrİ”t›s
::
	$cİy
(cÚ¡ 
Prİ”t›s
& 
´İ”t›s
)

247 
i
 = 0; i < 
La¡PrİTy³
; ++i)

248 
myPrİ”t›s
[
i
] = 
´İ”t›s
.myProperties[i];

249 
	}
}

252 
	gPrİ”t›s
::
	$´št
() const

254 
û¼
 << 
	`g‘
(
C¬Œidge_MD5
) << "|"

255 << 
	`g‘
(
C¬Œidge_Name
) << "|"

256 << 
	`g‘
(
C¬Œidge_R¬™y
) << "|"

257 << 
	`g‘
(
C¬Œidge_Mªuçùu»r
) << "|"

258 << 
	`g‘
(
C¬Œidge_NÙe
)

259 << 
’dl
;

260 
	}
}

263 
	gPrİ”t›s
::
	$£tDeçuÉs
()

265 
i
 = 0; i < 
La¡PrİTy³
; ++i)

266 
myPrİ”t›s
[
i
] = 
ourDeçuÉPrİ”t›s
[i];

267 
	}
}

270 
Prİ”tyTy³
 
	gPrİ”t›s
::
	$g‘Prİ”tyTy³
(cÚ¡ 
¡ršg
& 
Çme
)

272 
i
 = 0; i < 
La¡PrİTy³
; ++i)

273 if(
ourPrİ”tyNames
[
i
] =ğ
Çme
)

274  (
Prİ”tyTy³
)
i
;

277  
La¡PrİTy³
;

278 
	}
}

281 cÚ¡ * 
	gPrİ”t›s
::
ourDeçuÉPrİ”t›s
[
La¡PrİTy³
] = {

306 cÚ¡ * 
	gPrİ”t›s
::
ourPrİ”tyNames
[
La¡PrİTy³
] = {

	@emucore/Props.hxx

19 #iâdeà
PROPERTIES_HXX


20 
	#PROPERTIES_HXX


	)

22 
	~"b¥f.hxx
"

24 
	ePrİ”tyTy³
 {

25 
	mC¬Œidge_MD5
,

26 
	mC¬Œidge_Mªuçùu»r
,

27 
	mC¬Œidge_Mod–No
,

28 
	mC¬Œidge_Name
,

29 
	mC¬Œidge_NÙe
,

30 
	mC¬Œidge_R¬™y
,

31 
	mC¬Œidge_Sound
,

32 
	mC¬Œidge_Ty³
,

33 
	mCÚsŞe_LeáDifficuÉy
,

34 
	mCÚsŞe_RightDifficuÉy
,

35 
	mCÚsŞe_T–evisiÚTy³
,

36 
	mCÚsŞe_Sw­PÜts
,

37 
	mCÚŒŞËr_Leá
,

38 
	mCÚŒŞËr_Right
,

39 
	mCÚŒŞËr_Sw­PaddËs
,

40 
	mDi¥Ïy_FÜm©
,

41 
	mDi¥Ïy_YS¹
,

42 
	mDi¥Ïy_Height
,

43 
	mDi¥Ïy_Pho¥hÜ
,

44 
	mDi¥Ïy_PPBËnd
,

45 
	mEmuÏtiÚ_HmoveBÏnks
,

46 
	mLa¡PrİTy³


60 şas 
	cPrİ”t›s


62 
ä›nd
 
şass
 
	mPrİ”t›sS‘
;

64 
	mpublic
:

69 
Prİ”t›s
();

76 
Prİ”t›s
(cÚ¡ Prİ”t›s& 
´İ”t›s
);

81 
	mvœtu®
 ~
Prİ”t›s
();

83 
	mpublic
:

91 cÚ¡ 
¡ršg
& 
	$g‘
(
Prİ”tyTy³
 
key
) const;

99 
	`£t
(
Prİ”tyTy³
 
key
, cÚ¡ 
¡ršg
& 
v®ue
);

106 
	`lßd
(
i¡»am
& 
š
);

113 
	$§ve
(
o¡»am
& 
out
) const;

118 
	$´št
() const;

123 
	`£tDeçuÉs
();

125 
public
:

132 
Prİ”t›s
& 
İ”©Ü
 = (cÚ¡ Prİ”t›s& 
´İ”t›s
);

134 
´iv©e
:

142 
	`cİy
(cÚ¡ 
Prİ”t›s
& 
´İ”t›s
);

151 
¡ršg
 
	`»adQuÙedSŒšg
(
i¡»am
& 
š
);

160 
	`wr™eQuÙedSŒšg
(
o¡»am
& 
out
, cÚ¡ 
¡ršg
& 
s
);

167 
Prİ”tyTy³
 
	`g‘Prİ”tyTy³
(cÚ¡ 
¡ršg
& 
Çme
);

169 
´iv©e
:

171 
¡ršg
 
myPrİ”t›s
[
La¡PrİTy³
];

174 cÚ¡ * 
ourDeçuÉPrİ”t›s
[
La¡PrİTy³
];

177 cÚ¡ * 
ourPrİ”tyNames
[
La¡PrİTy³
];

	@emucore/PropsSet.cxx

19 
	~<s¡»am
>

21 
	~"OSy¡em.hxx
"

22 
	~"GuiUts.hxx
"

23 
	~"DefPrİs.hxx
"

24 
	~"Prİs.hxx
"

25 
	~"PrİsS‘.hxx
"

26 
	~"b¥f.hxx
"

29 
	gPrİ”t›sS‘
::
	$Prİ”t›sS‘
(
OSy¡em
* 
osy¡em
)

30 : 
	`myOSy¡em
(
osy¡em
),

31 
	`myRoÙ
(
NULL
),

32 
	$mySize
(0)

34 cÚ¡ 
¡ršg
& 
´İs
 = 
myOSy¡em
->
	`´İ”t›sFe
();

35 
	`lßd
(
´İs
, 
Œue
);

37 if(
myOSy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("showinfo"))

38 
û¼
 << "U£¸gam´İ”t›s: \'" << 
´İs
 << "\'\n";

39 
	}
}

42 
	gPrİ”t›sS‘
::~
	$Prİ”t›sS‘
()

44 
	`d–‘eNode
(
myRoÙ
);

45 
	}
}

48 
	gPrİ”t›sS‘
::
	$g‘MD5
(cÚ¡ 
¡ršg
& 
md5
, 
Prİ”t›s
& 
´İ”t›s
,

49 
boŞ
 
u£DeçuÉs
) const

51 
´İ”t›s
.
	`£tDeçuÉs
();

52 
boŞ
 
found
 = 
çl£
;

55 if(!
u£DeçuÉs
 && 
myRoÙ
 != 0)

57 
T»eNode
* 
cu¼’t
 = 
myRoÙ
;

58 
cu¼’t
)

60 cÚ¡ 
¡ršg
& 
cu¼’tMd5
 = 
cu¼’t
->
´İs
->
	`g‘
(
C¬Œidge_MD5
);

61 if(
cu¼’tMd5
 =ğ
md5
)

66 
found
 = 
cu¼’t
->
v®id
;

69 if(
md5
 < 
cu¼’tMd5
)

70 
cu¼’t
 = cu¼’t->
Ëá
;

72 
cu¼’t
 = cu¼’t->
right
;

75 if(
found
)

76 
´İ”t›s
 = *(
cu¼’t
->
´İs
);

80 if(!
found
)

82 
low
 = 0, 
high
 = 
DEF_PROPS_SIZE
 - 1;

83 
low
 <ğ
high
)

85 
i
 = (
low
 + 
high
) / 2;

86 
cmp
 = 
	`¡ºcmp
(
md5
.
	`c_¡r
(), 
DefPrİs
[
i
][
C¬Œidge_MD5
], 32);

88 if(
cmp
 == 0)

90 
p
 = 0;… < 
La¡PrİTy³
; ++p)

91 if(
DefPrİs
[
i
][
p
][0] != 0)

92 
´İ”t›s
.
	`£t
((
Prİ”tyTy³
)
p
, 
DefPrİs
[
i
][p]);

94 
found
 = 
Œue
;

97 if(
cmp
 < 0)

98 
high
 = 
i
 - 1;

100 
low
 = 
i
 + 1;

103 
	}
}

106 
	gPrİ”t›sS‘
::
	$š£¹
(cÚ¡ 
Prİ”t›s
& 
´İ”t›s
, 
boŞ
 
§ve
)

108 
	`š£¹Node
(
myRoÙ
, 
´İ”t›s
, 
§ve
);

109 
	}
}

112 
	gPrİ”t›sS‘
::
	$»moveMD5
(cÚ¡ 
¡ršg
& 
md5
)

115 if(
myRoÙ
 != 0)

117 
T»eNode
* 
cu¼’t
 = 
myRoÙ
;

118 
cu¼’t
)

120 cÚ¡ 
¡ršg
& 
cu¼’tMd5
 = 
cu¼’t
->
´İs
->
	`g‘
(
C¬Œidge_MD5
);

121 if(
cu¼’tMd5
 =ğ
md5
)

123 
cu¼’t
->
v®id
 = 
çl£
;

126 if(
md5
 < 
cu¼’tMd5
)

127 
cu¼’t
 = cu¼’t->
Ëá
;

129 
cu¼’t
 = cu¼’t->
right
;

132 
	}
}

135 
	gPrİ”t›sS‘
::
	$š£¹Node
(
T»eNode
* &
t
, cÚ¡ 
Prİ”t›s
& 
´İ”t›s
,

136 
boŞ
 
§ve
)

138 if(
t
)

140 
¡ršg
 
md5
 = 
´İ”t›s
.
	`g‘
(
C¬Œidge_MD5
);

141 
¡ršg
 
cu¼’tMd5
 = 
t
->
´İs
->
	`g‘
(
C¬Œidge_MD5
);

143 if(
md5
 < 
cu¼’tMd5
)

144 
	`š£¹Node
(
t
->
Ëá
, 
´İ”t›s
, 
§ve
);

145 if(
md5
 > 
cu¼’tMd5
)

146 
	`š£¹Node
(
t
->
right
, 
´İ”t›s
, 
§ve
);

149 
d–‘e
 
t
->
´İs
;

150 
t
->
´İs
 = 
Ãw
 
	`Prİ”t›s
(
´İ”t›s
);

151 
t
->
§ve
 = save;

152 
t
->
v®id
 = 
Œue
;

157 
t
 = 
Ãw
 
T»eNode
;

158 
t
->
´İs
 = 
Ãw
 
	`Prİ”t›s
(
´İ”t›s
);

159 
t
->
Ëá
 = 0;

160 
t
->
right
 = 0;

161 
t
->
§ve
 = save;

162 
t
->
v®id
 = 
Œue
;

164 ++
mySize
;

166 
	}
}

169 
	gPrİ”t›sS‘
::
	$d–‘eNode
(
T»eNode
 *
node
)

171 if(
node
)

173 
	`d–‘eNode
(
node
->
Ëá
);

174 
	`d–‘eNode
(
node
->
right
);

175 
d–‘e
 
node
->
´İs
;

176 
d–‘e
 
node
;

178 
	}
}

181 
	gPrİ”t›sS‘
::
	$lßd
(cÚ¡ 
¡ršg
& 
f’ame
, 
boŞ
 
§ve
)

183 
if¡»am
 
	`š
(
f’ame
.
	`c_¡r
(), 
ios
::
š
);

189 if(!
š
)

193 
Prİ”t›s
 
´İ
;

194 
´İ
.
	`lßd
(
š
);

197 if(
š
)

198 
	`š£¹
(
´İ
, 
§ve
);

200 if(
š
)

201 
š
.
	`şo£
();

202 
	}
}

205 
boŞ
 
	gPrİ”t›sS‘
::
	$§ve
(cÚ¡ 
¡ršg
& 
f’ame
) const

207 
of¡»am
 
	`out
(
f’ame
.
	`c_¡r
(), 
ios
::
out
);

208 if(!
out
)

209  
çl£
;

211 
	`§veNode
(
out
, 
myRoÙ
);

212 
out
.
	`şo£
();

213  
Œue
;

214 
	}
}

217 
	gPrİ”t›sS‘
::
	$´št
() const

219 
û¼
 << 
	`size
(è<< 
’dl
;

220 
	`´štNode
(
myRoÙ
);

221 
	}
}

224 
	gPrİ”t›sS‘
::
	$§veNode
(
o¡»am
& 
out
, 
T»eNode
 *
node
) const

226 if(
node
)

228 if(
node
->
v®id
 &&‚ode->
§ve
)

229 
node
->
´İs
->
	`§ve
(
out
);

230 
	`§veNode
(
out
, 
node
->
Ëá
);

231 
	`§veNode
(
out
, 
node
->
right
);

233 
	}
}

236 
	gPrİ”t›sS‘
::
	$´štNode
(
T»eNode
 *
node
) const

238 if(
node
)

240 if(
node
->
v®id
 &&‚ode->
§ve
)

241 
node
->
´İs
->
	`´št
();

242 
	`´štNode
(
node
->
Ëá
);

243 
	`´štNode
(
node
->
right
);

245 
	}
}

248 
uIÁ32
 
	gPrİ”t›sS‘
::
	$size
() const

250  
mySize
;

251 
	}
}

	@emucore/PropsSet.hxx

19 #iâdeà
PROPERTIES_SET_HXX


20 
	#PROPERTIES_SET_HXX


	)

22 
	~<f¡»am
>

24 
	~"b¥f.hxx
"

26 
şass
 
	gOSy¡em
;

27 
şass
 
	gPrİ”t›s
;

39 şas 
	cPrİ”t›sS‘


41 
	mpublic
:

46 
Prİ”t›sS‘
(
OSy¡em
* 
osy¡em
);

51 
	mvœtu®
 ~
Prİ”t›sS‘
();

53 
	mpublic
:

62 
	$g‘MD5
(cÚ¡ 
¡ršg
& 
md5
, 
Prİ”t›s
& 
´İ”t›s
,

63 
boŞ
 
u£DeçuÉs
 = 
çl£
) const;

73 
	`lßd
(cÚ¡ 
¡ršg
& 
f’ame
, 
boŞ
 
§ve
);

83 
boŞ
 
	$§ve
(cÚ¡ 
¡ršg
& 
f’ame
) const;

93 
	`š£¹
(cÚ¡ 
Prİ”t›s
& 
´İ”t›s
, 
boŞ
 
§ve
);

100 
	`»moveMD5
(cÚ¡ 
¡ršg
& 
md5
);

107 
uIÁ32
 
	$size
() const;

112 
	$´št
() const;

114 
´iv©e
:

115 
	sT»eNode
 {

116 
Prİ”t›s
* 
´İs
;

117 
T»eNode
* 
Ëá
;

118 
T»eNode
* 
right
;

119 
boŞ
 
§ve
;

120 
boŞ
 
v®id
;

131 
	`š£¹Node
(
T»eNode
* &
node
, cÚ¡ 
Prİ”t›s
& 
´İ”t›s
, 
boŞ
 
§ve
);

138 
	`d–‘eNode
(
T»eNode
 *
node
);

146 
	$§veNode
(
o¡»am
& 
out
, 
T»eNode
* 
node
) const;

153 
	$´štNode
(
T»eNode
* 
node
) const;

155 
´iv©e
:

157 
OSy¡em
* 
myOSy¡em
;

160 
T»eNode
* 
myRoÙ
;

163 
uIÁ32
 
mySize
;

164 
	}
};

	@emucore/Random.cxx

19 
	~<time.h
>

20 
	~"Rªdom.hxx
"

23 
	gRªdom
::
	$£ed
(
uIÁ32
 
v®ue
)

25 
ourS“d
 = 
v®ue
;

26 
ourS“ded
 = 
Œue
;

27 
	}
}

30 
	gRªdom
::
	$Rªdom
()

33 if(!
ourS“ded
)

35 
ourS“d
 = (
uIÁ32
)
	`time
(0);

36 
ourS“ded
 = 
Œue
;

39 
myV®ue
 = 
ourS“d
;

40 
	}
}

43 
uIÁ32
 
	gRªdom
::
	$Ãxt
()

45  (
myV®ue
 = (myValue * 2416 + 374441) % 1771875);

46 
	}
}

49 
uIÁ32
 
	gRªdom
::
ourS“d
 = 0;

52 
boŞ
 
	gRªdom
::
ourS“ded
 = 
çl£
;

	@emucore/Random.hxx

19 #iâdeà
RANDOM_HXX


20 
	#RANDOM_HXX


	)

22 
	~"b¥f.hxx
"

32 şas 
	cRªdom


34 
	mpublic
:

41 
£ed
(
uIÁ32
 
v®ue
);

43 
	mpublic
:

47 
Rªdom
();

49 
	mpublic
:

55 
uIÁ32
 
Ãxt
();

57 
	m´iv©e
:

59 
uIÁ32
 
myV®ue
;

61 
	m´iv©e
:

63 
uIÁ32
 
ourS“d
;

66 
boŞ
 
	mourS“ded
;

	@emucore/Serializer.cxx

19 
	~"S”Ÿliz”.hxx
"

22 
	gS”Ÿliz”
::
	$S”Ÿliz”
() {

23 
mySŒ—m
.
	`ş—r
();

25 
	}
}

28 
	gS”Ÿliz”
::~
	$S”Ÿliz”
()

30 
	`şo£
();

31 
	}
}

35 
	gS”Ÿliz”
::
	$şo£
()

37 
mySŒ—m
.
	`ş—r
();

38 
	}
}

42 
	gS”Ÿliz”
::
	$putIÁ
(
v®ue
)

44 
buf
[4];

45 
i
 = 0; i < 4; ++i)

46 
buf
[
i
] = (
v®ue
 >> (i<<3)) & 0xff;

48 
mySŒ—m
.
	`wr™e
((*)
buf
, 4);

49 if(
mySŒ—m
.
	`bad
())

50 
throw
 "Serializer: file write failed";

51 
	}
}

54 
	gS”Ÿliz”
::
	$putSŒšg
(cÚ¡ 
¡ršg
& 
¡r
)

56 
Ën
 = 
¡r
.
	`Ëngth
();

57 
	`putIÁ
(
Ën
);

58 
mySŒ—m
.
	`wr™e
(
¡r
.
	`d©a
(), (
¡»amsize
)
Ën
);

60 if(
mySŒ—m
.
	`bad
())

61 
throw
 "Serializer: file write failed";

62 
	}
}

65 
	gS”Ÿliz”
::
	$putBoŞ
(
boŞ
 
b
)

67 
	`putIÁ
(
b
 ? 
TrueP©‹º
: 
F®£P©‹º
);

68 
	}
}

	@emucore/Serializer.hxx

19 #iâdeà
SERIALIZER_HXX


20 
	#SERIALIZER_HXX


	)

22 
	~<s¡»am
>

23 
	~"b¥f.hxx
"

40 şas 
	cS”Ÿliz”


42 
	mpublic
:

47 
S”Ÿliz”
();

52 
	mvœtu®
 ~
S”Ÿliz”
();

58 
şo£
();

60 
boŞ
 
	$isO³n
(è{ 
Œue
;}

67 
	`putIÁ
(
v®ue
);

74 
	`putSŒšg
(cÚ¡ 
¡ršg
& 
¡r
);

81 
	`putBoŞ
(
boŞ
 
b
);

85 
¡ršg
 
	$g‘_¡r
() const {

86  
mySŒ—m
.
	`¡r
();

87 
	}
}

88 
	g´iv©e
:

90 
¡ršg¡»am
 
mySŒ—m
;

93 
	gTrueP©‹º
 = 0xfab1fab2,

94 
	gF®£P©‹º
 = 0xbad1bad2

	@emucore/Settings.cxx

19 
	~<ÿs£¹
>

20 
	~<s¡»am
>

21 
	~<f¡»am
>

22 
	~<®gÜ™hm
>

24 
	~"OSy¡em.hxx
"

25 
	~"V”siÚ.hxx
"

26 
	~"b¥f.hxx
"

27 
	~"S‘tšgs.hxx
"

28 
	~"GuiUts.hxx
"

31 
	gS‘tšgs
::
	$S‘tšgs
(
OSy¡em
* 
osy¡em
è: 
	$myOSy¡em
(
osy¡em
) {

33 
myOSy¡em
->
	`©ch
(
this
);

36 
	`£tIÁ”Çl
("video", "soft");

38 
	`£tIÁ”Çl
("gl_filter", "nearest");

39 
	`£tIÁ”Çl
("gl_aspect", "100");

40 
	`£tIÁ”Çl
("gl_fsmax", "never");

41 
	`£tIÁ”Çl
("gl_lib", "libGL.so");

42 
	`£tIÁ”Çl
("gl_vsync", "false");

43 
	`£tIÁ”Çl
("gl_texrect", "false");

45 
	`£tIÁ”Çl
("zoom_ui", "2");

46 
	`£tIÁ”Çl
("zoom_tia", "2");

47 
	`£tIÁ”Çl
("fullscreen", "false");

48 
	`£tIÁ”Çl
("fullres", "");

49 
	`£tIÁ”Çl
("center", "true");

50 
	`£tIÁ”Çl
("grabmouse", "false");

51 
	`£tIÁ”Çl
("palette", "standard");

52 
	`£tIÁ”Çl
("colorloss", "false");

54 
	`£tIÁ”Çl
("sound", "false");

55 
	`£tIÁ”Çl
("fragsize", "512");

56 
	`£tIÁ”Çl
("freq", "31400");

57 
	`£tIÁ”Çl
("tiafreq", "31400");

58 
	`£tIÁ”Çl
("volume", "100");

59 
	`£tIÁ”Çl
("clipvol", "true");

61 
	`£tIÁ”Çl
("keymap", "");

62 
	`£tIÁ”Çl
("joymap", "");

63 
	`£tIÁ”Çl
("joyaxismap", "");

64 
	`£tIÁ”Çl
("joyhatmap", "");

65 
	`£tIÁ”Çl
("paddle", "0");

66 
	`£tIÁ”Çl
("sa1", "left");

67 
	`£tIÁ”Çl
("sa2", "right");

68 
	`£tIÁ”Çl
("p0speed", "50");

69 
	`£tIÁ”Çl
("p1speed", "50");

70 
	`£tIÁ”Çl
("p2speed", "50");

71 
	`£tIÁ”Çl
("p3speed", "50");

72 
	`£tIÁ”Çl
("pthresh", "600");

74 
	`£tIÁ”Çl
("showinfo", "false");

76 
	`£tIÁ”Çl
("ssdœ", 
	`¡ršg
("."è+ 
BSPF_PATH_SEPARATOR
);

77 
	`£tIÁ”Çl
("sssingle", "false");

79 
	`£tIÁ”Çl
("romdir", "");

80 
	`£tIÁ”Çl
("statedir", "");

81 
	`£tIÁ”Çl
("cheatfile", "");

82 
	`£tIÁ”Çl
("palettefile", "");

83 
	`£tIÁ”Çl
("propsfile", "");

84 
	`£tIÁ”Çl
("wÜkšg_dœ", 
	`¡ršg
("."è+ 
BSPF_PATH_SEPARATOR
);

85 
	`£tIÁ”Çl
("rl_params_file", "rl_params.txt");

86 
	`£tIÁ”Çl
("class_disc_params_file", "class_disc_params.txt");

87 
	`£tIÁ”Çl
("rombrowse", "true");

88 
	`£tIÁ”Çl
("lastrom", "");

90 
	`£tIÁ”Çl
("debuggerres", "1030x690");

91 
	`£tIÁ”Çl
("launcherres", "400x300");

92 
	`£tIÁ”Çl
("uipalette", "0");

93 
	`£tIÁ”Çl
("mwheel", "4");

94 
	`£tIÁ”Çl
("autoslot", "false");

97 
	`£tIÁ”Çl
("game_controller", "internal");

107 
	`£tIÁ”Çl
("initial_delay", "1000");

109 
	`£tIÁ”Çl
("random_seed", "0");

112 
	`£tIÁ”Çl
("export_frames_frq", "0");

115 
	`£tIÁ”Çl
("export_frames_after", "0");

117 
	`£tIÁ”Çl
("export_frames_before", "-1");

119 
	`£tIÁ”Çl
("export_screens_on_last_n_screens", "0");

121 
	`£tIÁ”Çl
("export_screens_on_last_n_episodes", "0");

123 
	`£tIÁ”Çl
("export_weights_frq", "0");

125 
	`£tIÁ”Çl
("export_rewards_frq", "0");

127 
	`£tIÁ”Çl
("plot_class_inst_frq", "0");

130 
	`£tIÁ”Çl
("export_score_screens", "false");

133 
	`£tIÁ”Çl
("export_death_screens", "false");

136 
	`£tIÁ”Çl
("max_num_episodes", "-1");

138 
	`£tIÁ”Çl
("max_num_frames", "-1");

140 
	`£tIÁ”Çl
("max_num_frames_per_episode", "-1");

142 
	`£tIÁ”Çl
("num_episodes_to_avg_results", "1000");

145 
	`£tIÁ”Çl
("alpha", "-1");

148 
	`£tIÁ”Çl
("import_weights_file", "");

150 
	`£tIÁ”Çl
("init_act_explor_count", "0");

155 
	`£tIÁ”Çl
("use_delta_bar_delta", "false");

158 
	`£tIÁ”Çl
("use_idbd", "false");

161 
	`£tIÁ”Çl
("single_action_index", "-1");

164 
	`£tIÁ”Çl
("minus_one_zero_reward", "false");

165 
	`£tIÁ”Çl
("end_game_with_score", "false");

167 
	`£tIÁ”Çl
("end_episode_with_reward", "false");

170 
	`£tIÁ”Çl
("do_bg_detection", "false");

173 
	`£tIÁ”Çl
("do_class_disc", "false");

175 
	`£tIÁ”Çl
("max_perc_difference", "0.1");

180 
	`£tIÁ”Çl
("max_shape_area_dif", "1.2");

184 
	`£tIÁ”Çl
("max_obj_velocity", "8");

186 
	`£tIÁ”Çl
("num_block_per_row", "10");

187 
	`£tIÁ”Çl
("num_block_per_col", "10");

188 
	`£tIÁ”Çl
("do_subtract_background", "true");

191 
	`£tIÁ”Çl
("plot_gridscr_grids", "false");

194 
	`£tIÁ”Çl
("epsilon_dim_start", "-1");

198 
	`£tIÁ”Çl
("shrink_weights_frq", "0");

202 
	}
}

205 
	gS‘tšgs
::~
	$S‘tšgs
()

207 
myIÁ”ÇlS‘tšgs
.
	`ş—r
();

208 
myEx‹º®S‘tšgs
.
	`ş—r
();

209 
	}
}

211 
	gS‘tšgs
::
	$lßdCÚfig
(cÚ¡ * 
cÚfig_fe
){

212 
¡ršg
 
lše
, 
key
, 
v®ue
;

213 
¡ršg
::
size_ty³
 
equ®Pos
, 
g¬bage
;

215 
if¡»am
 
	`š
(
cÚfig_fe
);

216 if(!
š
 || !š.
	`is_İ’
()) {

217 
û¼
 << "W¬nšg: couldn'ˆlßd s‘tšg fe: " << 
cÚfig_fe
 << "\n";

221 
	`g‘lše
(
š
, 
lše
)) {

223 (
g¬bage
 = 
lše
.
	`fšd
("\t")è!ğ
¡ršg
::
Åos
)

224 
lše
.
	`”a£
(
g¬bage
, 1);

227 if((
lše
.
	`Ëngth
() == 0) || (line[0] == ';'))

231 if((
equ®Pos
 = 
lše
.
	`fšd
("=")è=ğ
¡ršg
::
Åos
)

235 
key
 = 
lše
.
	`sub¡r
(0, 
equ®Pos
);

236 
v®ue
 = 
lše
.
	`sub¡r
(
equ®Pos
 + 1,†še.
	`Ëngth
(è- 
key
.length() - 1);

237 
key
 = 
	`Œim
(key);

238 
v®ue
 = 
	`Œim
(value);

241 if((
key
.
	`Ëngth
(è=ğ0è|| (
v®ue
.length() == 0))

247 
	`£tIÁ”Çl
(
key
, 
v®ue
);

250 
š
.
	`şo£
();

251 
	}
}

253 
	gS‘tšgs
::
	$lßdCÚfig
()

255 
	`lßdCÚfig
(
myOSy¡em
->
	`cÚfigFe
().
	`c_¡r
());

256 
	}
}

259 
¡ršg
 
	gS‘tšgs
::
	$lßdCommªdLše
(
¬gc
, ** 
¬gv
)

261 
i
 = 1; i < 
¬gc
; ++i)

264 
¡ršg
 
key
 = 
¬gv
[
i
];

265 if(
key
[0] == '-')

267 
key
 = key.
	`sub¡r
(1, key.
	`Ëngth
());

271 if(
key
 == "help" || key == "listrominfo")

273 
	`u§ge
();

274 
	`£tEx‹º®
(
key
, "true");

279 if(
key
 == "rominfo" || key == "debug" || key == "holdreset" ||

280 
key
 == "holdselect" || key == "holdbutton0")

282 
	`£tEx‹º®
(
key
, "true");

286 if(++
i
 >ğ
¬gc
)

288 
û¼
 << "Missšg‡rgum’ˆfÜ '" << 
key
 << "'" << 
’dl
;

291 
¡ršg
 
v®ue
 = 
¬gv
[
i
];

295 if(
idx
 = 
	`g‘IÁ”ÇlPos
(
key
) != -1)

296 
	`£tIÁ”Çl
(
key
, 
v®ue
, 
idx
);

298 
	`£tEx‹º®
(
key
, 
v®ue
);

301  
key
;

305 
	}
}

308 
	gS‘tšgs
::
	$v®id©e
()

310 
¡ršg
 
s
;

311 
i
;

313 
s
 = 
	`g‘SŒšg
("video");

314 if(
s
 != "soft" && s != "gl")

315 
	`£tIÁ”Çl
("video", "soft");

317 #ifdeà
DISPLAY_OPENGL


318 
s
 = 
	`g‘SŒšg
("gl_filter");

319 if(
s
 != "linear" && s != "nearest")

320 
	`£tIÁ”Çl
("gl_filter", "nearest");

322 
i
 = 
	`g‘IÁ
("gl_aspect");

323 if(
i
 < 50 || i > 100)

324 
	`£tIÁ”Çl
("gl_aspect", "100");

326 
s
 = 
	`g‘SŒšg
("gl_fsmax");

327 if(
s
 != "never" && s != "ui" && s != "tia" && s != "always")

328 
	`£tIÁ”Çl
("gl_fsmax", "never");

331 #ifdeà
SOUND_SUPPORT


332 
i
 = 
	`g‘IÁ
("volume");

333 if(
i
 < 0 || i > 100)

334 
	`£tIÁ”Çl
("volume", "100");

335 
i
 = 
	`g‘IÁ
("freq");

336 if(
i
 < 0 || i > 48000)

337 
	`£tIÁ”Çl
("freq", "31400");

338 
i
 = 
	`g‘IÁ
("tiafreq");

339 if(
i
 < 0 || i > 48000)

340 
	`£tIÁ”Çl
("tiafreq", "31400");

343 
i
 = 
	`g‘IÁ
("zoom_ui");

344 if(
i
 < 1 || i > 10)

345 
	`£tIÁ”Çl
("zoom_ui", "2");

347 
i
 = 
	`g‘IÁ
("zoom_tia");

348 if(
i
 < 1 || i > 10)

349 
	`£tIÁ”Çl
("zoom_tia", "2");

351 
i
 = 
	`g‘IÁ
("paddle");

352 if(
i
 < 0 || i > 3)

353 
	`£tIÁ”Çl
("paddle", "0");

355 
i
 = 
	`g‘IÁ
("pthresh");

356 if(
i
 < 400)

357 
	`£tIÁ”Çl
("pthresh", "400");

358 if(
i
 > 800)

359 
	`£tIÁ”Çl
("pthresh", "800");

361 
s
 = 
	`g‘SŒšg
("palette");

362 if(
s
 != "standard" && s != "z26" && s != "user")

363 
	`£tIÁ”Çl
("palette", "standard");

366 iàĞ
	`g‘IÁ
("expÜt_äames_aá”", 
Œue
) == 0) {

367 
¡ršg
 
š™Ÿl_d–ay
 = 
	`g‘SŒšg
("š™Ÿl_d–ay", 
Œue
);

368 
	`£tIÁ”Çl
("expÜt_äames_aá”", 
š™Ÿl_d–ay
);

370 
	}
}

373 
	gS‘tšgs
::
	$u§ge
() {

375 
cout
 << 
’dl


376 << " *************************************************************************" << 
’dl


377 << " * W–comtØA.L.E (Ar˜2600 L—ºšg EnvœÚm’tè" << 
’dl


378 << " * (Pow”ed by S‹Îa)" << 
’dl


379 << " ***************************************************************************" << 
’dl


380 << 
’dl


381 << " * U§ge:‡Ë [İtiÚ ...]„omfe" << 
’dl


382 << 
’dl


383 << 
’dl


384 << " * V®id o±iÚ ¬e:" << 
’dl


385 << " * -game_cÚŒŞË¸[š‹º®]/[fifo]" << 
’dl


386 << " * Defše how s‹Î¨wÈcommuniÿ‹ w™hh¶ay”‡g’t:" << 
’dl


387 << " * - 'š‹º®': (deçuÉèª in¡ªû oàthPÏy”Ag’t" << 
’dl


388 << " * subşas wÈbš™ized‡nd cÚŒŞhgame" << 
’dl


389 << " * - 'fifo': ThcÚŒŞ wÈbthroughwØFIFO…es, oÃ s’dšgh"<< 
’dl


390 << " * sü“n,¿m,‡ndhÙh”„ec›všghaùiÚs" << 
’dl


391 << 
’dl


392 << " * -¶ay”_ag’ˆ[bass]/[disco]/[¿m]/[¿ndom_]/[£¬ch_ag’t]/[sšgË_aùiÚ]" << 
’dl


393 << " * /[aùiÚs_summ¬y]" << 
’dl


394 << " * D‘”mše wh©…Ïy”‡g’ˆthš‹º® cÚŒŞË¸should u£" << 
’dl


395 << 
’dl


396 << " * -š™Ÿl_d–ay‚" << 
’dl


397 << " * How mªy f¿me tØwa™‡ˆthv”y begššg, befÜ»£‰šghgame" << 
’dl


398 << 
’dl


399 << " * -¿ndom_£ed [time]/[n] " << 
’dl


400 << " * S‘ th£ed u£d fÜ„ªdom‚umb” g’”©iÚ. " << 
’dl


401 << " * 'time' wÈu£hthcu¼’ˆtime." << 
’dl


402 << 
’dl


403 << " * -expÜt_äames_äq‚" << 
’dl


404 << " * How oá’ØexpÜˆthäame a PNG fes. 0 (deçuÉèm—n Ãv”." << 
’dl


405 << 
’dl


406 << " * -expÜt_äames_aá”‚" << 
’dl


407 << " * ExpÜtšg f¿me ¡¬t aá”hi mªy f¿mes. DeçuÉ i 0, i.e.„ighˆaway"<< 
’dl


408 << 
’dl


409 << " * -expÜt_äames_befÜn" << 
’dl


410 << " * ExpÜtšg f¿me ¡¬t befÜthi mªy f¿mes. DeçuÉ i -1, m—nšg‚ev”"<< 
’dl


411 << 
’dl


412 << " * -expÜt_sü“ns_Ú_Ï¡_n_sü“n n" << 
’dl


413 << " * OÆyhÏ¡‚ sü“n wÈbexpÜ‹d. " << 
’dl


414 << " * 0 (deçuÉèm—n nØchªgtØthcu¼’ˆexpÜˆruËs" << 
’dl


415 << 
’dl


416 << " * -expÜt_sü“ns_Ú_Ï¡_n_•isode n" << 
’dl


417 << " * OÆyhÏ¡‚ƒpisode wÈbexpÜ‹d. " << 
’dl


418 << " * 0 (deçuÉèm—n nØchªgtØthcu¼’ˆexpÜˆruËs" << 
’dl


419 << 
’dl


420 << " * -expÜt_weights_äq‚" << 
’dl


421 << " * How oá’ØexpÜˆthweight veùÜ. 0 (deçuÉèm—n Ãv”." << 
’dl


422 << 
’dl


423 << " * -expÜt_»w¬ds_äq‚" << 
’dl


424 << " * How oá’ØexpÜˆth»w¬d hi¡Üy. 0 (deçuÉèm—n Ãv”." << 
’dl


425 << 
’dl


426 << " * -¶Ù_şass_š¡_äq f" << 
’dl


427 << " * How oá’Ø¶Ùhşas š¡ªûs. 0 (deçuÉèm—n Ãv”." << 
’dl


428 << 
’dl


429 << " * -expÜt_scÜe_sü“n [Œue]/[çl£]" << 
’dl


430 << " * Wh’rue, wwÈ§vthsü“n wh”thag’ˆ»c›ve ¨nÚ-z”Ø»w¬d"<< 
’dl


431 << 
’dl


432 << " * -expÜt_d—th_sü“n [Œue]/[çl£]" << 
’dl


433 << " * Wh’rue, wwÈ§vthsü“n wh”thag’ˆd›s" << 
’dl


434 << 
’dl


435 << " * -max_num_•isode n" << 
’dl


436 << " * Th´og¿m wÈqu™‡á”hi numb” oà•isodes. -1 (deçuÉèm—n Ãv”."<< 
’dl


437 << 
’dl


438 << " * -max_num_äame m" << 
’dl


439 << " * Th´og¿m wÈqu™‡á”hi numb” oàäames. -1 (deçuÉèm—n Ãv”." << 
’dl


440 << 
’dl


441 << " * -max_num_äames_³r_•isodm" << 
’dl


442 << " * End —chƒpisodaá”hi numb” oàäames. -1 (deçuÉèm—n Ãv”." << 
’dl


443 << 
’dl


444 << " * -num_•isodes_to_avg_»suÉ n" << 
’dl


445 << " * ThË¬nšg„esuÉ wÈbav”aged ov”hi numb” oà•isodes. " << 
’dl


446 << " * DeçuÉ i 1000" << 
’dl


447 << 
’dl


448 << " * -impÜt_weights_f¡r" << 
’dl


449 << " * Wh’ s‘, wwÈimpÜˆthgiv’ weight fe." << 
’dl


450 << 
’dl


451 << " * -ld [A/B]" << 
’dl


452 << " * Leá…Ïy” difficuÉy. B (deçuÉèm—n —sy" << 
’dl


453 << 
’dl


454 << " * -rd [A/B]" << 
’dl


455 << " * Righˆ¶ay” difficuÉy. B (deçuÉèm—n —sy" << 
’dl


456 << 
’dl


457 << " * -’d_game_w™h_scÜ[Œue/çl£]" << 
’dl


458 << " * Wh’rue,hgam’d aá”ƒach scÜ»c›ved. Thi i u£fuÈš sŞvšg "<< 
’dl


459 << " * somgames. DeçuÉ i çl£." << 
’dl


460 << 
’dl


461 << " * -sšgË_aùiÚ_šdex " << 
’dl


462 << " * Index oàthaùiÚh© SšgË-AùiÚ Ag’ˆwÈ»tuº" << 
’dl


463 << 
’dl


464 << " * -mšus_Úe_z”o_»w¬d U£ -1/0„ew¬d sy¡em. Wh’rue,„ew¬d wÈb-1 on"<< 
’dl


465 << " *ƒv”y¡•s,ƒsxû± wh’ scÜi pos™ive, iÀwhich "<< 
’dl


466 << " * ca£h»w¬d wÈb0" << 
’dl


467 << 
’dl


468 << 
’dl


469 << " * S¬§-Lambd¨P¬am‘” (usu®ly†ßded from '¾_·¿ms.txt'). " << 
’dl


470 << " * NÙth©he£…¬am‘” Óxû±‡Íha)havnØdeçuÉ v®ues" << 
’dl


471 << " * -•sÚ f…robab™y oà¿ndom‡ùiÚ" << 
’dl


472 << " * -Ïmbd¨à¿û-deÿy…¬am‘”" << 
’dl


473 << " * -gamm¨à discouÁ-¿‹…¬am‘”" << 
’dl


474 << " * -İtimi¡ic_š™ [Œue]/[çl£]" << 
’dl


475 << " * wh’rue, wwÈdØİtim™iøš™Ÿliz©iÚ" << 
’dl


476 << " * -nÜm®ize_ã©u»_veùÜ [Œue]/[çl£]" << 
’dl


477 << " * wh’rue,hã©u»-veùÜ wÈbnÜm®izedØaddØ1.0" << 
’dl


478 << 
’dl


479 << " * -®pha_muÉl›¸n" << 
’dl


480 << " * -Œaû_vec_size_¿tiØf" << 
’dl


481 << " * -mšimum_Œaû_v®uf" << 
’dl


482 << " * -®ph¨f" << 
’dl


483 << " *‡Íh¨v®ufÜ S¬§-Ïmbda. -1 (deçuÉèm—n ®ph¨wÈbe" << 
’dl


484 << " * s–eùed‡utom©iÿÎy." << 
’dl


485 << 
’dl


486 << " * -th‘¨f" << 
’dl


487 << " * m‘¨Ë©nšg-¿‹ u£d iÀiDBD" << 
’dl


488 << 
’dl


489 << " * -shršk_weights_äq‚" << 
’dl


490 << " * How oá’Ø»movthsm®Ë¡ v®ušhweight vaùÜ. " << 
’dl


491 << " * 0 (deçuÉèm—n Ãv”." << 
’dl


492 << 
’dl


493 << " * -shršk_weights_m‘hod [sqr_roÙ_num_äames/lš—r_shršk/cÚ¡_shršk]" << 
’dl


494 << " * Numb” oàv®ue th© wÈbk•ˆšhweight veùÜ is" << 
’dl


495 << " * sqr_roÙ(i_äame_couÁ”è* shršk_weights_cÚ¡" << 
’dl


496 << " * o¸" << 
’dl


497 << " * shršk_weights_cÚ¡ *‚umb”_of_cu¼’t_nÚ_z”o_v®ues" << 
’dl


498 << " * o¸" << 
’dl


499 << " *‚umb”_of_cu¼’t_nÚ_z”o_v®ue - shršk_weights_cÚ¡" << 
’dl


500 << 
’dl


502 << " * s“ docum’t fÜ shršk_weights_m‘hod" << 
’dl


503 << 
’dl


504 << " * -u£_d–_b¬_d– [Œue]/[çl£] " << 
’dl


505 << " * Wh’rue, wwÈu£ d–-b¬-d–ØÿlcuÏ‹ dyÇmiø¡• size š SARSA" << 
’dl


506 << 
’dl


507 << " * -u£_idbd [Œue]/[çl£] " << 
’dl


508 << " * Wh’rue, wwÈu£ iDBDØÿlcuÏ‹ dyÇmiø¡• size š SARSA" << 
’dl


509 << 
’dl


510 << " * -’d_•isode_w™h_»w¬d [Œue/çl£]" << 
’dl


511 << " * Wh’rue, cu¼’ˆ•isod’d aá”ƒach„ew¬d. Thi i u£fuÈš sŞvšg " << 
’dl


512 << " * somgames. DeçuÉ i çl£." << 
’dl


513 << 
’dl


514 << " * -•sÚ_dim_¡¬ˆf" << 
’dl


515 << " * S¹ dimšishšgƒpsÚ‡á”hgivÄ©iØoàƒpisodes. -1" << 
’dl


516 << " * (deçuÉèm—n Ãv”" << 
’dl


517 << 
’dl


518 << " * CÏss-Ag’ˆP¬am©” ×lsØlßded from '¾_·¿ms.txt')" << 
’dl


519 << " * -šşude_abs_pos™iÚ [Œue]/[çl£]" << 
’dl


520 << " * -num_tšg n" << 
’dl


521 << " * -num_»ùªgË n" << 
’dl


522 << " * -mem_size_muÉl›¸n" << 
’dl


523 << " * -max_obj_v–oc™y‚" << 
’dl


524 << " * Maximum v–oc™y (pix–/£cèoàobjeù Ú sü“n. DeçuÉ i 8" << 
’dl


525 << " * -max_num_d‘eùed_š¡aû n" << 
’dl


526 << " * Maximum‚umb” oàš¡ªû th© wÈbd‘eùed fromƒach cÏss." << 
’dl


528 << 
’dl


529 << 
’dl


530 << " * Grid-Sü“ÀAg’ˆP¬am©” ×lsØlßded from '¾_·¿ms.txt')" << 
’dl


531 << " * -num_block_³r_row‚" << 
’dl


532 << " * How mªy block tØhav³¸row. DeçuÉ i 10" << 
’dl


533 << 
’dl


534 << " * -num_block_³r_cŞ‚" << 
’dl


535 << " * How mªy block tØhav³¸cŞumn. DeçuÉ i 10" << 
’dl


536 << 
’dl


537 << " * -do_subŒaù_background [Œue/çl£]" << 
’dl


538 << " * Wh’ru(deçuÉ), wwÈsubŒaùhbackground befÜg’”©šg " << 
’dl


539 << " *hã©u» veùÜ" << 
’dl


540 << " * -¶Ù_gridsü_grid [Œue/çl£]" << 
’dl


541 << " * Wh’rue, wwÈ¶ÙhgridƒxŒaùed fÜhsü“Àby dœec-sü“Àag’t."<< 
’dl


542 << 
’dl


543 << 
’dl


544 << " * CÏss-Discov”y S‘tšg (usu®ly†ßded from 'şass_disc_·¿ms.txt'è:" << 
’dl


545 << " * -do_bg_d‘eùiÚ [Œue]/[çl£]" << 
’dl


546 << " * Wh’rue,h¶ay”-ag’ˆwÈ®sØdØbackgroudÀd‘eùiÚ." << 
’dl


547 << 
’dl


548 << " * -do_şass_disø[Œue]/[çl£]" << 
’dl


549 << " * Wh’rue,h¶ay”-ag’ˆwÈ®sØdØşas discov”y." << 
’dl


550 << 
’dl


551 << " * -şs_disc_äames_num‚" << 
’dl


552 << " * Numb” oàäame tØu£ fÜ cÏs discov”y." << 
’dl


553 << 
’dl


554 << " * -¶Ù_»giÚ_m©rix_´e_m”g[Œue]/[çl£] " << 
’dl


555 << " * Wh’rue, wwÈ¶Ùh»giÚ m©rix, befÜ m”šghobjeùs" << 
’dl


556 << 
’dl


557 << " * -¶Ù_»giÚ_m©rix_po¡_m”g[Œue]/[çl£]" << 
’dl


558 << " * Wh’rue, wwÈ¶Ùh»giÚ m©rix,‡á” m”šghobjeùs" << 
’dl


559 << 
’dl


560 << " * -¶Ù_´e_f‹r_şas£ [Œue]/[çl£] " << 
’dl


561 << " * Wh’rue, wwÈ¶Ùh´e-f‹¸discov”ed cÏs£s" << 
’dl


562 << 
’dl


563 << " * -¶Ù_po¡_f‹r_şas£ [Œue]/[çl£]" << 
’dl


564 << " * Wh’rue, wwÈ¶Ùhpo¡-f‹¸discov”ed cÏs£s" << 
’dl


565 << 
’dl


566 << " * -max_³rc_difã»nû f" << 
’dl


567 << " * Thmaximum…”ûÁagoàpix– oàthtwØsh­e th© cª bdifã»Á," << 
’dl


568 << " *‡ndwØsh­e ¡ÈbcÚsid”ed sim¬. DeçuÉ i 0.1" << 
’dl


569 << 
’dl


570 << " * -max_sh­e_¬—_diàf" << 
’dl


571 << " * How muchwØsh­¬— ÿÀdifã¸,ªdhdi¡ªû b‘w“Àthem stÈbe" << 
’dl


572 << " * m—nšgful. DeçuÉ i ¨çùÜ oà1.2" << 
’dl


573 << 
’dl


574 << " * -mš_Ú_äame_¿tiØf" << 
’dl


575 << " * Mšimum„©iØth©‡ cÏs Ãed tØbÚ sü“ÀtØbcÚsid”ed‡ v®id cÏss"<< 
’dl


576 << 
’dl


577 << " * -mš_bound¬y_Ëngth‚" << 
’dl


578 << " * FÜ‡ cÏs tØbv®id,ƒ™h” iˆha tØex·nd‡ˆËa¡ i_mš_bound¬y_Ëngth"<< 
’dl


579 << " * oÀX o¸Y‡xi Üh¬— iˆex·nd mu¡ bÏrg”hª mš_bound¬y_Ëngth ^ 2"<< 
’dl


580 << 
’dl


581 << " * -max_num_şas£ n" << 
’dl


582 << " * Maximum‡cû±abË‚umb” oàşas£ th© cª bdiscov”ed" << 
’dl


583 << 
’dl


584 << 
’dl


585 << " * S—rch-Ag’ˆAg’ˆP¬am©” Ößded from '£¬ch_·¿ms.txt')" << 
’dl


586 << " * -£¬ch_m‘hod [fuÎŒ“/uù]" << 
’dl


587 << " * D‘”mše thm‘hodØbu£d byhS—rch-Ag’ˆ" << 
’dl


588 << 
’dl


589 << " * -sim_¡•s_³r_nodn" << 
’dl


590 << " * Numb” oà¡• wwÈruÀthsimuÏtiÚ iÀ—ch s—rch-Œ“‚ode" << 
’dl


591 << 
’dl


592 << " * -max_sim_¡•s_³r_äamn" << 
’dl


593 << " * Maximum‚umb” oàsimuÏtiÚ s‹p ®lowed…” f¿me" << 
’dl


594 << 
’dl


595 << " * -discouÁ_çùÜ f" << 
’dl


596 << " * ThdiscouÁ faùÜØh–°thŒ“-£¬ch…»ã¸şo£¸gßls" << 
’dl


597 << 
’dl


598 << " * -uù_mÚ‹_ÿ¾o_¡• n" << 
’dl


599 << " * Numb” oàsimuÏ‹d MÚ‹ C¬lØ¡• th© wÈbruÀÚƒach UCT i‹¿tiÚ" << 
’dl


600 << 
’dl


601 << " * -uù_ex¶Ü©iÚ_cÚ¡ f" << 
’dl


602 << " * Ex¶Ü©iÚ CÚ¡ªt" << 
’dl


603 << 
’dl


604 << " * -uù_mš_d—th_couÁ‚" << 
’dl


605 << " * Mšimum‚umb” oàsimuÏtiÚ th© shouldƒnd u°d—d from‡‚ode, " << 
’dl


606 << " * befÜwm¬kh©‚oda d—d." << 
’dl


607 << 
’dl


608 << " * -uù_b¿nch_v®ue_m‘hod [av”ag/ max]" << 
’dl


609 << " * Howhv®uoà¨b¿nch i d‘”mšed. 'av”age'ake thav”agv®uoà"<< 
’dl


610 << " *hchd»n, wh'max'ake thmax v®ue" << 
’dl


611 << 
’dl


612 << " * -uù_avg_»w¬d_³r_äam[Œue]/[çl£]" << 
’dl


613 << " * Wh’rue, uù wÈlook‡ˆ»w¬d/äamÒÙ ju¡„ew¬d). Thi i tØ´ev’t"<< 
’dl


614 << " * bŸsšgow¬d ex¶Üšg‡Ì—dy d“³¸sub-b¿nches" << 
’dl


615 << 
’dl


616 << 
’dl
;

617 
	}
}

620 
	gS‘tšgs
::
	$§veCÚfig
()

624 
boŞ
 
£‰šgsChªged
 = 
çl£
;

625 
i
 = 0; i < 
myIÁ”ÇlS‘tšgs
.
	`size
(); ++i)

627 if(
myIÁ”ÇlS‘tšgs
[
i
].
v®ue
 !ğmyIÁ”ÇlS‘tšgs[i].
š™ŸlV®ue
)

629 
£‰šgsChªged
 = 
Œue
;

634 if(!
£‰šgsChªged
)

637 
of¡»am
 
	`out
(
myOSy¡em
->
	`cÚfigFe
().
	`c_¡r
());

638 if(!
out
 || !out.
	`is_İ’
())

640 
û¼
 << "Error: Couldn't save settings file\n";

644 
out
 << "; S‹Î¨cÚfigu¿tiÚ fe" << 
’dl


645 << ";" << 
’dl


646 << "; Lše ¡¬tšg w™h ';'‡» comm’t ªd‡» ignÜed." << 
’dl


647 << "; S·û ªdab ¬ignÜed." << 
’dl


648 << ";" << 
’dl


649 << "; FÜm© MUST ba fŞlows:" << 
’dl


650 << "; commªd = v®ue" << 
’dl


651 << ";" << 
’dl


652 << "; Commmªd ¬th§ma tho£ s³cif›d oÀthcommªdlše," << 
’dl


653 << "; w™houˆth'-' ch¬aù”." << 
’dl


654 << ";" << 
’dl


655 << "; V®ue ¬th§ma tho£‡Îowed oÀthcommªdlše." << 
’dl


656 << "; BoŞ—Àv®ue ¬¥ecif›d‡ 1 (Ürueèªd 0 (Ü f®£)" << 
’dl


657 << ";" << 
’dl
;

660 
i
 = 0; i < 
myIÁ”ÇlS‘tšgs
.
	`size
(); ++i)

662 
out
 << 
myIÁ”ÇlS‘tšgs
[
i
].
key
 << " = " <<

663 
myIÁ”ÇlS‘tšgs
[
i
].
v®ue
 << 
’dl
;

666 
out
.
	`şo£
();

667 
	}
}

670 
	gS‘tšgs
::
	$£tIÁ
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue
)

672 
o¡ršg¡»am
 
¡»am
;

673 
¡»am
 << 
v®ue
;

675 if(
idx
 = 
	`g‘IÁ”ÇlPos
(
key
) != -1)

676 
	`£tIÁ”Çl
(
key
, 
¡»am
.
	`¡r
(), 
idx
);

678 
	`£tEx‹º®
(
key
, 
¡»am
.
	`¡r
());

679 
	}
}

682 
	gS‘tšgs
::
	$£tFlßt
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue
)

684 
o¡ršg¡»am
 
¡»am
;

685 
¡»am
 << 
v®ue
;

687 if(
idx
 = 
	`g‘IÁ”ÇlPos
(
key
) != -1)

688 
	`£tIÁ”Çl
(
key
, 
¡»am
.
	`¡r
(), 
idx
);

690 
	`£tEx‹º®
(
key
, 
¡»am
.
	`¡r
());

691 
	}
}

694 
	gS‘tšgs
::
	$£tBoŞ
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
boŞ
 
v®ue
)

696 
o¡ršg¡»am
 
¡»am
;

697 
¡»am
 << 
v®ue
;

699 if(
idx
 = 
	`g‘IÁ”ÇlPos
(
key
) != -1)

700 
	`£tIÁ”Çl
(
key
, 
¡»am
.
	`¡r
(), 
idx
);

702 
	`£tEx‹º®
(
key
, 
¡»am
.
	`¡r
());

703 
	}
}

706 
	gS‘tšgs
::
	$£tSŒšg
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
)

708 if(
idx
 = 
	`g‘IÁ”ÇlPos
(
key
) != -1)

709 
	`£tIÁ”Çl
(
key
, 
v®ue
, 
idx
);

711 
	`£tEx‹º®
(
key
, 
v®ue
);

712 
	}
}

715 
	gS‘tšgs
::
	$g‘Size
(cÚ¡ 
¡ršg
& 
key
, & 
x
, & 
y
) const

717 
¡ršg
 
size
 = 
	`g‘SŒšg
(
key
);

718 
	`»¶aû
(
size
.
	`begš
(), size.
	`’d
(), 'x', ' ');

719 
i¡ršg¡»am
 
	`buf
(
size
);

720 
buf
 >> 
x
;

721 
buf
 >> 
y
;

722 
	}
}

725 
	gS‘tšgs
::
	$g‘IÁ
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
) const {

727 
idx
 = -1;

728 if((
idx
 = 
	`g‘IÁ”ÇlPos
(
key
)) != -1) {

729  (è
	`©oi
(
myIÁ”ÇlS‘tšgs
[
idx
].
v®ue
.
	`c_¡r
());

731 if((
idx
 = 
	`g‘Ex‹º®Pos
(
key
)) != -1) {

732  (è
	`©oi
(
myEx‹º®S‘tšgs
[
idx
].
v®ue
.
	`c_¡r
());

734 ià(
¡riù
) {

735 
û¼
 << "NØv®ufound fÜ key: " << 
key
 << ". ";

736 
û¼
 << "Maksu»‡Îh£‰šg fe ¬lßded." << 
’dl
;

737 
	`ex™
(-1);

743 
	}
}

746 
	gS‘tšgs
::
	$g‘Flßt
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
) const {

748 
idx
 = -1;

749 if((
idx
 = 
	`g‘IÁ”ÇlPos
(
key
)) != -1) {

750  (è
	`©of
(
myIÁ”ÇlS‘tšgs
[
idx
].
v®ue
.
	`c_¡r
());

752 if((
idx
 = 
	`g‘Ex‹º®Pos
(
key
)) != -1) {

753  (è
	`©of
(
myEx‹º®S‘tšgs
[
idx
].
v®ue
.
	`c_¡r
());

755 ià(
¡riù
) {

756 
û¼
 << "NØv®ufound fÜ key: " << 
key
 << ". ";

757 
û¼
 << "Maksu»‡Îh£‰šg fe ¬lßded." << 
’dl
;

758 
	`ex™
(-1);

764 
	}
}

767 
boŞ
 
	gS‘tšgs
::
	$g‘BoŞ
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
) const {

769 
idx
 = -1;

770 if((
idx
 = 
	`g‘IÁ”ÇlPos
(
key
)) != -1)

772 cÚ¡ 
¡ršg
& 
v®ue
 = 
myIÁ”ÇlS‘tšgs
[
idx
].value;

773 if(
v®ue
 == "1" || value == "true" || value == "True")

774  
Œue
;

775 if(
v®ue
 == "0" || value == "false" || value == "False")

776  
çl£
;

778  
çl£
;

779 } if((
idx
 = 
	`g‘Ex‹º®Pos
(
key
)) != -1) {

780 cÚ¡ 
¡ršg
& 
v®ue
 = 
myEx‹º®S‘tšgs
[
idx
].value;

781 if(
v®ue
 == "1" || value == "true")

782  
Œue
;

783 if(
v®ue
 == "0" || value == "false")

784  
çl£
;

786  
çl£
;

788 ià(
¡riù
) {

789 
û¼
 << "NØv®ufound fÜ key: " << 
key
 << ". ";

790 
û¼
 << "Maksu»‡Îh£‰šg fe ¬lßded." << 
’dl
;

791 
	`ex™
(-1);

793  
çl£
;

796 
	}
}

799 cÚ¡ 
	g¡ršg
& 
	gS‘tšgs
::
	$g‘SŒšg
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
) const {

801 
idx
 = -1;

802 if((
idx
 = 
	`g‘IÁ”ÇlPos
(
key
)) != -1) {

803  
myIÁ”ÇlS‘tšgs
[
idx
].
v®ue
;

804 } ià((
idx
 = 
	`g‘Ex‹º®Pos
(
key
)) != -1) {

805  
myEx‹º®S‘tšgs
[
idx
].
v®ue
;

807 ià(
¡riù
) {

808 
û¼
 << "NØv®ufound fÜ key: " << 
key
 << ". ";

809 
û¼
 << "Maksu»‡Îh£‰šg fe ¬lßded." << 
’dl
;

810 
	`ex™
(-1);

812  
Em±ySŒšg
;

815 
	}
}

818 
	gS‘tšgs
::
	$£tSize
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue1
, cÚ¡ 
v®ue2
)

820 
o¡ršg¡»am
 
buf
;

821 
buf
 << 
v®ue1
 << "x" << 
v®ue2
;

822 
	`£tSŒšg
(
key
, 
buf
.
	`¡r
());

823 
	}
}

826 
	gS‘tšgs
::
	$g‘IÁ”ÇlPos
(cÚ¡ 
¡ršg
& 
key
) const

828 
i
 = 0; i < 
myIÁ”ÇlS‘tšgs
.
	`size
(); ++i)

829 if(
myIÁ”ÇlS‘tšgs
[
i
].
key
 == key)

830  
i
;

833 
	}
}

836 
	gS‘tšgs
::
	$g‘Ex‹º®Pos
(cÚ¡ 
¡ršg
& 
key
) const

838 
i
 = 0; i < 
myEx‹º®S‘tšgs
.
	`size
(); ++i)

839 if(
myEx‹º®S‘tšgs
[
i
].
key
 == key)

840  
i
;

843 
	}
}

846 
	gS‘tšgs
::
	$£tIÁ”Çl
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
,

847 
pos
, 
boŞ
 
u£AsIn™Ÿl
)

849 
idx
 = -1;

851 if(
pos
 !ğ-1 &&…o >ğ0 &&…o < ()
myIÁ”ÇlS‘tšgs
.
	`size
() &&

852 
myIÁ”ÇlS‘tšgs
[
pos
].
key
 == key)

854 
idx
 = 
pos
;

858 
i
 = 0; i < 
myIÁ”ÇlS‘tšgs
.
	`size
(); ++i)

860 if(
myIÁ”ÇlS‘tšgs
[
i
].
key
 == key)

862 
idx
 = 
i
;

868 if(
idx
 != -1)

870 
myIÁ”ÇlS‘tšgs
[
idx
].
key
 = key;

871 
myIÁ”ÇlS‘tšgs
[
idx
].
v®ue
 = value;

872 if(
u£AsIn™Ÿl
è
myIÁ”ÇlS‘tšgs
[
idx
].
š™ŸlV®ue
 = 
v®ue
;

882 
S‘tšg
 
£‰šg
;

883 
£‰šg
.
key
 = key;

884 
£‰šg
.
v®ue
 = value;

885 if(
u£AsIn™Ÿl
è
£‰šg
.
š™ŸlV®ue
 = 
v®ue
;

887 
myIÁ”ÇlS‘tšgs
.
	`push_back
(
£‰šg
);

888 
idx
 = 
myIÁ”ÇlS‘tšgs
.
	`size
() - 1;

897  
idx
;

898 
	}
}

901 
	gS‘tšgs
::
	$£tEx‹º®
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
,

902 
pos
, 
boŞ
 
u£AsIn™Ÿl
)

904 
idx
 = -1;

906 if(
pos
 !ğ-1 &&…o >ğ0 &&…o < ()
myEx‹º®S‘tšgs
.
	`size
() &&

907 
myEx‹º®S‘tšgs
[
pos
].
key
 == key)

909 
idx
 = 
pos
;

913 
i
 = 0; i < 
myEx‹º®S‘tšgs
.
	`size
(); ++i)

915 if(
myEx‹º®S‘tšgs
[
i
].
key
 == key)

917 
idx
 = 
i
;

923 if(
idx
 != -1)

925 
myEx‹º®S‘tšgs
[
idx
].
key
 = key;

926 
myEx‹º®S‘tšgs
[
idx
].
v®ue
 = value;

927 if(
u£AsIn™Ÿl
è
myEx‹º®S‘tšgs
[
idx
].
š™ŸlV®ue
 = 
v®ue
;

936 
S‘tšg
 
£‰šg
;

937 
£‰šg
.
key
 = key;

938 
£‰šg
.
v®ue
 = value;

939 if(
u£AsIn™Ÿl
è
£‰šg
.
š™ŸlV®ue
 = 
v®ue
;

941 
myEx‹º®S‘tšgs
.
	`push_back
(
£‰šg
);

942 
idx
 = 
myEx‹º®S‘tšgs
.
	`size
() - 1;

950  
idx
;

951 
	}
}

954 
	gS‘tšgs
::
	$S‘tšgs
(cÚ¡ 
S‘tšgs
&)

956 
	}
}

959 
S‘tšgs
& S‘tšgs::
İ”©Ü
 = (const Settings&)

961 
as£¹
(
çl£
);

963  *
	gthis
;

	@emucore/Settings.hxx

19 #iâdeà
SETTINGS_HXX


20 
	#SETTINGS_HXX


	)

22 
şass
 
	gOSy¡em
;

24 
	~"A¼ay.hxx
"

25 
	~"b¥f.hxx
"

33 şas 
	cS‘tšgs


35 
	mpublic
:

39 
S‘tšgs
(
OSy¡em
* 
osy¡em
);

44 
	mvœtu®
 ~
S‘tšgs
();

46 
	mpublic
:

50 
vœtu®
 
lßdCÚfig
();

55 
lßdCÚfig
(cÚ¡ * 
cÚfig_fe
);

60 
vœtu®
 
§veCÚfig
();

67 
¡ršg
 
lßdCommªdLše
(
¬gc
, ** 
¬gv
);

73 
v®id©e
();

78 
u§ge
();

87 
	$g‘IÁ
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
 = 
çl£
) const;

96 
	$g‘Flßt
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
 = 
çl£
) const;

105 
boŞ
 
	$g‘BoŞ
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
 = 
çl£
) const;

114 cÚ¡ 
¡ršg
& 
	$g‘SŒšg
(cÚ¡ 
¡ršg
& 
key
, 
boŞ
 
¡riù
 = 
çl£
) const;

123 
	$g‘Size
(cÚ¡ 
¡ršg
& 
key
, & 
x
, & 
y
) const;

131 
	`£tIÁ
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue
);

139 
	`£tFlßt
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue
);

147 
	`£tBoŞ
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
boŞ
 
v®ue
);

155 
	`£tSŒšg
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
);

163 
	`£tSize
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ 
v®ue1
, cÚ¡ 
v®ue2
);

165 
´iv©e
:

167 
	`S‘tšgs
(cÚ¡ 
S‘tšgs
&);

170 
S‘tšgs
& 
İ”©Ü
 = (const Settings&);

173 
¡ršg
 
	$Œim
(
¡ršg
& 
¡r
)

175 
¡ršg
::
size_ty³
 
fœ¡
 = 
¡r
.
	`fšd_fœ¡_nÙ_of
(' ');

176  (
fœ¡
 =ğ
¡ršg
::
Åos
è? 
	`¡ršg
() :

177 
¡r
.
	`sub¡r
(
fœ¡
, sŒ.
	`fšd_Ï¡_nÙ_of
(' ')-first+1);

180 
´Ùeùed
:

182 
OSy¡em
* 
myOSy¡em
;

185 
	sS‘tšg


187 
¡ršg
 
key
;

188 
¡ršg
 
v®ue
;

189 
¡ršg
 
š™ŸlV®ue
;

190 
	}
};

191 
	gCommÚ
::
	tA¼ay
<
	tS‘tšg
> 
	tS‘tšgsA¼ay
;

193 cÚ¡ 
	gS‘tšgsA¼ay
& 
	$g‘IÁ”ÇlS‘tšgs
() const

194 {  
myIÁ”ÇlS‘tšgs
; 
	}
}

195 cÚ¡ 
	gS‘tšgsA¼ay
& 
	$g‘Ex‹º®S‘tšgs
() const

196 {  
myEx‹º®S‘tšgs
; 
	}
}

199 
	$g‘IÁ”ÇlPos
(cÚ¡ 
¡ršg
& 
key
) const;

200 
	$g‘Ex‹º®Pos
(cÚ¡ 
¡ršg
& 
key
) const;

203 
	`£tIÁ”Çl
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
,

204 
pos
 = -1, 
boŞ
 
u£AsIn™Ÿl
 = 
çl£
);

205 
	`£tEx‹º®
(cÚ¡ 
¡ršg
& 
key
, cÚ¡ sŒšg& 
v®ue
,

206 
pos
 = -1, 
boŞ
 
u£AsIn™Ÿl
 = 
çl£
);

208 
´iv©e
:

211 
S‘tšgsA¼ay
 
myIÁ”ÇlS‘tšgs
;

215 
S‘tšgsA¼ay
 
myEx‹º®S‘tšgs
;

216 
	}
};

	@emucore/Sound.hxx

19 #iâdeà
SOUND_HXX


20 
	#SOUND_HXX


	)

22 
şass
 
	gOSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

35 şas 
	cSound


37 
	mpublic
:

42 
	$Sound
(
OSy¡em
* 
osy¡em
è{ 
myOSy¡em
 = osystem; }

47 
vœtu®
 ~
	$Sound
(è{ 
	}
};

49 
	gpublic
:

55 
vœtu®
 
£tEÇbËd
(
boŞ
 
’abË
) = 0;

63 
vœtu®
 
adju¡CyşeCouÁ”
(
IÁ32
 
amouÁ
) = 0;

70 
vœtu®
 
£tChªÃls
(
uIÁ32
 
chªÃls
) = 0;

78 
vœtu®
 
£tF¿meR©e
(
uIÁ32
 
äam”©e
) = 0;

84 
vœtu®
 
š™Ÿlize
() = 0;

90 
vœtu®
 
şo£
() = 0;

97 
vœtu®
 
boŞ
 
	$isSucûssfuÎyIn™Ÿlized
() const = 0;

104 
vœtu®
 
	`mu‹
(
boŞ
 
¡©e
) = 0;

109 
vœtu®
 
	`»£t
() = 0;

118 
vœtu®
 
	`£t
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
, 
IÁ32
 
cyşe
) = 0;

127 
vœtu®
 
	`£tVŞume
(
IÁ32
 
³rûÁ
) = 0;

135 
vœtu®
 
	`adju¡VŞume
(
IÁ8
 
dœeùiÚ
) = 0;

137 
public
:

144 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
) = 0;

152 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
) = 0;

154 
´Ùeùed
:

156 
OSy¡em
* 
myOSy¡em
;

157 
	}
};

	@emucore/SpeakJet.cxx

19 #ifdeà
ATARIVOX_SUPPORT


21 
	~"S³akJ‘.hxx
"

24 
	gS³akJ‘
::
	$S³akJ‘
()

29 
S³echBufãr
 *
fœ¡
 = &
ouutBufãrs
[0];

30 
S³echBufãr
 *
Ï¡
 = 0;

31 
i
=0; i<
SPEECH_BUFFERS
; i++) {

32 
S³echBufãr
 *
sb
 = &
ouutBufãrs
[
i
];

33 
sb
->
™ems
 = 0;

34 
sb
->
lock
 = 
	`SDL_C»©eSem­hÜe
(1);

35 if(
Ï¡
) {

36 
Ï¡
->
Ãxt
 = 
sb
;

38 
Ï¡
 = 
sb
;

40 
Ï¡
->
Ãxt
 = 
fœ¡
;

42 
myCu¼’tOuutBufãr
 = 
ourCu¼’tWr™eBufãr
 = 
fœ¡
;

43 
ourCu¼’tWr™ePos™iÚ
 = 0;

46 
	`d¬¿y_š™
(&
rsyÁhSam¶es
, (), 2048);

53 
rsyÁh
 = 
	`rsyÁh_š™
(31400, 10.0,

54 
	`rsyÁh_¥—k”
(133.0, 57, 
EËm’ts
),

55 
§ve_§m¶e
, 
æush_§m¶es
, &
rsyÁhSam¶es
);

56 
	`¥awnTh»ad
();

57 
	}
}

60 
	gS³akJ‘
::~
	$S³akJ‘
()

62 
	}
}

65 
S³akJ‘
::
	$¥awnTh»ad
()

67 
ourIÅutSem­hÜe
 = 
	`SDL_C»©eSem­hÜe
(1);

68 
uIÁ32
 
£m
 = 
	`SDL_SemV®ue
(
ourIÅutSem­hÜe
);

69 
û¼
 << "befÜSDL_C»©eTh»ad(), sem==" << 
£m
 << 
’dl
;

70 
ourTh»ad
 = 
	`SDL_C»©eTh»ad
(
th»ad
, 0);

71 
£m
 = 
	`SDL_SemV®ue
(
ourIÅutSem­hÜe
);

72 
û¼
 << "aá” SDL_C»©eTh»ad(), sem==" << 
£m
 << 
’dl
;

73 
	}
}

76 
	gS³akJ‘
::
	$th»ad
(*
d©a
) {

77 
û¼
 << "rsyÁhh»ad s·wÃd" << 
’dl
;

79 
	`¥—k
();

80 
	`u¦“p
(10);

83 
	}
}

86 
	gS³akJ‘
::
	$wr™e
(
uIÁ8
 
code
)

89 cÚ¡ *
rsyÁhPhÚes
 = 
	`xÏ‹PhÚeme
(
code
);

90 
û¼
 << "rsyÁh: \"" << 
rsyÁhPhÚes
 << "\"" << 
’dl
;

91 
Ën
 = 
	`¡¾’
(
rsyÁhPhÚes
);

93 if(
ourIÅutCouÁ
 + 
Ën
 + 1 >ğ
INPUT_BUFFER_SIZE
) {

94 
û¼
 << "phÚemeBufã¸i fuÎ, drİpšg" << 
’dl
;

98 
uIÁ32
 
£m
 = 
	`SDL_SemV®ue
(
ourIÅutSem­hÜe
);

99 
û¼
 << "wr™e(èwa™šg oÀ£m­hÜ(v®u" << 
£m
 << ")" << 
’dl
;

100 
	`SDL_SemWa™
(
ourIÅutSem­hÜe
);

101 
û¼
 << "wr™e(ègÙ sem­hÜe" << 
’dl
;

102 
i
=0; i<
Ën
; i++)

103 
phÚemeBufãr
[
ourIÅutCouÁ
++] = 
rsyÁhPhÚes
[
i
];

104 
phÚemeBufãr
[
ourIÅutCouÁ
] = '\0';

105 
û¼
 << "phÚemeBufã¸cÚš \"" << 
phÚemeBufãr
 << "\"" << 
’dl
;

106 
û¼
 << "wr™e(è»Ëasšg sem­hÜe" << 
’dl
;

107 
	`SDL_SemPo¡
(
ourIÅutSem­hÜe
);

108 
	}
}

111 
	gS³akJ‘
::
	$¥—k
()

114 
myIÅut
[
INPUT_BUFFER_SIZE
];

116 if(!
ourIÅutCouÁ
)

119 
uIÁ32
 
£m
 = 
	`SDL_SemV®ue
(
ourIÅutSem­hÜe
);

120 
û¼
 << "¥—k(èwa™šg oÀ£m­hÜ(v®u" << 
£m
 << ")" << 
’dl
;

121 
	`SDL_SemWa™
(
ourIÅutSem­hÜe
);

122 
û¼
 << "¥—k(ègÙ sem­hÜe" << 
’dl
;

126 
boŞ
 
foundS·û
 = 
çl£
;

127 
i
=0; i<
ourIÅutCouÁ
; i++)

128 ifĞ(
myIÅut
[
i
] = 
phÚemeBufãr
[i]) == ' ')

129 
foundS·û
 = 
Œue
;

131 if(
ourIÅutCouÁ
 >ğ
INPUT_BUFFER_SIZE
 - 5)

132 
foundS·û
 = 
Œue
;

134 if(
foundS·û
)

135 
ourIÅutCouÁ
 = 0;

138 
û¼
 << "¥—k(è»Ëasšg sem­hÜe" << 
’dl
;

139 
	`SDL_SemPo¡
(
ourIÅutSem­hÜe
);

141 if(
foundS·û
)

144 
	`SDL_SemWa™
(
ourCu¼’tWr™eBufãr
->
lock
);

145 
	`rsyÁh_phÚes
(
rsyÁh
, 
myIÅut
, 
	`¡¾’
(myInput));

147 
	}
}

150 cÚ¡ *
	gS³akJ‘
::
	$xÏ‹PhÚeme
(
uIÁ8
 
code
)

152 if(
code
 <= 6)

155 if(
code
 >= 128 && code <= 199)

156  
ourPhÚemeTabË
[ 
code
 - 128 ];

159 
	}
}

162 
uIÁ8
 *
	gS³akJ‘
::
	$g‘Sam¶es
(*
couÁ
) {

163 
uIÁ8
 
cÚ‹Ás
[
OUTPUT_BUFFER_SIZE
];

164 
SDL_£m
 *
lock
 = 
myCu¼’tOuutBufãr
->lock;

165 
	`SDL_SemWa™
(
lock
);

166 *
couÁ
 = 
myCu¼’tOuutBufãr
->
™ems
;

167 
i
=0; i<*
couÁ
; i++)

168 
cÚ‹Ás
[
i
] = 
myCu¼’tOuutBufãr
->contents[i];

169 
myCu¼’tOuutBufãr
->
™ems
 = 0;

170 
myCu¼’tOuutBufãr
 = myCu¼’tOuutBufãr->
Ãxt
;

171 
	`SDL_SemPo¡
(
lock
);

172  
cÚ‹Ás
;

173 
	}
}

176 
boŞ
 
	gS³akJ‘
::
	$chR—dy
()

178  
Œue
;

179 
	}
}

182 *
	gS³akJ‘
::
	$§ve_§m¶e
(*
u£r_d©a
,

183 
§m¶e
,

184 
n§mp
,

185 
rsyÁh_t
 *
rsyÁh
)

187 
ş_max
;

188 
³ak
;

189 
shÜtSamp
;

190 
uIÁ8
 
ouut
;

192 
d¬¿y_t
 *
buf
 = (d¬¿y_ˆ*è
u£r_d©a
;

193 
shÜtSamp
 = 
	`ş
(&
ş_max
, 
§m¶e
, &
³ak
);

194 
	`d¬¿y_shÜt
(
buf
, 
shÜtSamp
);

198 
d
 = 
shÜtSamp
 + 32768.0;

199 
ouut
 = (
uIÁ8
)(
d
/256.0);

200 
û¼
 << "Ouuˆ§m¶e: " << (()(
ouut
)è<< 
’dl
;

203 
ourCu¼’tWr™eBufãr
->
cÚ‹Ás
[
ourCu¼’tWr™ePos™iÚ
++] = 
ouut
;

204 
ourCu¼’tWr™eBufãr
->
™ems
 = 
ourCu¼’tWr™ePos™iÚ
;

207 if(
ourCu¼’tWr™ePos™iÚ
 =ğ
OUTPUT_BUFFER_SIZE
)

209 
	`SDL_SemWa™
(
ourCu¼’tWr™eBufãr
->
Ãxt
->
lock
);

210 
	`SDL_SemPo¡
(
ourCu¼’tWr™eBufãr
->
lock
);

211 
ourCu¼’tWr™eBufãr
 = ourCu¼’tWr™eBufãr->
Ãxt
;

212 
ourCu¼’tWr™eBufãr
->
™ems
 = 
ourCu¼’tWr™ePos™iÚ
 = 0;

214  (*è
buf
;

215 
	}
}

218 *
	gS³akJ‘
::
	$æush_§m¶es
(*
u£r_d©a
,

219 
n§mp
,

220 
rsyÁh_t
 *
rsyÁh
)

222 
d¬¿y_t
 *
buf
 = (d¬¿y_ˆ*è
u£r_d©a
;

223 
buf
->
™ems
 = 0;

224 ;
ourCu¼’tWr™ePos™iÚ
 < 
OUTPUT_BUFFER_SIZE
; ourCurrentWritePosition++)

225 
ourCu¼’tWr™eBufãr
->
cÚ‹Ás
[
ourCu¼’tWr™ePos™iÚ
] = 0;

226 
ourCu¼’tWr™ePos™iÚ
 = 0;

227 
	`SDL_SemPo¡
(
ourCu¼’tWr™eBufãr
->
lock
);

228 
ourCu¼’tWr™eBufãr
 = ourCu¼’tWr™eBufãr->
Ãxt
;

229  (*è
buf
;

230 
	}
}

233 
	gS³akJ‘
::
	$ş
(*
ş_max
, 
šput
, *
³ak
)

235 
‹mp
 = (è
šput
;

236 
isq
 = 
šput
 * input;

237 #ifdeà
PEAK


238 ià(
isq
 > *
³ak
)

239 *
³ak
 = 
isq
;

241 *
³ak
 +ğ
isq
;

243 ià(-
‹mp
 > *
ş_max
)

244 *
ş_max
 = -
‹mp
;

245 ià(
‹mp
 > *
ş_max
)

246 *
ş_max
 = 
‹mp
;

247 ià(
‹mp
 < -32767) {

248 
‹mp
 = -32767;

250 ià(
‹mp
 > 32767) {

251 
‹mp
 = 32767;

253  (
‹mp
);

254 
	}
}

269 cÚ¡ *
	gS³akJ‘
::
ourPhÚemeTabË
[] = {

	@emucore/SpeakJet.hxx

19 #ifdeà
ATARIVOX_SUPPORT


21 #iâdeà
SPEAKJET_HXX


22 
	#SPEAKJET_HXX


	)

83 
	~"b¥f.hxx
"

85 
	~<SDL.h
>

86 
	~<SDL_th»ad.h
>

87 
	~"rsyÁh/rsyÁh.h
"

89 
	gS³echBufãr
;

92 ’um { 
	mINPUT_BUFFER_SIZE
 = 128 };

93 ’um { 
	mOUTPUT_BUFFER_SIZE
 = 128 };

94 ’um { 
	mSPEECH_BUFFERS
 = 1024 };

95 
SDL_£m
 *
	gourIÅutSem­hÜe
;

96 
rsyÁh_t
 *
	grsyÁh
;

97 
d¬¿y_t
 
	grsyÁhSam¶es
;

100 
	gphÚemeBufãr
[
INPUT_BUFFER_SIZE
];

102 
uIÁ16
 
	gourIÅutCouÁ
;

105 şas 
	cS³akJ‘


107 
	mpublic
:

116 
S³akJ‘
();

118 ~
S³akJ‘
();

120 
	mpublic
:

130 
wr™e
(
uIÁ8
 
code
);

140 
uIÁ8
 *
g‘Sam¶es
(*
couÁ
);

145 
boŞ
 
chR—dy
();

147 
	m´iv©e
:

149 
¥awnTh»ad
();

154 
th»ad
(*
d©a
);

156 
	m´iv©e
:

160 
¥—k
();

162 *
§ve_§m¶e
(*
u£r_d©a
,

163 
§m¶e
,

164 
n§mp
,

165 
rsyÁh_t
 *
rsyÁh
);

167 *
æush_§m¶es
(*
u£r_d©a
,

168 
n§mp
,

169 
rsyÁh_t
 *
rsyÁh
);

171 
ş
(*
ş_max
, 
šput
, *
³ak
);

173 
	m´iv©e
:

176 
boŞ
 
ÃedP¬am‘”
;

178 cÚ¡ *
	mourPhÚemeTabË
[];

180 
SDL_Th»ad
 *
	mourTh»ad
;

182 
S³echBufãr
 *
	mmyCu¼’tOuutBufãr
;

215 
	m´iv©e
:

218 cÚ¡ *
xÏ‹PhÚeme
(
uIÁ8
 
code
);

223 
	sS³echBufãr


225 
SDL_£m
 *
	mlock
;

226 
S³echBufãr
 *
	mÃxt
;

227 
	m™ems
;

228 
uIÁ8
 
	mcÚ‹Ás
[
OUTPUT_BUFFER_SIZE
];

232 
S³echBufãr
 
	gouutBufãrs
[
SPEECH_BUFFERS
];

234 
S³echBufãr
 *
	gourCu¼’tWr™eBufãr
;

235 
uIÁ8
 
	gourCu¼’tWr™ePos™iÚ
;

	@emucore/Switches.cxx

19 
	~"Ev’t.hxx
"

20 
	~"Prİs.hxx
"

21 
	~"Sw™ches.hxx
"

24 
	gSw™ches
::
	$Sw™ches
(cÚ¡ 
Ev’t
& 
ev’t
, cÚ¡ 
Prİ”t›s
& 
´İ”t›s
)

25 : 
	`myEv’t
(
ev’t
),

26 
	$mySw™ches
(0xFF)

28 if(
´İ”t›s
.
	`g‘
(
CÚsŞe_RightDifficuÉy
) == "B")

30 
mySw™ches
 &= ~0x80;

34 
mySw™ches
 |= 0x80;

37 if(
´İ”t›s
.
	`g‘
(
CÚsŞe_LeáDifficuÉy
) == "B")

39 
mySw™ches
 &= ~0x40;

43 
mySw™ches
 |= 0x40;

46 if(
´İ”t›s
.
	`g‘
(
CÚsŞe_T–evisiÚTy³
) == "COLOR")

48 
mySw™ches
 |= 0x08;

52 
mySw™ches
 &= ~0x08;

54 
	}
}

57 
	gSw™ches
::~
	$Sw™ches
()

59 
	}
}

62 
uIÁ8
 
Sw™ches
::
	$»ad
()

64 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeCŞÜ
) != 0)

66 
mySw™ches
 |= 0x08;

68 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeBÏckWh™e
) != 0)

70 
mySw™ches
 &= ~0x08;

73 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeRightDifficuÉyA
) != 0)

75 
mySw™ches
 |= 0x80;

77 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeRightDifficuÉyB
) != 0)

79 
mySw™ches
 &= ~0x80;

82 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeLeáDifficuÉyA
) != 0)

84 
mySw™ches
 |= 0x40;

86 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeLeáDifficuÉyB
) != 0)

88 
mySw™ches
 &= ~0x40;

91 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeS–eù
) != 0)

93 
mySw™ches
 &= ~0x02;

97 
mySw™ches
 |= 0x02;

100 if(
myEv’t
.
	`g‘
(
Ev’t
::
CÚsŞeRe£t
) != 0)

102 
mySw™ches
 &= ~0x01;

106 
mySw™ches
 |= 0x01;

109  
mySw™ches
;

110 
	}
}

	@emucore/Switches.hxx

19 #iâdeà
SWITCHES_HXX


20 
	#SWITCHES_HXX


	)

22 
şass
 
	gEv’t
;

23 
şass
 
	gPrİ”t›s
;

24 
şass
 
	gSw™ches
;

26 
	~"b¥f.hxx
"

34 şas 
	cSw™ches


36 
	mpublic
:

43 
Sw™ches
(cÚ¡ 
Ev’t
& 
ev’t
, cÚ¡ 
Prİ”t›s
& 
´İ”t›s
);

48 
	mvœtu®
 ~
Sw™ches
();

50 
	mpublic
:

56 
uIÁ8
 
»ad
();

58 
	m´iv©e
:

60 cÚ¡ 
Ev’t
& 
myEv’t
;

63 
uIÁ8
 
	mmySw™ches
;

	@emucore/TIA.cxx

19 
	~<ÿs£¹
>

20 
	~<c¡dlib
>

21 
	~<c¡ršg
>

22 
	~<io¡»am
>

24 
	~"CÚsŞe.hxx
"

25 
	~"CÚŒŞ.hxx
"

26 
	~"M6502.hxx
"

27 
	~"Sy¡em.hxx
"

28 
	~"TIA.hxx
"

29 
	~"S”Ÿliz”.hxx
"

30 
	~"De£rŸliz”.hxx
"

31 
	~"S‘tšgs.hxx
"

32 
	~"Sound.hxx
"

33 
	~"GuiUts.hxx
"

35 
	#HBLANK
 68

	)

38 
	gTIA
::
	$TIA
(cÚ¡ 
CÚsŞe
& 
cÚsŞe
, 
S‘tšgs
& 
£‰šgs
)

39 : 
	`myCÚsŞe
(
cÚsŞe
),

40 
	`myS‘tšgs
(
£‰šgs
),

41 
	`mySound
(
NULL
),

42 
	`myCŞÜLossEÇbËd
(
çl£
),

43 
	`myMaximumNumb”OfSÿÆšes
(262),

44 
	`myCOLUBK
(
myCŞÜ
[0]),

45 
	`myCOLUPF
(
myCŞÜ
[1]),

46 
	`myCOLUP0
(
myCŞÜ
[2]),

47 
	$myCOLUP1
(
myCŞÜ
[3])

49 
uIÁ32
 
i
;

52 
myCu¼’tF¿meBufãr
 = 
Ãw
 
uIÁ8
[160 * 300];

53 
myP»viousF¿meBufãr
 = 
Ãw
 
uIÁ8
[160 * 300];

55 
myF¿meG»yed
 = 
çl£
;

56 
myP¬tŸlF¿meFÏg
 = 
çl£
;

58 
i
 = 0; i < 6; ++i)

59 
myB™EÇbËd
[
i
] = 
Œue
;

61 
uIÁ16
 
x
 = 0; x < 2; ++x)

63 
uIÁ16
 
’abËd
 = 0;ƒnabled < 256; ++enabled)

65 if(
’abËd
 & 
PriÜ™yB™
)

67 
uIÁ8
 
cŞÜ
 = 0;

69 if((
’abËd
 & (
myP1B™
 | 
myM1B™
)) != 0)

70 
cŞÜ
 = 3;

71 if((
’abËd
 & (
myP0B™
 | 
myM0B™
)) != 0)

72 
cŞÜ
 = 2;

73 if((
’abËd
 & 
myBLB™
) != 0)

74 
cŞÜ
 = 1;

75 if((
’abËd
 & 
myPFB™
) != 0)

76 
cŞÜ
 = 1;

78 
myPriÜ™yEncod”
[
x
][
’abËd
] = 
cŞÜ
;

82 
uIÁ8
 
cŞÜ
 = 0;

84 if((
’abËd
 & 
myBLB™
) != 0)

85 
cŞÜ
 = 1;

86 if((
’abËd
 & 
myPFB™
) != 0)

87 
cŞÜ
 = (
’abËd
 & 
ScÜeB™
è? ((
x
 == 0) ? 2 : 3) : 1;

88 if((
’abËd
 & (
myP1B™
 | 
myM1B™
)) != 0)

89 
cŞÜ
 = (color != 2) ? 3 : 2;

90 if((
’abËd
 & (
myP0B™
 | 
myM0B™
)) != 0)

91 
cŞÜ
 = 2;

93 
myPriÜ™yEncod”
[
x
][
’abËd
] = 
cŞÜ
;

98 
i
 = 0; i < 640; ++i)

99 
ourDi§bËdMaskTabË
[
i
] = 0;

102 
	`compu‹B®lMaskTabË
();

103 
	`compu‹CŞlisiÚTabË
();

104 
	`compu‹Mis¦eMaskTabË
();

105 
	`compu‹PÏy”MaskTabË
();

106 
	`compu‹PÏy”Pos™iÚRe£tWh’TabË
();

107 
	`compu‹PÏy”ReæeùTabË
();

108 
	`compu‹PÏyf›ldMaskTabË
();

111 
myF¿meCouÁ”
 = 0;

113 
myAUDV0
 = 
myAUDV1
 = 
myAUDF0
 = 
myAUDF1
 = 
myAUDC0
 = 
myAUDC1
 = 0;

114 
	}
}

117 
	gTIA
::~
	$TIA
()

119 
d–‘e
[] 
myCu¼’tF¿meBufãr
;

120 
d–‘e
[] 
myP»viousF¿meBufãr
;

121 
	}
}

124 cÚ¡ * 
	gTIA
::
	$Çme
() const

127 
	}
}

130 
	gTIA
::
	$»£t
()

133 
mySound
->
	`»£t
();

136 
myEÇbËdObjeùs
 = 0;

139 
myVSYNC
 = 0;

140 
myVBLANK
 = 0;

141 
myNUSIZ0
 = 0;

142 
myNUSIZ1
 = 0;

143 
myCOLUP0
 = 0;

144 
myCOLUP1
 = 0;

145 
myCOLUPF
 = 0;

146 
myPÏyf›ldPriÜ™yAndScÜe
 = 0;

147 
myCOLUBK
 = 0;

148 
myCTRLPF
 = 0;

149 
myREFP0
 = 
çl£
;

150 
myREFP1
 = 
çl£
;

151 
myPF
 = 0;

152 
myGRP0
 = 0;

153 
myGRP1
 = 0;

154 
myDGRP0
 = 0;

155 
myDGRP1
 = 0;

156 
myENAM0
 = 
çl£
;

157 
myENAM1
 = 
çl£
;

158 
myENABL
 = 
çl£
;

159 
myDENABL
 = 
çl£
;

160 
myHMP0
 = 0;

161 
myHMP1
 = 0;

162 
myHMM0
 = 0;

163 
myHMM1
 = 0;

164 
myHMBL
 = 0;

165 
myVDELP0
 = 
çl£
;

166 
myVDELP1
 = 
çl£
;

167 
myVDELBL
 = 
çl£
;

168 
myRESMP0
 = 
çl£
;

169 
myRESMP1
 = 
çl£
;

170 
myCŞlisiÚ
 = 0;

171 
myPOSP0
 = 0;

172 
myPOSP1
 = 0;

173 
myPOSM0
 = 0;

174 
myPOSM1
 = 0;

175 
myPOSBL
 = 0;

178 
myCu¼’tGRP0
 = 0;

179 
myCu¼’tGRP1
 = 0;

180 
myCu¼’tBLMask
 = 
ourB®lMaskTabË
[0][0];

181 
myCu¼’tM0Mask
 = 
ourMis¦eMaskTabË
[0][0][0];

182 
myCu¼’tM1Mask
 = 
ourMis¦eMaskTabË
[0][0][0];

183 
myCu¼’tP0Mask
 = 
ourPÏy”MaskTabË
[0][0][0];

184 
myCu¼’tP1Mask
 = 
ourPÏy”MaskTabË
[0][0][0];

185 
myCu¼’tPFMask
 = 
ourPÏyf›ldTabË
[0];

187 
myLa¡HMOVEClock
 = 0;

188 
myHMOVEBÏnkEÇbËd
 = 
çl£
;

189 
myM0CosmicArkMÙiÚEÇbËd
 = 
çl£
;

190 
myM0CosmicArkCouÁ”
 = 0;

192 
	`’abËB™s
(
Œue
);

194 
myDumpEÇbËd
 = 
çl£
;

195 
myDumpDi§bËdCyşe
 = 0;

197 
myAÎowHMOVEBÏnks
 =

198 (
myCÚsŞe
.
	`´İ”t›s
().
	`g‘
(
EmuÏtiÚ_HmoveBÏnks
) == "YES");

200 if(
myCÚsŞe
.
	`g‘FÜm©
().
	`com·»
(0, 3, "PAL") == 0)

202 
myCŞÜLossEÇbËd
 = 
Œue
;

203 
myMaximumNumb”OfSÿÆšes
 = 342;

207 
myCŞÜLossEÇbËd
 = 
çl£
;

208 
myMaximumNumb”OfSÿÆšes
 = 290;

212 
	`äameRe£t
();

213 
	}
}

216 
	gTIA
::
	$äameRe£t
()

219 
	`ş—rBufãrs
();

222 
myF¿mePoš‹r
 = 
myCu¼’tF¿meBufãr
;

224 
myYS¹
 = 
	`©oi
(
myCÚsŞe
.
	`´İ”t›s
().
	`g‘
(
Di¥Ïy_YS¹
).
	`c_¡r
());

225 
myHeight
 = 
	`©oi
(
myCÚsŞe
.
	`´İ”t›s
().
	`g‘
(
Di¥Ïy_Height
).
	`c_¡r
());

228 
myS¹Di¥ÏyOff£t
 = 228 * 
myYS¹
;

229 
myStİDi¥ÏyOff£t
 = 
myS¹Di¥ÏyOff£t
 + 228 * 
myHeight
;

232 
myClockWh’F¿meS¹ed
 = 
mySy¡em
->
	`cyşes
() * 3;

233 
myClockS¹Di¥Ïy
 = 
myClockWh’F¿meS¹ed
 + 
myS¹Di¥ÏyOff£t
;

234 
myClockStİDi¥Ïy
 = 
myClockWh’F¿meS¹ed
 + 
myStİDi¥ÏyOff£t
;

235 
myClockAtLa¡Upd©e
 = 
myClockWh’F¿meS¹ed
;

236 
myClocksToEndOfSÿnLše
 = 228;

237 
myVSYNCFšishClock
 = 0x7FFFFFFF;

238 
mySÿÆšeCouÁFÜLa¡F¿me
 = 0;

239 
myCu¼’tSÿÆše
 = 0;

241 
myF¿meXS¹
 = 0;

242 
myF¿meWidth
 = 160;

243 
myF¿meYS¹
 = 
	`©oi
(
myCÚsŞe
.
	`´İ”t›s
().
	`g‘
(
Di¥Ïy_YS¹
).
	`c_¡r
());

244 
myF¿meHeight
 = 
	`©oi
(
myCÚsŞe
.
	`´İ”t›s
().
	`g‘
(
Di¥Ïy_Height
).
	`c_¡r
());

248 if(
myF¿meHeight
 < 200)

251 
myF¿meHeight
 = 200;

253 
	}
}

256 
	gTIA
::
	$sy¡emCyşesRe£t
()

259 
uIÁ32
 
cyşes
 = 
mySy¡em
->
	`cyşes
();

262 
mySound
->
	`adju¡CyşeCouÁ”
(-1 * 
cyşes
);

265 
myDumpDi§bËdCyşe
 -ğ
cyşes
;

268 
uIÁ32
 
şocks
 = 
cyşes
 * 3;

271 
myClockWh’F¿meS¹ed
 -ğ
şocks
;

272 
myClockS¹Di¥Ïy
 -ğ
şocks
;

273 
myClockStİDi¥Ïy
 -ğ
şocks
;

274 
myClockAtLa¡Upd©e
 -ğ
şocks
;

275 
myVSYNCFšishClock
 -ğ
şocks
;

276 
myLa¡HMOVEClock
 -ğ
şocks
;

277 
	}
}

280 
	gTIA
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

283 
mySy¡em
 = &
sy¡em
;

285 
uIÁ16
 
shiá
 = 
mySy¡em
->
	`·geShiá
();

286 
mySy¡em
->
	`»£tCyşes
();

289 
Sy¡em
::
PageAcûss
 
acûss
;

290 
acûss
.
dœeùP“kBa£
 = 0;

291 
acûss
.
dœeùPokeBa£
 = 0;

292 
acûss
.
deviû
 = 
this
;

295 
uIÁ32
 
i
 = 0; i < 8192; i +ğ(1 << 
shiá
))

297 if((
i
 & 0x1080) == 0x0000)

299 
mySy¡em
->
	`£tPageAcûss
(
i
 >> 
shiá
, 
acûss
);

303 
	}
}

306 
boŞ
 
	gTIA
::
	$§ve
(
S”Ÿliz”
& 
out
)

308 
¡ršg
 
deviû
 = 
	`Çme
();

310 
Œy


312 
out
.
	`putSŒšg
(
deviû
);

314 
out
.
	`putIÁ
(
myClockWh’F¿meS¹ed
);

315 
out
.
	`putIÁ
(
myClockS¹Di¥Ïy
);

316 
out
.
	`putIÁ
(
myClockStİDi¥Ïy
);

317 
out
.
	`putIÁ
(
myClockAtLa¡Upd©e
);

318 
out
.
	`putIÁ
(
myClocksToEndOfSÿnLše
);

319 
out
.
	`putIÁ
(
mySÿÆšeCouÁFÜLa¡F¿me
);

320 
out
.
	`putIÁ
(
myCu¼’tSÿÆše
);

321 
out
.
	`putIÁ
(
myVSYNCFšishClock
);

323 
out
.
	`putIÁ
(
myEÇbËdObjeùs
);

325 
out
.
	`putIÁ
(
myVSYNC
);

326 
out
.
	`putIÁ
(
myVBLANK
);

327 
out
.
	`putIÁ
(
myNUSIZ0
);

328 
out
.
	`putIÁ
(
myNUSIZ1
);

330 
out
.
	`putIÁ
(
myCOLUP0
);

331 
out
.
	`putIÁ
(
myCOLUP1
);

332 
out
.
	`putIÁ
(
myCOLUPF
);

333 
out
.
	`putIÁ
(
myCOLUBK
);

335 
out
.
	`putIÁ
(
myCTRLPF
);

336 
out
.
	`putIÁ
(
myPÏyf›ldPriÜ™yAndScÜe
);

337 
out
.
	`putBoŞ
(
myREFP0
);

338 
out
.
	`putBoŞ
(
myREFP1
);

339 
out
.
	`putIÁ
(
myPF
);

340 
out
.
	`putIÁ
(
myGRP0
);

341 
out
.
	`putIÁ
(
myGRP1
);

342 
out
.
	`putIÁ
(
myDGRP0
);

343 
out
.
	`putIÁ
(
myDGRP1
);

344 
out
.
	`putBoŞ
(
myENAM0
);

345 
out
.
	`putBoŞ
(
myENAM1
);

346 
out
.
	`putBoŞ
(
myENABL
);

347 
out
.
	`putBoŞ
(
myDENABL
);

348 
out
.
	`putIÁ
(
myHMP0
);

349 
out
.
	`putIÁ
(
myHMP1
);

350 
out
.
	`putIÁ
(
myHMM0
);

351 
out
.
	`putIÁ
(
myHMM1
);

352 
out
.
	`putIÁ
(
myHMBL
);

353 
out
.
	`putBoŞ
(
myVDELP0
);

354 
out
.
	`putBoŞ
(
myVDELP1
);

355 
out
.
	`putBoŞ
(
myVDELBL
);

356 
out
.
	`putBoŞ
(
myRESMP0
);

357 
out
.
	`putBoŞ
(
myRESMP1
);

358 
out
.
	`putIÁ
(
myCŞlisiÚ
);

359 
out
.
	`putIÁ
(
myPOSP0
);

360 
out
.
	`putIÁ
(
myPOSP1
);

361 
out
.
	`putIÁ
(
myPOSM0
);

362 
out
.
	`putIÁ
(
myPOSM1
);

363 
out
.
	`putIÁ
(
myPOSBL
);

365 
out
.
	`putIÁ
(
myCu¼’tGRP0
);

366 
out
.
	`putIÁ
(
myCu¼’tGRP1
);

376 
out
.
	`putIÁ
(
myLa¡HMOVEClock
);

377 
out
.
	`putBoŞ
(
myHMOVEBÏnkEÇbËd
);

378 
out
.
	`putBoŞ
(
myM0CosmicArkMÙiÚEÇbËd
);

379 
out
.
	`putIÁ
(
myM0CosmicArkCouÁ”
);

381 
out
.
	`putBoŞ
(
myDumpEÇbËd
);

382 
out
.
	`putIÁ
(
myDumpDi§bËdCyşe
);

385 
mySound
->
	`§ve
(
out
);

387 
	`ÿtch
(*
msg
)

389 
û¼
 << 
msg
 << 
’dl
;

390  
çl£
;

392 
	`ÿtch
(...)

394 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
deviû
 << 
’dl
;

395  
çl£
;

398  
Œue
;

399 
	}
}

402 
boŞ
 
	gTIA
::
	$lßd
(
De£rŸliz”
& 
š
)

404 
¡ršg
 
deviû
 = 
	`Çme
();

406 
Œy


408 if(
š
.
	`g‘SŒšg
(è!ğ
deviû
)

409  
çl£
;

411 
myClockWh’F¿meS¹ed
 = (
IÁ32
è
š
.
	`g‘IÁ
();

412 
myClockS¹Di¥Ïy
 = (
IÁ32
è
š
.
	`g‘IÁ
();

413 
myClockStİDi¥Ïy
 = (
IÁ32
è
š
.
	`g‘IÁ
();

414 
myClockAtLa¡Upd©e
 = (
IÁ32
è
š
.
	`g‘IÁ
();

415 
myClocksToEndOfSÿnLše
 = (
IÁ32
è
š
.
	`g‘IÁ
();

416 
mySÿÆšeCouÁFÜLa¡F¿me
 = (
IÁ32
è
š
.
	`g‘IÁ
();

417 
myCu¼’tSÿÆše
 = (
IÁ32
è
š
.
	`g‘IÁ
();

418 
myVSYNCFšishClock
 = (
IÁ32
è
š
.
	`g‘IÁ
();

420 
myEÇbËdObjeùs
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

422 
myVSYNC
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

423 
myVBLANK
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

424 
myNUSIZ0
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

425 
myNUSIZ1
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

427 
myCOLUP0
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

428 
myCOLUP1
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

429 
myCOLUPF
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

430 
myCOLUBK
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

432 
myCTRLPF
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

433 
myPÏyf›ldPriÜ™yAndScÜe
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

434 
myREFP0
 = 
š
.
	`g‘BoŞ
();

435 
myREFP1
 = 
š
.
	`g‘BoŞ
();

436 
myPF
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

437 
myGRP0
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

438 
myGRP1
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

439 
myDGRP0
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

440 
myDGRP1
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

441 
myENAM0
 = 
š
.
	`g‘BoŞ
();

442 
myENAM1
 = 
š
.
	`g‘BoŞ
();

443 
myENABL
 = 
š
.
	`g‘BoŞ
();

444 
myDENABL
 = 
š
.
	`g‘BoŞ
();

445 
myHMP0
 = (
IÁ8
è
š
.
	`g‘IÁ
();

446 
myHMP1
 = (
IÁ8
è
š
.
	`g‘IÁ
();

447 
myHMM0
 = (
IÁ8
è
š
.
	`g‘IÁ
();

448 
myHMM1
 = (
IÁ8
è
š
.
	`g‘IÁ
();

449 
myHMBL
 = (
IÁ8
è
š
.
	`g‘IÁ
();

450 
myVDELP0
 = 
š
.
	`g‘BoŞ
();

451 
myVDELP1
 = 
š
.
	`g‘BoŞ
();

452 
myVDELBL
 = 
š
.
	`g‘BoŞ
();

453 
myRESMP0
 = 
š
.
	`g‘BoŞ
();

454 
myRESMP1
 = 
š
.
	`g‘BoŞ
();

455 
myCŞlisiÚ
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

456 
myPOSP0
 = (
IÁ16
è
š
.
	`g‘IÁ
();

457 
myPOSP1
 = (
IÁ16
è
š
.
	`g‘IÁ
();

458 
myPOSM0
 = (
IÁ16
è
š
.
	`g‘IÁ
();

459 
myPOSM1
 = (
IÁ16
è
š
.
	`g‘IÁ
();

460 
myPOSBL
 = (
IÁ16
è
š
.
	`g‘IÁ
();

462 
myCu¼’tGRP0
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

463 
myCu¼’tGRP1
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

473 
myLa¡HMOVEClock
 = (
IÁ32
è
š
.
	`g‘IÁ
();

474 
myHMOVEBÏnkEÇbËd
 = 
š
.
	`g‘BoŞ
();

475 
myM0CosmicArkMÙiÚEÇbËd
 = 
š
.
	`g‘BoŞ
();

476 
myM0CosmicArkCouÁ”
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

478 
myDumpEÇbËd
 = 
š
.
	`g‘BoŞ
();

479 
myDumpDi§bËdCyşe
 = (
IÁ32
è
š
.
	`g‘IÁ
();

482 
mySound
->
	`lßd
(
š
);

485 
	`’abËB™s
(
Œue
);

487 
	`ÿtch
(*
msg
)

489 
û¼
 << 
msg
 << 
’dl
;

490  
çl£
;

492 
	`ÿtch
(...)

494 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
deviû
 << 
’dl
;

495  
çl£
;

498  
Œue
;

499 
	}
}

502 
	gTIA
::
	$upd©e
()

505 if(!
myP¬tŸlF¿meFÏg
)

506 
	`¡¬tF¿me
();

511 
myP¬tŸlF¿meFÏg
 = 
Œue
;

514 
mySy¡em
->
	`m6502
().
	`execu‹
(25000);

518 
uIÁ32
 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

519 
myCu¼’tSÿÆše
 = 
tÙ®Clocks
 / 228;

521 if(
myP¬tŸlF¿meFÏg
) {

523 if(!
myF¿meG»yed
è
	`g»yOutF¿me
();

524 
myF¿meG»yed
 = 
Œue
;

526 
	`’dF¿me
();

528 
	}
}

531 
šlše
 
	gTIA
::
	$¡¬tF¿me
()

534 
uIÁ8
* 
tmp
 = 
myCu¼’tF¿meBufãr
;

535 
myCu¼’tF¿meBufãr
 = 
myP»viousF¿meBufãr
;

536 
myP»viousF¿meBufãr
 = 
tmp
;

542 
uIÁ32
 
şocks
 = ((
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
) % 228;

545 
mySy¡em
->
	`»£tCyşes
();

548 
myClockWh’F¿meS¹ed
 = -1 * 
şocks
;

549 
myClockS¹Di¥Ïy
 = 
myClockWh’F¿meS¹ed
 + 
myS¹Di¥ÏyOff£t
;

550 
myClockStİDi¥Ïy
 = 
myClockWh’F¿meS¹ed
 + 
myStİDi¥ÏyOff£t
;

551 
myClockAtLa¡Upd©e
 = 
myClockS¹Di¥Ïy
;

552 
myClocksToEndOfSÿnLše
 = 228;

555 
myF¿mePoš‹r
 = 
myCu¼’tF¿meBufãr
;

559 if(
myCŞÜLossEÇbËd
)

561 if(
mySÿÆšeCouÁFÜLa¡F¿me
 & 0x01)

563 
myCOLUP0
 |= 0x01010101;

564 
myCOLUP1
 |= 0x01010101;

565 
myCOLUPF
 |= 0x01010101;

566 
myCOLUBK
 |= 0x01010101;

570 
myCOLUP0
 &= 0xfefefefe;

571 
myCOLUP1
 &= 0xfefefefe;

572 
myCOLUPF
 &= 0xfefefefe;

573 
myCOLUBK
 &= 0xfefefefe;

577 
myF¿meG»yed
 = 
çl£
;

578 
	}
}

581 
šlše
 
	gTIA
::
	$’dF¿me
()

585 
mySÿÆšeCouÁFÜLa¡F¿me
 = 
myCu¼’tSÿÆše
;

588 
myF¿meCouÁ”
++;

590 
myF¿meG»yed
 = 
çl£
;

591 
	}
}

593 #ifdeà
DEBUGGER_SUPPORT


595 
	gTIA
::
	$upd©eSÿÆše
()

598 if(!
myP¬tŸlF¿meFÏg
) {

599 
	`¡¬tF¿me
();

603 if(!
myF¿meG»yed
è
	`g»yOutF¿me
();

604 
myF¿meG»yed
 = 
Œue
;

607 
myP¬tŸlF¿meFÏg
 = 
Œue
;

609 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

610 
’dClock
 = ((
tÙ®Clocks
 + 228) / 228) * 228;

612 
şock
;

614 
mySy¡em
->
	`m6502
().
	`execu‹
(1);

615 
şock
 = 
mySy¡em
->
	`cyşes
() * 3;

616 
	`upd©eF¿me
(
şock
);

617 } 
şock
 < 
’dClock
);

619 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

620 
myCu¼’tSÿÆše
 = 
tÙ®Clocks
 / 228;

623 if(!
myP¬tŸlF¿meFÏg
)

624 
	`’dF¿me
();

625 
	}
}

628 
	gTIA
::
	$upd©eSÿÆšeByS‹p
()

631 if(!
myP¬tŸlF¿meFÏg
) {

632 
	`¡¬tF¿me
();

636 if(!
myF¿meG»yed
è
	`g»yOutF¿me
();

637 
myF¿meG»yed
 = 
Œue
;

640 
myP¬tŸlF¿meFÏg
 = 
Œue
;

642 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

645 
mySy¡em
->
	`m6502
().
	`execu‹
(1);

646 
	`upd©eF¿me
(
mySy¡em
->
	`cyşes
() * 3);

648 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

649 
myCu¼’tSÿÆše
 = 
tÙ®Clocks
 / 228;

652 if(!
myP¬tŸlF¿meFÏg
)

653 
	`’dF¿me
();

654 
	}
}

657 
	gTIA
::
	$upd©eSÿÆšeByT¿û
(
rg‘
)

660 if(!
myP¬tŸlF¿meFÏg
) {

661 
	`¡¬tF¿me
();

665 if(!
myF¿meG»yed
è
	`g»yOutF¿me
();

666 
myF¿meG»yed
 = 
Œue
;

669 
myP¬tŸlF¿meFÏg
 = 
Œue
;

671 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

673 
mySy¡em
->
	`m6502
().
	`g‘PC
(è!ğ
rg‘
)

675 
mySy¡em
->
	`m6502
().
	`execu‹
(1);

676 
	`upd©eF¿me
(
mySy¡em
->
	`cyşes
() * 3);

679 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

680 
myCu¼’tSÿÆše
 = 
tÙ®Clocks
 / 228;

683 if(!
myP¬tŸlF¿meFÏg
)

684 
	`’dF¿me
();

685 
	}
}

689 
uIÁ32
 
	gTIA
::
	$width
() const

691  
myF¿meWidth
;

692 
	}
}

695 
uIÁ32
 
	gTIA
::
	$height
() const

697  
myF¿meHeight
;

698 
	}
}

701 
uIÁ32
 
	gTIA
::
	$sÿÆšes
() const

704 
uIÁ32
 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

705  
tÙ®Clocks
/228;

706 
	}
}

709 
uIÁ32
 
	gTIA
::
	$şocksThisLše
() const

712 
uIÁ32
 
tÙ®Clocks
 = (
mySy¡em
->
	`cyşes
(è* 3è- 
myClockWh’F¿meS¹ed
;

713  
tÙ®Clocks
%228;

714 
	}
}

717 
	gTIA
::
	$£tSound
(
Sound
& 
sound
)

719 
mySound
 = &
sound
;

720 
	}
}

723 
	gTIA
::
	$compu‹B®lMaskTabË
()

726 
IÁ32
 
size
 = 0; size < 4; ++size)

728 
IÁ32
 
x
;

731 
x
 = 0; x < 160; ++x)

733 
ourB®lMaskTabË
[0][
size
][
x
] = 
çl£
;

737 
x
 = 0; x < 160 + 8; ++x)

739 if((
x
 >ğ0è&& (x < (1 << 
size
)))

741 
ourB®lMaskTabË
[0][
size
][
x
 % 160] = 
Œue
;

746 
x
 = 0; x < 160; ++x)

748 
ourB®lMaskTabË
[0][
size
][
x
 + 160] = ourBallMaskTable[0][size][x];

753 
uIÁ32
 
®ign
 = 1;‡lign < 4; ++align)

755 
uIÁ32
 
size
 = 0; size < 4; ++size)

757 
uIÁ32
 
x
 = 0; x < 320; ++x)

759 
ourB®lMaskTabË
[
®ign
][
size
][
x
] =

760 
ourB®lMaskTabË
[0][
size
][(
x
 + 320 - 
®ign
) % 320];

764 
	}
}

767 
	gTIA
::
	$compu‹CŞlisiÚTabË
()

769 
uIÁ8
 
i
 = 0; i < 64; ++i)

771 
ourCŞlisiÚTabË
[
i
] = 0;

773 if((
i
 & 
myM0B™
è&& (˜& 
myP1B™
))

774 
ourCŞlisiÚTabË
[
i
] |= 0x0001;

776 if((
i
 & 
myM0B™
è&& (˜& 
myP0B™
))

777 
ourCŞlisiÚTabË
[
i
] |= 0x0002;

779 if((
i
 & 
myM1B™
è&& (˜& 
myP0B™
))

780 
ourCŞlisiÚTabË
[
i
] |= 0x0004;

782 if((
i
 & 
myM1B™
è&& (˜& 
myP1B™
))

783 
ourCŞlisiÚTabË
[
i
] |= 0x0008;

785 if((
i
 & 
myP0B™
è&& (˜& 
myPFB™
))

786 
ourCŞlisiÚTabË
[
i
] |= 0x0010;

788 if((
i
 & 
myP0B™
è&& (˜& 
myBLB™
))

789 
ourCŞlisiÚTabË
[
i
] |= 0x0020;

791 if((
i
 & 
myP1B™
è&& (˜& 
myPFB™
))

792 
ourCŞlisiÚTabË
[
i
] |= 0x0040;

794 if((
i
 & 
myP1B™
è&& (˜& 
myBLB™
))

795 
ourCŞlisiÚTabË
[
i
] |= 0x0080;

797 if((
i
 & 
myM0B™
è&& (˜& 
myPFB™
))

798 
ourCŞlisiÚTabË
[
i
] |= 0x0100;

800 if((
i
 & 
myM0B™
è&& (˜& 
myBLB™
))

801 
ourCŞlisiÚTabË
[
i
] |= 0x0200;

803 if((
i
 & 
myM1B™
è&& (˜& 
myPFB™
))

804 
ourCŞlisiÚTabË
[
i
] |= 0x0400;

806 if((
i
 & 
myM1B™
è&& (˜& 
myBLB™
))

807 
ourCŞlisiÚTabË
[
i
] |= 0x0800;

809 if((
i
 & 
myBLB™
è&& (˜& 
myPFB™
))

810 
ourCŞlisiÚTabË
[
i
] |= 0x1000;

812 if((
i
 & 
myP0B™
è&& (˜& 
myP1B™
))

813 
ourCŞlisiÚTabË
[
i
] |= 0x2000;

815 if((
i
 & 
myM0B™
è&& (˜& 
myM1B™
))

816 
ourCŞlisiÚTabË
[
i
] |= 0x4000;

818 
	}
}

821 
	gTIA
::
	$compu‹Mis¦eMaskTabË
()

824 
IÁ32
 
x
, 
size
, 
numb”
;

827 
numb”
 = 0;‚umber < 8; ++number)

828 
size
 = 0; size < 4; ++size)

829 
x
 = 0; x < 160; ++x)

830 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
] = 
çl£
;

832 
numb”
 = 0;‚umber < 8; ++number)

834 
size
 = 0; size < 4; ++size)

836 
x
 = 0; x < 160 + 72; ++x)

839 if((
numb”
 == 0x00) || (number == 0x05) || (number == 0x07))

841 if((
x
 >ğ0è&& (x < (1 << 
size
)))

842 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

845 if(
numb”
 == 0x01)

847 if((
x
 >ğ0è&& (x < (1 << 
size
)))

848 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

849 if(((
x
 - 16è>ğ0è&& ((x - 16è< (1 << 
size
)))

850 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

853 if(
numb”
 == 0x02)

855 if((
x
 >ğ0è&& (x < (1 << 
size
)))

856 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

857 if(((
x
 - 32è>ğ0è&& ((x - 32è< (1 << 
size
)))

858 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

861 if(
numb”
 == 0x03)

863 if((
x
 >ğ0è&& (x < (1 << 
size
)))

864 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

865 if(((
x
 - 16è>ğ0è&& ((x - 16è< (1 << 
size
)))

866 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

867 if(((
x
 - 32è>ğ0è&& ((x - 32è< (1 << 
size
)))

868 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

871 if(
numb”
 == 0x04)

873 if((
x
 >ğ0è&& (x < (1 << 
size
)))

874 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

875 if(((
x
 - 64è>ğ0è&& ((x - 64è< (1 << 
size
)))

876 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

879 if(
numb”
 == 0x06)

881 if((
x
 >ğ0è&& (x < (1 << 
size
)))

882 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

883 if(((
x
 - 32è>ğ0è&& ((x - 32è< (1 << 
size
)))

884 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

885 if(((
x
 - 64è>ğ0è&& ((x - 64è< (1 << 
size
)))

886 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 % 160] = 
Œue
;

891 
x
 = 0; x < 160; ++x)

892 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
 + 160] =

893 
ourMis¦eMaskTabË
[0][
numb”
][
size
][
x
];

898 
uIÁ32
 
®ign
 = 1;‡lign < 4; ++align)

900 
numb”
 = 0;‚umber < 8; ++number)

902 
size
 = 0; size < 4; ++size)

904 
x
 = 0; x < 320; ++x)

906 
ourMis¦eMaskTabË
[
®ign
][
numb”
][
size
][
x
] =

907 
ourMis¦eMaskTabË
[0][
numb”
][
size
][(
x
 + 320 - 
®ign
) % 320];

912 
	}
}

915 
	gTIA
::
	$compu‹PÏy”MaskTabË
()

918 
IÁ32
 
x
, 
’abË
, 
mode
;

921 
’abË
 = 0;ƒnable < 2; ++enable)

922 
mode
 = 0; mode < 8; ++mode)

923 
x
 = 0; x < 160; ++x)

924 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
] = 0x00;

927 
’abË
 = 0;ƒnable < 2; ++enable)

929 
mode
 = 0; mode < 8; ++mode)

931 
x
 = 0; x < 160 + 72; ++x)

933 if(
mode
 == 0x00)

935 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

936 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

938 if(
mode
 == 0x01)

940 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

941 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

942 if(((
x
 - 16) >= 0) && ((x - 16) < 8))

943 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 16);

945 if(
mode
 == 0x02)

947 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

948 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

949 if(((
x
 - 32) >= 0) && ((x - 32) < 8))

950 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 32);

952 if(
mode
 == 0x03)

954 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

955 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

956 if(((
x
 - 16) >= 0) && ((x - 16) < 8))

957 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 16);

958 if(((
x
 - 32) >= 0) && ((x - 32) < 8))

959 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 32);

961 if(
mode
 == 0x04)

963 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

964 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

965 if(((
x
 - 64) >= 0) && ((x - 64) < 8))

966 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 64);

968 if(
mode
 == 0x05)

972 if((
’abË
 =ğ0è&& (
x
 > 0) && (x <= 16))

973 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> ((x - 1)/2);

975 if(
mode
 == 0x06)

977 if((
’abË
 =ğ0è&& (
x
 >= 0) && (x < 8))

978 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> x;

979 if(((
x
 - 32) >= 0) && ((x - 32) < 8))

980 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 32);

981 if(((
x
 - 64) >= 0) && ((x - 64) < 8))

982 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> (x - 64);

984 if(
mode
 == 0x07)

988 if((
’abË
 =ğ0è&& (
x
 > 0) && (x <= 32))

989 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 % 160] = 0x80 >> ((x - 1)/4);

994 
x
 = 0; x < 160; ++x)

996 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
 + 160] =

997 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][
x
];

1003 
uIÁ32
 
®ign
 = 1;‡lign < 4; ++align)

1005 
’abË
 = 0;ƒnable < 2; ++enable)

1007 
mode
 = 0; mode < 8; ++mode)

1009 
x
 = 0; x < 320; ++x)

1011 
ourPÏy”MaskTabË
[
®ign
][
’abË
][
mode
][
x
] =

1012 
ourPÏy”MaskTabË
[0][
’abË
][
mode
][(
x
 + 320 - 
®ign
) % 320];

1017 
	}
}

1020 
	gTIA
::
	$compu‹PÏy”Pos™iÚRe£tWh’TabË
()

1022 
uIÁ32
 
mode
, 
Şdx
, 
Ãwx
;

1029 
mode
 = 0; mode < 8; ++mode)

1031 
Şdx
 = 0; oldx < 160; ++oldx)

1034 
Ãwx
 = 0;‚ewx < 160; ++newx)

1036 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
] = 0;

1040 
Ãwx
 = 0;‚ewx < 160 + 72 + 5; ++newx)

1042 if(
mode
 == 0x00)

1044 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1045 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1047 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1048 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1050 if(
mode
 == 0x01)

1052 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1053 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1054 if((
Ãwx
 >ğ(
Şdx
 + 16)) && (newx < (oldx + 16 + 4)))

1055 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1057 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1058 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1059 if((
Ãwx
 >ğ
Şdx
 + 16 + 4) && (newx < (oldx + 16 + 4 + 8)))

1060 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1062 if(
mode
 == 0x02)

1064 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1065 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1066 if((
Ãwx
 >ğ(
Şdx
 + 32)) && (newx < (oldx + 32 + 4)))

1067 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1069 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1070 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1071 if((
Ãwx
 >ğ
Şdx
 + 32 + 4) && (newx < (oldx + 32 + 4 + 8)))

1072 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1074 if(
mode
 == 0x03)

1076 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1077 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1078 if((
Ãwx
 >ğ(
Şdx
 + 16)) && (newx < (oldx + 16 + 4)))

1079 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1080 if((
Ãwx
 >ğ(
Şdx
 + 32)) && (newx < (oldx + 32 + 4)))

1081 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1083 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1084 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1085 if((
Ãwx
 >ğ
Şdx
 + 16 + 4) && (newx < (oldx + 16 + 4 + 8)))

1086 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1087 if((
Ãwx
 >ğ
Şdx
 + 32 + 4) && (newx < (oldx + 32 + 4 + 8)))

1088 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1090 if(
mode
 == 0x04)

1092 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1093 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1094 if((
Ãwx
 >ğ(
Şdx
 + 64)) && (newx < (oldx + 64 + 4)))

1095 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1097 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1098 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1099 if((
Ãwx
 >ğ
Şdx
 + 64 + 4) && (newx < (oldx + 64 + 4 + 8)))

1100 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1102 if(
mode
 == 0x05)

1104 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1105 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1107 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 16)))

1108 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1110 if(
mode
 == 0x06)

1112 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1113 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1114 if((
Ãwx
 >ğ(
Şdx
 + 32)) && (newx < (oldx + 32 + 4)))

1115 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1116 if((
Ãwx
 >ğ(
Şdx
 + 64)) && (newx < (oldx + 64 + 4)))

1117 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1119 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 8)))

1120 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1121 if((
Ãwx
 >ğ
Şdx
 + 32 + 4) && (newx < (oldx + 32 + 4 + 8)))

1122 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1123 if((
Ãwx
 >ğ
Şdx
 + 64 + 4) && (newx < (oldx + 64 + 4 + 8)))

1124 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1126 if(
mode
 == 0x07)

1128 if((
Ãwx
 >ğ
Şdx
) && (newx < (oldx + 4)))

1129 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = -1;

1131 if((
Ãwx
 >ğ
Şdx
 + 4) && (newx < (oldx + 4 + 32)))

1132 
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
 % 160] = 1;

1137 
uIÁ32
 
s1
 = 0, 
s2
 = 0;

1138 
Ãwx
 = 0;‚ewx < 160; ++newx)

1140 if(
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
] == -1)

1141 ++
s1
;

1142 if(
ourPÏy”Pos™iÚRe£tWh’TabË
[
mode
][
Şdx
][
Ãwx
] == 1)

1143 ++
s2
;

1145 
	`as£¹
((
s1
 % 4 =ğ0è&& (
s2
 % 8 == 0));

1148 
	}
}

1151 
	gTIA
::
	$compu‹PÏy”ReæeùTabË
()

1153 
uIÁ16
 
i
 = 0; i < 256; ++i)

1155 
uIÁ8
 
r
 = 0;

1157 
uIÁ16
 
t
 = 1; <= 128; *= 2)

1159 
r
 = (¸<< 1è| ((
i
 & 
t
) ? 0x01 : 0x00);

1162 
ourPÏy”ReæeùTabË
[
i
] = 
r
;

1164 
	}
}

1167 
	gTIA
::
	$compu‹PÏyf›ldMaskTabË
()

1169 
IÁ32
 
x
;

1172 
x
 = 0; x < 160; ++x)

1174 if(
x
 < 16)

1175 
ourPÏyf›ldTabË
[0][
x
] = 0x00001 << (x / 4);

1176 if(
x
 < 48)

1177 
ourPÏyf›ldTabË
[0][
x
] = 0x00800 >> ((x - 16) / 4);

1178 if(
x
 < 80)

1179 
ourPÏyf›ldTabË
[0][
x
] = 0x01000 << ((x - 48) / 4);

1180 if(
x
 < 96)

1181 
ourPÏyf›ldTabË
[0][
x
] = 0x00001 << ((x - 80) / 4);

1182 if(
x
 < 128)

1183 
ourPÏyf›ldTabË
[0][
x
] = 0x00800 >> ((x - 96) / 4);

1184 if(
x
 < 160)

1185 
ourPÏyf›ldTabË
[0][
x
] = 0x01000 << ((x - 128) / 4);

1189 
x
 = 0; x < 160; ++x)

1191 if(
x
 < 16)

1192 
ourPÏyf›ldTabË
[1][
x
] = 0x00001 << (x / 4);

1193 if(
x
 < 48)

1194 
ourPÏyf›ldTabË
[1][
x
] = 0x00800 >> ((x - 16) / 4);

1195 if(
x
 < 80)

1196 
ourPÏyf›ldTabË
[1][
x
] = 0x01000 << ((x - 48) / 4);

1197 if(
x
 < 112)

1198 
ourPÏyf›ldTabË
[1][
x
] = 0x80000 >> ((x - 80) / 4);

1199 if(
x
 < 144)

1200 
ourPÏyf›ldTabË
[1][
x
] = 0x00010 << ((x - 112) / 4);

1201 if(
x
 < 160)

1202 
ourPÏyf›ldTabË
[1][
x
] = 0x00008 >> ((x - 144) / 4);

1204 
	}
}

1207 
šlše
 
	gTIA
::
	$upd©eF¿meSÿÆše
(
uIÁ32
 
şocksToUpd©e
, uIÁ32 
hpos
)

1210 
uIÁ8
* 
’dšg
 = 
myF¿mePoš‹r
 + 
şocksToUpd©e
;

1213 if(
myVBLANK
 & 0x02)

1215 
	`mem£t
(
myF¿mePoš‹r
, 0, 
şocksToUpd©e
);

1220 
myEÇbËdObjeùs
 | 
myPÏyf›ldPriÜ™yAndScÜe
)

1224 0x00 | 
ScÜeB™
:

1225 0x00 | 
PriÜ™yB™
:

1226 0x00 | 
PriÜ™yB™
 | 
ScÜeB™
:

1228 
	`mem£t
(
myF¿mePoš‹r
, 
myCOLUBK
, 
şocksToUpd©e
);

1233 
myPFB™
:

1234 
myPFB™
 | 
PriÜ™yB™
:

1236 
uIÁ32
* 
mask
 = &
myCu¼’tPFMask
[
hpos
];

1239 ; ((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& (myF¿mePoš‹¸< 
’dšg
);

1240 ++
myF¿mePoš‹r
, ++
mask
)

1242 *
myF¿mePoš‹r
 = (
myPF
 & *
mask
è? 
myCOLUPF
 : 
myCOLUBK
;

1246 ; 
myF¿mePoš‹r
 < 
’dšg
; myF¿mePoš‹¸+ğ4, 
mask
 += 4)

1248 *((
uIÁ32
*)
myF¿mePoš‹r
èğ(
myPF
 & *
mask
è? 
myCOLUPF
 : 
myCOLUBK
;

1254 
myPFB™
 | 
ScÜeB™
:

1255 
myPFB™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1257 
uIÁ32
* 
mask
 = &
myCu¼’tPFMask
[
hpos
];

1260 ; ((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& (myF¿mePoš‹¸< 
’dšg
);

1261 ++
myF¿mePoš‹r
, ++
mask
, ++
hpos
)

1263 *
myF¿mePoš‹r
 = (
myPF
 & *
mask
) ?

1264 (
hpos
 < 80 ? 
myCOLUP0
 : 
myCOLUP1
è: 
myCOLUBK
;

1268 ; 
myF¿mePoš‹r
 < 
’dšg
;

1269 
myF¿mePoš‹r
 +ğ4, 
mask
 +ğ4, 
hpos
 += 4)

1271 *((
uIÁ32
*)
myF¿mePoš‹r
èğ(
myPF
 & *
mask
) ?

1272 (
hpos
 < 80 ? 
myCOLUP0
 : 
myCOLUP1
è: 
myCOLUBK
;

1278 
myP0B™
:

1279 
myP0B™
 | 
ScÜeB™
:

1280 
myP0B™
 | 
PriÜ™yB™
:

1281 
myP0B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1283 
uIÁ8
* 
mP0
 = &
myCu¼’tP0Mask
[
hpos
];

1285 
myF¿mePoš‹r
 < 
’dšg
)

1287 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP0
)

1289 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1290 
mP0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1294 *
myF¿mePoš‹r
 = (
myCu¼’tGRP0
 & *
mP0
è? 
myCOLUP0
 : 
myCOLUBK
;

1295 ++
mP0
; ++
myF¿mePoš‹r
;

1302 
myP1B™
:

1303 
myP1B™
 | 
ScÜeB™
:

1304 
myP1B™
 | 
PriÜ™yB™
:

1305 
myP1B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1307 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1309 
myF¿mePoš‹r
 < 
’dšg
)

1311 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP1
)

1313 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1314 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1318 *
myF¿mePoš‹r
 = (
myCu¼’tGRP1
 & *
mP1
è? 
myCOLUP1
 : 
myCOLUBK
;

1319 ++
mP1
; ++
myF¿mePoš‹r
;

1326 
myP0B™
 | 
myP1B™
:

1327 
myP0B™
 | 
myP1B™
 | 
ScÜeB™
:

1328 
myP0B™
 | 
myP1B™
 | 
PriÜ™yB™
:

1329 
myP0B™
 | 
myP1B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1331 
uIÁ8
* 
mP0
 = &
myCu¼’tP0Mask
[
hpos
];

1332 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1334 
myF¿mePoš‹r
 < 
’dšg
)

1336 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP0
 &&

1337 !*(
uIÁ32
*)
mP1
)

1339 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1340 
mP0
 +ğ4; 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1344 *
myF¿mePoš‹r
 = (
myCu¼’tGRP0
 & *
mP0
) ?

1345 
myCOLUP0
 : ((
myCu¼’tGRP1
 & *
mP1
è? 
myCOLUP1
 : 
myCOLUBK
);

1347 if((
myCu¼’tGRP0
 & *
mP0
è&& (
myCu¼’tGRP1
 & *
mP1
))

1348 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myP0B™
 | 
myP1B™
];

1350 ++
mP0
; ++
mP1
; ++
myF¿mePoš‹r
;

1357 
myM0B™
:

1358 
myM0B™
 | 
ScÜeB™
:

1359 
myM0B™
 | 
PriÜ™yB™
:

1360 
myM0B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1362 
uIÁ8
* 
mM0
 = &
myCu¼’tM0Mask
[
hpos
];

1364 
myF¿mePoš‹r
 < 
’dšg
)

1366 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mM0
)

1368 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1369 
mM0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1373 *
myF¿mePoš‹r
 = *
mM0
 ? 
myCOLUP0
 : 
myCOLUBK
;

1374 ++
mM0
; ++
myF¿mePoš‹r
;

1381 
myM1B™
:

1382 
myM1B™
 | 
ScÜeB™
:

1383 
myM1B™
 | 
PriÜ™yB™
:

1384 
myM1B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1386 
uIÁ8
* 
mM1
 = &
myCu¼’tM1Mask
[
hpos
];

1388 
myF¿mePoš‹r
 < 
’dšg
)

1390 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mM1
)

1392 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1393 
mM1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1397 *
myF¿mePoš‹r
 = *
mM1
 ? 
myCOLUP1
 : 
myCOLUBK
;

1398 ++
mM1
; ++
myF¿mePoš‹r
;

1405 
myBLB™
:

1406 
myBLB™
 | 
ScÜeB™
:

1407 
myBLB™
 | 
PriÜ™yB™
:

1408 
myBLB™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1410 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1412 
myF¿mePoš‹r
 < 
’dšg
)

1414 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
)

1416 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1417 
mBL
 +ğ4; 
myF¿mePoš‹r
 += 4;

1421 *
myF¿mePoš‹r
 = *
mBL
 ? 
myCOLUPF
 : 
myCOLUBK
;

1422 ++
mBL
; ++
myF¿mePoš‹r
;

1429 
myM0B™
 | 
myM1B™
:

1430 
myM0B™
 | 
myM1B™
 | 
ScÜeB™
:

1431 
myM0B™
 | 
myM1B™
 | 
PriÜ™yB™
:

1432 
myM0B™
 | 
myM1B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1434 
uIÁ8
* 
mM0
 = &
myCu¼’tM0Mask
[
hpos
];

1435 
uIÁ8
* 
mM1
 = &
myCu¼’tM1Mask
[
hpos
];

1437 
myF¿mePoš‹r
 < 
’dšg
)

1439 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mM0
 && !*(uIÁ32*)
mM1
)

1441 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1442 
mM0
 +ğ4; 
mM1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1446 *
myF¿mePoš‹r
 = *
mM0
 ? 
myCOLUP0
 : (*
mM1
 ? 
myCOLUP1
 : 
myCOLUBK
);

1448 if(*
mM0
 && *
mM1
)

1449 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myM0B™
 | 
myM1B™
];

1451 ++
mM0
; ++
mM1
; ++
myF¿mePoš‹r
;

1458 
myBLB™
 | 
myM0B™
:

1459 
myBLB™
 | 
myM0B™
 | 
ScÜeB™
:

1461 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1462 
uIÁ8
* 
mM0
 = &
myCu¼’tM0Mask
[
hpos
];

1464 
myF¿mePoš‹r
 < 
’dšg
)

1466 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
 && !*(uIÁ32*)
mM0
)

1468 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1469 
mBL
 +ğ4; 
mM0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1473 *
myF¿mePoš‹r
 = (*
mM0
 ? 
myCOLUP0
 : (*
mBL
 ? 
myCOLUPF
 : 
myCOLUBK
));

1475 if(*
mBL
 && *
mM0
)

1476 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myM0B™
];

1478 ++
mBL
; ++
mM0
; ++
myF¿mePoš‹r
;

1485 
myBLB™
 | 
myM0B™
 | 
PriÜ™yB™
:

1486 
myBLB™
 | 
myM0B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1488 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1489 
uIÁ8
* 
mM0
 = &
myCu¼’tM0Mask
[
hpos
];

1491 
myF¿mePoš‹r
 < 
’dšg
)

1493 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
 && !*(uIÁ32*)
mM0
)

1495 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1496 
mBL
 +ğ4; 
mM0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1500 *
myF¿mePoš‹r
 = (*
mBL
 ? 
myCOLUPF
 : (*
mM0
 ? 
myCOLUP0
 : 
myCOLUBK
));

1502 if(*
mBL
 && *
mM0
)

1503 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myM0B™
];

1505 ++
mBL
; ++
mM0
; ++
myF¿mePoš‹r
;

1512 
myBLB™
 | 
myM1B™
:

1513 
myBLB™
 | 
myM1B™
 | 
ScÜeB™
:

1515 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1516 
uIÁ8
* 
mM1
 = &
myCu¼’tM1Mask
[
hpos
];

1518 
myF¿mePoš‹r
 < 
’dšg
)

1520 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
 &&

1521 !*(
uIÁ32
*)
mM1
)

1523 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1524 
mBL
 +ğ4; 
mM1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1528 *
myF¿mePoš‹r
 = (*
mM1
 ? 
myCOLUP1
 : (*
mBL
 ? 
myCOLUPF
 : 
myCOLUBK
));

1530 if(*
mBL
 && *
mM1
)

1531 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myM1B™
];

1533 ++
mBL
; ++
mM1
; ++
myF¿mePoš‹r
;

1540 
myBLB™
 | 
myM1B™
 | 
PriÜ™yB™
:

1541 
myBLB™
 | 
myM1B™
 | 
ScÜeB™
 | 
PriÜ™yB™
:

1543 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1544 
uIÁ8
* 
mM1
 = &
myCu¼’tM1Mask
[
hpos
];

1546 
myF¿mePoš‹r
 < 
’dšg
)

1548 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
 &&

1549 !*(
uIÁ32
*)
mM1
)

1551 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1552 
mBL
 +ğ4; 
mM1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1556 *
myF¿mePoš‹r
 = (*
mBL
 ? 
myCOLUPF
 : (*
mM1
 ? 
myCOLUP1
 : 
myCOLUBK
));

1558 if(*
mBL
 && *
mM1
)

1559 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myM1B™
];

1561 ++
mBL
; ++
mM1
; ++
myF¿mePoš‹r
;

1568 
myBLB™
 | 
myP1B™
:

1569 
myBLB™
 | 
myP1B™
 | 
ScÜeB™
:

1571 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1572 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1574 
myF¿mePoš‹r
 < 
’dšg
)

1576 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP1
 && !*(uIÁ32*)
mBL
)

1578 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1579 
mBL
 +ğ4; 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1583 *
myF¿mePoš‹r
 = (
myCu¼’tGRP1
 & *
mP1
è? 
myCOLUP1
 :

1584 (*
mBL
 ? 
myCOLUPF
 : 
myCOLUBK
);

1586 if(*
mBL
 && (
myCu¼’tGRP1
 & *
mP1
))

1587 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myP1B™
];

1589 ++
mBL
; ++
mP1
; ++
myF¿mePoš‹r
;

1596 
myBLB™
 | 
myP1B™
 | 
PriÜ™yB™
:

1597 
myBLB™
 | 
myP1B™
 | 
PriÜ™yB™
 | 
ScÜeB™
:

1599 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1600 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1602 
myF¿mePoš‹r
 < 
’dšg
)

1604 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP1
 && !*(uIÁ32*)
mBL
)

1606 *(
uIÁ32
*)
myF¿mePoš‹r
 = 
myCOLUBK
;

1607 
mBL
 +ğ4; 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1611 *
myF¿mePoš‹r
 = *
mBL
 ? 
myCOLUPF
 :

1612 ((
myCu¼’tGRP1
 & *
mP1
è? 
myCOLUP1
 : 
myCOLUBK
);

1614 if(*
mBL
 && (
myCu¼’tGRP1
 & *
mP1
))

1615 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myBLB™
 | 
myP1B™
];

1617 ++
mBL
; ++
mP1
; ++
myF¿mePoš‹r
;

1624 
myPFB™
 | 
myP0B™
:

1626 
uIÁ32
* 
mPF
 = &
myCu¼’tPFMask
[
hpos
];

1627 
uIÁ8
* 
mP0
 = &
myCu¼’tP0Mask
[
hpos
];

1629 
myF¿mePoš‹r
 < 
’dšg
)

1631 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP0
)

1633 *(
uIÁ32
*)
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
;

1634 
mPF
 +ğ4; 
mP0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1638 *
myF¿mePoš‹r
 = (
myCu¼’tGRP0
 & *
mP0
) ?

1639 
myCOLUP0
 : ((
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
);

1641 if((
myPF
 & *
mPF
è&& (
myCu¼’tGRP0
 & *
mP0
))

1642 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myPFB™
 | 
myP0B™
];

1644 ++
mPF
; ++
mP0
; ++
myF¿mePoš‹r
;

1652 
myPFB™
 | 
myP0B™
 | 
PriÜ™yB™
:

1654 
uIÁ32
* 
mPF
 = &
myCu¼’tPFMask
[
hpos
];

1655 
uIÁ8
* 
mP0
 = &
myCu¼’tP0Mask
[
hpos
];

1657 
myF¿mePoš‹r
 < 
’dšg
)

1659 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP0
)

1661 *(
uIÁ32
*)
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
;

1662 
mPF
 +ğ4; 
mP0
 +ğ4; 
myF¿mePoš‹r
 += 4;

1666 *
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 :

1667 ((
myCu¼’tGRP0
 & *
mP0
è? 
myCOLUP0
 : 
myCOLUBK
);

1669 if((
myPF
 & *
mPF
è&& (
myCu¼’tGRP0
 & *
mP0
))

1670 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myPFB™
 | 
myP0B™
];

1672 ++
mPF
; ++
mP0
; ++
myF¿mePoš‹r
;

1680 
myPFB™
 | 
myP1B™
:

1682 
uIÁ32
* 
mPF
 = &
myCu¼’tPFMask
[
hpos
];

1683 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1685 
myF¿mePoš‹r
 < 
’dšg
)

1687 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP1
)

1689 *(
uIÁ32
*)
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
;

1690 
mPF
 +ğ4; 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1694 *
myF¿mePoš‹r
 = (
myCu¼’tGRP1
 & *
mP1
) ?

1695 
myCOLUP1
 : ((
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
);

1697 if((
myPF
 & *
mPF
è&& (
myCu¼’tGRP1
 & *
mP1
))

1698 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myPFB™
 | 
myP1B™
];

1700 ++
mPF
; ++
mP1
; ++
myF¿mePoš‹r
;

1708 
myPFB™
 | 
myP1B™
 | 
PriÜ™yB™
:

1710 
uIÁ32
* 
mPF
 = &
myCu¼’tPFMask
[
hpos
];

1711 
uIÁ8
* 
mP1
 = &
myCu¼’tP1Mask
[
hpos
];

1713 
myF¿mePoš‹r
 < 
’dšg
)

1715 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mP1
)

1717 *(
uIÁ32
*)
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
;

1718 
mPF
 +ğ4; 
mP1
 +ğ4; 
myF¿mePoš‹r
 += 4;

1722 *
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 :

1723 ((
myCu¼’tGRP1
 & *
mP1
è? 
myCOLUP1
 : 
myCOLUBK
);

1725 if((
myPF
 & *
mPF
è&& (
myCu¼’tGRP1
 & *
mP1
))

1726 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myPFB™
 | 
myP1B™
];

1728 ++
mPF
; ++
mP1
; ++
myF¿mePoš‹r
;

1736 
myPFB™
 | 
myBLB™
:

1737 
myPFB™
 | 
myBLB™
 | 
PriÜ™yB™
:

1739 
uIÁ32
* 
mPF
 = &
myCu¼’tPFMask
[
hpos
];

1740 
uIÁ8
* 
mBL
 = &
myCu¼’tBLMask
[
hpos
];

1742 
myF¿mePoš‹r
 < 
’dšg
)

1744 if(!((
ušŒ_t
)
myF¿mePoš‹r
 & 0x03è&& !*(
uIÁ32
*)
mBL
)

1746 *(
uIÁ32
*)
myF¿mePoš‹r
 = (
myPF
 & *
mPF
è? 
myCOLUPF
 : 
myCOLUBK
;

1747 
mPF
 +ğ4; 
mBL
 +ğ4; 
myF¿mePoš‹r
 += 4;

1751 *
myF¿mePoš‹r
 = ((
myPF
 & *
mPF
è|| *
mBL
è? 
myCOLUPF
 : 
myCOLUBK
;

1753 if((
myPF
 & *
mPF
è&& *
mBL
)

1754 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
myPFB™
 | 
myBLB™
];

1756 ++
mPF
; ++
mBL
; ++
myF¿mePoš‹r
;

1765 ; 
myF¿mePoš‹r
 < 
’dšg
; ++myF¿mePoš‹r, ++
hpos
)

1767 
uIÁ8
 
’abËd
 = (
myPF
 & 
myCu¼’tPFMask
[
hpos
]è? 
myPFB™
 : 0;

1769 if((
myEÇbËdObjeùs
 & 
myBLB™
è&& 
myCu¼’tBLMask
[
hpos
])

1770 
’abËd
 |ğ
myBLB™
;

1772 if(
myCu¼’tGRP1
 & 
myCu¼’tP1Mask
[
hpos
])

1773 
’abËd
 |ğ
myP1B™
;

1775 if((
myEÇbËdObjeùs
 & 
myM1B™
è&& 
myCu¼’tM1Mask
[
hpos
])

1776 
’abËd
 |ğ
myM1B™
;

1778 if(
myCu¼’tGRP0
 & 
myCu¼’tP0Mask
[
hpos
])

1779 
’abËd
 |ğ
myP0B™
;

1781 if((
myEÇbËdObjeùs
 & 
myM0B™
è&& 
myCu¼’tM0Mask
[
hpos
])

1782 
’abËd
 |ğ
myM0B™
;

1784 
myCŞlisiÚ
 |ğ
ourCŞlisiÚTabË
[
’abËd
];

1785 *
myF¿mePoš‹r
 = 
myCŞÜ
[
myPriÜ™yEncod”
[
hpos
 < 80 ? 0 : 1]

1786 [
’abËd
 | 
myPÏyf›ldPriÜ™yAndScÜe
]];

1792 
myF¿mePoš‹r
 = 
’dšg
;

1793 
	}
}

1796 
šlše
 
	gTIA
::
	$upd©eF¿me
(
IÁ32
 
şock
)

1800 if((
şock
 < 
myClockS¹Di¥Ïy
) ||

1801 (
myClockAtLa¡Upd©e
 >ğ
myClockStİDi¥Ïy
) ||

1802 (
myClockAtLa¡Upd©e
 >ğ
şock
))

1808 if(
şock
 > 
myClockStİDi¥Ïy
)

1810 
şock
 = 
myClockStİDi¥Ïy
;

1817 
IÁ32
 
şocksToUpd©e
 = 0;

1820 
IÁ32
 
şocksFromS¹OfSÿnLše
 = 228 - 
myClocksToEndOfSÿnLše
;

1823 if(
şock
 > (
myClockAtLa¡Upd©e
 + 
myClocksToEndOfSÿnLše
))

1826 
şocksToUpd©e
 = 
myClocksToEndOfSÿnLše
;

1827 
myClocksToEndOfSÿnLše
 = 228;

1828 
myClockAtLa¡Upd©e
 +ğ
şocksToUpd©e
;

1833 
şocksToUpd©e
 = 
şock
 - 
myClockAtLa¡Upd©e
;

1834 
myClocksToEndOfSÿnLše
 -ğ
şocksToUpd©e
;

1835 
myClockAtLa¡Upd©e
 = 
şock
;

1838 
IÁ32
 
¡¬tOfSÿnLše
 = 
HBLANK
 + 
myF¿meXS¹
;

1841 if(
şocksFromS¹OfSÿnLše
 < 
¡¬tOfSÿnLše
)

1843 
uIÁ32
 
tmp
;

1845 if((
¡¬tOfSÿnLše
 - 
şocksFromS¹OfSÿnLše
è< 
şocksToUpd©e
)

1846 
tmp
 = 
¡¬tOfSÿnLše
 - 
şocksFromS¹OfSÿnLše
;

1848 
tmp
 = 
şocksToUpd©e
;

1850 
şocksFromS¹OfSÿnLše
 +ğ
tmp
;

1851 
şocksToUpd©e
 -ğ
tmp
;

1855 
uIÁ8
* 
ŞdF¿mePoš‹r
 = 
myF¿mePoš‹r
;

1858 if(
şocksToUpd©e
 != 0)

1860 
	`upd©eF¿meSÿÆše
(
şocksToUpd©e
, 
şocksFromS¹OfSÿnLše
 - 
HBLANK
);

1864 if(
myHMOVEBÏnkEÇbËd
 && (
¡¬tOfSÿnLše
 < 
HBLANK
 + 8) &&

1865 (
şocksFromS¹OfSÿnLše
 < (
HBLANK
 + 8)))

1867 
IÁ32
 
bÏnks
 = (
HBLANK
 + 8è- 
şocksFromS¹OfSÿnLše
;

1868 
	`mem£t
(
ŞdF¿mePoš‹r
, 0, 
bÏnks
);

1870 if((
şocksToUpd©e
 + 
şocksFromS¹OfSÿnLše
è>ğ(
HBLANK
 + 8))

1872 
myHMOVEBÏnkEÇbËd
 = 
çl£
;

1877 if(
myClocksToEndOfSÿnLše
 == 228)

1879 
myF¿mePoš‹r
 -ğ(160 - 
myF¿meWidth
 - 
myF¿meXS¹
);

1882 
myCu¼’tPFMask
 = 
ourPÏyf›ldTabË
[
myCTRLPF
 & 0x01];

1887 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

1888 [0][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

1889 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

1890 [0][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

1893 if(
myM0CosmicArkMÙiÚEÇbËd
)

1896 
uIÁ32
 
m
[4] = {18, 33, 0, 17};

1898 
myM0CosmicArkCouÁ”
 = (myM0CosmicArkCounter + 1) & 3;

1899 
myPOSM0
 -ğ
m
[
myM0CosmicArkCouÁ”
];

1901 if(
myPOSM0
 >= 160)

1902 
myPOSM0
 -= 160;

1903 if(
myPOSM0
 < 0)

1904 
myPOSM0
 += 160;

1906 if(
myM0CosmicArkCouÁ”
 == 1)

1909 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

1910 [
myNUSIZ0
 & 0x07][((myNUSIZ0 & 0x30) >> 4) | 0x01]

1911 [160 - (
myPOSM0
 & 0xFC)];

1913 if(
myM0CosmicArkCouÁ”
 == 2)

1916 
myCu¼’tM0Mask
 = &
ourDi§bËdMaskTabË
[0];

1920 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

1921 [
myNUSIZ0
 & 0x07][(myNUSIZ0 & 0x30è>> 4][160 - (
myPOSM0
 & 0xFC)];

1926 
myClockAtLa¡Upd©e
 < 
şock
);

1927 
	}
}

1930 
šlše
 
	gTIA
::
	$wa™HÜizÚlSync
()

1932 
uIÁ32
 
cyşesToEndOfLše
 = 76 - ((
mySy¡em
->
	`cyşes
() -

1933 (
myClockWh’F¿meS¹ed
 / 3)) % 76);

1935 if(
cyşesToEndOfLše
 < 76)

1937 
mySy¡em
->
	`šüem’tCyşes
(
cyşesToEndOfLše
);

1939 
	}
}

1942 
	gTIA
::
	$g»yOutF¿me
()

1944 
c
 = 
	`sÿÆšes
();

1945 if(
c
 < 
myYS¹
) c = myYStart;

1947 
s
 = 
c
; s < (
myHeight
 + 
myYS¹
); s++)

1948 
i
 = 0; i < 160; i++) {

1949 
uIÁ8
 
tmp
 = 
myCu¼’tF¿meBufãr
[ (
s
 - 
myYS¹
è* 160 + 
i
] & 0x0f;

1950 
tmp
 >>= 1;

1951 
myCu¼’tF¿meBufãr
[ (
s
 - 
myYS¹
è* 160 + 
i
] = 
tmp
;

1954 
	}
}

1957 
	gTIA
::
	$ş—rBufãrs
()

1959 
uIÁ32
 
i
 = 0; i < 160 * 300; ++i)

1961 
myCu¼’tF¿meBufãr
[
i
] = 
myP»viousF¿meBufãr
[i] = 0;

1963 
	}
}

1966 
uIÁ8
 
	gTIA
::
	$³ek
(
uIÁ16
 
addr
)

1969 
	`upd©eF¿me
(
mySy¡em
->
	`cyşes
() * 3);

1971 
uIÁ8
 
noi£
 = 
mySy¡em
->
	`g‘D©aBusS‹
() & 0x3F;

1973 
addr
 & 0x000f)

1976  ((
myCŞlisiÚ
 & 0x0001) ? 0x80 : 0x00) |

1977 ((
myCŞlisiÚ
 & 0x0002è? 0x40 : 0x00è| 
noi£
;

1980  ((
myCŞlisiÚ
 & 0x0004) ? 0x80 : 0x00) |

1981 ((
myCŞlisiÚ
 & 0x0008è? 0x40 : 0x00è| 
noi£
;

1984  ((
myCŞlisiÚ
 & 0x0010) ? 0x80 : 0x00) |

1985 ((
myCŞlisiÚ
 & 0x0020è? 0x40 : 0x00è| 
noi£
;

1988  ((
myCŞlisiÚ
 & 0x0040) ? 0x80 : 0x00) |

1989 ((
myCŞlisiÚ
 & 0x0080è? 0x40 : 0x00è| 
noi£
;

1992  ((
myCŞlisiÚ
 & 0x0100) ? 0x80 : 0x00) |

1993 ((
myCŞlisiÚ
 & 0x0200è? 0x40 : 0x00è| 
noi£
;

1996  ((
myCŞlisiÚ
 & 0x0400) ? 0x80 : 0x00) |

1997 ((
myCŞlisiÚ
 & 0x0800è? 0x40 : 0x00è| 
noi£
;

2000  ((
myCŞlisiÚ
 & 0x1000è? 0x80 : 0x00è| 
noi£
;

2003  ((
myCŞlisiÚ
 & 0x2000) ? 0x80 : 0x00) |

2004 ((
myCŞlisiÚ
 & 0x4000è? 0x40 : 0x00è| 
noi£
;

2008 
IÁ32
 
r
 = 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Nše
);

2009 if(
r
 =ğ
CÚŒŞËr
::
mšimumResi¡ªû
)

2011  0x80 | 
noi£
;

2013 if((
r
 =ğ
CÚŒŞËr
::
maximumResi¡ªû
è|| 
myDumpEÇbËd
)

2015  
noi£
;

2019 
t
 = (1.6 * 
r
 * 0.01E-6);

2020 
uIÁ32
 
Ãeded
 = (uIÁ32)(
t
 * 1.19E6);

2021 if(
mySy¡em
->
	`cyşes
(è> (
myDumpDi§bËdCyşe
 + 
Ãeded
))

2023  0x80 | 
noi£
;

2027  
noi£
;

2034 
IÁ32
 
r
 = 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Five
);

2035 if(
r
 =ğ
CÚŒŞËr
::
mšimumResi¡ªû
)

2037  0x80 | 
noi£
;

2039 if((
r
 =ğ
CÚŒŞËr
::
maximumResi¡ªû
è|| 
myDumpEÇbËd
)

2041  
noi£
;

2045 
t
 = (1.6 * 
r
 * 0.01E-6);

2046 
uIÁ32
 
Ãeded
 = (uIÁ32)(
t
 * 1.19E6);

2047 if(
mySy¡em
->
	`cyşes
(è> (
myDumpDi§bËdCyşe
 + 
Ãeded
))

2049  0x80 | 
noi£
;

2053  
noi£
;

2060 
IÁ32
 
r
 = 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Nše
);

2061 if(
r
 =ğ
CÚŒŞËr
::
mšimumResi¡ªû
)

2063  0x80 | 
noi£
;

2065 if((
r
 =ğ
CÚŒŞËr
::
maximumResi¡ªû
è|| 
myDumpEÇbËd
)

2067  
noi£
;

2071 
t
 = (1.6 * 
r
 * 0.01E-6);

2072 
uIÁ32
 
Ãeded
 = (uIÁ32)(
t
 * 1.19E6);

2073 if(
mySy¡em
->
	`cyşes
(è> (
myDumpDi§bËdCyşe
 + 
Ãeded
))

2075  0x80 | 
noi£
;

2079  
noi£
;

2086 
IÁ32
 
r
 = 
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Five
);

2087 if(
r
 =ğ
CÚŒŞËr
::
mšimumResi¡ªû
)

2089  0x80 | 
noi£
;

2091 if((
r
 =ğ
CÚŒŞËr
::
maximumResi¡ªû
è|| 
myDumpEÇbËd
)

2093  
noi£
;

2097 
t
 = (1.6 * 
r
 * 0.01E-6);

2098 
uIÁ32
 
Ãeded
 = (uIÁ32)(
t
 * 1.19E6);

2099 if(
mySy¡em
->
	`cyşes
(è> (
myDumpDi§bËdCyşe
 + 
Ãeded
))

2101  0x80 | 
noi£
;

2105  
noi£
;

2111  
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Leá
).
	`»ad
(CÚŒŞËr::
Six
) ?

2112 (0x80 | 
noi£
) :‚oise;

2115  
myCÚsŞe
.
	`cÚŒŞËr
(
CÚŒŞËr
::
Right
).
	`»ad
(CÚŒŞËr::
Six
) ?

2116 (0x80 | 
noi£
) :‚oise;

2119  
noi£
;

2122  
noi£
;

2124 
	}
}

2127 
	gTIA
::
	$poke
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
)

2129 
addr
 =‡ddr & 0x003f;

2131 
IÁ32
 
şock
 = 
mySy¡em
->
	`cyşes
() * 3;

2132 
IÁ16
 
d–ay
 = 
ourPokeD–ayTabË
[
addr
];

2135 if(
d–ay
 == -1)

2137 
uIÁ32
 
d
[4] = {4, 5, 2, 3};

2138 
IÁ32
 
x
 = ((
şock
 - 
myClockWh’F¿meS¹ed
) % 228);

2139 
d–ay
 = 
d
[(
x
 / 3) & 3];

2143 
	`upd©eF¿me
(
şock
 + 
d–ay
);

2146 if(((
şock
 - 
myClockWh’F¿meS¹ed
è/ 228è> 
myMaximumNumb”OfSÿÆšes
)

2148 
mySy¡em
->
	`m6502
().
	`¡İ
();

2149 
myP¬tŸlF¿meFÏg
 = 
çl£
;

2152 
addr
)

2156 
myVSYNC
 = 
v®ue
;

2158 if(
myVSYNC
 & 0x02)

2163 
myVSYNCFšishClock
 = 
şock
 + 228;

2165 if(!(
myVSYNC
 & 0x02è&& (
şock
 >ğ
myVSYNCFšishClock
))

2168 
myVSYNCFšishClock
 = 0x7FFFFFFF;

2171 
mySy¡em
->
	`m6502
().
	`¡İ
();

2172 
myP¬tŸlF¿meFÏg
 = 
çl£
;

2180 if(!(
myVBLANK
 & 0x80è&& (
v®ue
 & 0x80))

2182 
myDumpEÇbËd
 = 
Œue
;

2186 if((
myVBLANK
 & 0x80è&& !(
v®ue
 & 0x80))

2188 
myDumpEÇbËd
 = 
çl£
;

2189 
myDumpDi§bËdCyşe
 = 
mySy¡em
->
	`cyşes
();

2192 
myVBLANK
 = 
v®ue
;

2205 if(
mySy¡em
->
	`m6502
().
	`Ï¡AcûssWasR—d
())

2208 
	`wa™HÜizÚlSync
();

2221 
myNUSIZ0
 = 
v®ue
;

2226 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

2227 [0][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

2229 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

2230 [
myNUSIZ0
 & 0x07][(myNUSIZ0 & 0x30è>> 4][160 - (
myPOSM0
 & 0xFC)];

2237 
myNUSIZ1
 = 
v®ue
;

2242 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

2243 [0][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

2245 
myCu¼’tM1Mask
 = &
ourMis¦eMaskTabË
[
myPOSM1
 & 0x03]

2246 [
myNUSIZ1
 & 0x07][(myNUSIZ1 & 0x30è>> 4][160 - (
myPOSM1
 & 0xFC)];

2253 
uIÁ32
 
cŞÜ
 = (uIÁ32)(
v®ue
 & 0xfe);

2254 if(
myCŞÜLossEÇbËd
 && (
mySÿÆšeCouÁFÜLa¡F¿me
 & 0x01))

2256 
cŞÜ
 |= 0x01;

2258 
myCOLUP0
 = (((((
cŞÜ
 << 8) | color) << 8) | color) << 8) | color;

2264 
uIÁ32
 
cŞÜ
 = (uIÁ32)(
v®ue
 & 0xfe);

2265 if(
myCŞÜLossEÇbËd
 && (
mySÿÆšeCouÁFÜLa¡F¿me
 & 0x01))

2267 
cŞÜ
 |= 0x01;

2269 
myCOLUP1
 = (((((
cŞÜ
 << 8) | color) << 8) | color) << 8) | color;

2275 
uIÁ32
 
cŞÜ
 = (uIÁ32)(
v®ue
 & 0xfe);

2276 if(
myCŞÜLossEÇbËd
 && (
mySÿÆšeCouÁFÜLa¡F¿me
 & 0x01))

2278 
cŞÜ
 |= 0x01;

2280 
myCOLUPF
 = (((((
cŞÜ
 << 8) | color) << 8) | color) << 8) | color;

2286 
uIÁ32
 
cŞÜ
 = (uIÁ32)(
v®ue
 & 0xfe);

2287 if(
myCŞÜLossEÇbËd
 && (
mySÿÆšeCouÁFÜLa¡F¿me
 & 0x01))

2289 
cŞÜ
 |= 0x01;

2291 
myCOLUBK
 = (((((
cŞÜ
 << 8) | color) << 8) | color) << 8) | color;

2297 
myCTRLPF
 = 
v®ue
;

2302 
myPÏyf›ldPriÜ™yAndScÜe
 = ((
myCTRLPF
 & 0x06) << 5);

2306 if(((
şock
 - 
myClockWh’F¿meS¹ed
) % 228) < (68 + 79))

2308 
myCu¼’tPFMask
 = 
ourPÏyf›ldTabË
[
myCTRLPF
 & 0x01];

2311 
myCu¼’tBLMask
 = &
ourB®lMaskTabË
[
myPOSBL
 & 0x03]

2312 [(
myCTRLPF
 & 0x30è>> 4][160 - (
myPOSBL
 & 0xFC)];

2320 if(((
v®ue
 & 0x08è&& !
myREFP0
) || (!(value & 0x08) && myREFP0))

2322 
myREFP0
 = (
v®ue
 & 0x08);

2323 
myCu¼’tGRP0
 = 
ourPÏy”ReæeùTabË
[myCurrentGRP0];

2331 if(((
v®ue
 & 0x08è&& !
myREFP1
) || (!(value & 0x08) && myREFP1))

2333 
myREFP1
 = (
v®ue
 & 0x08);

2334 
myCu¼’tGRP1
 = 
ourPÏy”ReæeùTabË
[myCurrentGRP1];

2341 
myPF
 = (myPF & 0x000FFFF0è| ((
v®ue
 >> 4) & 0x0F);

2343 if(!
myB™EÇbËd
[
TIA
::
PF
] || 
myPF
 == 0)

2344 
myEÇbËdObjeùs
 &ğ~
myPFB™
;

2346 
myEÇbËdObjeùs
 |ğ
myPFB™
;

2353 
myPF
 = (myPF & 0x000FF00Fè| ((
uIÁ32
)
v®ue
 << 4);

2355 if(!
myB™EÇbËd
[
TIA
::
PF
] || 
myPF
 == 0)

2356 
myEÇbËdObjeùs
 &ğ~
myPFB™
;

2358 
myEÇbËdObjeùs
 |ğ
myPFB™
;

2365 
myPF
 = (myPF & 0x00000FFFè| ((
uIÁ32
)
v®ue
 << 12);

2367 if(!
myB™EÇbËd
[
TIA
::
PF
] || 
myPF
 == 0)

2368 
myEÇbËdObjeùs
 &ğ~
myPFB™
;

2370 
myEÇbËdObjeùs
 |ğ
myPFB™
;

2377 
IÁ32
 
hpos
 = (
şock
 - 
myClockWh’F¿meS¹ed
) % 228;

2378 
IÁ32
 
Ãwx
 = 
hpos
 < 
HBLANK
 ? 3 : (((hpos - HBLANK) + 5) % 160);

2381 
IÁ8
 
wh’
 = 
ourPÏy”Pos™iÚRe£tWh’TabË
[
myNUSIZ0
 & 7][
myPOSP0
][
Ãwx
];

2384 if(
wh’
 == 1)

2390 
	`upd©eF¿me
(
şock
 + 11);

2392 
myPOSP0
 = 
Ãwx
;

2395 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

2396 [1][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

2399 if(
wh’
 == 0)

2401 
myPOSP0
 = 
Ãwx
;

2404 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

2405 [1][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

2408 if(
wh’
 == -1)

2410 
myPOSP0
 = 
Ãwx
;

2413 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

2414 [0][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

2421 
IÁ32
 
hpos
 = (
şock
 - 
myClockWh’F¿meS¹ed
) % 228;

2422 
IÁ32
 
Ãwx
 = 
hpos
 < 
HBLANK
 ? 3 : (((hpos - HBLANK) + 5) % 160);

2425 
IÁ8
 
wh’
 = 
ourPÏy”Pos™iÚRe£tWh’TabË
[
myNUSIZ1
 & 7][
myPOSP1
][
Ãwx
];

2428 if(
wh’
 == 1)

2434 
	`upd©eF¿me
(
şock
 + 11);

2436 
myPOSP1
 = 
Ãwx
;

2439 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

2440 [1][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

2443 if(
wh’
 == 0)

2445 
myPOSP1
 = 
Ãwx
;

2448 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

2449 [1][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

2452 if(
wh’
 == -1)

2454 
myPOSP1
 = 
Ãwx
;

2457 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

2458 [0][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

2465 
hpos
 = (
şock
 - 
myClockWh’F¿meS¹ed
) % 228;

2466 
myPOSM0
 = 
hpos
 < 
HBLANK
 ? 2 : (((hpos - HBLANK) + 4) % 160);

2471 if(((
şock
 - 
myLa¡HMOVEClock
è=ğ(20 * 3)è&& (
hpos
 == 69))

2473 
myPOSM0
 = 8;

2476 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

2477 [
myNUSIZ0
 & 0x07][(myNUSIZ0 & 0x30è>> 4][160 - (
myPOSM0
 & 0xFC)];

2483 
hpos
 = (
şock
 - 
myClockWh’F¿meS¹ed
) % 228;

2484 
myPOSM1
 = 
hpos
 < 
HBLANK
 ? 2 : (((hpos - HBLANK) + 4) % 160);

2489 if(((
şock
 - 
myLa¡HMOVEClock
è=ğ(3 * 3)è&& (
hpos
 == 18))

2491 
myPOSM1
 = 3;

2494 
myCu¼’tM1Mask
 = &
ourMis¦eMaskTabË
[
myPOSM1
 & 0x03]

2495 [
myNUSIZ1
 & 0x07][(myNUSIZ1 & 0x30è>> 4][160 - (
myPOSM1
 & 0xFC)];

2501 
hpos
 = (
şock
 - 
myClockWh’F¿meS¹ed
) % 228 ;

2502 
myPOSBL
 = 
hpos
 < 
HBLANK
 ? 2 : (((hpos - HBLANK) + 4) % 160);

2507 if(((
şock
 - 
myLa¡HMOVEClock
) == (18 * 3)) &&

2508 ((
hpos
 == 60) || (hpos == 69)))

2510 
myPOSBL
 = 10;

2515 if(((
şock
 - 
myLa¡HMOVEClock
è=ğ(3 * 3)è&& (
hpos
 == 18))

2517 
myPOSBL
 = 3;

2522 if(((
şock
 - 
myLa¡HMOVEClock
è=ğ(7 * 3)è&& (
hpos
 == 30))

2524 
myPOSBL
 = 6;

2529 if(((
şock
 - 
myLa¡HMOVEClock
è=ğ(6 * 3)è&& (
hpos
 == 27))

2531 
myPOSBL
 = 5;

2534 
myCu¼’tBLMask
 = &
ourB®lMaskTabË
[
myPOSBL
 & 0x03]

2535 [(
myCTRLPF
 & 0x30è>> 4][160 - (
myPOSBL
 & 0xFC)];

2541 
myAUDC0
 = 
v®ue
 & 0x0f;

2542 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2548 
myAUDC1
 = 
v®ue
 & 0x0f;

2549 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2555 
myAUDF0
 = 
v®ue
 & 0x1f;

2556 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2562 
myAUDF1
 = 
v®ue
 & 0x1f;

2563 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2569 
myAUDV0
 = 
v®ue
 & 0x0f;

2570 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2576 
myAUDV1
 = 
v®ue
 & 0x0f;

2577 
mySound
->
	`£t
(
addr
, 
v®ue
, 
mySy¡em
->
	`cyşes
());

2584 
myGRP0
 = (
myB™EÇbËd
[
TIA
::
P0
] ? 
v®ue
 : 0);

2587 
myDGRP1
 = 
myGRP1
;

2590 
uIÁ8
 
g½0
 = 
myVDELP0
 ? 
myDGRP0
 : 
myGRP0
;

2591 
myCu¼’tGRP0
 = 
myREFP0
 ? 
ourPÏy”ReæeùTabË
[
g½0
] : grp0;

2594 
uIÁ8
 
g½1
 = 
myVDELP1
 ? 
myDGRP1
 : 
myGRP1
;

2595 
myCu¼’tGRP1
 = 
myREFP1
 ? 
ourPÏy”ReæeùTabË
[
g½1
] : grp1;

2598 if(
myCu¼’tGRP0
 != 0)

2599 
myEÇbËdObjeùs
 |ğ
myP0B™
;

2601 
myEÇbËdObjeùs
 &ğ~
myP0B™
;

2603 if(
myCu¼’tGRP1
 != 0)

2604 
myEÇbËdObjeùs
 |ğ
myP1B™
;

2606 
myEÇbËdObjeùs
 &ğ~
myP1B™
;

2614 
myGRP1
 = (
myB™EÇbËd
[
TIA
::
P1
] ? 
v®ue
 : 0);

2617 
myDGRP0
 = 
myGRP0
;

2620 
myDENABL
 = 
myENABL
;

2623 
uIÁ8
 
g½0
 = 
myVDELP0
 ? 
myDGRP0
 : 
myGRP0
;

2624 
myCu¼’tGRP0
 = 
myREFP0
 ? 
ourPÏy”ReæeùTabË
[
g½0
] : grp0;

2627 
uIÁ8
 
g½1
 = 
myVDELP1
 ? 
myDGRP1
 : 
myGRP1
;

2628 
myCu¼’tGRP1
 = 
myREFP1
 ? 
ourPÏy”ReæeùTabË
[
g½1
] : grp1;

2631 if(
myCu¼’tGRP0
 != 0)

2632 
myEÇbËdObjeùs
 |ğ
myP0B™
;

2634 
myEÇbËdObjeùs
 &ğ~
myP0B™
;

2636 if(
myCu¼’tGRP1
 != 0)

2637 
myEÇbËdObjeùs
 |ğ
myP1B™
;

2639 
myEÇbËdObjeùs
 &ğ~
myP1B™
;

2641 if(
myVDELBL
 ? 
myDENABL
 : 
myENABL
)

2642 
myEÇbËdObjeùs
 |ğ
myBLB™
;

2644 
myEÇbËdObjeùs
 &ğ~
myBLB™
;

2651 
myENAM0
 = (
myB™EÇbËd
[
TIA
::
M0
] ? 
v®ue
 & 0x02 : 0);

2653 if(
myENAM0
 && !
myRESMP0
)

2654 
myEÇbËdObjeùs
 |ğ
myM0B™
;

2656 
myEÇbËdObjeùs
 &ğ~
myM0B™
;

2662 
myENAM1
 = (
myB™EÇbËd
[
TIA
::
M1
] ? 
v®ue
 & 0x02 : 0);

2664 if(
myENAM1
 && !
myRESMP1
)

2665 
myEÇbËdObjeùs
 |ğ
myM1B™
;

2667 
myEÇbËdObjeùs
 &ğ~
myM1B™
;

2673 
myENABL
 = (
myB™EÇbËd
[
TIA
::
BL
] ? 
v®ue
 & 0x02 : 0);

2675 if(
myVDELBL
 ? 
myDENABL
 : 
myENABL
)

2676 
myEÇbËdObjeùs
 |ğ
myBLB™
;

2678 
myEÇbËdObjeùs
 &ğ~
myBLB™
;

2685 
myHMP0
 = 
v®ue
 >> 4;

2691 
myHMP1
 = 
v®ue
 >> 4;

2697 
IÁ8
 
tmp
 = 
v®ue
 >> 4;

2700 if((
şock
 =ğ(
myLa¡HMOVEClock
 + 21 * 3)è&& (
myHMM0
 =ğ7è&& (
tmp
 == 6))

2702 
myM0CosmicArkMÙiÚEÇbËd
 = 
Œue
;

2703 
myM0CosmicArkCouÁ”
 = 0;

2706 
myHMM0
 = 
tmp
;

2712 
myHMM1
 = 
v®ue
 >> 4;

2718 
myHMBL
 = 
v®ue
 >> 4;

2724 
myVDELP0
 = 
v®ue
 & 0x01;

2726 
uIÁ8
 
g½0
 = 
myVDELP0
 ? 
myDGRP0
 : 
myGRP0
;

2727 
myCu¼’tGRP0
 = 
myREFP0
 ? 
ourPÏy”ReæeùTabË
[
g½0
] : grp0;

2729 if(
myCu¼’tGRP0
 != 0)

2730 
myEÇbËdObjeùs
 |ğ
myP0B™
;

2732 
myEÇbËdObjeùs
 &ğ~
myP0B™
;

2738 
myVDELP1
 = 
v®ue
 & 0x01;

2740 
uIÁ8
 
g½1
 = 
myVDELP1
 ? 
myDGRP1
 : 
myGRP1
;

2741 
myCu¼’tGRP1
 = 
myREFP1
 ? 
ourPÏy”ReæeùTabË
[
g½1
] : grp1;

2743 if(
myCu¼’tGRP1
 != 0)

2744 
myEÇbËdObjeùs
 |ğ
myP1B™
;

2746 
myEÇbËdObjeùs
 &ğ~
myP1B™
;

2752 
myVDELBL
 = 
v®ue
 & 0x01;

2754 if(
myVDELBL
 ? 
myDENABL
 : 
myENABL
)

2755 
myEÇbËdObjeùs
 |ğ
myBLB™
;

2757 
myEÇbËdObjeùs
 &ğ~
myBLB™
;

2763 if(
myRESMP0
 && !(
v®ue
 & 0x02))

2765 
uIÁ16
 
middË
;

2767 if((
myNUSIZ0
 & 0x07) == 0x05)

2768 
middË
 = 8;

2769 if((
myNUSIZ0
 & 0x07) == 0x07)

2770 
middË
 = 16;

2772 
middË
 = 4;

2774 
myPOSM0
 = (
myPOSP0
 + 
middË
) % 160;

2775 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

2776 [
myNUSIZ0
 & 0x07][(myNUSIZ0 & 0x30è>> 4][160 - (
myPOSM0
 & 0xFC)];

2779 
myRESMP0
 = 
v®ue
 & 0x02;

2781 if(
myENAM0
 && !
myRESMP0
)

2782 
myEÇbËdObjeùs
 |ğ
myM0B™
;

2784 
myEÇbËdObjeùs
 &ğ~
myM0B™
;

2791 if(
myRESMP1
 && !(
v®ue
 & 0x02))

2793 
uIÁ16
 
middË
;

2795 if((
myNUSIZ1
 & 0x07) == 0x05)

2796 
middË
 = 8;

2797 if((
myNUSIZ1
 & 0x07) == 0x07)

2798 
middË
 = 16;

2800 
middË
 = 4;

2802 
myPOSM1
 = (
myPOSP1
 + 
middË
) % 160;

2803 
myCu¼’tM1Mask
 = &
ourMis¦eMaskTabË
[
myPOSM1
 & 0x03]

2804 [
myNUSIZ1
 & 0x07][(myNUSIZ1 & 0x30è>> 4][160 - (
myPOSM1
 & 0xFC)];

2807 
myRESMP1
 = 
v®ue
 & 0x02;

2809 if(
myENAM1
 && !
myRESMP1
)

2810 
myEÇbËdObjeùs
 |ğ
myM1B™
;

2812 
myEÇbËdObjeùs
 &ğ~
myM1B™
;

2819 
IÁ32
 
x
 = ((
şock
 - 
myClockWh’F¿meS¹ed
) % 228) / 3;

2822 if(
myAÎowHMOVEBÏnks
 && 
ourHMOVEBÏnkEÇbËCyşes
[
x
])

2825 
myHMOVEBÏnkEÇbËd
 = 
Œue
;

2828 
myPOSP0
 +ğ
ourCom¶‘eMÙiÚTabË
[
x
][
myHMP0
];

2829 
myPOSP1
 +ğ
ourCom¶‘eMÙiÚTabË
[
x
][
myHMP1
];

2830 
myPOSM0
 +ğ
ourCom¶‘eMÙiÚTabË
[
x
][
myHMM0
];

2831 
myPOSM1
 +ğ
ourCom¶‘eMÙiÚTabË
[
x
][
myHMM1
];

2832 
myPOSBL
 +ğ
ourCom¶‘eMÙiÚTabË
[
x
][
myHMBL
];

2834 if(
myPOSP0
 >= 160)

2835 
myPOSP0
 -= 160;

2836 if(
myPOSP0
 < 0)

2837 
myPOSP0
 += 160;

2839 if(
myPOSP1
 >= 160)

2840 
myPOSP1
 -= 160;

2841 if(
myPOSP1
 < 0)

2842 
myPOSP1
 += 160;

2844 if(
myPOSM0
 >= 160)

2845 
myPOSM0
 -= 160;

2846 if(
myPOSM0
 < 0)

2847 
myPOSM0
 += 160;

2849 if(
myPOSM1
 >= 160)

2850 
myPOSM1
 -= 160;

2851 if(
myPOSM1
 < 0)

2852 
myPOSM1
 += 160;

2854 if(
myPOSBL
 >= 160)

2855 
myPOSBL
 -= 160;

2856 if(
myPOSBL
 < 0)

2857 
myPOSBL
 += 160;

2859 
myCu¼’tBLMask
 = &
ourB®lMaskTabË
[
myPOSBL
 & 0x03]

2860 [(
myCTRLPF
 & 0x30è>> 4][160 - (
myPOSBL
 & 0xFC)];

2862 
myCu¼’tP0Mask
 = &
ourPÏy”MaskTabË
[
myPOSP0
 & 0x03]

2863 [0][
myNUSIZ0
 & 0x07][160 - (
myPOSP0
 & 0xFC)];

2864 
myCu¼’tP1Mask
 = &
ourPÏy”MaskTabË
[
myPOSP1
 & 0x03]

2865 [0][
myNUSIZ1
 & 0x07][160 - (
myPOSP1
 & 0xFC)];

2867 
myCu¼’tM0Mask
 = &
ourMis¦eMaskTabË
[
myPOSM0
 & 0x03]

2868 [
myNUSIZ0
 & 0x07][(myNUSIZ0 & 0x30è>> 4][160 - (
myPOSM0
 & 0xFC)];

2869 
myCu¼’tM1Mask
 = &
ourMis¦eMaskTabË
[
myPOSM1
 & 0x03]

2870 [
myNUSIZ1
 & 0x07][(myNUSIZ1 & 0x30è>> 4][160 - (
myPOSM1
 & 0xFC)];

2873 
myLa¡HMOVEClock
 = 
şock
;

2876 
myM0CosmicArkMÙiÚEÇbËd
 = 
çl£
;

2882 
myHMP0
 = 0;

2883 
myHMP1
 = 0;

2884 
myHMM0
 = 0;

2885 
myHMM1
 = 0;

2886 
myHMBL
 = 0;

2892 
myCŞlisiÚ
 = 0;

2898 #ifdeà
DEBUG_ACCESSES


2899 
û¼
 << "BAD TIA Poke: " << 
hex
 << 
addr
 << 
’dl
;

2904 
	}
}

2907 
uIÁ8
 
	gTIA
::
ourB®lMaskTabË
[4][4][320];

2910 
uIÁ16
 
	gTIA
::
ourCŞlisiÚTabË
[64];

2913 
uIÁ8
 
	gTIA
::
ourDi§bËdMaskTabË
[640];

2916 cÚ¡ 
IÁ16
 
	gTIA
::
ourPokeD–ayTabË
[64] = {

2924 
uIÁ8
 
	gTIA
::
ourMis¦eMaskTabË
[4][8][4][320];

2927 cÚ¡ 
boŞ
 
	gTIA
::
ourHMOVEBÏnkEÇbËCyşes
[76] = {

2928 
Œue
,rue,rue,rue,rue,rue,rue,rue,rue,rue,

2929 
Œue
,rue,rue,rue,rue,rue,rue,rue,rue,rue,

2930 
Œue
, 
çl£
, false, false, false, false, false, false, false, false,

2931 
çl£
, false, false, false, false, false, false, false, false, false,

2932 
çl£
, false, false, false, false, false, false, false, false, false,

2933 
çl£
, false, false, false, false, false, false, false, false, false,

2934 
çl£
, false, false, false, false, false, false, false, false, false,

2935 
çl£
, f®£, f®£, f®£, f®£, 
Œue


2939 cÚ¡ 
IÁ32
 
	gTIA
::
ourCom¶‘eMÙiÚTabË
[76][16] = {

3019 
uIÁ8
 
	gTIA
::
ourPÏy”MaskTabË
[4][2][8][320];

3022 
IÁ8
 
	gTIA
::
ourPÏy”Pos™iÚRe£tWh’TabË
[8][160][160];

3025 
uIÁ8
 
	gTIA
::
ourPÏy”ReæeùTabË
[256];

3028 
uIÁ32
 
	gTIA
::
ourPÏyf›ldTabË
[2][160];

3031 
	gTIA
::
	$TIA
(cÚ¡ 
TIA
& 
c
)

3032 : 
	`myCÚsŞe
(
c
.
myCÚsŞe
),

3033 
	`myS‘tšgs
(
c
.
myS‘tšgs
),

3034 
	`mySound
(
c
.
mySound
),

3035 
	`myCOLUBK
(
myCŞÜ
[0]),

3036 
	`myCOLUPF
(
myCŞÜ
[1]),

3037 
	`myCOLUP0
(
myCŞÜ
[2]),

3038 
	$myCOLUP1
(
myCŞÜ
[3])

3040 
	`as£¹
(
çl£
);

3041 
	}
}

3044 
	gTIA
& TIA::
İ”©Ü
 = (cÚ¡ 
TIA
&)

3046 
as£¹
(
çl£
);

3048  *
	gthis
;

	@emucore/TIA.hxx

19 #iâdeà
TIA_HXX


20 
	#TIA_HXX


	)

22 
şass
 
	gCÚsŞe
;

23 
şass
 
	gSy¡em
;

24 
şass
 
	gS”Ÿliz”
;

25 
şass
 
	gDe£rŸliz”
;

26 
şass
 
	gS‘tšgs
;

28 
	~"b¥f.hxx
"

29 
	~"Sound.hxx
"

30 
	~"Deviû.hxx
"

31 
	~"MedŸSrc.hxx
"

47 
şass
 
	gTIA
 : 
public
 
Deviû
 ,…ubliø
	gMedŸSourû


49 
	gpublic
:

50 
ä›nd
 
şass
 
TIADebug
;

58 
TIA
(cÚ¡ 
CÚsŞe
& 
cÚsŞe
, 
S‘tšgs
& 
£‰šgs
);

63 
	gvœtu®
 ~
TIA
();

65 
	gpublic
:

71 
vœtu®
 cÚ¡ * 
Çme
() const;

76 
vœtu®
 
»£t
();

81 
vœtu®
 
äameRe£t
();

88 
vœtu®
 
sy¡emCyşesRe£t
();

96 
vœtu®
 
š¡®l
(
Sy¡em
& 
sy¡em
);

104 
vœtu®
 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
);

112 
vœtu®
 
boŞ
 
lßd
(
De£rŸliz”
& 
š
);

114 
	gpublic
:

120 
vœtu®
 
uIÁ8
 
³ek
(
uIÁ16
 
add»ss
);

128 
vœtu®
 
poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

130 
	gpublic
:

135 
vœtu®
 
upd©e
();

142 
uIÁ8
* 
cu¼’tF¿meBufãr
(ècÚ¡ {  
	gmyCu¼’tF¿meBufãr
; }

149 
uIÁ8
* 
´eviousF¿meBufãr
(ècÚ¡ {  
	gmyP»viousF¿meBufãr
; }

156 
uIÁ32
 
height
() const;

163 
uIÁ32
 
width
() const;

172 
uIÁ32
 
sÿÆšes
() const;

179 
uIÁ32
 
şocksThisLše
() const;

184 
£tSound
(
Sound
& 
sound
);

186 
	eTIAB™
 {

187 
	gP0
,

188 
	gP1
,

189 
	gM0
,

190 
	gM1
,

191 
	gBL
,

192 
	gPF


200 
boŞ
 
’abËB™
(
TIAB™
 
b
, boŞ 
mode
è{ 
	gmyB™EÇbËd
[b] = mode;  
	gmode
; }

207 
boŞ
 
toggËB™
(
TIAB™
 
b
è{ 
	gmyB™EÇbËd
[b] = !
myB™EÇbËd
[b];  myBitEnabled[b]; }

214 
’abËB™s
(
boŞ
 
mode
è{ 
uIÁ8
 
	gi
 = 0; i < 6; ++iè
	gmyB™EÇbËd
[
i
] = mode; }

216 #ifdeà
DEBUGGER_SUPPORT


221 
vœtu®
 
upd©eSÿÆše
();

227 
vœtu®
 
upd©eSÿÆšeByS‹p
();

233 
vœtu®
 
upd©eSÿÆšeByT¿û
(
rg‘
);

236 
	g´iv©e
:

238 
compu‹B®lMaskTabË
();

241 
compu‹CŞlisiÚTabË
();

244 
compu‹Mis¦eMaskTabË
();

247 
compu‹PÏy”MaskTabË
();

250 
compu‹PÏy”Pos™iÚRe£tWh’TabË
();

253 
compu‹PÏy”ReæeùTabË
();

256 
compu‹PÏyf›ldMaskTabË
();

258 
	g´iv©e
:

260 
upd©eF¿meSÿÆše
(
uIÁ32
 
şocksToUpd©e
, uIÁ32 
hpos
);

263 
upd©eF¿me
(
IÁ32
 
şock
);

266 
wa™HÜizÚlSync
();

269 
g»yOutF¿me
();

272 
ş—rBufãrs
();

275 
¡¬tF¿me
();

278 
’dF¿me
();

280 
	g´iv©e
:

282 cÚ¡ 
CÚsŞe
& 
myCÚsŞe
;

285 cÚ¡ 
	gS‘tšgs
& 
	gmyS‘tšgs
;

288 
Sound
* 
	gmySound
;

290 
	g´iv©e
:

294 
boŞ
 
myCŞÜLossEÇbËd
;

298 
boŞ
 
	gmyP¬tŸlF¿meFÏg
;

300 
	g´iv©e
:

302 
myF¿meCouÁ”
;

305 
uIÁ8
* 
	gmyCu¼’tF¿meBufãr
;

308 
uIÁ8
* 
	gmyP»viousF¿meBufãr
;

311 
uIÁ8
* 
	gmyF¿mePoš‹r
;

314 
uIÁ32
 
	gmyF¿meXS¹
;

317 
uIÁ32
 
	gmyF¿meWidth
;

320 
uIÁ32
 
	gmyF¿meYS¹
;

323 
uIÁ32
 
	gmyF¿meHeight
;

325 
	g´iv©e
:

328 
uIÁ32
 
myYS¹
;

331 
uIÁ32
 
	gmyHeight
;

334 
uIÁ32
 
	gmyS¹Di¥ÏyOff£t
;

337 
uIÁ32
 
	gmyStİDi¥ÏyOff£t
;

339 
	g´iv©e
:

341 
IÁ32
 
myClockWh’F¿meS¹ed
;

344 
IÁ32
 
	gmyClockS¹Di¥Ïy
;

347 
IÁ32
 
	gmyClockStİDi¥Ïy
;

350 
IÁ32
 
	gmyClockAtLa¡Upd©e
;

355 
IÁ32
 
	gmyClocksToEndOfSÿnLše
;

358 
IÁ32
 
	gmySÿÆšeCouÁFÜLa¡F¿me
;

361 
IÁ32
 
	gmyCu¼’tSÿÆše
;

364 
IÁ32
 
	gmyMaximumNumb”OfSÿÆšes
;

366 
	g´iv©e
:

368 
IÁ32
 
myVSYNCFšishClock
;

370 
	g´iv©e
:

373 
myP0B™
 = 0x01,

374 
	gmyM0B™
 = 0x02,

375 
	gmyP1B™
 = 0x04,

376 
	gmyM1B™
 = 0x08,

377 
	gmyBLB™
 = 0x10,

378 
	gmyPFB™
 = 0x20,

379 
	gScÜeB™
 = 0x40,

380 
	gPriÜ™yB™
 = 0x080

384 
uIÁ8
 
	gmyEÇbËdObjeùs
;

386 
	g´iv©e
:

387 
uIÁ8
 
myVSYNC
;

388 
uIÁ8
 
	gmyVBLANK
;

390 
uIÁ8
 
	gmyNUSIZ0
;

391 
uIÁ8
 
	gmyNUSIZ1
;

393 
uIÁ8
 
	gmyPÏyf›ldPriÜ™yAndScÜe
;

394 
uIÁ32
 
	gmyCŞÜ
[4];

395 
uIÁ8
 
	gmyPriÜ™yEncod”
[2][256];

397 
	guIÁ32
& 
	gmyCOLUBK
;

398 
	guIÁ32
& 
	gmyCOLUPF
;

399 
	guIÁ32
& 
	gmyCOLUP0
;

400 
	guIÁ32
& 
	gmyCOLUP1
;

402 
uIÁ8
 
	gmyCTRLPF
;

404 
boŞ
 
	gmyREFP0
;

405 
boŞ
 
	gmyREFP1
;

407 
uIÁ32
 
	gmyPF
;

409 
uIÁ8
 
	gmyGRP0
;

410 
uIÁ8
 
	gmyGRP1
;

412 
uIÁ8
 
	gmyDGRP0
;

413 
uIÁ8
 
	gmyDGRP1
;

415 
boŞ
 
	gmyENAM0
;

416 
boŞ
 
	gmyENAM1
;

418 
boŞ
 
	gmyENABL
;

419 
boŞ
 
	gmyDENABL
;

421 
IÁ8
 
	gmyHMP0
;

422 
IÁ8
 
	gmyHMP1
;

423 
IÁ8
 
	gmyHMM0
;

424 
IÁ8
 
	gmyHMM1
;

425 
IÁ8
 
	gmyHMBL
;

427 
boŞ
 
	gmyVDELP0
;

428 
boŞ
 
	gmyVDELP1
;

429 
boŞ
 
	gmyVDELBL
;

431 
boŞ
 
	gmyRESMP0
;

432 
boŞ
 
	gmyRESMP1
;

434 
uIÁ16
 
	gmyCŞlisiÚ
;

438 
IÁ16
 
	gmyPOSP0
;

439 
IÁ16
 
	gmyPOSP1
;

440 
IÁ16
 
	gmyPOSM0
;

441 
IÁ16
 
	gmyPOSM1
;

442 
IÁ16
 
	gmyPOSBL
;

444 
	g´iv©e
:

447 
uIÁ8
 
myCu¼’tGRP0
;

451 
uIÁ8
 
	gmyCu¼’tGRP1
;

458 
uIÁ8
* 
	gmyCu¼’tBLMask
;

461 
uIÁ8
* 
	gmyCu¼’tM0Mask
;

464 
uIÁ8
* 
	gmyCu¼’tM1Mask
;

467 
uIÁ8
* 
	gmyCu¼’tP0Mask
;

470 
uIÁ8
* 
	gmyCu¼’tP1Mask
;

473 
uIÁ32
* 
	gmyCu¼’tPFMask
;

476 
uIÁ8
 
	gmyAUDV0
;

477 
uIÁ8
 
	gmyAUDV1
;

478 
uIÁ8
 
	gmyAUDC0
;

479 
uIÁ8
 
	gmyAUDC1
;

480 
uIÁ8
 
	gmyAUDF0
;

481 
uIÁ8
 
	gmyAUDF1
;

483 
	g´iv©e
:

485 
IÁ32
 
myDumpDi§bËdCyşe
;

488 
boŞ
 
	gmyDumpEÇbËd
;

490 
	g´iv©e
:

492 
IÁ32
 
myLa¡HMOVEClock
;

495 
boŞ
 
	gmyHMOVEBÏnkEÇbËd
;

498 
boŞ
 
	gmyAÎowHMOVEBÏnks
;

501 
boŞ
 
	gmyM0CosmicArkMÙiÚEÇbËd
;

504 
uIÁ32
 
	gmyM0CosmicArkCouÁ”
;

507 
boŞ
 
	gmyB™EÇbËd
[6];

510 
boŞ
 
	gmyF¿meG»yed
;

512 
	g´iv©e
:

514 
uIÁ8
 
ourB®lMaskTabË
[4][4][320];

517 
uIÁ16
 
	gourCŞlisiÚTabË
[64];

520 
uIÁ8
 
	gourDi§bËdMaskTabË
[640];

523 cÚ¡ 
IÁ16
 
	gourPokeD–ayTabË
[64];

526 
uIÁ8
 
	gourMis¦eMaskTabË
[4][8][4][320];

530 cÚ¡ 
IÁ32
 
	gourCom¶‘eMÙiÚTabË
[76][16];

533 cÚ¡ 
boŞ
 
	gourHMOVEBÏnkEÇbËCyşes
[76];

536 
uIÁ8
 
	gourPÏy”MaskTabË
[4][2][8][320];

539 
IÁ8
 
	gourPÏy”Pos™iÚRe£tWh’TabË
[8][160][160];

542 
uIÁ8
 
	gourPÏy”ReæeùTabË
[256];

545 
uIÁ32
 
	gourPÏyf›ldTabË
[2][160];

547 
	g´iv©e
:

549 
TIA
(const TIA&);

552 
	gTIA
& 
	gİ”©Ü
 = (cÚ¡ 
TIA
&);

	@emucore/TIASnd.cxx

19 
	~"Sy¡em.hxx
"

20 
	~"TIASnd.hxx
"

23 
	gTIASound
::
	$TIASound
(
IÁ32
 
ouutF»qu’cy
, IÁ32 
tŸF»qu’cy
, 
uIÁ32
 
chªÃls
)

24 : 
	`myOuutF»qu’cy
(
ouutF»qu’cy
),

25 
	`myTIAF»qu’cy
(
tŸF»qu’cy
),

26 
	`myChªÃls
(
chªÃls
),

27 
	`myOuutCouÁ”
(0),

28 
	`myVŞumeP”ûÁage
(100),

29 
	$myVŞumeCl
(128)

31 
	`»£t
();

32 
	}
}

35 
	gTIASound
::~
	$TIASound
()

37 
	}
}

40 
TIASound
::
	$»£t
()

42 
myAUDC
[0] = myAUDC[1] = 
myAUDF
[0] = myAUDF[1] = 
myAUDV
[0] = myAUDV[1] = 0;

43 
myP4
[0] = 
myP5
[0] = myP4[1] = myP5[1] = 1;

44 
myF»qDiv
[0].
	`£t
(0);

45 
myF»qDiv
[1].
	`£t
(0);

46 
myOuutCouÁ”
 = 0;

47 
	}
}

50 
	gTIASound
::
	$ouutF»qu’cy
(
IÁ32
 
äeq
)

52 
myOuutF»qu’cy
 = 
äeq
;

53 
	}
}

56 
	gTIASound
::
	$tŸF»qu’cy
(
IÁ32
 
äeq
)

58 
myTIAF»qu’cy
 = 
äeq
;

59 
	}
}

62 
	gTIASound
::
	$chªÃls
(
uIÁ32
 
numb”
)

64 
myChªÃls
 = 
numb”
 == 2 ? 2 : 1;

65 
	}
}

68 
	gTIASound
::
	$şVŞume
(
boŞ
 
ş
)

70 
myVŞumeCl
 = 
ş
 ? 128 : 0;

71 
	}
}

74 
	gTIASound
::
	$£t
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

76 
add»ss
)

79 
myAUDC
[0] = 
v®ue
 & 0x0f;

83 
myAUDC
[1] = 
v®ue
 & 0x0f;

87 
myAUDF
[0] = 
v®ue
 & 0x1f;

88 
myF»qDiv
[0].
	`£t
(
myAUDF
[0]);

92 
myAUDF
[1] = 
v®ue
 & 0x1f;

93 
myF»qDiv
[1].
	`£t
(
myAUDF
[1]);

97 
myAUDV
[0] = 
v®ue
 & 0x0f;

101 
myAUDV
[1] = 
v®ue
 & 0x0f;

107 
	}
}

110 
uIÁ8
 
	gTIASound
::
	$g‘
(
uIÁ16
 
add»ss
)

112 
add»ss
)

115  
myAUDC
[0];

118  
myAUDC
[1];

121  
myAUDF
[0];

124  
myAUDF
[1];

127  
myAUDV
[0];

130  
myAUDV
[1];

135 
	}
}

138 
	gTIASound
::
	$vŞume
(
uIÁ32
 
³rûÁ
)

140 if((
³rûÁ
 >= 0) && (percent <= 100))

141 
myVŞumeP”ûÁage
 = 
³rûÁ
;

142 
	}
}

145 
	gTIASound
::
	$´oûss
(
uIÁ8
* 
bufãr
, 
uIÁ32
 
§m¶es
)

147 
IÁ32
 
v0
 = ((
myAUDV
[0] << 2è* 
myVŞumeP”ûÁage
) / 100;

148 
IÁ32
 
v1
 = ((
myAUDV
[1] << 2è* 
myVŞumeP”ûÁage
) / 100;

151 
§m¶es
 > 0)

154 
uIÁ32
 
c
 = 0; c < 2; ++c)

157 if((
myF»qDiv
[
c
].
	`şock
()))

159 
myAUDC
[
c
])

164 
myP4
[
c
] = (myP4[c] << 1) | 0x01;

171 
myP4
[
c
] = (myP4[c] & 0x0f) ?

172 ((
myP4
[
c
] << 1) | (((myP4[c] & 0x08) ? 1 : 0) ^

173 ((
myP4
[
c
] & 0x04) ? 1 : 0))) : 1;

180 
myP5
[
c
] = (myP5[c] & 0x1f) ?

181 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

182 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

185 if((
myP5
[
c
] & 0x0f) == 0x08)

188 
myP4
[
c
] = (myP4[c] & 0x0f) ?

189 ((
myP4
[
c
] << 1) | (((myP4[c] & 0x08) ? 1 : 0) ^

190 ((
myP4
[
c
] & 0x04) ? 1 : 0))) : 1;

198 
myP5
[
c
] = (myP5[c] & 0x1f) ?

199 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

200 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

203 if(
myP5
[
c
] & 0x10)

206 
myP4
[
c
] = (myP4[c] & 0x0f) ?

207 ((
myP4
[
c
] << 1) | (((myP4[c] & 0x08) ? 1 : 0) ^

208 ((
myP4
[
c
] & 0x04) ? 1 : 0))) : 1;

216 
myP4
[
c
] = (myP4[c] << 1) | ((myP4[c] & 0x01) ? 0 : 1);

223 
myP4
[
c
] = (myP4[c] << 1) | ((myP4[c] & 0x01) ? 0 : 1);

230 
myP5
[
c
] = (myP5[c] & 0x1f) ?

231 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

232 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

235 if((
myP5
[
c
] & 0x0f) == 0x08)

238 
myP4
[
c
] = (myP4[c] << 1) | ((myP4[c] & 0x01) ? 0 : 1);

246 
myP5
[
c
] = (myP5[c] & 0x1f) ?

247 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

248 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

251 if(
myP5
[
c
] & 0x10)

254 
myP4
[
c
] = (myP4[c] << 1) | ((myP4[c] & 0x01) ? 0 : 1);

262 
myP5
[
c
] = ((myP5[c] & 0x1fè|| (
myP4
[c] & 0x0f)) ?

263 ((
myP5
[
c
] << 1è| (((
myP4
[c] & 0x08) ? 1 : 0) ^

264 ((
myP5
[
c
] & 0x10) ? 1 : 0))) : 1;

265 
myP4
[
c
] = (myP4[c] << 1è| ((
myP5
[c] & 0x20) ? 1 : 0);

272 
myP5
[
c
] = (myP5[c] & 0x1f) ?

273 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

274 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

277 
myP4
[
c
] = (myP4[c] << 1è| ((
myP5
[c] & 0x20) ? 1 : 0);

284 
myP5
[
c
] = (myP5[c] & 0x1f) ?

285 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

286 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

289 if((
myP5
[
c
] & 0x0f) == 0x08)

292 
myP4
[
c
] = (myP4[c] << 1è| ((
myP5
[c] & 0x10) ? 1 : 0);

300 
myP4
[
c
] = (myP4[c] << 1) | 0x01;

307 
myP4
[
c
] = (~myP4[c] << 1) |

308 ((!(!(
myP4
[
c
] & 4) && ((myP4[c] & 7)))) ? 0 : 1);

315 
myP4
[
c
] = (~myP4[c] << 1) |

316 ((!(!(
myP4
[
c
] & 4) && ((myP4[c] & 7)))) ? 0 : 1);

323 
myP5
[
c
] = (myP5[c] & 0x1f) ?

324 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

325 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

328 if((
myP5
[
c
] & 0x0f) == 0x08)

331 
myP4
[
c
] = (~myP4[c] << 1) |

332 ((!(!(
myP4
[
c
] & 4) && ((myP4[c] & 7)))) ? 0 : 1);

340 
myP5
[
c
] = (myP5[c] & 0x1f) ?

341 ((
myP5
[
c
] << 1) | (((myP5[c] & 0x10) ? 1 : 0) ^

342 ((
myP5
[
c
] & 0x04) ? 1 : 0))) : 1;

345 if(
myP5
[
c
] & 0x10)

348 
myP4
[
c
] = (~myP4[c] << 1) |

349 ((!(!(
myP4
[
c
] & 4) && ((myP4[c] & 7)))) ? 0 : 1);

357 
myOuutCouÁ”
 +ğ
myOuutF»qu’cy
;

359 if(
myChªÃls
 == 1)

362 (
§m¶es
 > 0è&& (
myOuutCouÁ”
 >ğ
myTIAF»qu’cy
))

364 *(
bufãr
++èğ(((
myP4
[0] & 8è? 
v0
 : 0) +

365 ((
myP4
[1] & 8è? 
v1
 : 0)è+ 
myVŞumeCl
;

366 
myOuutCouÁ”
 -ğ
myTIAF»qu’cy
;

367 
§m¶es
--;

373 (
§m¶es
 > 0è&& (
myOuutCouÁ”
 >ğ
myTIAF»qu’cy
))

375 *(
bufãr
++èğ((
myP4
[0] & 8è? 
v0
 : 0è+ 
myVŞumeCl
;

376 *(
bufãr
++èğ((
myP4
[1] & 8è? 
v1
 : 0è+ 
myVŞumeCl
;

377 
myOuutCouÁ”
 -ğ
myTIAF»qu’cy
;

378 
§m¶es
--;

382 
	}
}

	@emucore/TIASnd.hxx

19 #iâdeà
TIASOUND_HXX


20 
	#TIASOUND_HXX


	)

22 
	~"b¥f.hxx
"

31 şas 
	cTIASound


33 
	mpublic
:

37 
TIASound
(
IÁ32
 
ouutF»qu’cy
 = 31400, IÁ32 
tŸF»qu’cy
 = 31400,

38 
uIÁ32
 
chªÃls
 = 1);

43 
	mvœtu®
 ~
TIASound
();

45 
	mpublic
:

49 
»£t
();

54 
ouutF»qu’cy
(
IÁ32
 
äeq
);

59 
tŸF»qu’cy
(
IÁ32
 
äeq
);

64 
chªÃls
(
uIÁ32
 
numb”
);

69 
şVŞume
(
boŞ
 
ş
);

71 
	mpublic
:

78 
£t
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

85 
uIÁ8
 
g‘
(
uIÁ16
 
add»ss
);

95 
´oûss
(
uIÁ8
* 
bufãr
, 
uIÁ32
 
§m¶es
);

100 
vŞume
(
uIÁ32
 
³rûÁ
);

102 
	m´iv©e
:

107 şas 
	cF»qDiv


109 
public
:

110 
F»qDiv
()

112 
myDivideByV®ue
 = 
myCouÁ”
 = 0;

115 
£t
(
uIÁ32
 
divideBy
)

117 
	mmyDivideByV®ue
 = 
divideBy
;

120 
boŞ
 
şock
()

122 if(++
	mmyCouÁ”
 > 
	mmyDivideByV®ue
)

124 
	mmyCouÁ”
 = 0;

125  
	mŒue
;

127  
	mçl£
;

130 
	m´iv©e
:

131 
uIÁ32
 
myDivideByV®ue
;

132 
uIÁ32
 
	mmyCouÁ”
;

135 
	g´iv©e
:

136 
uIÁ8
 
myAUDC
[2];

137 
uIÁ8
 
	gmyAUDF
[2];

138 
uIÁ8
 
	gmyAUDV
[2];

140 
F»qDiv
 
	gmyF»qDiv
[2];

141 
uIÁ8
 
	gmyP4
[2];

142 
uIÁ8
 
	gmyP5
[2];

144 
IÁ32
 
	gmyOuutF»qu’cy
;

145 
IÁ32
 
	gmyTIAF»qu’cy
;

146 
uIÁ32
 
	gmyChªÃls
;

147 
IÁ32
 
	gmyOuutCouÁ”
;

148 
uIÁ32
 
	gmyVŞumeP”ûÁage
;

149 
uIÁ8
 
	gmyVŞumeCl
;

	@emucore/m6502/src/Device.cxx

19 
	~"Deviû.hxx
"

22 
	gDeviû
::
	$Deviû
()

23 : 
	$mySy¡em
(0)

25 
	}
}

28 
Deviû
::~
	$Deviû
()

30 
	}
}

33 
Deviû
::
	$sy¡emCyşesRe£t
()

36 
	}
}

	@emucore/m6502/src/Device.hxx

19 #iâdeà
DEVICE_HXX


20 
	#DEVICE_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

35 şas 
	cDeviû


37 
	mpublic
:

41 
Deviû
();

46 
	mvœtu®
 ~
Deviû
();

48 
	mpublic
:

54 
vœtu®
 cÚ¡ * 
	$Çme
() const = 0;

59 
vœtu®
 
	`»£t
() = 0;

66 
vœtu®
 
	`sy¡emCyşesRe£t
();

74 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
) = 0;

82 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
) = 0;

90 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
) = 0;

92 
public
:

98 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
) = 0;

106 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
) = 0;

108 
´Ùeùed
:

110 
Sy¡em
* 
mySy¡em
;

	@emucore/m6502/src/M6502.cxx

19 
	~"M6502.hxx
"

21 #ifdeà
DEBUGGER_SUPPORT


22 
	~"Ex´essiÚ.hxx
"

26 
	gM6502
::
	$M6502
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
)

27 : 
	`myExecutiÚStus
(0),

28 
	`mySy¡em
(0),

29 
	$mySy¡emCyşesP”ProûssÜCyşe
(
sy¡emCyşesP”ProûssÜCyşe
)

31 #ifdeà
DEBUGGER_SUPPORT


32 
myDebugg”
 = 
NULL
;

33 
myB»akPošts
 = 
NULL
;

34 
myR—dT¿ps
 = 
NULL
;

35 
myWr™eT¿ps
 = 
NULL
;

39 
uIÁ16
 
t
;

40 
t
 = 0; < 256; ++t)

42 
ourBCDTabË
[0][
t
] = ((t >> 4) * 10) + (t & 0x0f);

43 
ourBCDTabË
[1][
t
] = (((t % 100) / 10) << 4) | (t % 10);

47 
t
 = 0; < 256; ++t)

49 
myIn¡ruùiÚSy¡emCyşeTabË
[
t
] = 
ourIn¡ruùiÚProûssÜCyşeTabË
[t] *

50 
mySy¡emCyşesP”ProûssÜCyşe
;

53 
myTÙ®In¡ruùiÚCouÁ
 = 0;

54 
	}
}

57 
	gM6502
::~
	$M6502
()

59 #ifdeà
DEBUGGER_SUPPORT


60 
myB»akCÚds
.
	`ş—r
();

61 
myB»akCÚdNames
.
	`ş—r
();

63 
	}
}

66 
	gM6502
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

69 
mySy¡em
 = &
sy¡em
;

70 
	}
}

73 
	gM6502
::
	$»£t
()

76 
myExecutiÚStus
 = 0;

79 
A
 = 
X
 = 
Y
 = 0;

80 
SP
 = 0xff;

81 
	`PS
(0x20);

84 
myLa¡AcûssWasR—d
 = 
Œue
;

87 
PC
 = (
uIÁ16
)
mySy¡em
->
	`³ek
(0xfffc) | ((uInt16)mySystem->peek(0xfffd) << 8);

88 
	}
}

91 
	gM6502
::
	$œq
()

93 
myExecutiÚStus
 |ğ
MaskabËIÁ”ru±B™
;

94 
	}
}

97 
	gM6502
::
	$nmi
()

99 
myExecutiÚStus
 |ğ
NÚmaskabËIÁ”ru±B™
;

100 
	}
}

103 
	gM6502
::
	$¡İ
()

105 
myExecutiÚStus
 |ğ
StİExecutiÚB™
;

106 
	}
}

109 
	gM6502
::
Add»ssšgMode
 
M6502
::
	$add»ssšgMode
(
uIÁ8
 
İcode
) const

111  
ourAdd»ssšgModeTabË
[
İcode
];

112 
	}
}

115 
uIÁ8
 
	gM6502
::
	$PS
() const

117 
uIÁ8
 
ps
 = 0x20;

119 if(
N
)

120 
ps
 |= 0x80;

121 if(
V
)

122 
ps
 |= 0x40;

123 if(
B
)

124 
ps
 |= 0x10;

125 if(
D
)

126 
ps
 |= 0x08;

127 if(
I
)

128 
ps
 |= 0x04;

129 if(!
nÙZ
)

130 
ps
 |= 0x02;

131 if(
C
)

132 
ps
 |= 0x01;

134  
ps
;

135 
	}
}

138 
	gM6502
::
	$PS
(
uIÁ8
 
ps
)

140 
N
 = 
ps
 & 0x80;

141 
V
 = 
ps
 & 0x40;

142 
B
 = 
Œue
;

143 
D
 = 
ps
 & 0x08;

144 
I
 = 
ps
 & 0x04;

145 
nÙZ
 = !(
ps
 & 0x02);

146 
C
 = 
ps
 & 0x01;

147 
	}
}

150 
	go¡»am
& 
	gİ”©Ü
<<(o¡»am& 
	gout
, cÚ¡ 
	gM6502
::
Add»ssšgMode
& 
mode
)

152 
mode
)

154 
M6502
::
AbsŞu‹
:

155 
out
 << "$nnnn ";

157 
	gM6502
::
AbsŞu‹X
:

158 
out
 << "$nnnn,X";

160 
	gM6502
::
AbsŞu‹Y
:

161 
out
 << "$nnnn,Y";

163 
	gM6502
::
Im¶›d
:

164 
out
 << "implied";

166 
	gM6502
::
ImmedŸ‹
:

167 
out
 << "#$nn ";

169 
	gM6502
::
Indœeù
:

170 
out
 << "($nnnn)";

172 
	gM6502
::
IndœeùX
:

173 
out
 << "($nn,X)";

175 
	gM6502
::
IndœeùY
:

176 
out
 << "($nn),Y";

178 
	gM6502
::
Inv®id
:

179 
out
 << "invalid";

181 
	gM6502
::
R–©ive
:

182 
out
 << "$nn ";

184 
	gM6502
::
Z”o
:

185 
out
 << "$nn ";

187 
	gM6502
::
Z”oX
:

188 
out
 << "$nn,X ";

190 
	gM6502
::
Z”oY
:

191 
out
 << "$nn,Y ";

194  
	gout
;

198 
uIÁ8
 
	gM6502
::
ourBCDTabË
[2][256];

201 
	gM6502
::
Add»ssšgMode
 
M6502
::
ourAdd»ssšgModeTabË
[256] = {

202 
Im¶›d
, 
IndœeùX
, 
Inv®id
, IndirectX,

203 
Z”o
, Zero, Zero, Zero,

204 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

205 
AbsŞu‹
, Absolute, Absolute, Absolute,

207 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

208 
Z”oX
, ZeroX, ZeroX, ZeroX,

209 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

210 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX,

212 
AbsŞu‹
, 
IndœeùX
, 
Inv®id
, IndirectX,

213 
Z”o
, Zero, Zero, Zero,

214 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

215 
AbsŞu‹
, Absolute, Absolute, Absolute,

217 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

218 
Z”oX
, ZeroX, ZeroX, ZeroX,

219 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

220 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX,

222 
Im¶›d
, 
IndœeùX
, 
Inv®id
, IndirectX,

223 
Z”o
, Zero, Zero, Zero,

224 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

225 
AbsŞu‹
, Absolute, Absolute, Absolute,

227 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

228 
Z”oX
, ZeroX, ZeroX, ZeroX,

229 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

230 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX,

232 
Im¶›d
, 
IndœeùX
, 
Inv®id
, IndirectX,

233 
Z”o
, Zero, Zero, Zero,

234 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

235 
Indœeù
, 
AbsŞu‹
, Absolute, Absolute,

237 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

238 
Z”oX
, ZeroX, ZeroX, ZeroX,

239 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

240 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX,

242 
ImmedŸ‹
, 
IndœeùX
, Immediate, IndirectX,

243 
Z”o
, Zero, Zero, Zero,

244 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

245 
AbsŞu‹
, Absolute, Absolute, Absolute,

247 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

248 
Z”oX
, Z”oX, 
Z”oY
, ZeroY,

249 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

250 
AbsŞu‹X
, AbsŞu‹X, 
AbsŞu‹Y
, AbsoluteY,

252 
ImmedŸ‹
, 
IndœeùX
, Immediate, IndirectX,

253 
Z”o
, Zero, Zero, Zero,

254 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

255 
AbsŞu‹
, Absolute, Absolute, Absolute,

257 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

258 
Z”oX
, Z”oX, 
Z”oY
, ZeroY,

259 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

260 
AbsŞu‹X
, AbsŞu‹X, 
AbsŞu‹Y
, AbsoluteY,

262 
ImmedŸ‹
, 
IndœeùX
, Immediate, IndirectX,

263 
Z”o
, Zero, Zero, Zero,

264 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

265 
AbsŞu‹
, Absolute, Absolute, Absolute,

267 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

268 
Z”oX
, ZeroX, ZeroX, ZeroX,

269 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

270 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX,

272 
ImmedŸ‹
, 
IndœeùX
, Immediate, IndirectX,

273 
Z”o
, Zero, Zero, Zero,

274 
Im¶›d
, 
ImmedŸ‹
, Implied, Immediate,

275 
AbsŞu‹
, Absolute, Absolute, Absolute,

277 
R–©ive
, 
IndœeùY
, 
Inv®id
, IndirectY,

278 
Z”oX
, ZeroX, ZeroX, ZeroX,

279 
Im¶›d
, 
AbsŞu‹Y
, Implied, AbsoluteY,

280 
AbsŞu‹X
, AbsoluteX, AbsoluteX, AbsoluteX

284 
uIÁ32
 
	gM6502
::
ourIn¡ruùiÚProûssÜCyşeTabË
[256] = {

305 cÚ¡ * 
	gM6502
::
ourIn¡ruùiÚMÃmÚicTabË
[256] = {

355 #ifdeà
DEBUGGER_SUPPORT


411 
	gM6502
::
	$©ch
(
Debugg”
& 
debugg”
)

414 
myDebugg”
 = &
debugg”
;

415 
	}
}

418 
	gM6502
::
	$addCÚdB»ak
(
Ex´essiÚ
 *
e
, 
¡ršg
 
Çme
)

420 
myB»akCÚds
.
	`push_back
(
e
);

421 
myB»akCÚdNames
.
	`push_back
(
Çme
);

422  
myB»akCÚds
.
	`size
() - 1;

423 
	}
}

426 
	gM6502
::
	$d–CÚdB»ak
(
brk
)

428 if(
brk
 < 
myB»akCÚds
.
	`size
())

430 
d–‘e
 
myB»akCÚds
[
brk
];

431 
myB»akCÚds
.
	`»move_©
(
brk
);

432 
myB»akCÚdNames
.
	`»move_©
(
brk
);

434 
	}
}

437 
	gM6502
::
	$ş—rCÚdB»aks
()

439 
i
=0; i<
myB»akCÚds
.
	`size
(); i++)

440 
d–‘e
 
myB»akCÚds
[
i
];

441 
myB»akCÚds
.
	`ş—r
();

442 
myB»akCÚdNames
.
	`ş—r
();

443 
	}
}

446 cÚ¡ 
	gSŒšgLi¡
& 
	gM6502
::
	$g‘CÚdB»akNames
()

448  
myB»akCÚdNames
;

449 
	}
}

452 
	gM6502
::
	$ev®CÚdB»aks
()

454 
i
=0; i<
myB»akCÚds
.
	`size
(); i++)

456 
Ex´essiÚ
* 
e
 = 
myB»akCÚds
[
i
];

457 if(
e
->
	`ev®u©e
())

458  
i
;

462 
	}
}

465 
	gM6502
::
	$£tB»akPošts
(
PackedB™A¼ay
 *
bp
)

467 
myB»akPošts
 = 
bp
;

468 
	}
}

471 
	gM6502
::
	$£tT¿ps
(
PackedB™A¼ay
 *
»ad
, PackedB™A¼ay *
wr™e
)

473 
myR—dT¿ps
 = 
»ad
;

474 
myWr™eT¿ps
 = 
wr™e
;

475 
	}
}

	@emucore/m6502/src/M6502.hxx

19 #iâdeà
M6502_HXX


20 
	#M6502_HXX


	)

22 
şass
 
	gD6502
;

23 
şass
 
	gM6502
;

24 
şass
 
	gS”Ÿliz”
;

25 
şass
 
	gDe£rŸliz”
;

26 
şass
 
	gDebugg”
;

27 
şass
 
	gCpuDebug
;

28 
şass
 
	gEx´essiÚ
;

29 
şass
 
	gPackedB™A¼ay
;

31 
	~"b¥f.hxx
"

32 
	~"Sy¡em.hxx
"

33 
	~"A¼ay.hxx
"

34 #ifdeà
DEBUGGER_SUPPORT


35 
	~"SŒšgLi¡.hxx
"

38 
	gCommÚ
::
	tA¼ay
<
	tEx´essiÚ
*> 
	tEx´essiÚLi¡
;

48 şas 
	cM6502


50 
	mpublic
:

54 
ä›nd
 
şass
 
CpuDebug
;

56 
	mpublic
:

60 
	eAdd»ssšgMode


62 
AbsŞu‹
, 
	mAbsŞu‹X
, 
	mAbsŞu‹Y
, 
	mImmedŸ‹
, 
	mIm¶›d
,

63 
	mIndœeù
, 
	mIndœeùX
, 
	mIndœeùY
, 
	mInv®id
, 
	mR–©ive
,

64 
	mZ”o
, 
	mZ”oX
, 
	mZ”oY


67 
	gpublic
:

75 
M6502
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
);

80 
	gvœtu®
 ~
M6502
();

82 
	gpublic
:

89 
vœtu®
 
š¡®l
(
Sy¡em
& 
sy¡em
);

96 
vœtu®
 
»£t
();

101 
vœtu®
 
œq
();

106 
vœtu®
 
nmi
();

114 
vœtu®
 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
) = 0;

122 
vœtu®
 
boŞ
 
lßd
(
De£rŸliz”
& 
š
) = 0;

129 
vœtu®
 cÚ¡ * 
	$Çme
() const = 0;

131 
public
:

138 
Add»ssšgMode
 
	$add»ssšgMode
(
uIÁ8
 
İcode
) const;

140 
public
:

149 
vœtu®
 
boŞ
 
	`execu‹
(
uIÁ32
 
numb”
) = 0;

156 
	`¡İ
();

164 
boŞ
 
	$çlE¼Ü
() const

166  
myExecutiÚStus
 & 
F©®E¼ÜB™
;

167 
	}
}

174 
uIÁ16
 
	$g‘PC
(ècÚ¡ {  
PC
; 
	}
}

181 
boŞ
 
	$Ï¡AcûssWasR—d
(ècÚ¡ {  
myLa¡AcûssWasR—d
; 
	}
}

183 
	gpublic
:

190 
ä›nd
 
o¡»am
& 
İ”©Ü
<<(o¡»am& 
out
, cÚ¡ 
	gAdd»ssšgMode
& 
	gmode
);

192 
	gpublic
:

193 #ifdeà
DEBUGGER_SUPPORT


199 
©ch
(
Debugg”
& 
debugg”
);

202 
£tB»akPošts
(
PackedB™A¼ay
 *
bp
);

203 
£tT¿ps
(
PackedB™A¼ay
 *
»ad
, PackedB™A¼ay *
wr™e
);

204 
	$tÙ®In¡ruùiÚCouÁ
(è{  
myTÙ®In¡ruùiÚCouÁ
; 
	}
}

206 
addCÚdB»ak
(
Ex´essiÚ
 *
e
, 
¡ršg
 
Çme
);

207 
d–CÚdB»ak
(
brk
);

208 
ş—rCÚdB»aks
();

209 cÚ¡ 
	gSŒšgLi¡
& 
g‘CÚdB»akNames
();

210 
ev®CÚdB»aks
();

213 
	g´Ùeùed
:

219 
uIÁ8
 
	$PS
() const;

226 
	`PS
(
uIÁ8
 
ps
);

228 
´Ùeùed
:

229 
uIÁ8
 
A
;

230 
uIÁ8
 
X
;

231 
uIÁ8
 
Y
;

232 
uIÁ8
 
SP
;

233 
uIÁ8
 
IR
;

234 
uIÁ16
 
PC
;

236 
boŞ
 
N
;

237 
boŞ
 
V
;

238 
boŞ
 
B
;

239 
boŞ
 
D
;

240 
boŞ
 
I
;

241 
boŞ
 
nÙZ
;

242 
boŞ
 
C
;

244 #ifdeà
DEBUGGER_SUPPORT


246 
Debugg”
* 
myDebugg”
;

248 
PackedB™A¼ay
* 
myB»akPošts
;

249 
PackedB™A¼ay
* 
myR—dT¿ps
;

250 
PackedB™A¼ay
* 
myWr™eT¿ps
;

253 
boŞ
 
myJu¡H™T¿pFÏg
;

254 
	sH™T¿pInfo
 {

255 
¡ršg
 
mes§ge
;

256 
add»ss
;

257 
	}
};

258 
H™T¿pInfo
 
	gmyH™T¿pInfo
;

260 
SŒšgLi¡
 
	gmyB»akCÚdNames
;

261 
Ex´essiÚLi¡
 
	gmyB»akCÚds
;

269 
uIÁ8
 
	gmyExecutiÚStus
;

276 
	gStİExecutiÚB™
 = 0x01,

277 
	gF©®E¼ÜB™
 = 0x02,

278 
	gMaskabËIÁ”ru±B™
 = 0x04,

279 
	gNÚmaskabËIÁ”ru±B™
 = 0x08

283 
Sy¡em
* 
	gmySy¡em
;

286 cÚ¡ 
uIÁ32
 
	gmySy¡emCyşesP”ProûssÜCyşe
;

289 
uIÁ32
 
	gmyIn¡ruùiÚSy¡emCyşeTabË
[256];

292 
boŞ
 
	gmyLa¡AcûssWasR—d
;

294 
	g´Ùeùed
:

296 
Add»ssšgMode
 
ourAdd»ssšgModeTabË
[256];

299 
uIÁ8
 
	gourBCDTabË
[2][256];

305 
uIÁ32
 
	gourIn¡ruùiÚProûssÜCyşeTabË
[256];

308 cÚ¡ * 
	gourIn¡ruùiÚMÃmÚicTabË
[256];

310 
	gmyTÙ®In¡ruùiÚCouÁ
;

	@emucore/m6502/src/M6502Hi.cxx

19 
	~"M6502Hi.hxx
"

20 
	~"S”Ÿliz”.hxx
"

21 
	~"De£rŸliz”.hxx
"

23 #ifdeà
DEBUGGER_SUPPORT


24 
	~"Debugg”.hxx
"

27 
	#debugSŒ—m
 
cout


	)

30 
	gM6502High
::
	$M6502High
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
)

31 : 
	$M6502
(
sy¡emCyşesP”ProûssÜCyşe
)

33 
myNumb”OfDi¡šùAcûs£s
 = 0;

34 
myLa¡Add»ss
 = 0;

36 #ifdeà
DEBUGGER_SUPPORT


37 
myJu¡H™T¿pFÏg
 = 
çl£
;

39 
	}
}

42 
	gM6502High
::~
	$M6502High
()

44 
	}
}

47 
šlše
 
uIÁ8
 
M6502High
::
	$³ek
(
uIÁ16
 
add»ss
)

49 if(
add»ss
 !ğ
myLa¡Add»ss
)

51 
myNumb”OfDi¡šùAcûs£s
++;

52 
myLa¡Add»ss
 = 
add»ss
;

54 
mySy¡em
->
	`šüem’tCyşes
(
mySy¡emCyşesP”ProûssÜCyşe
);

56 #ifdeà
DEBUGGER_SUPPORT


57 if(
myR—dT¿ps
 !ğ
NULL
 && myR—dT¿ps->
	`isS‘
(
add»ss
))

59 
myJu¡H™T¿pFÏg
 = 
Œue
;

60 
myH™T¿pInfo
.
mes§ge
 = "Readrap: ";

61 
myH™T¿pInfo
.
add»ss
 =‡ddress;

66 
uIÁ8
 
»suÉ
 = 
mySy¡em
->
	`³ek
(
add»ss
);

67 
myLa¡AcûssWasR—d
 = 
Œue
;

68  
»suÉ
;

69 
	}
}

72 
šlše
 
	gM6502High
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

74 if(
add»ss
 !ğ
myLa¡Add»ss
)

76 
myNumb”OfDi¡šùAcûs£s
++;

77 
myLa¡Add»ss
 = 
add»ss
;

79 
mySy¡em
->
	`šüem’tCyşes
(
mySy¡emCyşesP”ProûssÜCyşe
);

81 #ifdeà
DEBUGGER_SUPPORT


82 if(
myWr™eT¿ps
 !ğ
NULL
 && myWr™eT¿ps->
	`isS‘
(
add»ss
))

84 
myJu¡H™T¿pFÏg
 = 
Œue
;

85 
myH™T¿pInfo
.
mes§ge
 = "Writerap: ";

86 
myH™T¿pInfo
.
add»ss
 =‡ddress;

90 
mySy¡em
->
	`poke
(
add»ss
, 
v®ue
);

91 
myLa¡AcûssWasR—d
 = 
çl£
;

92 
	}
}

95 
boŞ
 
	gM6502High
::
	$execu‹
(
uIÁ32
 
numb”
)

98 
myExecutiÚStus
 &ğ
F©®E¼ÜB™
;

103 ; !
myExecutiÚStus
 && (
numb”
 != 0); --number)

105 
uIÁ16
 
İ”ªdAdd»ss
 = 0;

106 
uIÁ8
 
İ”ªd
 = 0;

108 #ifdeà
DEBUGGER_SUPPORT


109 if(
myJu¡H™T¿pFÏg
)

111 if(
myDebugg”
->
	`¡¬t
(
myH™T¿pInfo
.
mes§ge
, myH™T¿pInfo.
add»ss
))

113 
myJu¡H™T¿pFÏg
 = 
çl£
;

114  
Œue
;

118 if(
myB»akPošts
 !ğ
NULL
)

120 if(
myB»akPošts
->
	`isS‘
(
PC
))

122 if(
myDebugg”
->
	`¡¬t
("B»akpošˆh™: ", 
PC
))

123  
Œue
;

127 
cÚd
 = 
	`ev®CÚdB»aks
();

128 if(
cÚd
 > -1)

130 
¡ršg
 
buf
 = "CBP: " + 
myB»akCÚdNames
[
cÚd
];

131 if(
myDebugg”
->
	`¡¬t
(
buf
))

132  
Œue
;

136 #ifdeà
DEBUG


137 
debugSŒ—m
 << "PC=" << 
hex
 << 
	`£tw
(4è<< 
PC
 << " ";

141 
IR
 = 
	`³ek
(
PC
++);

143 #ifdeà
DEBUG


144 
debugSŒ—m
 << "IR=" << 
hex
 << 
	`£tw
(2è<< ()
IR
 << " ";

145 
debugSŒ—m
 << "<" << 
ourAdd»ssšgModeTabË
[
IR
] << " ";

149 
IR
)

152 
	~"M6502Hi.šs
"

156 
myExecutiÚStus
 |ğ
F©®E¼ÜB™
;

159 
myTÙ®In¡ruùiÚCouÁ
++;

161 #ifdeà
DEBUG


162 
debugSŒ—m
 << 
hex
 << 
	`£tw
(4è<< 
İ”ªdAdd»ss
 << " ";

163 
debugSŒ—m
 << 
	`£tw
(4è<< 
ourIn¡ruùiÚMÃmÚicTabË
[
IR
];

164 
debugSŒ—m
 << "> ";

165 
debugSŒ—m
 << "A=" << ::
hex
 << 
	`£tw
(2è<< ()
A
 << " ";

166 
debugSŒ—m
 << "X=" << ::
hex
 << 
	`£tw
(2è<< ()
X
 << " ";

167 
debugSŒ—m
 << "Y=" << ::
hex
 << 
	`£tw
(2è<< ()
Y
 << " ";

168 
debugSŒ—m
 << "PS=" << ::
hex
 << 
	`£tw
(2è<< ()
	`PS
() << " ";

169 
debugSŒ—m
 << "SP=" << ::
hex
 << 
	`£tw
(2è<< ()
SP
 << " ";

170 
debugSŒ—m
 << "Cyc=" << 
dec
 << 
mySy¡em
->
	`cyşes
();

171 
debugSŒ—m
 << 
’dl
;

176 if((
myExecutiÚStus
 & 
MaskabËIÁ”ru±B™
) ||

177 (
myExecutiÚStus
 & 
NÚmaskabËIÁ”ru±B™
))

180 
	`š‹¼u±HªdËr
();

184 if(
myExecutiÚStus
 & 
StİExecutiÚB™
)

187  
Œue
;

191 if(
myExecutiÚStus
 & 
F©®E¼ÜB™
)

194  
çl£
;

198 if(
numb”
 == 0)

201  
Œue
;

204 
	}
}

207 
	gM6502High
::
	$š‹¼u±HªdËr
()

210 if((
myExecutiÚStus
 & 
MaskabËIÁ”ru±B™
è&& !
I
)

212 
mySy¡em
->
	`šüem’tCyşes
(7 * 
mySy¡emCyşesP”ProûssÜCyşe
);

213 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) >> 8);

214 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) & 0x00ff);

215 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, 
	`PS
() & (~0x10));

216 
D
 = 
çl£
;

217 
I
 = 
Œue
;

218 
PC
 = (
uIÁ16
)
mySy¡em
->
	`³ek
(0xFFFE) | ((uInt16)mySystem->peek(0xFFFF) << 8);

220 if(
myExecutiÚStus
 & 
NÚmaskabËIÁ”ru±B™
)

222 
mySy¡em
->
	`šüem’tCyşes
(7 * 
mySy¡emCyşesP”ProûssÜCyşe
);

223 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) >> 8);

224 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) & 0x00ff);

225 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, 
	`PS
() & (~0x10));

226 
D
 = 
çl£
;

227 
PC
 = (
uIÁ16
)
mySy¡em
->
	`³ek
(0xFFFA) | ((uInt16)mySystem->peek(0xFFFB) << 8);

231 
myExecutiÚStus
 &ğ~(
MaskabËIÁ”ru±B™
 | 
NÚmaskabËIÁ”ru±B™
);

232 
	}
}

235 
boŞ
 
	gM6502High
::
	$§ve
(
S”Ÿliz”
& 
out
)

237 
¡ršg
 
CPU
 = 
	`Çme
();

239 
Œy


241 
out
.
	`putSŒšg
(
CPU
);

243 
out
.
	`putIÁ
(
A
);

244 
out
.
	`putIÁ
(
X
);

245 
out
.
	`putIÁ
(
Y
);

246 
out
.
	`putIÁ
(
SP
);

247 
out
.
	`putIÁ
(
IR
);

248 
out
.
	`putIÁ
(
PC
);

250 
out
.
	`putBoŞ
(
N
);

251 
out
.
	`putBoŞ
(
V
);

252 
out
.
	`putBoŞ
(
B
);

253 
out
.
	`putBoŞ
(
D
);

254 
out
.
	`putBoŞ
(
I
);

255 
out
.
	`putBoŞ
(
nÙZ
);

256 
out
.
	`putBoŞ
(
C
);

258 
out
.
	`putIÁ
(
myExecutiÚStus
);

261 
out
.
	`putIÁ
(
myNumb”OfDi¡šùAcûs£s
);

263 
out
.
	`putIÁ
(
myLa¡Add»ss
);

266 
	`ÿtch
(*
msg
)

268 
û¼
 << 
msg
 << 
’dl
;

269  
çl£
;

271 
	`ÿtch
(...)

273 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
CPU
 << 
’dl
;

274  
çl£
;

277  
Œue
;

278 
	}
}

281 
boŞ
 
	gM6502High
::
	$lßd
(
De£rŸliz”
& 
š
)

283 
¡ršg
 
CPU
 = 
	`Çme
();

285 
Œy


287 if(
š
.
	`g‘SŒšg
(è!ğ
CPU
)

288  
çl£
;

290 
A
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

291 
X
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

292 
Y
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

293 
SP
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

294 
IR
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

295 
PC
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

297 
N
 = 
š
.
	`g‘BoŞ
();

298 
V
 = 
š
.
	`g‘BoŞ
();

299 
B
 = 
š
.
	`g‘BoŞ
();

300 
D
 = 
š
.
	`g‘BoŞ
();

301 
I
 = 
š
.
	`g‘BoŞ
();

302 
nÙZ
 = 
š
.
	`g‘BoŞ
();

303 
C
 = 
š
.
	`g‘BoŞ
();

305 
myExecutiÚStus
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

308 
myNumb”OfDi¡šùAcûs£s
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

310 
myLa¡Add»ss
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

312 
	`ÿtch
(*
msg
)

314 
û¼
 << 
msg
 << 
’dl
;

315  
çl£
;

317 
	`ÿtch
(...)

319 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
CPU
 << 
’dl
;

320  
çl£
;

323  
Œue
;

324 
	}
}

327 cÚ¡ * 
	gM6502High
::
	$Çme
() const

330 
	}
}

	@emucore/m6502/src/M6502Hi.hxx

19 #iâdeà
M6502HIGH_HXX


20 
	#M6502HIGH_HXX


	)

22 
şass
 
	gM6502High
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"M6502.hxx
"

40 şas 
	cM6502High
 : 
public
 
M6502


42 
public
:

49 
M6502High
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
);

54 
	mvœtu®
 ~
M6502High
();

56 
	mpublic
:

65 
vœtu®
 
boŞ
 
execu‹
(
uIÁ32
 
numb”
);

73 
vœtu®
 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
);

81 
vœtu®
 
boŞ
 
lßd
(
De£rŸliz”
& 
š
);

88 
vœtu®
 cÚ¡ * 
	$Çme
() const;

90 
public
:

96 
uIÁ32
 
	$di¡šùAcûs£s
() const

98  
myNumb”OfDi¡šùAcûs£s
;

101 
´Ùeùed
:

105 
	`š‹¼u±HªdËr
();

107 
´Ùeùed
:

114 
šlše
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

123 
šlše
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

125 
´iv©e
:

127 
uIÁ32
 
myNumb”OfDi¡šùAcûs£s
;

130 
uIÁ16
 
myLa¡Add»ss
;

131 
	}
};

	@emucore/m6502/src/M6502Low.cxx

19 
	~"M6502Low.hxx
"

20 
	~"S”Ÿliz”.hxx
"

21 
	~"De£rŸliz”.hxx
"

23 #ifdeà
DEBUGGER_SUPPORT


24 
	~"Debugg”.hxx
"

27 
	#debugSŒ—m
 
cout


	)

30 
	gM6502Low
::
	$M6502Low
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
)

31 : 
	$M6502
(
sy¡emCyşesP”ProûssÜCyşe
)

33 #ifdeà
DEBUGGER_SUPPORT


34 
myJu¡H™T¿pFÏg
 = 
çl£
;

36 
	}
}

39 
	gM6502Low
::~
	$M6502Low
()

41 
	}
}

44 
šlše
 
uIÁ8
 
M6502Low
::
	$³ek
(
uIÁ16
 
add»ss
)

46 #ifdeà
DEBUGGER_SUPPORT


47 if(
myR—dT¿ps
 !ğ
NULL
 && myR—dT¿ps->
	`isS‘
(
add»ss
))

49 
myJu¡H™T¿pFÏg
 = 
Œue
;

50 
myH™T¿pInfo
.
mes§ge
 = "Readrap: ";

51 
myH™T¿pInfo
.
add»ss
 =‡ddress;

55 
uIÁ8
 
»suÉ
 = 
mySy¡em
->
	`³ek
(
add»ss
);

56 
myLa¡AcûssWasR—d
 = 
Œue
;

57  
»suÉ
;

58 
	}
}

61 
šlše
 
	gM6502Low
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

63 #ifdeà
DEBUGGER_SUPPORT


64 if(
myWr™eT¿ps
 !ğ
NULL
 && myWr™eT¿ps->
	`isS‘
(
add»ss
))

66 
myJu¡H™T¿pFÏg
 = 
Œue
;

67 
myH™T¿pInfo
.
mes§ge
 = "Writerap: ";

68 
myH™T¿pInfo
.
add»ss
 =‡ddress;

72 
mySy¡em
->
	`poke
(
add»ss
, 
v®ue
);

73 
myLa¡AcûssWasR—d
 = 
çl£
;

74 
	}
}

77 
boŞ
 
	gM6502Low
::
	$execu‹
(
uIÁ32
 
numb”
)

80 
myExecutiÚStus
 &ğ
F©®E¼ÜB™
;

85 ; !
myExecutiÚStus
 && (
numb”
 != 0); --number)

87 
uIÁ16
 
İ”ªdAdd»ss
 = 0;

88 
uIÁ8
 
İ”ªd
 = 0;

90 #ifdeà
DEBUGGER_SUPPORT


91 if(
myJu¡H™T¿pFÏg
)

93 if(
myDebugg”
->
	`¡¬t
(
myH™T¿pInfo
.
mes§ge
, myH™T¿pInfo.
add»ss
))

95 
myJu¡H™T¿pFÏg
 = 
çl£
;

96  
Œue
;

100 if(
myB»akPošts
 !ğ
NULL
)

102 if(
myB»akPošts
->
	`isS‘
(
PC
))

104 if(
myDebugg”
->
	`¡¬t
("B»akpošˆh™: ", 
PC
))

105  
Œue
;

109 
cÚd
 = 
	`ev®CÚdB»aks
();

110 if(
cÚd
 > -1)

112 
¡ršg
 
buf
 = "CBP: " + 
myB»akCÚdNames
[
cÚd
];

113 if(
myDebugg”
->
	`¡¬t
(
buf
))

114  
Œue
;

118 #ifdeà
DEBUG


119 
debugSŒ—m
 << "PC=" << 
hex
 << 
	`£tw
(4è<< 
PC
 << " ";

123 
IR
 = 
	`³ek
(
PC
++);

125 #ifdeà
DEBUG


126 
debugSŒ—m
 << "IR=" << 
hex
 << 
	`£tw
(2è<< ()
IR
 << " ";

127 
debugSŒ—m
 << "<" << 
ourAdd»ssšgModeTabË
[
IR
] << " ";

131 
mySy¡em
->
	`šüem’tCyşes
(
myIn¡ruùiÚSy¡emCyşeTabË
[
IR
]);

134 
IR
)

137 
	~"M6502Low.šs
"

141 
myExecutiÚStus
 |ğ
F©®E¼ÜB™
;

142 
û¼
 << "IÎeg® In¡ruùiÚ! " << 
hex
 << (è
IR
 << 
’dl
;

145 #ifdeà
DEBUG


146 
debugSŒ—m
 << 
hex
 << 
	`£tw
(4è<< 
İ”ªdAdd»ss
 << " ";

147 
debugSŒ—m
 << 
	`£tw
(4è<< 
ourIn¡ruùiÚMÃmÚicTabË
[
IR
];

148 
debugSŒ—m
 << "> ";

149 
debugSŒ—m
 << "A=" << ::
hex
 << 
	`£tw
(2è<< ()
A
 << " ";

150 
debugSŒ—m
 << "X=" << ::
hex
 << 
	`£tw
(2è<< ()
X
 << " ";

151 
debugSŒ—m
 << "Y=" << ::
hex
 << 
	`£tw
(2è<< ()
Y
 << " ";

152 
debugSŒ—m
 << "PS=" << ::
hex
 << 
	`£tw
(2è<< ()
	`PS
() << " ";

153 
debugSŒ—m
 << "SP=" << ::
hex
 << 
	`£tw
(2è<< ()
SP
 << " ";

154 
debugSŒ—m
 << "Cyc=" << 
dec
 << 
mySy¡em
->
	`cyşes
();

155 
debugSŒ—m
 << 
’dl
;

160 if((
myExecutiÚStus
 & 
MaskabËIÁ”ru±B™
) ||

161 (
myExecutiÚStus
 & 
NÚmaskabËIÁ”ru±B™
))

164 
	`š‹¼u±HªdËr
();

168 if(
myExecutiÚStus
 & 
StİExecutiÚB™
)

171  
Œue
;

175 if(
myExecutiÚStus
 & 
F©®E¼ÜB™
)

178  
çl£
;

182 if(
numb”
 == 0)

185  
Œue
;

188 
	}
}

191 
	gM6502Low
::
	$š‹¼u±HªdËr
()

194 if((
myExecutiÚStus
 & 
MaskabËIÁ”ru±B™
è&& !
I
)

196 
mySy¡em
->
	`šüem’tCyşes
(7 * 
mySy¡emCyşesP”ProûssÜCyşe
);

197 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) >> 8);

198 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) & 0x00ff);

199 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, 
	`PS
() & (~0x10));

200 
D
 = 
çl£
;

201 
I
 = 
Œue
;

202 
PC
 = (
uIÁ16
)
mySy¡em
->
	`³ek
(0xFFFE) | ((uInt16)mySystem->peek(0xFFFF) << 8);

204 if(
myExecutiÚStus
 & 
NÚmaskabËIÁ”ru±B™
)

206 
mySy¡em
->
	`šüem’tCyşes
(7 * 
mySy¡emCyşesP”ProûssÜCyşe
);

207 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) >> 8);

208 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, (
PC
 - 1) & 0x00ff);

209 
mySy¡em
->
	`poke
(0x0100 + 
SP
--, 
	`PS
() & (~0x10));

210 
D
 = 
çl£
;

211 
PC
 = (
uIÁ16
)
mySy¡em
->
	`³ek
(0xFFFA) | ((uInt16)mySystem->peek(0xFFFB) << 8);

215 
myExecutiÚStus
 &ğ~(
MaskabËIÁ”ru±B™
 | 
NÚmaskabËIÁ”ru±B™
);

216 
	}
}

219 
boŞ
 
	gM6502Low
::
	$§ve
(
S”Ÿliz”
& 
out
)

221 
¡ršg
 
CPU
 = 
	`Çme
();

223 
Œy


225 
out
.
	`putSŒšg
(
CPU
);

227 
out
.
	`putIÁ
(
A
);

228 
out
.
	`putIÁ
(
X
);

229 
out
.
	`putIÁ
(
Y
);

230 
out
.
	`putIÁ
(
SP
);

231 
out
.
	`putIÁ
(
IR
);

232 
out
.
	`putIÁ
(
PC
);

234 
out
.
	`putBoŞ
(
N
);

235 
out
.
	`putBoŞ
(
V
);

236 
out
.
	`putBoŞ
(
B
);

237 
out
.
	`putBoŞ
(
D
);

238 
out
.
	`putBoŞ
(
I
);

239 
out
.
	`putBoŞ
(
nÙZ
);

240 
out
.
	`putBoŞ
(
C
);

242 
out
.
	`putIÁ
(
myExecutiÚStus
);

244 
	`ÿtch
(*
msg
)

246 
û¼
 << 
msg
 << 
’dl
;

247  
çl£
;

249 
	`ÿtch
(...)

251 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ " << 
CPU
 << 
’dl
;

252  
çl£
;

255  
Œue
;

256 
	}
}

259 
boŞ
 
	gM6502Low
::
	$lßd
(
De£rŸliz”
& 
š
)

261 
¡ršg
 
CPU
 = 
	`Çme
();

263 
Œy


265 if(
š
.
	`g‘SŒšg
(è!ğ
CPU
)

266  
çl£
;

268 
A
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

269 
X
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

270 
Y
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

271 
SP
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

272 
IR
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

273 
PC
 = (
uIÁ16
è
š
.
	`g‘IÁ
();

275 
N
 = 
š
.
	`g‘BoŞ
();

276 
V
 = 
š
.
	`g‘BoŞ
();

277 
B
 = 
š
.
	`g‘BoŞ
();

278 
D
 = 
š
.
	`g‘BoŞ
();

279 
I
 = 
š
.
	`g‘BoŞ
();

280 
nÙZ
 = 
š
.
	`g‘BoŞ
();

281 
C
 = 
š
.
	`g‘BoŞ
();

283 
myExecutiÚStus
 = (
uIÁ8
è
š
.
	`g‘IÁ
();

285 
	`ÿtch
(*
msg
)

287 
û¼
 << 
msg
 << 
’dl
;

288  
çl£
;

290 
	`ÿtch
(...)

292 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ " << 
CPU
 << 
’dl
;

293  
çl£
;

296  
Œue
;

297 
	}
}

300 cÚ¡ * 
	gM6502Low
::
	$Çme
() const

303 
	}
}

	@emucore/m6502/src/M6502Low.hxx

19 #iâdeà
M6502LOW_HXX


20 
	#M6502LOW_HXX


	)

22 
şass
 
	gM6502Low
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"M6502.hxx
"

46 şas 
	cM6502Low
 : 
public
 
M6502


48 
public
:

55 
M6502Low
(
uIÁ32
 
sy¡emCyşesP”ProûssÜCyşe
);

60 
	mvœtu®
 ~
M6502Low
();

62 
	mpublic
:

71 
vœtu®
 
boŞ
 
execu‹
(
uIÁ32
 
numb”
);

79 
vœtu®
 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
);

87 
vœtu®
 
boŞ
 
lßd
(
De£rŸliz”
& 
š
);

94 
vœtu®
 cÚ¡ * 
	$Çme
() const;

96 
´Ùeùed
:

100 
	`š‹¼u±HªdËr
();

102 
´Ùeùed
:

108 
šlše
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

116 
šlše
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

	@emucore/m6502/src/NullDev.cxx

19 
	~"NuÎDev.hxx
"

20 
	~"S”Ÿliz”.hxx
"

21 
	~"De£rŸliz”.hxx
"

24 
	gNuÎDeviû
::
	$NuÎDeviû
()

26 
	}
}

29 
NuÎDeviû
::~
	$NuÎDeviû
()

31 
	}
}

34 cÚ¡ * 
NuÎDeviû
::
	$Çme
() const

37 
	}
}

40 
	gNuÎDeviû
::
	$»£t
()

42 
	}
}

45 
NuÎDeviû
::
	$š¡®l
(
Sy¡em
& 
sy¡em
)

47 
mySy¡em
 = &
sy¡em
;

48 
	}
}

51 
uIÁ8
 
	gNuÎDeviû
::
	$³ek
(
uIÁ16
 
add»ss
)

53 
û¼
 << 
hex
 << "NuÎDeviû:…“k(" << 
add»ss
 << ")" << 
’dl
;

55 
	}
}

58 
	gNuÎDeviû
::
	$poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
)

60 
û¼
 << 
hex
 << "NuÎDeviû:…oke(" << 
add»ss
 << "," << 
v®ue
 << ")" << 
’dl
;

61 
	}
}

64 
boŞ
 
	gNuÎDeviû
::
	$§ve
(
S”Ÿliz”
& 
out
)

66  
Œue
;

67 
	}
}

70 
boŞ
 
	gNuÎDeviû
::
	$lßd
(
De£rŸliz”
& 
š
)

72  
Œue
;

73 
	}
}

	@emucore/m6502/src/NullDev.hxx

19 #iâdeà
NULLDEVICE_HXX


20 
	#NULLDEVICE_HXX


	)

22 
şass
 
	gSy¡em
;

23 
şass
 
	gS”Ÿliz”
;

24 
şass
 
	gDe£rŸliz”
;

26 
	~"b¥f.hxx
"

27 
	~"Deviû.hxx
"

37 şas 
	cNuÎDeviû
 : 
public
 
Deviû


39 
public
:

43 
NuÎDeviû
();

48 
	mvœtu®
 ~
NuÎDeviû
();

50 
	mpublic
:

56 
vœtu®
 cÚ¡ * 
	$Çme
() const;

61 
vœtu®
 
	`»£t
();

69 
vœtu®
 
	`š¡®l
(
Sy¡em
& 
sy¡em
);

77 
vœtu®
 
boŞ
 
	`§ve
(
S”Ÿliz”
& 
out
);

85 
vœtu®
 
boŞ
 
	`lßd
(
De£rŸliz”
& 
š
);

87 
public
:

93 
vœtu®
 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

101 
vœtu®
 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

	@emucore/m6502/src/System.cxx

19 
	~<as£¹.h
>

20 
	~<io¡»am
>

22 
	~"Deviû.hxx
"

23 
	~"M6502.hxx
"

24 
	~"TIA.hxx
"

25 
	~"Sy¡em.hxx
"

26 
	~"S”Ÿliz”.hxx
"

27 
	~"De£rŸliz”.hxx
"

30 
	gSy¡em
::
	$Sy¡em
(
uIÁ16
 
n
, uIÁ16 
m
)

31 : 
	`myAdd»ssMask
((1 << 
n
) - 1),

32 
	`myPageShiá
(
m
),

33 
	`myPageMask
((1 << 
m
) - 1),

34 
	`myNumb”OfPages
(1 << (
n
 - 
m
)),

35 
	`myNumb”OfDeviûs
(0),

36 
	`myM6502
(0),

37 
	`myTIA
(0),

38 
	`myCyşes
(0),

39 
	$myD©aBusS‹
(0)

42 
	`as£¹
((1 <ğ
m
è&& (m <ğ
n
) && (n <= 16));

45 
myPageAcûssTabË
 = 
Ãw
 
PageAcûss
[
myNumb”OfPages
];

48 
PageAcûss
 
acûss
;

49 
acûss
.
dœeùP“kBa£
 = 0;

50 
acûss
.
dœeùPokeBa£
 = 0;

51 
acûss
.
deviû
 = &
myNuÎDeviû
;

52 
·ge
 = 0;…ag< 
myNumb”OfPages
; ++page)

54 
	`£tPageAcûss
(
·ge
, 
acûss
);

58 
myD©aBusLocked
 = 
çl£
;

59 
	}
}

62 
	gSy¡em
::~
	$Sy¡em
()

65 
uIÁ32
 
i
 = 0; i < 
myNumb”OfDeviûs
; ++i)

67 
d–‘e
 
myDeviûs
[
i
];

71 
d–‘e
 
myM6502
;

74 
d–‘e
[] 
myPageAcûssTabË
;

75 
	}
}

78 
	gSy¡em
::
	$»£t
()

81 
	`»£tCyşes
();

84 
uIÁ32
 
i
 = 0; i < 
myNumb”OfDeviûs
; ++i)

86 
myDeviûs
[
i
]->
	`»£t
();

90 if(
myM6502
 != 0)

92 
myM6502
->
	`»£t
();

94 
	}
}

97 
	gSy¡em
::
	$©ch
(
Deviû
* 
deviû
)

99 
	`as£¹
(
myNumb”OfDeviûs
 < 100);

102 
myDeviûs
[
myNumb”OfDeviûs
++] = 
deviû
;

105 
deviû
->
	`š¡®l
(*
this
);

106 
	}
}

109 
	gSy¡em
::
	$©ch
(
M6502
* 
m6502
)

112 
myM6502
 = 
m6502
;

115 
myM6502
->
	`š¡®l
(*
this
);

116 
	}
}

119 
	gSy¡em
::
	$©ch
(
TIA
* 
tŸ
)

121 
myTIA
 = 
tŸ
;

122 
	`©ch
((
Deviû
*è
tŸ
);

123 
	}
}

126 
boŞ
 
	gSy¡em
::
	$§ve
(
S”Ÿliz”
& 
out
)

128 
Œy


130 
out
.
	`putSŒšg
("System");

131 
out
.
	`putIÁ
(
myCyşes
);

133 
	`ÿtch
(*
msg
)

135 
û¼
 << 
msg
 << 
’dl
;

136  
çl£
;

138 
	`ÿtch
(...)

140 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ \'Sy¡em\'" << 
’dl
;

141  
çl£
;

144  
Œue
;

145 
	}
}

148 
boŞ
 
	gSy¡em
::
	$lßd
(
De£rŸliz”
& 
š
)

150 
Œy


152 if(
š
.
	`g‘SŒšg
() != "System")

153  
çl£
;

155 
myCyşes
 = (
uIÁ32
è
š
.
	`g‘IÁ
();

157 
	`ÿtch
(*
msg
)

159 
û¼
 << 
msg
 << 
’dl
;

160  
çl£
;

162 
	`ÿtch
(...)

164 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ \'Sy¡em\'" << 
’dl
;

165  
çl£
;

168  
Œue
;

169 
	}
}

172 
	gSy¡em
::
	$»£tCyşes
()

175 
uIÁ32
 
i
 = 0; i < 
myNumb”OfDeviûs
; ++i)

177 
myDeviûs
[
i
]->
	`sy¡emCyşesRe£t
();

181 
myCyşes
 = 0;

182 
	}
}

185 
	gSy¡em
::
	$£tPageAcûss
(
uIÁ16
 
·ge
, cÚ¡ 
PageAcûss
& 
acûss
)

188 
	`as£¹
(
·ge
 <ğ
myNumb”OfPages
);

191 
	`as£¹
(
acûss
.
deviû
 != 0);

193 
myPageAcûssTabË
[
·ge
] = 
acûss
;

194 
	}
}

197 cÚ¡ 
	gSy¡em
::
PageAcûss
& 
Sy¡em
::
	$g‘PageAcûss
(
uIÁ16
 
·ge
)

200 
	`as£¹
(
·ge
 <ğ
myNumb”OfPages
);

202  
myPageAcûssTabË
[
·ge
];

203 
	}
}

206 
boŞ
 
	gSy¡em
::
	$§veS‹
(cÚ¡ 
¡ršg
& 
md5sum
, 
S”Ÿliz”
& 
out
)

209 if(!
out
.
	`isO³n
())

210  
çl£
;

212 
Œy


216 
out
.
	`putSŒšg
(
md5sum
);

219 if(!
	`§ve
(
out
))

220  
çl£
;

223 if(!
myM6502
->
	`§ve
(
out
))

224  
çl£
;

227 
uIÁ32
 
i
 = 0; i < 
myNumb”OfDeviûs
; ++i)

228 if(!
myDeviûs
[
i
]->
	`§ve
(
out
))

229  
çl£
;

231 
	`ÿtch
(*
msg
)

233 
û¼
 << 
msg
 << 
’dl
;

234  
çl£
;

236 
	`ÿtch
(...)

238 
û¼
 << "UnknowÀ”rÜ iÀ§v¡©fÜ \'Sy¡em\'" << 
’dl
;

239  
çl£
;

242  
Œue
;

243 
	}
}

246 
boŞ
 
	gSy¡em
::
	$lßdS‹
(cÚ¡ 
¡ršg
& 
md5sum
, 
De£rŸliz”
& 
š
)

249 if(!
š
.
	`isO³n
())

250  
çl£
;

252 
Œy


256 if(
š
.
	`g‘SŒšg
(è!ğ
md5sum
)

257  
çl£
;

260 if(!
	`lßd
(
š
))

261  
çl£
;

264 if(!
myM6502
->
	`lßd
(
š
))

265  
çl£
;

268 
uIÁ32
 
i
 = 0; i < 
myNumb”OfDeviûs
; ++i)

269 if(!
myDeviûs
[
i
]->
	`lßd
(
š
))

270  
çl£
;

272 
	`ÿtch
(*
msg
)

274 
û¼
 << 
msg
 << 
’dl
;

275  
çl£
;

277 
	`ÿtch
(...)

279 
û¼
 << "UnknowÀ”rÜ iÀlßd s‹ fÜ \'Sy¡em\'" << 
’dl
;

280  
çl£
;

283  
Œue
;

284 
	}
}

287 
	gSy¡em
::
	$Sy¡em
(cÚ¡ 
Sy¡em
& 
s
)

288 : 
	`myAdd»ssMask
(
s
.
myAdd»ssMask
),

289 
	`myPageShiá
(
s
.
myPageShiá
),

290 
	`myPageMask
(
s
.
myPageMask
),

291 
	$myNumb”OfPages
(
s
.
myNumb”OfPages
)

293 
	`as£¹
(
çl£
);

294 
	}
}

297 
	gSy¡em
& Sy¡em::
İ”©Ü
 = (cÚ¡ 
Sy¡em
&)

299 
as£¹
(
çl£
);

301  *
	gthis
;

305 
uIÁ8
 
	gSy¡em
::
	$³ek
(
uIÁ16
 
addr
)

307 
PageAcûss
& 
acûss
 = 
myPageAcûssTabË
[(
addr
 & 
myAdd»ssMask
è>> 
myPageShiá
];

309 
uIÁ8
 
»suÉ
;

312 if(
acûss
.
dœeùP“kBa£
 != 0)

314 
»suÉ
 = *(
acûss
.
dœeùP“kBa£
 + (
addr
 & 
myPageMask
));

318 
»suÉ
 = 
acûss
.
deviû
->
	`³ek
(
addr
);

321 #ifdeà
DEBUGGER_SUPPORT


322 if(!
myD©aBusLocked
)

324 
myD©aBusS‹
 = 
»suÉ
;

326  
»suÉ
;

327 
	}
}

330 
	gSy¡em
::
	$poke
(
uIÁ16
 
addr
, 
uIÁ8
 
v®ue
)

332 
PageAcûss
& 
acûss
 = 
myPageAcûssTabË
[(
addr
 & 
myAdd»ssMask
è>> 
myPageShiá
];

335 if(
acûss
.
dœeùPokeBa£
 != 0)

337 *(
acûss
.
dœeùPokeBa£
 + (
addr
 & 
myPageMask
)èğ
v®ue
;

341 
acûss
.
deviû
->
	`poke
(
addr
, 
v®ue
);

344 #ifdeà
DEBUGGER_SUPPORT


345 if(!
myD©aBusLocked
)

347 
myD©aBusS‹
 = 
v®ue
;

348 
	}
}

351 
	gSy¡em
::
	$lockD©aBus
()

353 
myD©aBusLocked
 = 
Œue
;

354 
	}
}

357 
	gSy¡em
::
	$uÆockD©aBus
()

359 
myD©aBusLocked
 = 
çl£
;

360 
	}
}

	@emucore/m6502/src/System.hxx

19 #iâdeà
SYSTEM_HXX


20 
	#SYSTEM_HXX


	)

22 
şass
 
	gDeviû
;

23 
şass
 
	gM6502
;

24 
şass
 
	gTIA
;

25 
şass
 
	gNuÎDeviû
;

26 
şass
 
	gS”Ÿliz”
;

27 
şass
 
	gDe£rŸliz”
;

29 
	~"b¥f.hxx
"

30 
	~"Deviû.hxx
"

31 
	~"NuÎDev.hxx
"

52 şas 
	cSy¡em


54 
	mpublic
:

62 
Sy¡em
(
uIÁ16
 
n
, uIÁ16 
m
);

67 
	mvœtu®
 ~
Sy¡em
();

69 
	mpublic
:

74 
»£t
();

82 
boŞ
 
§ve
(
S”Ÿliz”
& 
out
);

90 
boŞ
 
lßd
(
De£rŸliz”
& 
š
);

92 
	mpublic
:

99 
©ch
(
Deviû
* 
deviû
);

107 
©ch
(
M6502
* 
m6502
);

115 
©ch
(
TIA
* 
tŸ
);

126 
boŞ
 
§veS‹
(cÚ¡ 
¡ršg
& 
md5sum
, 
S”Ÿliz”
& 
out
);

137 
boŞ
 
lßdS‹
(cÚ¡ 
¡ršg
& 
md5sum
, 
De£rŸliz”
& 
š
);

139 
	mpublic
:

146 
M6502
& 
	$m6502
()

148  *
myM6502
;

156 
TIA
& 
	$tŸ
()

158  *
myTIA
;

159 
	}
}

168 
	gNuÎDeviû
& 
	$nuÎDeviû
()

170  
myNuÎDeviû
;

171 
	}
}

178 
uIÁ16
 
	$numb”OfPages
() const

180  
myNumb”OfPages
;

181 
	}
}

188 
uIÁ16
 
	$·geShiá
() const

190  
myPageShiá
;

191 
	}
}

198 
uIÁ16
 
	$·geMask
() const

200  
myPageMask
;

201 
	}
}

203 
	gpublic
:

210 
uIÁ32
 
	$cyşes
() const

212  
myCyşes
;

213 
	}
}

220 
	$šüem’tCyşes
(
uIÁ32
 
amouÁ
)

222 
myCyşes
 +ğ
amouÁ
;

223 
	}
}

231 
»£tCyşes
();

233 
	gpublic
:

240 
uIÁ8
 
	$g‘D©aBusS‹
() const;

249 
uIÁ8
 
	`³ek
(
uIÁ16
 
add»ss
);

259 
	`poke
(
uIÁ16
 
add»ss
, 
uIÁ8
 
v®ue
);

270 
	`lockD©aBus
();

271 
	`uÆockD©aBus
();

273 
public
:

277 
	sPageAcûss


285 
uIÁ8
* 
dœeùP“kBa£
;

293 
uIÁ8
* 
dœeùPokeBa£
;

299 
Deviû
* 
deviû
;

300 
	}
};

308 
£tPageAcûss
(
uIÁ16
 
·ge
, cÚ¡ 
PageAcûss
& 
acûss
);

316 cÚ¡ 
	gPageAcûss
& 
g‘PageAcûss
(
uIÁ16
 
·ge
);

318 
	g´iv©e
:

320 cÚ¡ 
uIÁ16
 
myAdd»ssMask
;

323 cÚ¡ 
uIÁ16
 
	gmyPageShiá
;

326 cÚ¡ 
uIÁ16
 
	gmyPageMask
;

329 cÚ¡ 
uIÁ16
 
	gmyNumb”OfPages
;

332 
PageAcûss
* 
	gmyPageAcûssTabË
;

335 
Deviû
* 
	gmyDeviûs
[100];

338 
uIÁ32
 
	gmyNumb”OfDeviûs
;

341 
M6502
* 
	gmyM6502
;

344 
TIA
* 
	gmyTIA
;

347 
uIÁ32
 
	gmyCyşes
;

350 
NuÎDeviû
 
	gmyNuÎDeviû
;

353 
uIÁ8
 
	gmyD©aBusS‹
;

358 
boŞ
 
	gmyD©aBusLocked
;

360 
	g´iv©e
:

362 
Sy¡em
(const System&);

365 
	gSy¡em
& 
	gİ”©Ü
 = (cÚ¡ 
Sy¡em
&);

369 
šlše
 
uIÁ8
 
	gSy¡em
::
	$g‘D©aBusS‹
() const

371  
myD©aBusS‹
;

372 
	}
}

	@emucore/m6502/src/bspf/src/bspf.hxx

19 #iâdeà
BSPF_HXX


20 
	#BSPF_HXX


	)

31 sigÃd 
	tIÁ8
;

32 
	tuIÁ8
;

35 sigÃd 
	tIÁ16
;

36 
	tuIÁ16
;

39 sigÃd 
	tIÁ32
;

40 
	tuIÁ32
;

44 #ifdeà
BSPF_OLD_STYLE_CXX_HEADERS


45 
	~<io¡»am.h
>

46 
	~<iomª.h
>

47 
	~<¡ršg.h
>

49 
	~<io¡»am
>

50 
	~<iomª
>

51 
	~<¡ršg
>

52 
	~<¡ršg.h
>

53 
usšg
 
Çme¥aû
 
	g¡d
;

56 #ifdeà
HAVE_INTTYPES


57 
	~<š‰y³s.h
>

62 
	#BSPF_PATH_SEPARATOR
 "/"

	)

72 #ifdeà
BSPF_WIN32


73 
	#BSPF_¡rÿ£cmp
 
¡ricmp


	)

74 
	#BSPF_¡ºÿ£cmp
 
¡ºicmp


	)

75 
	#BSPF_isbÏnk
(
c
è((ø=ğ' 'è|| (ø=ğ'\t'))

	)

76 
	#BSPF_¢´štf
 
_¢´štf


	)

77 
	#BSPF_v¢´štf
 
_v¢´štf


	)

79 
	#BSPF_¡rÿ£cmp
 
¡rÿ£cmp


	)

80 
	#BSPF_¡ºÿ£cmp
 
¡ºÿ£cmp


	)

81 
	#BSPF_isbÏnk
(
c
è
	`isbÏnk
(c)

	)

82 
	#BSPF_¢´štf
 
¢´štf


	)

83 
	#BSPF_v¢´štf
 
v¢´štf


	)

87 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
	$BSPF_sw­
(
T
 &
a
, T &
b
è{ T 
tmp
 =‡;‡ = b; b =mp; 
	}
}

88 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
	$BSPF_abs
 (
T
 
x
è{  (x>=0è? x : -x; 
	}
}

89 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
	$BSPF_mš
 (
T
 
a
, T 
b
è{  (a<bè?‡ : b; 
	}
}

90 
	g‹m¶©e
<
ty³Çme
 
	gT
> 
šlše
 
T
 
	$BSPF_max
 (
T
 
a
, T 
b
è{  (a>bè?‡ : b; 
	}
}

92 #ifdeà
_WIN32_WCE


93 
	~"missšg.h
"

	@emucore/rsynth/config.h

8 
	#HAVE_ALSA_ASOUNDLIB_H
 1

	)

11 
	#HAVE_AUDIO_AUDIOLIB_H
 1

	)

32 
	#HAVE_FCNTL_H
 1

	)

35 
	#HAVE_FTRUNCATE
 1

	)

41 
	#HAVE_INTTYPES_H
 1

	)

44 
	#HAVE_LIBASOUND
 1

	)

59 
	#HAVE_LIBM
 1

	)

62 
	#HAVE_LIBX11
 1

	)

65 
	#HAVE_LIBXT
 1

	)

68 
	#HAVE_LIMITS_H
 1

	)

80 
	#HAVE_MEMORY_H
 1

	)

83 
	#HAVE_NAS
 1

	)

89 
	#HAVE_STDINT_H
 1

	)

92 
	#HAVE_STDLIB_H
 1

	)

98 
	#HAVE_STRINGS_H
 1

	)

101 
	#HAVE_STRING_H
 1

	)

110 
	#HAVE_SYS_FILE_H
 1

	)

116 
	#HAVE_SYS_IOCTL_H
 1

	)

122 
	#HAVE_SYS_STAT_H
 1

	)

125 
	#HAVE_SYS_TIME_H
 1

	)

128 
	#HAVE_SYS_TYPES_H
 1

	)

131 
	#HAVE_TRUNCATE
 1

	)

134 
	#HAVE_UNISTD_H
 1

	)

140 
	#PACKAGE_BUGREPORT
 ""

	)

143 
	#PACKAGE_NAME
 ""

	)

146 
	#PACKAGE_STRING
 ""

	)

149 
	#PACKAGE_TARNAME
 ""

	)

152 
	#PACKAGE_VERSION
 ""

	)

155 
	#RETSIGTYPE
 

	)

158 
	#RSYNTH_ALSA_PCM_POINTER_PARAMS_API
 1

	)

161 
	#STDC_HEADERS
 1

	)

	@emucore/rsynth/darray.c

20 
	~"cÚfig.h
"

23 *
	gd¬¿y_id
 = "$Id: darray.c,v 1.1 2006/06/11 07:13:23 urchlay Exp $";

24 
	~"u£cÚfig.h
"

25 
	~"d¬¿y.h
"

28 
	$d¬¿y_ä“
(
d¬¿y_t
 * 
a
)

30 ià(
a
->
d©a
) {

31 
	`ä“
(
a
->
d©a
);

32 
a
->
d©a
 = 
NULL
;

34 
a
->
™ems
 =‡->
®loc
 = 0;

35 
	}
}

38 
	$D¬¿y_fšd
(
d¬¿y_t
 * 
a
, 
n
)

40 ià(
n
 >ğ
a
->
®loc
 ||‚ >ğa->
™ems
) {

41 
osize
 = 
a
->
™ems
 *‡->
esize
;

42 
nsize
;

43 ià(!
a
->
esize
)

44 
	`abÜt
();

45 ià(
n
 >ğ
a
->
®loc
) {

46 
add
 = (
a
->
g‘
) ?‡->get : 1;

47 *
nd©a
 = (*è
	`m®loc
(
nsize
 = (
n
 + 
add
è* 
a
->
esize
);

48 ià(
nd©a
) {

49 ià(
osize
)

50 
	`memıy
(
nd©a
, 
a
->
d©a
, 
osize
);

51 ià(
a
->
d©a
)

52 
	`ä“
(
a
->
d©a
);

53 
a
->
d©a
 = 
nd©a
;

54 
a
->
®loc
 = 
n
 + 
add
;

57  
NULL
;

60 
nsize
 = (
n
 + 1è* 
a
->
esize
;

61 ià(
n
 >ğ
a
->
™ems
) {

62 
	`mem£t
(
a
->
d©a
 + 
osize
, 0, 
nsize
 - osize);

63 
a
->
™ems
 = 
n
 + 1;

66  (*è(
a
->
d©a
 + 
n
 *‡->
esize
);

67 
	}
}

70 
	$d¬¿y_d–‘e
(
d¬¿y_t
 * 
a
, 
n
)

72 *
p
 = (*è
	`d¬¿y_fšd
(
a
, 
n
);

73 ià(
p
) {

74 ià(
a
->
™ems
) {

75 
a
->
™ems
--;

76 
n
++ < 
a
->
™ems
) {

77 
	`memıy
(
p
,… + 
a
->
esize
,‡->esize);

78 
p
 +ğ
a
->
esize
;

80 
	`mem£t
(
p
, 0, 
a
->
esize
);

84 
	`abÜt
();

88 
	}
}

91 
	$d¬¿y_­³nd
(
d¬¿y_±r
 
p
, 
ch
)

93 *
s
 = (*è
	`d¬¿y_fšd
(
p
,…->
™ems
);

94 *
s
 = 
ch
;

95  
ch
;

96 
	}
}

99 
	$d¬¿y_ÿt
(*
¬g
, *
s
)

101 
d¬¿y_±r
 
p
 = (d¬¿y_±rè
¬g
;

102 
ch
;

103 (
ch
 = *
s
++))

104 
	`d¬¿y_­³nd
(
p
, 
ch
);

105 
	}
}

108 
	$d¬¿y_fg‘
(
FILE
 * 
f
, 
d¬¿y_±r
 
p
)

110 
ch
;

111 (
ch
 = 
	`fg‘c
(
f
)è!ğ
EOF
) {

112 
	`d¬¿y_­³nd
(
p
, 
ch
);

113 ià(
ch
 == '\n')

116 
	`d¬¿y_­³nd
(
p
, '\0');

117  
p
->
™ems
 - 1;

118 
	}
}

120 #ià!
defšed
(
__GNUC__
)

123 
	$d¬¿y_æßt
(
d¬¿y_±r
 
f0
, 
f
)

125 *
å
 = (*è
	`d¬¿y_fšd
(
f0
, f0->
™ems
);

126 *
å
 = 
f
;

127  
f
;

128 
	}
}

131 
	$d¬¿y_shÜt
(
d¬¿y_±r
 
f0
, 
f
)

133 *
å
 = (*è
	`d¬¿y_fšd
(
f0
, f0->
™ems
);

134 *
å
 = 
f
;

135  
f
;

136 
	}
}

	@emucore/rsynth/darray.h

22 #ià!
defšed
(
DARRAY_H
)

23 
	#DARRAY_H


	)

24 
	~<¡dio.h
>

26 #ifdeà
__ılu¥lus


31 {*
d©a
;

32 
™ems
;

33 
®loc
;

34 
esize
;

35 
g‘
;

36 } 
	td¬¿y_t
, *
	td¬¿y_±r
;

39 *
D¬¿y_fšd
(
d¬¿y_t
 *
a
,
n
);

41 
d¬¿y_d–‘e
(
d¬¿y_t
 *
a
,
n
);

42 
d¬¿y_ä“
(
d¬¿y_t
 *
a
);

43 
d¬¿y_­³nd
(
d¬¿y_t
 *
p
, 
ch
);

44 
d¬¿y_ÿt
(*
da
, *
s
);

46 #ià
defšed
(
__GNUC__
)

47 
__šlše__
 
d¬¿y_š™
(
d¬¿y_t
 *
a
,
size
,
g‘
)

49 
	ga
->
	gesize
 = 
size
;

50 
	ga
->
	gg‘
 = 
g‘
;

51 
	ga
->
	g™ems
 = 
a
->
®loc
 = 0;

52 
	ga
->
	gd©a
 = 
NULL
;

55 
__šlše__
 *
d¬¿y_fšd
(
d¬¿y_t
 *
a
,
n
)

57 ià(
	gn
 < 
	ga
->
	g®loc
 &&‚ <‡->
	g™ems
)

58  (*è(
	ga
->
	gd©a
 + 
n
 *‡->
	gesize
);

59  
D¬¿y_fšd
(
a
,
n
);

62 
šlše
 

63 
d¬¿y_æßt
(
d¬¿y_±r
 
f0
, 
f
)

65 *
	gå
 = (*è
d¬¿y_fšd
(
f0
, f0->
™ems
);

66 *
	gå
 = 
f
;

67  
	gf
;

70 
šlše
 

71 
d¬¿y_shÜt
(
d¬¿y_±r
 
f0
, 
f
)

73 *
	gå
 = (*è
d¬¿y_fšd
(
f0
, f0->
™ems
);

74 *
	gå
 = 
f
;

75  
	gf
;

80 
d¬¿y_æßt
(
d¬¿y_±r
 
f0
, 
f
);

81 
d¬¿y_shÜt
(
d¬¿y_±r
 
f0
, 
f
);

83 
	#d¬¿y_š™
(
a
,
sz
,
gt
) \

84 ((
a
)->
esize
 = (
sz
), (a)->
g‘
 = (
gt
), (a)->
™ems
 = (a)->
®loc
 = 0, (a)->
d©a
 = 
NULL
)

	)

86 
	#d¬¿y_fšd
(
a
,
n
) \

87 (((
n
è< (
a
)->
®loc
 && (nè< (a)->
™ems
) \

88 ? (*è((
a
)->
d©a
 + (
n
è* (a)->
esize
) \

89 : 
	`D¬¿y_fšd
(
a
,
n
))

	)

93 
d¬¿y_fg‘
(
FILE
 * 
f
, 
d¬¿y_±r
 
p
);

95 #ifdeà
__ılu¥lus


	@emucore/rsynth/elements.c

20 
	~<cÚfig.h
>

23 *
	g–em’ts_id
 = "$Id:ƒlements.c,v 1.1 2006/06/11 07:13:24 urchlay Exp $";

24 
	~<¡dio.h
>

25 
	~<m©h.h
>

26 
	~"rsyÁh.h
"

27 
	~"phã©.h
"

30 
Elm_t
 
	gEËm’ts
[] = {

31 
	~"EËm’ts.def
"

34 
	gnum_EËm’ts
 = ((
EËm’ts
è/ (
Elm_t
));

36 *
	gEp_Çme
[
nE·rm
] = {

44 
¥—k”_t
 *

45 
	$rsyÁh_¥—k”
(
F0Hz
, 
gaš
, 
Elm_t
 * 
e
)

47 
¥—k”_t
 
·rs
;

49 
·rs
.
F0Hz
 = F0Hz;

52 
·rs
.
Gaš0
 = 
gaš
;

53 
·rs
.
F4hz
 = 3900;

54 
·rs
.
B4hz
 = 400;

55 
·rs
.
F5hz
 = 4700;

56 
·rs
.
B5hz
 = 150;

57 
·rs
.
F6hz
 = 4900;

58 
·rs
.
B6hz
 = 150;

60 
·rs
.
B4phz
 = 500;

61 
·rs
.
B5phz
 = 600;

62 
·rs
.
B6phz
 = 800;

64 
·rs
.
BNhz
 = 500;

71 
·rs
.
FNPhz
 = (è
e
->
p
[
â
].
¡dy
;

72  &
·rs
;

73 
	}
}

	@emucore/rsynth/holmes.c

20 
	~"cÚfig.h
"

23 *
	ghŞmes_id
 = "$Id: holmes.c,v 1.2 2006/06/12 14:12:52 stephena Exp $";

24 
	~<¡dio.h
>

25 
	~<ùy³.h
>

26 
	~<as£¹.h
>

27 
	~"u£cÚfig.h
"

28 
	~<m©h.h
>

29 
	~"rsyÁh.h
"

30 
	~"d¬¿y.h
"

33 
	mv
;

34 
	mt
;

35 } 
	t¦İe_t
;

40 
	ma
;

41 
	mb
;

42 
	mv
;

43 } 
	tf‹r_t
, *
	tf‹r_±r
;

46 
	$f‹r
(
f‹r_±r
 
p
, 
v
)

48  
p
->
v
 = (p->
a
 * v +…->
b
 *…->v);

49 
	}
}

58 
	$£t_Œªs
(
¦İe_t
 * 
t
, 
i
, 
Elm_±r
 
a
, Elm_±¸
b
, 
ext
, 
e
,

59 
¥“d
)

61 
t
[
i
].ˆğ(è(((
ext
è? 
a
->
p
[i].
ed
 :‡->p[i].
id
è* 
¥“d
);

62 ià(
t
[
i
].t) {

63 
aäac
 = 
a
->
p
[
i
].
´İ
 * 0.01F;

64 
t
[
i
].
v
 = 
a
->
p
[i].
¡dy
 * (1.0F - 
aäac
è+ (aäaø* 
b
->p[i].stdy);

67 
t
[
i
].
v
 = 
b
->
p
[i].
¡dy
;

68 
	}
}

82 
	$lš—r
(
a
, 
b
, 
t
, 
d
)

84 ià(
t
 <= 0)

85  
a
;

86 ià(
t
 >ğ
d
)

87  
b
;

89 
f
 = (è
t
 / (è
d
;

90  
a
 + (
b
 -‡è* 
f
;

92 
	}
}

95 
	$š‹½Ş©e
(*
w
, *
p
, 
¦İe_t
 * 
s
, slİe_ˆ* 
e
, 
mid
, 
t
,

96 
d
)

98 
¡—dy
 = 
d
 - (
s
->
t
 + 
e
->t);

99 #ifdeà
DEBUG


100 
	`årštf
(
¡dout
, "%4s %s s=%g,%dƒ=%g,%d m=%g,%g\n",

101 
w
, 
p
, 
s
->
v
, s->
t
, 
e
->v,ƒ->t, 
mid
, 
¡—dy
);

103 ià(
¡—dy
 >= 0) {

105 ià(
t
 < 
s
->t)

106  
	`lš—r
(
s
->
v
, 
mid
, 
t
, s->t);

108 
t
 -ğ
s
->t;

109 ià(
t
 <ğ
¡—dy
)

110  
mid
;

112  
	`lš—r
(
mid
, 
e
->
v
, (è(
t
 - 
¡—dy
),ƒ->t);

117 
f
 = (è1.0 - ((è
t
 / (è
d
);

118 
¥
 = 
	`lš—r
(
s
->
v
, 
mid
, 
t
, s->t);

119 
•
 = 
	`lš—r
(
e
->
v
, 
mid
, 
d
 - 
t
,ƒ->t);

120  
f
 * 
¥
 + ((è1.0 - fè* 
•
;

122 
	}
}

124 
	#CHECK_SPACING
(
a
,
b
) \

126 ià(
a
 < 
b
 + 200) \

127 
	`årštf
(
¡dout
,"%s=%g < %s=%g+200\n",#a,
a
,#b,
b
); \

128 } 0)

	)

132 
	$rsyÁh_š‹½Ş©e
(
rsyÁh_t
 * 
rsyÁh
,

133 *
–m
, 
Ãlm
,

134 *
f0
, 
nf0
)

136 
f‹r_t
 
æt
[
nE·rm
];

137 
•
[
nE·rm
];

138 
Elm_±r
 
Ë
 = &
EËm’ts
[0];

139 
i
 = 0;

140 
tf0
 = 0;

141 
Áf0
 = 0;

142 
§mp
 = 0;

143 
cÚtour
[3];

144 
f0s
 = 
rsyÁh
->
¥—k”
->
F0Hz
;

145 
f0e
 = 
f0s
;

146 
j
;

147 
¥“d
 = 
rsyÁh
->speed;

148 
F0Hz
;

150 ià(
nf0
 < 3 || !
f0
 || (
rsyÁh
->
æags
 & 
RSYNTH_MONOTONE
)) {

151 
i
;

152 
f0
 = 
cÚtour
;

153 
nf0
 = 3;

154 
i
 = 0; i < 
Ãlm
; i += 2) {

155 
f0
[1] +ğ
–m
[
i
 + 1];

157 ià((
rsyÁh
->
æags
 & 
RSYNTH_MONOTONE
)) {

158 
f0
[0] = 
rsyÁh
->
¥—k”
->
F0Hz
;

159 
f0
[2] = f0[0];

162 
f0
[0] = 1.1 * 
rsyÁh
->
¥—k”
->
F0Hz
;

163 
f0
[2] = 0.6 * f0[0];

168 
	`årštf
(
¡d”r
, "f0 (%gè%5.1à%g %5.1f\n", 
rsyÁh
->
F0hz
,

169 
f0
[0], 1.0 * f0[1] * 
rsyÁh
->
§m¶es_äame
 /„syÁh->
§mp_¿‹
,

170 
f0
[2]);

172 
f0e
 = 
f0s
 = *
f0
++;

187 
j
 = 0; j < 
nE·rm
; j++) {

188 
æt
[
j
].
v
 = 
Ë
->
p
[j].
¡dy
;

189 
æt
[
j
].
a
 = 
rsyÁh
->
smoÙh
;

190 
æt
[
j
].
b
 = 1.0F - 
rsyÁh
->
smoÙh
;

192 
i
 < 
Ãlm
) {

193 
Elm_±r
 
û
 = &
EËm’ts
[
–m
[
i
++]];

194 
dur
 = 
–m
[
i
++];

195 ià(
rsyÁh
->
æags
 & 
RSYNTH_ETRACE
) {

196 
	`´štf
("%s.%ld ", 
û
->
Çme
,

197 1000 * 
dur
 * 
rsyÁh
->
§m¶es_äame
 /„syÁh->
¤
);

204 ià(
dur
 > 0) {

205 
Elm_±r
 
Ã
 = (
i
 < 
Ãlm
è? &
EËm’ts
[
–m
[i]] : &Elements[0];

206 
¦İe_t
 
¡¬t
[
nE·rm
];

207 
¦İe_t
 
’d
[
nE·rm
];

208 
t
;

210 
i
;

211 
i
 = 0; i < 
nE·rm
; i++) {

214 ià(
û
->
p
[
i
].
rk
 > 
Ë
->p[i].rk) {

215 ià(
rsyÁh
->
·rm_fe
)

216 
	`årštf
(
rsyÁh
->
·rm_fe
,

217 "# %3 %2s(%2dè< %2s(%2d)\n", 
Ep_Çme
[
i
],

218 
Ë
->
Çme
,†e->
p
[
i
].
rk
, 
û
->name,

219 
û
->
p
[
i
].
rk
);

220 
	`£t_Œªs
(
¡¬t
, 
i
, 
û
, 
Ë
, 0, 's', 
¥“d
);

224 ià(
rsyÁh
->
·rm_fe
)

225 
	`årštf
(
rsyÁh
->
·rm_fe
,

226 "# %3 %2s(%2dè>ğ%2s(%2d)\n", 
Ep_Çme
[
i
],

227 
Ë
->
Çme
,†e->
p
[
i
].
rk
, 
û
->name,

228 
û
->
p
[
i
].
rk
);

229 
	`£t_Œªs
(
¡¬t
, 
i
, 
Ë
, 
û
, 1, 's', 
¥“d
);

233 ià(
Ã
->
p
[
i
].
rk
 > 
û
->p[i].rk) {

234 ià(
rsyÁh
->
·rm_fe
)

235 
	`årštf
(
rsyÁh
->
·rm_fe
,

236 "# %3 %2s(%2dè< %2s(%2d)\n", 
Ep_Çme
[
i
],

237 
û
->
Çme
, ce->
p
[
i
].
rk
, 
Ã
->name,

238 
Ã
->
p
[
i
].
rk
);

239 
	`£t_Œªs
(
’d
, 
i
, 
Ã
, 
û
, 1, 'e', 
¥“d
);

243 ià(
rsyÁh
->
·rm_fe
)

244 
	`årštf
(
rsyÁh
->
·rm_fe
,

245 "# %3 %2s(%2dè>ğ%2s(%2d)\n", 
Ep_Çme
[
i
],

246 
û
->
Çme
, ce->
p
[
i
].
rk
, 
Ã
->name,

247 
Ã
->
p
[
i
].
rk
);

248 
	`£t_Œªs
(
’d
, 
i
, 
û
, 
Ã
, 0, 'e', 
¥“d
);

254 ià(
rsyÁh
->
·rm_fe
) {

255 
j
;

256 
	`årštf
(
rsyÁh
->
·rm_fe
, "# %s\n", 
û
->
Çme
);

257 
	`årštf
(
rsyÁh
->
·rm_fe
, "%c%6s %6s", '#', "f0", "ao");

258 
j
 = 0; j < 
nE·rm
; j++)

259 
	`årštf
(
rsyÁh
->
·rm_fe
, "%c%6s", ' ', 
Ep_Çme
[
j
]);

260 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n#%6s %6s", "", "");

261 
j
 = 0; j < 
nE·rm
; j++)

262 
	`årštf
(
rsyÁh
->
·rm_fe
, "%c%6.4g", ' ', 
¡¬t
[
j
].
v
);

263 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n#%6s %6s", "", "");

264 
j
 = 0; j < 
nE·rm
; j++)

265 
	`årštf
(
rsyÁh
->
·rm_fe
, "%c%6ld", ' ', 
¡¬t
[
j
].
t
);

266 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n");

269 
t
 = 0; < 
dur
;++, 
tf0
++) {

270 
j
;

271 
³ak
 = 0.25;

273 
j
 = 0; j < 
nE·rm
; j++) {

274 
•
[
j
] =

275 
	`f‹r
(
æt
 + 
j
,

276 
	`š‹½Ş©e
(
û
->
Çme
, 
Ep_Çme
[
j
], &
¡¬t
[j],

277 &
’d
[
j
], (è
û
->
p
[j].
¡dy
,

278 
t
, 
dur
));

281 
tf0
 =ğ
Áf0
) {

282 
tf0
 = 0;

283 
f0s
 = 
f0e
;

284 
Áf0
 = (è*
f0
++;

285 
f0e
 = *
f0
++;

287 
	`årštf
(
¡d”r
, "f0 %5.1à%g %5.1f\n", 
f0s
,

288 1.0 * 
Áf0
 * 
§m¶es_äame
 / 
§mp_¿‹
, 
f0e
);

293 
F0Hz
 = 
	`lš—r
(
f0s
, 
f0e
, 
tf0
, 
Áf0
);

295 ià(
rsyÁh
->
æags
 & 
RSYNTH_F0TRACE
) {

296 
	`´štf
(" %5.1fHz", 
F0Hz
);

300 
	`CHECK_SPACING
(
•
[
f2
],ƒp[
f1
]);

301 
	`CHECK_SPACING
(
•
[
f3
],ƒp[
f2
]);

302 
	`CHECK_SPACING
(
rsyÁh
->
¥—k”
->
F4hz
, 
•
[
f3
]);

304 
§mp
 +ğ
	`rsyÁh_äame
(
rsyÁh
, 
F0Hz
, 
•
, 
û
->
Çme
);

306 ià(
rsyÁh
->
·rm_fe
) {

307 
	`årštf
(
rsyÁh
->
·rm_fe
, " %6.4g %6.4g",

308 
F0Hz
, 10 * 
	`log10
(
³ak
));

309 
j
 = 0; j < 
nE·rm
; j++)

310 
	`årštf
(
rsyÁh
->
·rm_fe
, " %6.4g", 
•
[
j
]);

311 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n");

314 ià(
rsyÁh
->
·rm_fe
) {

315 
j
;

316 
	`årštf
(
rsyÁh
->
·rm_fe
, "#%6s %6s", "", "");

317 
j
 = 0; j < 
nE·rm
; j++)

318 
	`årštf
(
rsyÁh
->
·rm_fe
, " %6.4g", 
’d
[
j
].
v
);

319 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n");

320 
	`årštf
(
rsyÁh
->
·rm_fe
, "#%6s %6s", "", "");

321 
j
 = 0; j < 
nE·rm
; j++)

322 
	`årštf
(
rsyÁh
->
·rm_fe
, " %6ld", 
’d
[
j
].
t
);

323 
	`årštf
(
rsyÁh
->
·rm_fe
, "\n");

326 
Ë
 = 
û
;

328 ià(
rsyÁh
->
æags
 & (
RSYNTH_ETRACE
 | 
RSYNTH_F0TRACE
)) {

329 
	`´štf
("\n");

331  
§mp
;

332 
	}
}

	@emucore/rsynth/opsynth.c

20 
	~<cÚfig.h
>

21 
	~<u£cÚfig.h
>

22 
	~<¡dio.h
>

23 
	#__USE_ISOC99
 1

	)

24 
	~<m©h.h
>

25 #iâdeà
PI


26 
	#PI
 3.1415927

	)

28 
	~"rsyÁh.h
"

30 
	#SYNC_CASCADE


	)

32 
	#PVT
(
x
è
rsyÁh
->
pvt
->
	)
x

33 
	#RES
(
x
è&
	`PVT
(x),#x

	)

36 #ià
defšed
(
__lšux__
)

37 
	#FPCHECK
(
x
) do { \

38 ià(
	`åşassify
(
x
è< 
FP_ZERO
) \

40 
	`årštf
(
¡d”r
, #x "=%g (%s:%d)\n",
x
,
__FILE__
,
__LINE__
); \

41 
	`abÜt
(); \

43 } 0)

	)

45 
	#FPCHECK
(
x
)

	)

48 #ifdeà
DO_RANGE_CHECKS


50 
	g¿nge_max
 = 0.0;

51 
	g¿nge_Ê
 = 0;

53 
	#RGCHECK
(
x
) do { \

54 
	`FPCHECK
(
x
); \

55 ià(
	`abs
(
x
è> 
¿nge_max
) \

57 
¿nge_max
 = 
	`abs
(
x
); \

58 ià(
¿nge_max
 > 32767) \

59 
	`årštf
(
¡dout
, #x "=%g (%s:%d)\n",
¿nge_max
,
__FILE__
,
__LINE__
); \

60 
¿nge_Ê
 = 
__LINE__
; \

62 } 0)

	)

64 
	#RGCHECK
(
x
)

	)

70 
	ma
;

71 
	mb
;

72 
	mc
;

73 
	mp1
;

74 
	mp2
;

75 } 
	t»sÚ©Ü_t
, *
	t»sÚ©Ü_±r
;

78 
	ma
;

79 
	mb
;

80 
	mp1
;

81 } 
	tlow·ss_t
, *
	tlow·ss_±r
;

83 
	srsyÁh_´iv©e
 {

85 
	mÅ”
;

86 
	mT0
;

87 
	mnİ’
;

88 
	mF0Hz
;

90 
	mamp_av
;

91 
	mamp_by·ss
;

92 
	mamp_a¥
;

93 
	mamp_af
;

94 
	mamp_avc
;

95 
	mamp_turb
;

97 
	m£ed
;

98 
	mns
;

99 
	mş_max
;

100 
	mu¤§mp
;

102 
»sÚ©Ü_t
 
	mrgl
;

103 
»sÚ©Ü_t
 
	mºz
;

104 
»sÚ©Ü_t
 
	mºpc
;

105 
»sÚ©Ü_t
 
	mr5c
;

106 
»sÚ©Ü_t
 
	mrsc
;

107 
»sÚ©Ü_t
 
	mr4c
;

108 
»sÚ©Ü_t
 
	mr3c
;

109 
»sÚ©Ü_t
 
	mr2c
;

110 
»sÚ©Ü_t
 
	mr1c
;

111 
»sÚ©Ü_t
 
	mr6p
;

112 
»sÚ©Ü_t
 
	mr5p
;

113 
»sÚ©Ü_t
 
	mr4p
;

114 
»sÚ©Ü_t
 
	mr3p
;

115 
»sÚ©Ü_t
 
	mr2p
;

116 
»sÚ©Ü_t
 
	mrout
;

123 
	$£t_pŞe_fbw
(
¤
, 
f
, 
bw
, 
»sÚ©Ü_±r
 
½
, *
Çme
,

124 
ÿsc
)

126 
mšus_pi_t
 = -
PI
 / 
¤
;

127 
two_pi_t
 = -2.0 * 
mšus_pi_t
;

133 ià(2 * 
f
 - 
bw
 <ğ
¤
) {

134 
¬g
;

135 
r
;

136 ià(2 * (
f
 + 
bw
è> 
¤
) {

140 
low
 = 
f
 - 
bw
;

142 
	`årštf
(
¡d”r
, "Adj % %ld/%ld @ %ld", 
Çme
, 
f
, 
bw
, 
¤
);

144 
f
 = (
¤
 / 2 + 
low
) / 2;

145 
bw
 = 
f
 - 
low
;

147 
	`årštf
(
¡d”r
, "=> %ld/%ld\n", 
f
, 
bw
);

150 
¬g
 = 
mšus_pi_t
 * 
bw
;

151 
r
 = 
	`exp
(
¬g
);

152 
½
->
c
 = -(
r
 *„);

153 
¬g
 = 
two_pi_t
 * 
f
;

154 
½
->
b
 = 
r
 * 
	`cos
(
¬g
) * 2.0;

155 
½
->
a
 = 1.0 -„p->
b
 -„p->
c
;

162 
	`årštf
(
¡d”r
, "Sk % %ld/%ld @ %ld\n", 
Çme
, 
f
, 
bw
, 
¤
);

164 
½
->
a
 = 
ÿsc
;

165 
½
->
b
 = 0.0;

166 
½
->
c
 = 0.0;

168 
	}
}

172 
	$£t_pŞe_fbwg
(
¤
, 
f
, 
bw
, 
»sÚ©Ü_±r
 
½
, *
Çme
,

173 
gaš
, 
ÿsc
)

175 
	`£t_pŞe_fbw
(
¤
, 
f
, 
bw
, 
½
, 
Çme
, 
ÿsc
);

176 
½
->
a
 *ğ
gaš
;

177 
	}
}

183 
	$£t_z”o_fbw
(
¤
, 
f
, 
bw
, 
»sÚ©Ü_±r
 
½
, *
Çme
)

186 
	`£t_pŞe_fbw
(
¤
, 
f
, 
bw
, 
½
, 
Çme
, 1);

188 
½
->
a
 = 1.0 /„p->a;

189 
½
->
b
 *ğ-½->
a
;

190 
½
->
c
 *ğ-½->
a
;

191 
	}
}

196 
	$»sÚ©Ü
(
»sÚ©Ü_±r
 
r
, *
Çme
, 
šput
)

198 
x
 = 
r
->
a
 * 
šput
 +„->
b
 *„->
p1
 +„->
c
 *„->
p2
;

199 
	`FPCHECK
(
šput
);

200 
	`FPCHECK
(
r
->
a
);

201 
	`FPCHECK
(
r
->
b
);

202 
	`FPCHECK
(
r
->
c
);

203 
r
->
p2
 =„->
p1
;

204 
r
->
p1
 = 
x
;

205  
x
;

206 
	}
}

216 
	$ªtœesÚ©Ü
(
»sÚ©Ü_±r
 
r
, *
Çme
, 
šput
)

218 
x
 = 
r
->
a
 * 
šput
 +„->
b
 *„->
p1
 +„->
c
 *„->
p2
;

219 
	`FPCHECK
(
šput
);

220 
	`FPCHECK
(
r
->
a
);

221 
	`FPCHECK
(
r
->
b
);

222 
	`FPCHECK
(
r
->
c
);

223 
r
->
p2
 =„->
p1
;

224 
r
->
p1
 = 
šput
;

225  
x
;

226 
	}
}

231 
	$DBtoLIN
(
dB
)

233 ià(
dB
 > 0) {

234 
v®
 = 32768 * 
	`pow
(10.0, (
dB
 - 87) / 20 - 3);

235 
	`FPCHECK
(
v®
);

236  
v®
;

239 
	}
}

242 
	$£t_ÿsÿde
(
rsyÁh_t
 * 
rsyÁh
)

244 
¤
 = 
rsyÁh
->sr;

246 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
¥—k”
->
FNPhz
,„syÁh->¥—k”->
BNhz
,

247 
	`RES
(
ºpc
), 1);

248 
	`£t_z”o_fbw
(
¤
, 
rsyÁh
->
•
[
â
],„syÁh->
¥—k”
->
BNhz
, 
	`RES
(
ºz
));

250 
	`£t_pŞe_fbw
(
¤
, 3500, 1800, 
	`RES
(
rsc
), 1);

251 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
¥—k”
->
F5hz
,„syÁh->¥—k”->
B5hz
,

252 
	`RES
(
r5c
), 1);

253 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
¥—k”
->
F4hz
,„syÁh->¥—k”->
B4hz
,

254 
	`RES
(
r4c
), 1);

255 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
•
[
f3
],„syÁh->•[
b3
], 
	`RES
(
r3c
), 1);

256 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
•
[
f2
],„syÁh->•[
b2
], 
	`RES
(
r2c
), 1);

257 
	`£t_pŞe_fbw
(
¤
, 
rsyÁh
->
•
[
f1
],„syÁh->•[
b1
], 
	`RES
(
r1c
), 1);

258 
	}
}

261 
	$p™ch_sync
(
rsyÁh_t
 * 
rsyÁh
)

263 
F0Hz
 = 
	`PVT
(F0Hz);

265 ià(
rsyÁh
->
•
[
av
] > 0 ||„syÁh->•[
avc
] > 0) {

266 
	`PVT
(
T0
èğ(è((4 * 
rsyÁh
->
¤
è/ 
F0Hz
);

267 
	`PVT
(
amp_av
èğ
	`DBtoLIN
(
rsyÁh
->
•
[
av
]);

268 
	`PVT
(
amp_avc
èğ
	`DBtoLIN
(
rsyÁh
->
•
[
avc
]);

269 
	`PVT
(
amp_turb
èğPVT(
amp_avc
) * 0.1;

274 
	`PVT
(
nİ’
èğPVT(
T0
) / 3;

278 
	`PVT
(
T0
) = 4;

279 
	`PVT
(
nİ’
èğPVT(
T0
);

280 
	`PVT
(
amp_av
) = 0.0;

281 
	`PVT
(
amp_avc
) = 0.0;

286 ià((
	`PVT
(
T0
è!ğ4è|| (PVT(
ns
) == 0)) {

287 ià(
rsyÁh
->
voiû_fe
) {

288 
	`årštf
(
rsyÁh
->
voiû_fe
, "#…™ch synøT0=%ld\n", 
	`PVT
(
T0
));

294 
	`£t_pŞe_fbw
(
rsyÁh
->
¤
, 0L, (è(2 * 
F0Hz
), 
	`RES
(
rgl
), 1);

302 #ifdeà
SYNC_CASCADE


306 
	`£t_ÿsÿde
(
rsyÁh
);

309 
	}
}

312 
	$g’_voiû
(
rsyÁh_t
 * 
rsyÁh
, 
noi£
)

314 
i
;

315 
voiû
;

324 
i
 = 0; i < 4; i++) {

325 
®pha
;

326 cÚ¡ 
amp
 = 4096.0;

327 ià(
	`PVT
(
Å”
è>ğPVT(
T0
)) {

328 
	`PVT
(
Å”
) = 0;

329 
	`p™ch_sync
(
rsyÁh
);

340 
®pha
 = (è
	`PVT
(
Å”
è/ PVT(
T0
);

341 ià(
®pha
 <= 1.0 / 3) {

342 
voiû
 = 3 * 
amp
 * 
®pha
;

345 
voiû
 = 
amp
 * ((9 * 
®pha
 - 12) *‡lpha + 3);

352 
	`PVT
(
Å”
)++;

354 
	`FPCHECK
(
voiû
);

355  
voiû
;

356 
	}
}

359 
	$g’_noi£
(
rsyÁh_t
 * 
rsyÁh
)

361 
noi£
 = 0.0;

365 
i
;

366 
i
 = 0; i < 16; i++) {

372 
Äªd
;

373 
	`PVT
(
£ed
) = PVT(seed) * 1664525 + 1;

375 
	`PVT
(
£ed
) &= 0xFFFFFFFFL;

379 
Äªd
 =

380 (((è
	`PVT
(
£ed
)) << (8 * () -

382 
noi£
 +ğ
Äªd
;

385  
noi£
 / 2;

386 
	}
}

389 
	$£tup_äame
(
rsyÁh_t
 * 
rsyÁh
)

391 
¤
 = 
rsyÁh
->sr;

392 
Gaš0
 = 
rsyÁh
->
¥—k”
->Gain0 - 3;

394 #iâdeà
SYNC_CASCADE


395 
	`£t_ÿsÿde
(
¤
, 
äame
);

401 
	`£t_pŞe_fbwg
(
¤
, 
rsyÁh
->
•
[
f2
],„syÁh->•[
b2
], 
	`RES
(
r2p
),

402 
	`DBtoLIN
(
rsyÁh
->
•
[
a2
]), 0);

404 
	`£t_pŞe_fbwg
(
¤
, 
rsyÁh
->
•
[
f3
],„syÁh->•[
b3
], 
	`RES
(
r3p
),

405 
	`DBtoLIN
(
rsyÁh
->
•
[
a3
]), 0);

407 
	`£t_pŞe_fbwg
(
¤
, 
rsyÁh
->
¥—k”
->
F4hz
,„syÁh->¥—k”->
B4phz
,

408 
	`RES
(
r4p
), 
	`DBtoLIN
(
rsyÁh
->
•
[
a4
]), 0);

410 
	`£t_pŞe_fbwg
(
¤
, 
rsyÁh
->
¥—k”
->
F5hz
,„syÁh->¥—k”->
B5phz
,

411 
	`RES
(
r5p
), 
	`DBtoLIN
(
rsyÁh
->
•
[
a5
]), 0);

413 
	`£t_pŞe_fbwg
(
¤
, 
rsyÁh
->
¥—k”
->
F6hz
,„syÁh->¥—k”->
B6phz
,

414 
	`RES
(
r6p
), 
	`DBtoLIN
(
rsyÁh
->
•
[
a6
]), 0);

416 
	`PVT
(
amp_by·ss
èğ
	`DBtoLIN
(
rsyÁh
->
•
[
ab
]);

417 
	`PVT
(
amp_a¥
èğ
	`DBtoLIN
(
rsyÁh
->
•
[
a¥
]);

418 
	`PVT
(
amp_af
èğ
	`DBtoLIN
(
rsyÁh
->
•
[
af
]);

422 ià(
Gaš0
 <= 0)

423 
Gaš0
 = 57;

426 
	`£t_pŞe_fbwg
(
¤
, 0L, s¸/ 2, 
	`RES
(
rout
), 
	`DBtoLIN
(
Gaš0
), 1);

427 
	}
}

430 
	$rsyÁh_f‹r
(
rsyÁh_t
 * 
rsyÁh
, 
voiû
, 
noi£
)

432 
	`RGCHECK
(
noi£
);

433 
	`RGCHECK
(
voiû
);

436 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
ºpc
), voice);

437 
	`RGCHECK
(
voiû
);

438 
voiû
 = 
	`ªtœesÚ©Ü
(
	`RES
(
ºz
), voice);

439 
	`RGCHECK
(
voiû
);

440 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r1c
), voice);

441 
	`RGCHECK
(
voiû
);

442 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r2c
), voice);

443 
	`RGCHECK
(
voiû
);

444 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r3c
), voice);

445 
	`RGCHECK
(
voiû
);

446 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r4c
), voice);

447 
	`RGCHECK
(
voiû
);

448 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
rsc
), voice);

449 
	`RGCHECK
(
voiû
);

450 ià(
rsyÁh
->
¤
 > 8000) {

451 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r5c
), voice);

452 
	`RGCHECK
(
voiû
);

462 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r2p
), 
noi£
) - voice;

463 
	`RGCHECK
(
voiû
);

464 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r3p
), 
noi£
) - voice;

465 
	`RGCHECK
(
voiû
);

466 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r4p
), 
noi£
) - voice;

467 
	`RGCHECK
(
voiû
);

468 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r5p
), 
noi£
) - voice;

469 
	`RGCHECK
(
voiû
);

470 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
r6p
), 
noi£
) - voice;

471 
	`RGCHECK
(
voiû
);

472 
voiû
 = 
	`PVT
(
amp_by·ss
è* 
noi£
 - voice;

473 
	`RGCHECK
(
voiû
);

476 
voiû
 = 
	`»sÚ©Ü
(
	`RES
(
rout
), voice);

477 
	`RGCHECK
(
voiû
);

478  
voiû
;

479 
	}
}

482 
	$rsyÁh_äame
(
rsyÁh_t
 * 
rsyÁh
, 
F0Hz
, *
äame
, cÚ¡ *
Çme
)

484 
es
;

485 
rsyÁh
->
•
 = 
äame
;

486 
	`£tup_äame
(
rsyÁh
);

487 ià(
rsyÁh
->
voiû_fe
) {

488 
	`årštf
(
rsyÁh
->
voiû_fe
, "# voice†pvoc‚oise out");

489 
	`årštf
(
rsyÁh
->
voiû_fe
, "\n");

490 ià(
Çme
) {

491 
	`årštf
(
rsyÁh
->
voiû_fe
, "# %s\n", 
Çme
);

494 
	`PVT
(
F0Hz
) = F0Hz;

499 
es
 = 
	`PVT
(
ns
è+ 
rsyÁh
->
§m¶es_äame
; PVT(ns) <ƒs; PVT(ns)++) {

500 
noi£
 = 
	`g’_noi£
(
rsyÁh
);

501 
voiû
 = 
	`g’_voiû
(
rsyÁh
, 
noi£
);

502 
Ívoiû
 = 
	`»sÚ©Ü
(
	`RES
(
rgl
), 
voiû
);

503 ià(
	`PVT
(
Å”
è< PVT(
nİ’
)) {

507 
voiû
 +ğ
	`PVT
(
amp_turb
è* 
noi£
;

509 
	`RGCHECK
(
noi£
);

514 ià(
	`PVT
(
Å”
è< PVT(
nİ’
)) {

517 
noi£
 *= 0.5;

520 
voiû
 *ğ
	`PVT
(
amp_av
);

522 
voiû
 +ğ(
	`PVT
(
amp_a¥
è* 
noi£
);

525 
voiû
 +ğ(
	`PVT
(
amp_avc
è* 
Ívoiû
);

530 
noi£
 *ğ
	`PVT
(
amp_af
);

532 ià(
rsyÁh
->
voiû_fe
) {

533 
	`årštf
(
rsyÁh
->
voiû_fe
, "%6g %6g %6g", 
voiû
, 
Ívoiû
,

534 
noi£
);

537 
voiû
 = 
	`rsyÁh_f‹r
(
rsyÁh
, voiû, 
noi£
);

539 ià(
rsyÁh
->
voiû_fe
) {

540 
	`årštf
(
rsyÁh
->
voiû_fe
, " %6g\n", 
voiû
);

557 ià(
rsyÁh
->
§m¶e_p
)

558 
rsyÁh
->
u£r_d©a
 =

559 (*
rsyÁh
->
§m¶e_p
èÔsyÁh->
u£r_d©a
, 
voiû
,

560 
	`PVT
(
u¤§mp
)++, 
rsyÁh
);

562  
	`PVT
(
u¤§mp
è+ 
rsyÁh
->
§m¶es_äame
;

563 
	}
}

566 
	$rsyÁh_æush
(
rsyÁh_t
 * 
rsyÁh
, 
n§mp
)

568 ià(!
n§mp
)

569 
n§mp
 = 
	`PVT
(
u¤§mp
);

570 ià(
rsyÁh
->
æush_p
)

571 
rsyÁh
->
u£r_d©a
 =

572 (*
rsyÁh
->
æush_p
èÔsyÁh->
u£r_d©a
, 
n§mp
,„synth);

573 
	`PVT
(
u¤§mp
) = 0;

574 
	}
}

578 
rsyÁh_t
 *

579 
	$rsyÁh_š™
(
¤
, 
ms_³r_äame
, 
¥—k”_t
 * 
¥—k”
,

580 
rsyÁh_§m¶e_p
 * 
§m¶e_p
,

581 
rsyÁh_æush_p
 * 
æush_p
, *
u£r_d©a
)

583 
rsyÁh_t
 *
rsyÁh
 = (rsyÁh_ˆ*è
	`m®loc
((rsynth_t));

584 
rsyÁh_´iv©e
 *
pvt
 = (rsynth_private *)

585 
	`m®loc
((
rsyÁh_´iv©e
));

586 ià(
rsyÁh
 && 
pvt
) {

587 
	`mem£t
(
rsyÁh
, 0, (*rsynth));

588 
	`mem£t
(
pvt
, 0, (*pvt));

589 
rsyÁh
->
pvt
 =…vt;

590 
	`PVT
(
£ed
) = 5;

591 
rsyÁh
->
¤
 = sr;

592 
rsyÁh
->
§m¶es_äame
 = (è((
¤
 * 
ms_³r_äame
) / 1000);

593 
rsyÁh
->
¥—k”
 = speaker;

594 
rsyÁh
->
§m¶e_p
 = sample_p;

595 
rsyÁh
->
æush_p
 = flush_p;

596 
rsyÁh
->
u£r_d©a
 = user_data;

597 
rsyÁh
->
smoÙh
 = 0.5F;

598 
rsyÁh
->
¥“d
 = 1.0F;

600  
rsyÁh
;

601 
	}
}

	@emucore/rsynth/phfeat.h

1 #iâdeà
__PHFEAT_H


2 
	#__PHFEAT_H


	)

4 
	#uÄ
 0x00000000

	)

5 
	#ºd
 0x00000001

	)

6 
	#low
 0x00000002

	)

7 
	#lmd
 0x00000004

	)

8 
	#mdl
 0x00000008

	)

9 
	#smh
 0x00000010

	)

10 
	#Ïx
 0x00000020

	)

11 
	#hgh
 0x00000040

	)

12 
	#bck
 0x00000080

	)

13 
	#út
 0x00000100

	)

14 
	#ât
 0x00000200

	)

15 
	#vwl
 0x00000400

	)

16 
	#d
 0x00000800

	)

17 
	#blb
 0x00001000

	)

18 
	#¡l
 0x00002000

	)

19 
	#vls
 0x00004000

	)

20 
	#¡p
 0x00008000

	)

21 
	#vcd
 0x00010000

	)

22 
	#®v
 0x00020000

	)

23 
	#v–
 0x00040000

	)

24 
	#gÉ
 0x00080000

	)

25 
	#Çs
 0x00100000

	)

26 
	#p
 0x00200000

	)

27 
	#­r
 0x00400000

	)

28 
	#rzd
 0x00800000

	)

29 
	#äc
 0x01000000

	)

30 
	#lbd
 0x02000000

	)

31 
	#dÁ
 0x04000000

	)

32 
	#¶a
 0x08000000

	)

33 
	#Ït
 0x10000000

	)

34 
	#gld
 0x20000000

	)

35 
	#lbv
 0x40000000

	)

36 
	#·l
 0x80000000

	)

	@emucore/rsynth/phones.c

20 
	~<cÚfig.h
>

21 
	~<¡dio.h
>

22 
	~"phÚes.h
"

25 #ifdeà
__STDC__


26 
	#PHONE
(
nm
,
br
,
am
,
ex
è#nm,

	)

28 
	#PHONE
(
nm
,
br
,
am
,
ex
è"nm",

	)

32 
	#PHONE
(
nm
,
¡
,
br
,
am
,
ex
è
	)
st

34 *
	gph_Çme
[] =

36 
	~"phÚes.def
"

37 
NULL
};

38 #undeà
PHONE


40 
	#PHONE
(
nm
,
¡
,
br
,
am
,
ex
è
	)
br

41 *
	gph_br
[] =

43 
	~"phÚes.def
"

44 
NULL
};

45 #undeà
PHONE


47 
	#PHONE
(
nm
,
¡
,
br
,
am
,
ex
è
	)
am

48 *
	gph_am
[] =

50 
	~"phÚes.def
"

51 
NULL
};

52 #undeà
PHONE


	@emucore/rsynth/phones.h

1 #iâdeà
__PHONES_H


2 
	#__PHONES_H


	)

4 #ifdeà
__ılu¥lus


8 
	#PHONE
(
nm
,
¡
,
br
,
am
,
ex
è
	)
nm

9 
	ephÚe_e
 { 
SIL
,

10 
	~"phÚes.def
"

11 
END
 };

12 #undeà
PHONE


13 *
ph_Çme
[];

14 *
ph_br
[];

15 *
ph_am
[];

17 #ifdeà
__ılu¥lus


	@emucore/rsynth/phtoelm.c

20 
	~"cÚfig.h
"

24 *
	gphtÛlm_id
 = "$Id:…htoelm.c,v 1.2 2006/06/12 14:12:52 stephena Exp $";

25 
	~<¡dio.h
>

26 
	~<ùy³.h
>

27 
	~<¡dlib.h
>

28 
	~<m©h.h
>

29 
	~<¡d¬g.h
>

30 
	~"u£cÚfig.h
"

31 
	~"rsyÁh.h
"

32 
	~"Œ›.h
"

33 
	~"phã©.h
"

36 
Œ›_±r
 
	gphtÛlm
 = 
NULL
;

38 
Elm_±r
 
fšd_–m
(*
s
);

40 
Elm_±r


41 
	$fšd_–m
(*
s
)

43 
Elm_±r
 
e
 = 
EËm’ts
;

44 
e
 < 
EËm’ts
 + 
num_EËm’ts
) {

45 ià(!
	`¡rcmp
(
s
, 
e
->
Çme
)) {

46  
e
;

48 
e
++;

50  
NULL
;

51 
	}
}

53 
	#COMMENT
(
s
)

	)

56 
	$’‹r
(*
p
, ...)

58 
va_li¡
 
­
;

59 *
s
;

60 
buf
[20];

61 *
x
 = 
buf
 + 1;

62 
	`va_¡¬t
(
­
, 
p
);

63 (
s
 = 
	`va_¬g
(
­
, *))) {

64 
Elm_±r
 
e
 = 
	`fšd_–m
(
s
);

65 ià(
e
)

66 *
x
++ = (
e
 - 
EËm’ts
);

68 
	`årštf
(
¡d”r
, "CªnÙ fšd % fÜ [%s]\n", 
s
, 
p
);

71 
	`va_’d
(
­
);

72 
buf
[0] = (
x
 - buf) - 1;

73 
x
 = (*è
	`m®loc
(
buf
[0] + 1);

74 
	`memıy
(
x
, 
buf
, buf[0] + 1);

75 
	`Œ›_š£¹
(&
phtÛlm
, 
p
, 
x
);

76 
	}
}

79 
	$’‹r_phÚemes
()

81 
	~"phtÛlm.def
"

82 
	}
}

84 
Œ›_±r


85 
	$’‹r_Œªs
(*
Œªs
, 
v”bo£
)

87 
Œ›_±r
 
bË
 = 
NULL
;

88 
FILE
 *
f
 = 
	`fİ’
(
Œªs
, "r");

89 ià(
f
) {

90 
buf
[1024];

91 *
s
;

92 ià(
v”bo£
)

93 
	`årštf
(
¡d”r
, "R—dšg %s\n", 
Œªs
);

94 (
s
 = 
	`fg‘s
(
buf
, (buf), 
f
))) {

95 *
p
;

96 *
x
;

97 
	`is¥aû
((è*
s
))

98 
s
++;

99 
p
 = 
s
;

100 *
s
 && !
	`is¥aû
(() *s))

101 
s
++;

102 
	`is¥aû
((è*
s
))

103 *
s
++ = '\0';

104 
x
 = (*è
	`Œ›_lookup
(&
phtÛlm
, &
s
);

105 
	`is¥aû
(*
s
))

106 
s
++;

107 ià(*
s
) {

108 
	`årštf
(
¡d”r
, "% dÛ nÙ m­ (Ëave %s)\n", 
p
, 
s
);

111 
	`Œ›_š£¹
(&
bË
, 
p
, 
x
);

114 
	`fşo£
(
f
);

117 
	`³¼Ü
(
Œªs
);

119  
bË
;

120 
	}
}

124 
	#SŒessDur
(
e
,
s
,
l
è(Ó->
ud
 + (e->
du
 -ƒ->udè* s / 3)*
¥“d
)

	)

126 
	#SŒessDur
(
e
,
s
,
l
è(()(s),Ö ?ƒ->
du
*
¥“d
 : (e->du +ƒ->
ud
)/2)*¥“d)

	)

130 
	$deşše_f0
(
F0Hz
, 
d¬¿y_±r
 
f0
, 
f
, 
t
)

132 
	`d¬¿y_æßt
(
f0
, 
t
);

134 
f
 -ğ0.12 * 
t
;

136 ià(
f
 < 0.7 * 
F0Hz
)

137 
f
 = 0.7 * 
F0Hz
;

138  
	`d¬¿y_æßt
(
f0
, 
f
);

139 
	}
}

142 
	$phÚe_to_–m
(
rsyÁh_t
 * 
rsyÁh
, 
n
, *
phÚe
, 
d¬¿y_±r
 
–m
,

143 
d¬¿y_±r
 
f0
)

145 
F0Hz
 = 
rsyÁh
->
¥—k”
->F0Hz;

146 
¥“d
 = 
rsyÁh
->speed;

147 
¡»ss
 = 0;

148 
£’_vow–
 = 0;

149 
i¦Úg
 = 0;

150 *
s
 = 
phÚe
;

151 
t
 = 0;

152 
f0t
 = 0;

153 *
lim™
 = 
s
 + 
n
;

154 
f
 = 
	`d¬¿y_æßt
(
f0
, 
F0Hz
 * 1.1F);

155 ià(!
phtÛlm
)

156 
	`’‹r_phÚemes
();

157 
s
 < 
lim™
 && *s) {

158 *
e
 = (*è
	`Œ›_lookup
(&
phtÛlm
, &
s
);

159 ià(
e
) {

160 
n
 = *
e
++;

161 
n
-- > 0) {

162 
x
 = *
e
++;

163 
Elm_±r
 
p
 = &
EËm’ts
[
x
];

164 
	`d¬¿y_­³nd
(
–m
, 
x
);

168 
t
 +ğ
	`d¬¿y_­³nd
(
–m
,

169 (è(
	`SŒessDur
(
p
, 
¡»ss
, 
i¦Úg
)));

170 ià(
p
->
ã©
 & 
vwl
) {

171 
£’_vow–
 = 1;

173 ià(
£’_vow–
) {

174 
¡»ss
 = 0;

179 
ch
 = *
s
++;

180 
ch
) {

182 
¡»ss
++;

184 
¡»ss
++;

186 
¡»ss
++;

187 ià(
¡»ss
 > 3)

188 
¡»ss
 = 3;

189 
£’_vow–
 = 0;

191 
f
 = 
	`deşše_f0
(
F0Hz
, 
f0
, f, 
t
 - 
f0t
);

192 
f0t
 = 
t
;

194 
	`d¬¿y_æßt
(
f0
, 0);

195 
	`d¬¿y_æßt
(
f0
, 
f
 + 
F0Hz
 * 
¡»ss
 * 0.02);

200 
i¦Úg
 = 1;

203 
	`årštf
(
¡d”r
, "IgnÜšg %øš '%.*s'\n", 
ch
, 
n
, 
phÚe
);

209 
	`deşše_f0
(
F0Hz
, 
f0
, 
f
, 
t
 - 
f0t
);

210  
t
;

211 
	}
}

214 
	$rsyÁh_phÚes
(
rsyÁh_t
 * 
rsyÁh
, *
phÚe
, 
Ën
)

216 
d¬¿y_t
 
–m
;

217 
d¬¿y_t
 
f0
;

218 
äames
;

219 
	`d¬¿y_š™
(&
–m
, (), 
Ën
);

220 
	`d¬¿y_š™
(&
f0
, (), 
Ën
);

221 ià((
äames
 = 
	`phÚe_to_–m
(
rsyÁh
, 
Ën
, 
phÚe
, &
–m
, &
f0
))) {

222 ià(
	`rsyÁh_v”bo£
(
rsyÁh
))

223 
	`årštf
(
¡d”r
, "[%.*s]\n", 
Ën
, 
phÚe
);

224 
	`rsyÁh_æush
(
rsyÁh
,

225 
	`rsyÁh_š‹½Ş©e
(
rsyÁh
,

226 (*è
	`d¬¿y_fšd
(&
–m
, 0),–m.
™ems
,

227 (*è
	`d¬¿y_fšd
(&
f0
,0),

228 
f0
.
™ems
));

230 
	`d¬¿y_ä“
(&
f0
);

231 
	`d¬¿y_ä“
(&
–m
);

232 
	}
}

235 
	$rsyÁh_pho
(
rsyÁh_t
 * 
rsyÁh
, cÚ¡ *
·th
, 
dodur
, *
Œªs
)

237 
v”bo£
 = 
	`rsyÁh_v”bo£
(
rsyÁh
);

238 
FILE
 *
f
 = 
	`fİ’
(
·th
, "r");

239 
Œ›_±r
 
bË
;

240 ià(!
phtÛlm
)

241 
	`’‹r_phÚemes
();

242 ià(
Œªs
 && *Œª && 
	`¡rcmp
(trans, "sampa"))

243 
bË
 = 
	`’‹r_Œªs
(
Œªs
, 
v”bo£
);

245 
bË
 = 
phtÛlm
;

246 ià(
f
) {

247 
bufãr
[1024];

248 *
s
;

249 
d¬¿y_t
 
–m
;

250 
t
 = 0;

251 
f0a
[1024] = { 
rsyÁh
->
¥—k”
->
F0Hz
 };

252 
nf0
 = 0;

253 
f0t
 = 0;

254 
	`d¬¿y_š™
(&
–m
, (), 1024);

255 ià(
v”bo£
) {

256 
	`årštf
(
¡d”r
, "Frame is %.3gms\n",

257 
rsyÁh
->
§m¶es_äame
 * 1000.0 /„syÁh->
¤
);

259 (
s
 = 
	`fg‘s
(
bufãr
, (bufãr), 
f
))) {

261 
	`is¥aû
((è*
s
))

262 
s
++;

263 ià(*
s
 && *s != ';') {

265 *
ps
 = 
s
;

266 *
e
 = (*è
	`Œ›_lookup
(&
bË
, &
s
);

267 ià(*
s
 == ':')

268 
s
++;

269 ià(
e
 && 
	`is¥aû
((è*
s
)) {

270 *
³
 = 
s
;

271 
±
 = 0;

272 
n
 = *
e
++;

273 
i
;

274 
ms
 = 
	`¡¹od
(
s
, &s);

275 
äames
 =

276 
ms
 * (
rsyÁh
->
¤
 /„syÁh->
§m¶es_äame
) / 1000;

277 
edur
 = 0;

278 
e¡p
 = 0;

279 
n¡p
 = 0;

280 
d–
 = 0;

281 
i
 = 0; i < 
n
; i++) {

282 
x
 = 
e
[
i
];

283 
Elm_±r
 
p
 = &
EËm’ts
[
x
];

284 ià(!
p
->
du
 ||…->
ã©
 & 
¡p
)

285 
e¡p
 +ğ
p
->
ud
;

287 
edur
 +ğ
p
->
ud
;

288 
n¡p
++;

292 
äames
 -ğ
e¡p
;

293 
d–
 = 
äames
 - 
edur
;

296 ià(
v”bo£
)

297 
	`årštf
(
¡d”r
,

299 (
³
 - 
ps
),…s, 
ms
, 
n
, 
äames
, 
edur
, 
d–
,

300 
n
 - 
n¡p
);

302 
i
 = 0; i < 
n
; i++) {

303 
x
 = 
e
[
i
];

304 
Elm_±r
 
p
 = &
EËm’ts
[
x
];

305 
	`d¬¿y_­³nd
(&
–m
, 
x
);

306 ià(!
p
->
du
 ||…->
ã©
 & 
¡p
)

307 
±
 +ğ
	`d¬¿y_­³nd
(&
–m
, 
p
->
ud
);

309 ià(
dodur
) {

310 
sh¬e
 =

311 (
n¡p
 >

312 1è? 
	`ršt
(
d–
 * (
p
->
ud
 -

313 1è/ (
edur
 -

314 
n¡p
)) :

315 
d–
;

317 
	`årštf
(
¡d”r
,

319 
p
->
Çme
,…->
ud
, 
edur
, 
d–
,

320 
sh¬e
);

322 
edur
 -ğ
p
->
ud
;

323 
d–
 -ğ
sh¬e
;

324 
n¡p
--;

325 
±
 +=

326 
	`d¬¿y_­³nd
(&
–m
,

327 (è(
p
->
ud
 + 
sh¬e
));

330 
±
 +ğ
	`d¬¿y_­³nd
(&
–m
, 
p
->
du
);

334 ià(
v”bo£
 && 
dodur
) {

335 
gÙ
 =

336 1.0 * 
±
 * 
rsyÁh
->
§m¶es_äame
 /„syÁh->
¤
 *

338 ià(
	`çbs
(
gÙ
 - 
ms
) > 0.5) {

339 
	`årštf
(
¡d”r
,

341 (
³
 - 
ps
),…s, 
ms
, 
gÙ
,

342 100 * (
gÙ
 - 
ms
) / ms);

345 
	`is¥aû
((è*
s
))

346 
s
++;

347 *
s
) {

348 
³rûÁ
 = 
	`¡¹od
(
s
, &s);

349 
f0
 = 
	`¡¹od
(
s
, &s);

350 
Á
 =

351 (è(
t
 + (
³rûÁ
 * 
±
 / 100));

352 ià(
Á
 > 
f0t
) {

354 
f0a
[++
nf0
] = (
Á
 - 
f0t
);

355 
f0a
[++
nf0
] = 
f0
;

356 
f0t
 = 
Á
;

360 
f0a
[
nf0
] = 
f0
;

362 
	`is¥aû
((è*
s
))

363 
s
++;

365 
t
 +ğ
±
;

368 
	`åuts
(
bufãr
, 
¡d”r
);

369 
	`årštf
(
¡d”r
, "UnknowÀphÚe:%s", 
ps
);

373 
	`fşo£
(
f
);

374 ià(
t
) {

375 
f0
 = 
f0a
[
nf0
++];

376 ià(
f0t
 < 
t
) {

377 
f0a
[
nf0
++] = 
t
 - 
f0t
;

378 
f0a
[
nf0
++] = 
f0
;

380 
	`rsyÁh_æush
(
rsyÁh
,

381 
	`rsyÁh_š‹½Ş©e
(
rsyÁh
,

382 (*è
	`d¬¿y_fšd
(&
–m
, 0),

383 
–m
.
™ems
, 
f0a
, 
nf0
));

387 
	`³¼Ü
(
·th
);

389 
	}
}

392 
	$rsyÁh_‹rm
(
rsyÁh_t
 * 
rsyÁh
)

394 ià(
rsyÁh
) {

395 
	`rsyÁh_æush
(
rsyÁh
, 0);

396 
	`Œ›_ä“
(&
phtÛlm
, &
ä“
);

397 #ifdeà
DO_RANGE_CHECKS


398 
	`årštf
(
¡d”r
, "Max„ªg%g @ %s:%d\n", 
¿nge_max
, 
__FILE__
,

399 
¿nge_Ê
);

401 ià(
rsyÁh
->
voiû_fe
)

402 
	`fşo£
(
rsyÁh
->
voiû_fe
);

403 ià(
rsyÁh
->
·rm_fe
)

404 
	`fşo£
(
rsyÁh
->
·rm_fe
);

405 
	`ä“
(
rsyÁh
->
pvt
);

406 
	`ä“
(
rsyÁh
);

408 
	}
}

	@emucore/rsynth/phtoelm.h

3 #iâdeà
__PHTOELM_H


4 
	#__PHTOELM_H


	)

6 #ifdeà
__ılu¥lus


10 
rsyÁh_s
;

11 
phÚe_to_–m
 (*
s
, 
n
, 
d¬¿y_±r
 
–m
, d¬¿y_±¸
f0
);

12 
§y_pho
(
rsyÁh_s
 *
rsyÁh
, cÚ¡ *
·th
, 
dodur
,*
phÚe£t
);

14 #ifdeà
__ılu¥lus


	@emucore/rsynth/rsynth.h

20 #iâdeà
RSYNTH_H


21 
	#RSYNTH_H


	)

23 #ifdeà
__ılu¥lus


27 
	~"d¬¿y.h
"

28 
	~"Œ›.h
"

31 {
¡dy
;

32 
´İ
;

33 
ed
;

34 
id
;

35 
rk
;

36 } 
	tš‹½_t
, *
	tš‹½_±r
;

59 
	eE·rm_e


61 
â
, 
f1
, 
f2
, 
f3
, 
b1
, 
b2
, 
b3
, 
²
, 
a2
, 
a3
, 
a4
, 
a5
, 
a6
, 
ab
, 
av
, 
avc
, 
a¥
, 
af
,

62 
nE·rm


65 *
Ep_Çme
[
nE·rm
];

67 
	sElm_s


69 *
	gÇme
;

70 
	grk
;

71 
	gdu
;

72 
	gud
;

73 *
	gunicode
;

74 *
	g§m·
;

75 
	gã©
;

76 
š‹½_t
 
	gp
[
nE·rm
];

77 } 
	tElm_t
, *
	tElm_±r
;

79 
Elm_t
 
EËm’ts
[];

80 
num_EËm’ts
;

84 
	gGaš0
;

85 
	gF0Hz
;

86 
	gF4hz
;

87 
	gB4hz
;

88 
	gF5hz
;

89 
	gB5hz
;

90 
	gF6hz
;

91 
	gB6hz
;

92 
	gFNPhz
;

93 
	gBNhz
;

94 
	gB4phz
;

95 
	gB5phz
;

96 
	gB6phz
;

97 } 
	t¥—k”_t
;

100 
rsyÁh_s
 
	trsyÁh_t
;

101 *
	trsyÁh_§m¶e_p
(*
	tu£r_d©a
,
	t§m¶e
, 
	tn§mp
, 
	trsyÁh_t
 *
	trsyÁh
);

102 *
	trsyÁh_æush_p
(*
	tu£r_d©a
,
	tn§mp
, 
	trsyÁh_t
 *
	trsyÁh
);

104 
	srsyÁh_s


106 
	gæags
;

107 
	g¤
;

108 
	g§m¶es_äame
;

109 
¥—k”_t
 *
	g¥—k”
;

110 *
	g•
;

111 
FILE
 *
	gvoiû_fe
;

112 
FILE
 *
	g·rm_fe
;

113 
rsyÁh_§m¶e_p
 *
	g§m¶e_p
;

114 
rsyÁh_æush_p
 *
	gæush_p
;

115 *
	gu£r_d©a
;

116 
	g¥“d
;

117 
	gsmoÙh
;

118 
rsyÁh_´iv©e
 *
	gpvt
;

121 
	#RSYNTH_VERBOSE
 (1L << 0)

	)

122 
	#RSYNTH_ETRACE
 (1L << 1)

	)

123 
	#RSYNTH_MONOTONE
 (1L << 2)

	)

124 
	#RSYNTH_F0TRACE
 (1L << 3)

	)

126 
¥—k”_t
 *
rsyÁh_¥—k”
(
F0Hz
, 
gaš
, 
Elm_t
 *
–em’ts
);

128 
rsyÁh_t
 *
rsyÁh_š™
(
§m¿‹
,

129 
ms_³r_äame
,

130 
¥—k”_t
 *
¥—k”
,

131 
rsyÁh_§m¶e_p
 *
§m¶e_p
,

132 
rsyÁh_æush_p
 *
æush_p
,

133 *
u£r_d©a
);

136 
rsyÁh_phÚes
(
rsyÁh_s
 *
rsyÁh
, *
s
, 
Ën
);

139 
rsyÁh_pho
(
rsyÁh_s
 *
rsyÁh
, cÚ¡ *
·th
, 
dodur
,*
phÚe£t
);

143 
rsyÁh_š‹½Ş©e
(
rsyÁh_t
 *
rsyÁh
,

144 *
–m
, 
Ãlm
,

145 *
f0
, 
nf0
);

147 
rsyÁh_æush
(
rsyÁh_t
 *
rsyÁh
,
n§mp
);

150 
rsyÁh_äame
(
rsyÁh_t
 *
rsyÁh
, 
F0Hz
, *
äame
, cÚ¡ *
Çme
);

152 
rsyÁh_‹rm
(
rsyÁh_t
 *
rsyÁh
);

154 
	#rsyÁh_v”bo£
(
rsyÁh
è((!rsyÁhè|| (rsyÁh)->
æags
 & 
RSYNTH_VERBOSE
)

	)

156 #ifdeà
__ılu¥lus


	@emucore/rsynth/trie.c

21 
	~"cÚfig.h
"

24 *
	gŒ›_id
 = "$Id:rie.c,v 1.1 2006/06/11 07:13:27 urchlay Exp $";

25 
	~"u£cÚfig.h
"

26 
	~<¡dio.h
>

27 
	~"Œ›.h
"

29 
	sŒ›_s
 {

30 
Œ›_s
 *
	mÙh”wi£
;

31 
Œ›_s
 *
	mmÜe
;

32 *
	mv®ue
;

33 
	mch
;

37 
Œ›_ä“
(
Œ›_±r
 * 
r
, (*
func
) (*))

39 
Œ›_±r
 
p
;

40 (
p
 = *
r
)) {

41 
	`Œ›_ä“
(&
p
->
mÜe
, 
func
);

42 *
r
 = 
p
->
Ùh”wi£
;

43 ià(
func
)

44 (*
func
è(
p
->
v®ue
);

45 
	`ä“
(
p
);

47 
	}
}

50 
	$Œ›_š£¹
(
Œ›_±r
 * 
r
, *
s
, *
v®ue
)

52 
Œ›_±r
 
p
 = 
NULL
;

53 
ch
;

54 (
ch
 = *
s
++)) {

55 (
p
 = *
r
)) {

56 ià(
p
->
ch
 == ch)

59 
r
 = &
p
->
Ùh”wi£
;

61 ià(!
p
) {

62 
p
 = (
Œ›_±r
è
	`m®loc
((*p));

63 
	`mem£t
(
p
, 0, (*p));

64 
p
->
ch
 = ch;

65 *
r
 = 
p
;

67 
r
 = &
p
->
mÜe
;

69 
p
->
v®ue
 = value;

70 
	}
}

73 
	$Œ›_lookup
(
Œ›_±r
 * 
r
, **
¥
)

75 *
s
 = *
¥
;

76 *
v®ue
 = 
NULL
;

77 
ch
;

78 (
ch
 = *
s
)) {

79 
Œ›_±r
 *
l
 = 
r
;

80 
Œ›_±r
 
p
;

81 (
p
 = *
l
)) {

82 ià(
p
->
ch
 == ch)

85 
l
 = &
p
->
Ùh”wi£
;

87 ià(
p
) {

88 *
l
 = 
p
->
Ùh”wi£
;

89 
p
->
Ùh”wi£
 = *
r
;

90 *
r
 = 
p
;

91 
r
 = &
p
->
mÜe
;

92 
v®ue
 = (*è
p
->value;

93 
s
++;

98 *
¥
 = 
s
;

99  
v®ue
;

100 
	}
}

	@emucore/rsynth/trie.h

22 #iâdeà
TRIE_H


23 
	#TRIE_H


	)

25 #ifdeà
__ılu¥lus


29 
Œ›_s
 *
	tŒ›_±r
;

31 
Œ›_š£¹
(
Œ›_±r
 *
r
,*
s
,*
v®ue
);

32 *
Œ›_lookup
(
Œ›_±r
 *
r
,**
¥
);

33 
Œ›_ä“
(
Œ›_±r
 *
r
,(*
func
)(*));

35 #ifdeà
__ılu¥lus


	@emucore/rsynth/useconfig.h

1 #ifdeà
HAVE_SYS_TYPES_H


2 
	~<sys/ty³s.h
>

5 #ià
STDC_HEADERS


6 
	~<¡ddef.h
>

7 
	~<¡ršg.h
>

8 
	~<¡dlib.h
>

10 #iâdeà
HAVE_STRCHR


11 
	#¡rchr
 
šdex


	)

12 
	#¡¼chr
 
ršdex


	)

14 *
¡rchr
 (), *
¡¼chr
 ();

15 #iâdeà
HAVE_MEMCPY


16 
	#memıy
(
d
, 
s
, 
n
è
	`bcİy
 ((s), (d), (n))

	)

18 #ifdeà
HAVE_MALLOC_H


19 
	~<m®loc.h
>

23 #ià
HAVE_UNISTD_H


24 
	~<uni¡d.h
>

27 #ià
HAVE_LIBC_H


29 
	~<libc.h
>

	@emucore/unzip.c

8 
	~<¡dio.h
>

9 
	~<¡dlib.h
>

10 
	~<¡ršg.h
>

11 
	~<zlib.h
>

13 
	~"unz.h
"

15 #ifdeà
STDC


16 
	~<¡ddef.h
>

17 
	~<¡ršg.h
>

18 
	~<¡dlib.h
>

20 #ifdeà
NO_ERRNO_H


21 
”ºo
;

23 
	~<”ºo.h
>

26 #iâdeà
loÿl


27 
	#loÿl
 

	)

33 #ià!
defšed
(
unix
è&& !defšed(
CASESENSITIVITYDEFAULT_YES
) && \

34 !
	$defšed
(
CASESENSITIVITYDEFAULT_NO
)

35 
	#CASESENSITIVITYDEFAULT_NO


	)

39 #iâdeà
UNZ_BUFSIZE


40 
	#UNZ_BUFSIZE
 (16384)

	)

43 #iâdeà
UNZ_MAXFILENAMEINZIP


44 
	#UNZ_MAXFILENAMEINZIP
 (256)

	)

47 #iâdeà
ALLOC


48 
	#ALLOC
(
size
è(
	`m®loc
(size))

	)

50 #iâdeà
TRYFREE


51 
	#TRYFREE
(
p
è{iàÕè
	`ä“
Õ);
	}

	)
}

54 
	#SIZECENTRALDIRITEM
 (0x2e)

	)

55 
	#SIZEZIPLOCALHEADER
 (0x1e)

	)

60 #iâdeà
SEEK_CUR


61 
	#SEEK_CUR
 1

	)

64 #iâdeà
SEEK_END


65 
	#SEEK_END
 2

	)

68 #iâdeà
SEEK_SET


69 
	#SEEK_SET
 0

	)

72 cÚ¡ 
	gunz_cİyright
[] =

76 
	sunz_fe_šfo_š‹º®_s


78 
uLÚg
 
	moff£t_curfe
;

79 } 
	tunz_fe_šfo_š‹º®
;

86 *
	m»ad_bufãr
;

87 
z_¡»am
 
	m¡»am
;

89 
uLÚg
 
	mpos_š_zfe
;

90 
uLÚg
 
	m¡»am_š™Ÿli£d
;

92 
uLÚg
 
	moff£t_loÿl_exŒaf›ld
;

93 
uIÁ
 
	msize_loÿl_exŒaf›ld
;

94 
uLÚg
 
	mpos_loÿl_exŒaf›ld
;

96 
uLÚg
 
	müc32
;

97 
uLÚg
 
	müc32_wa™
;

98 
uLÚg
 
	m»¡_»ad_com´es£d
;

99 
uLÚg
 
	m»¡_»ad_uncom´es£d
;

100 
FILE
* 
	mfe
;

101 
uLÚg
 
	mcom´essiÚ_m‘hod
;

102 
uLÚg
 
	mby‹_befÜe_the_zfe
;

103 } 
	tfe_š_z_»ad_šfo_s
;

110 
FILE
* 
	mfe
;

111 
unz_glob®_šfo
 
	mgi
;

112 
uLÚg
 
	mby‹_befÜe_the_zfe
;

113 
uLÚg
 
	mnum_fe
;

114 
uLÚg
 
	mpos_š_ûÁ¿l_dœ
;

115 
uLÚg
 
	mcu¼’t_fe_ok
;

116 
uLÚg
 
	mûÁ¿l_pos
;

118 
uLÚg
 
	msize_ûÁ¿l_dœ
;

119 
uLÚg
 
	moff£t_ûÁ¿l_dœ
;

122 
unz_fe_šfo
 
	mcur_fe_šfo
;

123 
unz_fe_šfo_š‹º®
 
	mcur_fe_šfo_š‹º®
;

124 
fe_š_z_»ad_šfo_s
* 
	mpfe_š_z_»ad
;

126 } 
	tunz_s
;

136 
loÿl
 
	$unzloÿl_g‘By‹
(
FILE
* 
fš
, * 
pi
)

138 
c
;

139 
”r
 = 
	`ä—d
(&
c
, 1, 1, 
fš
);

140 ià(
”r
==1)

142 *
pi
 = ()
c
;

143  
UNZ_OK
;

147 ià(
	`ã¼Ü
(
fš
))

148  
UNZ_ERRNO
;

150  
UNZ_EOF
;

152 
	}
}

158 
loÿl
 
	$unzloÿl_g‘ShÜt
 (
FILE
* 
fš
,
uLÚg
* 
pX
)

160 
uLÚg
 
x
 ;

161 
i
 = 0;

162 
”r
;

164 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

165 
x
 = (
uLÚg
)
i
;

167 ià(
”r
==
UNZ_OK
)

168 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

169 
x
 +ğ((
uLÚg
)
i
)<<8;

171 ià(
”r
==
UNZ_OK
)

172 *
pX
 = 
x
;

174 *
pX
 = 0;

175  
”r
;

176 
	}
}

178 
loÿl
 
	$unzloÿl_g‘LÚg
 (
FILE
* 
fš
,
uLÚg
* 
pX
)

180 
uLÚg
 
x
 ;

181 
i
 = 0;

182 
”r
;

184 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

185 
x
 = (
uLÚg
)
i
;

187 ià(
”r
==
UNZ_OK
)

188 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

189 
x
 +ğ((
uLÚg
)
i
)<<8;

191 ià(
”r
==
UNZ_OK
)

192 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

193 
x
 +ğ((
uLÚg
)
i
)<<16;

195 ià(
”r
==
UNZ_OK
)

196 
”r
 = 
	`unzloÿl_g‘By‹
(
fš
,&
i
);

197 
x
 +ğ((
uLÚg
)
i
)<<24;

199 ià(
”r
==
UNZ_OK
)

200 *
pX
 = 
x
;

202 *
pX
 = 0;

203  
”r
;

204 
	}
}

208 
loÿl
 
	$¡rcmpÿ£no£ns™ive_š‹º®
 (cÚ¡ * 
feName1
, cÚ¡ * 
feName2
)

212 
c1
=*(
feName1
++);

213 
c2
=*(
feName2
++);

214 ià((
c1
>='a') && (c1<='z'))

215 
c1
 -= 0x20;

216 ià((
c2
>='a') && (c2<='z'))

217 
c2
 -= 0x20;

218 ià(
c1
=='\0')

219  ((
c2
=='\0') ? 0 : -1);

220 ià(
c2
=='\0')

222 ià(
c1
<
c2
)

224 ià(
c1
>
c2
)

227 
	}
}

230 #ifdeà 
CASESENSITIVITYDEFAULT_NO


231 
	#CASESENSITIVITYDEFAULTVALUE
 2

	)

233 
	#CASESENSITIVITYDEFAULTVALUE
 1

	)

236 #iâdeà
STRCMPCASENOSENTIVEFUNCTION


237 
	#STRCMPCASENOSENTIVEFUNCTION
 
¡rcmpÿ£no£ns™ive_š‹º®


	)

249 
ZEXPORT
 
unzSŒšgFeNameCom·»


250 (cÚ¡ * 
feName1
, cÚ¡ * 
feName2
, 
iCa£S’s™iv™y
)

252 ià(
iCa£S’s™iv™y
==0)

253 
iCa£S’s™iv™y
=
CASESENSITIVITYDEFAULTVALUE
;

255 ià(
iCa£S’s™iv™y
==1)

256  
¡rcmp
(
feName1
,
feName2
);

258  
STRCMPCASENOSENTIVEFUNCTION
(
feName1
,
feName2
);

261 
	#BUFREADCOMMENT
 (0x400)

	)

267 
loÿl
 
uLÚg
 
	$unzloÿl_S—rchC’Œ®Dœ
(
FILE
* 
fš
)

269 * 
buf
;

270 
uLÚg
 
uSizeFe
;

271 
uLÚg
 
uBackR—d
;

272 
uLÚg
 
uMaxBack
=0xffff;

273 
uLÚg
 
uPosFound
=0;

275 ià(
	`f£ek
(
fš
,0,
SEEK_END
) != 0)

279 
uSizeFe
 = 
	`á–l
Ğ
fš
 );

281 ià(
uMaxBack
>
uSizeFe
)

282 
uMaxBack
 = 
uSizeFe
;

284 
buf
 = (*)
	`ALLOC
(
BUFREADCOMMENT
+4);

285 ià(
buf
==
NULL
)

288 
uBackR—d
 = 4;

289 
uBackR—d
<
uMaxBack
)

291 
uLÚg
 
uR—dSize
,
uR—dPos
 ;

292 
i
;

293 ià(
uBackR—d
+
BUFREADCOMMENT
>
uMaxBack
)

294 
uBackR—d
 = 
uMaxBack
;

296 
uBackR—d
+=
BUFREADCOMMENT
;

297 
uR—dPos
 = 
uSizeFe
-
uBackR—d
 ;

299 
uR—dSize
 = ((
BUFREADCOMMENT
+4è< (
uSizeFe
-
uR—dPos
)) ?

300 (
BUFREADCOMMENT
+4è: (
uSizeFe
-
uR—dPos
);

301 ià(
	`f£ek
(
fš
,
uR—dPos
,
SEEK_SET
)!=0)

304 ià(
	`ä—d
(
buf
,(
uIÁ
)
uR—dSize
,1,
fš
)!=1)

307 
i
=()
uR—dSize
-3; (i--)>0;)

308 ià(((*(
buf
+
i
))==0x50) && ((*(buf+i+1))==0x4b) &&

309 ((*(
buf
+
i
+2))==0x05) && ((*(buf+i+3))==0x06))

311 
uPosFound
 = 
uR—dPos
+
i
;

315 ià(
uPosFound
!=0)

318 
	`TRYFREE
(
buf
);

319  
uPosFound
;

320 
	}
}

331 
unzFe
 
ZEXPORT
 
	$unzO³n
(cÚ¡ *
·th
)

333 
unz_s
 
us
;

334 
unz_s
 *
s
;

335 
uLÚg
 
ûÁ¿l_pos
,
uL
;

336 
FILE
 * 
fš
 ;

338 
uLÚg
 
numb”_disk
;

340 
uLÚg
 
numb”_disk_w™h_CD
;

342 
uLÚg
 
numb”_’Œy_CD
;

346 
”r
=
UNZ_OK
;

348 ià(
unz_cİyright
[0]!=' ')

349  
NULL
;

351 
fš
=
	`fİ’
(
·th
,"rb");

352 ià(
fš
==
NULL
)

353  
NULL
;

355 
ûÁ¿l_pos
 = 
	`unzloÿl_S—rchC’Œ®Dœ
(
fš
);

356 ià(
ûÁ¿l_pos
==0)

357 
”r
=
UNZ_ERRNO
;

359 ià(
	`f£ek
(
fš
,
ûÁ¿l_pos
,
SEEK_SET
)!=0)

360 
”r
=
UNZ_ERRNO
;

363 ià(
	`unzloÿl_g‘LÚg
(
fš
,&
uL
)!=
UNZ_OK
)

364 
”r
=
UNZ_ERRNO
;

367 ià(
	`unzloÿl_g‘ShÜt
(
fš
,&
numb”_disk
)!=
UNZ_OK
)

368 
”r
=
UNZ_ERRNO
;

371 ià(
	`unzloÿl_g‘ShÜt
(
fš
,&
numb”_disk_w™h_CD
)!=
UNZ_OK
)

372 
”r
=
UNZ_ERRNO
;

375 ià(
	`unzloÿl_g‘ShÜt
(
fš
,&
us
.
gi
.
numb”_’Œy
)!=
UNZ_OK
)

376 
”r
=
UNZ_ERRNO
;

379 ià(
	`unzloÿl_g‘ShÜt
(
fš
,&
numb”_’Œy_CD
)!=
UNZ_OK
)

380 
”r
=
UNZ_ERRNO
;

382 ià((
numb”_’Œy_CD
!=
us
.
gi
.
numb”_’Œy
) ||

383 (
numb”_disk_w™h_CD
!=0) ||

384 (
numb”_disk
!=0))

385 
”r
=
UNZ_BADZIPFILE
;

388 ià(
	`unzloÿl_g‘LÚg
(
fš
,&
us
.
size_ûÁ¿l_dœ
)!=
UNZ_OK
)

389 
”r
=
UNZ_ERRNO
;

393 ià(
	`unzloÿl_g‘LÚg
(
fš
,&
us
.
off£t_ûÁ¿l_dœ
)!=
UNZ_OK
)

394 
”r
=
UNZ_ERRNO
;

397 ià(
	`unzloÿl_g‘ShÜt
(
fš
,&
us
.
gi
.
size_comm’t
)!=
UNZ_OK
)

398 
”r
=
UNZ_ERRNO
;

400 ià((
ûÁ¿l_pos
<
us
.
off£t_ûÁ¿l_dœ
+us.
size_ûÁ¿l_dœ
) &&

401 (
”r
==
UNZ_OK
))

402 
”r
=
UNZ_BADZIPFILE
;

404 ià(
”r
!=
UNZ_OK
)

406 
	`fşo£
(
fš
);

407  
NULL
;

410 
us
.
fe
=
fš
;

411 
us
.
by‹_befÜe_the_zfe
 = 
ûÁ¿l_pos
 -

412 (
us
.
off£t_ûÁ¿l_dœ
+us.
size_ûÁ¿l_dœ
);

413 
us
.
ûÁ¿l_pos
 = central_pos;

414 
us
.
pfe_š_z_»ad
 = 
NULL
;

417 
s
=(
unz_s
*)
	`ALLOC
((unz_s));

418 *
s
=
us
;

419 
	`unzGoToFœ¡Fe
((
unzFe
)
s
);

420  (
unzFe
)
s
;

421 
	}
}

429 
ZEXPORT
 
	$unzClo£
 (
unzFe
 
fe
)

431 
unz_s
* 
s
;

432 ià(
fe
==
NULL
)

433  
UNZ_PARAMERROR
;

434 
s
=(
unz_s
*)
fe
;

436 ià(
s
->
pfe_š_z_»ad
!=
NULL
)

437 
	`unzClo£Cu¼’tFe
(
fe
);

439 
	`fşo£
(
s
->
fe
);

440 
	`TRYFREE
(
s
);

441  
UNZ_OK
;

442 
	}
}

449 
ZEXPORT
 
	$unzG‘Glob®Info
 (
unzFe
 
fe
, 
unz_glob®_šfo
* 
pglob®_šfo
)

451 
unz_s
* 
s
;

452 ià(
fe
==
NULL
)

453  
UNZ_PARAMERROR
;

454 
s
=(
unz_s
*)
fe
;

455 *
pglob®_šfo
=
s
->
gi
;

456  
UNZ_OK
;

457 
	}
}

463 
loÿl
 
	$unzloÿl_DosD©eToTmuD©e
 (
uLÚg
 
ulDosD©e
, 
tm_unz
* 
±m
)

465 
uLÚg
 
uD©e
;

466 
uD©e
 = (
uLÚg
)(
ulDosD©e
>>16);

467 
±m
->
tm_mday
 = (
uIÁ
)(
uD©e
&0x1f) ;

468 
±m
->
tm_mÚ
 = (
uIÁ
)((((
uD©e
)&0x1E0)/0x20)-1) ;

469 
±m
->
tm_y—r
 = (
uIÁ
)(((
uD©e
&0x0FE00)/0x0200)+1980) ;

471 
±m
->
tm_hour
 = (
uIÁ
è((
ulDosD©e
 &0xF800)/0x800);

472 
±m
->
tm_mš
 = (
uIÁ
è((
ulDosD©e
&0x7E0)/0x20) ;

473 
±m
->
tm_£c
 = (
uIÁ
è(2*(
ulDosD©e
&0x1f)) ;

474 
	}
}

479 
loÿl
 
unzloÿl_G‘Cu¼’tFeInfoIÁ”Çl
 
OF
((
unzFe
 
fe
,

480 
unz_fe_šfo
 *
pfe_šfo
,

481 
unz_fe_šfo_š‹º®


482 *
pfe_šfo_š‹º®
,

483 *
szFeName
,

484 
uLÚg
 
feNameBufãrSize
,

485 *
exŒaF›ld
,

486 
uLÚg
 
exŒaF›ldBufãrSize
,

487 *
szComm’t
,

488 
uLÚg
 
comm’tBufãrSize
));

490 
loÿl
 
	gunzloÿl_G‘Cu¼’tFeInfoIÁ”Çl


491 Ğ
unzFe
 
	gfe
,

492 
unz_fe_šfo
 *
	gpfe_šfo
,

493 
unz_fe_šfo_š‹º®
 *
	gpfe_šfo_š‹º®
,

494 *
	gszFeName
,

495 
uLÚg
 
	gfeNameBufãrSize
,

496 *
	gexŒaF›ld
,

497 
uLÚg
 
	gexŒaF›ldBufãrSize
,

498 *
	gszComm’t
,

499 
uLÚg
 
	gcomm’tBufãrSize
)

501 
unz_s
* 
	gs
;

502 
unz_fe_šfo
 
	gfe_šfo
;

503 
unz_fe_šfo_š‹º®
 
	gfe_šfo_š‹º®
;

504 
	g”r
=
UNZ_OK
;

505 
uLÚg
 
	guMagic
;

506 
	glS“k
=0;

508 ià(
	gfe
==
NULL
)

509  
UNZ_PARAMERROR
;

510 
	gs
=(
unz_s
*)
fe
;

511 ià(
f£ek
(
s
->
fe
,s->
pos_š_ûÁ¿l_dœ
+s->
by‹_befÜe_the_zfe
,
SEEK_SET
)!=0)

512 
”r
=
UNZ_ERRNO
;

516 ià(
	g”r
==
UNZ_OK
)

518 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uMagic
è!ğ
UNZ_OK
)

519 
”r
=
UNZ_ERRNO
;

520 ià(
	guMagic
!=0x02014b50)

521 
”r
=
UNZ_BADZIPFILE
;

524 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
v”siÚ
è!ğ
UNZ_OK
)

525 
”r
=
UNZ_ERRNO
;

527 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
v”siÚ_Ãeded
è!ğ
UNZ_OK
)

528 
”r
=
UNZ_ERRNO
;

530 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
æag
è!ğ
UNZ_OK
)

531 
”r
=
UNZ_ERRNO
;

533 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
com´essiÚ_m‘hod
è!ğ
UNZ_OK
)

534 
”r
=
UNZ_ERRNO
;

536 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo
.
dosD©e
è!ğ
UNZ_OK
)

537 
”r
=
UNZ_ERRNO
;

539 
unzloÿl_DosD©eToTmuD©e
(
fe_šfo
.
dosD©e
,&fe_šfo.
tmu_d©e
);

541 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo
.
üc
è!ğ
UNZ_OK
)

542 
”r
=
UNZ_ERRNO
;

544 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo
.
com´es£d_size
è!ğ
UNZ_OK
)

545 
”r
=
UNZ_ERRNO
;

547 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo
.
uncom´es£d_size
è!ğ
UNZ_OK
)

548 
”r
=
UNZ_ERRNO
;

550 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
size_f’ame
è!ğ
UNZ_OK
)

551 
”r
=
UNZ_ERRNO
;

553 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
size_fe_exŒa
è!ğ
UNZ_OK
)

554 
”r
=
UNZ_ERRNO
;

556 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
size_fe_comm’t
è!ğ
UNZ_OK
)

557 
”r
=
UNZ_ERRNO
;

559 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
disk_num_¡¬t
è!ğ
UNZ_OK
)

560 
”r
=
UNZ_ERRNO
;

562 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
fe_šfo
.
š‹º®_ç
è!ğ
UNZ_OK
)

563 
”r
=
UNZ_ERRNO
;

565 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo
.
ex‹º®_ç
è!ğ
UNZ_OK
)

566 
”r
=
UNZ_ERRNO
;

568 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
fe_šfo_š‹º®
.
off£t_curfe
è!ğ
UNZ_OK
)

569 
”r
=
UNZ_ERRNO
;

571 
	glS“k
+=
fe_šfo
.
size_f’ame
;

572 ià((
	g”r
==
UNZ_OK
è&& (
szFeName
!=
NULL
))

574 
uLÚg
 
uSizeR—d
 ;

575 ià(
	gfe_šfo
.
	gsize_f’ame
<
	gfeNameBufãrSize
)

577 *(
	gszFeName
+
	gfe_šfo
.
	gsize_f’ame
)='\0';

578 
	guSizeR—d
 = 
fe_šfo
.
size_f’ame
;

581 
	guSizeR—d
 = 
feNameBufãrSize
;

583 ià((
	gfe_šfo
.
	gsize_f’ame
>0è&& (
	gfeNameBufãrSize
>0))

584 ià(
ä—d
(
szFeName
,(
uIÁ
)
uSizeR—d
,1,
s
->
fe
)!=1)

585 
”r
=
UNZ_ERRNO
;

586 
	glS“k
 -ğ
uSizeR—d
;

590 ià((
	g”r
==
UNZ_OK
è&& (
exŒaF›ld
!=
NULL
))

592 
uLÚg
 
uSizeR—d
 ;

593 ià(
	gfe_šfo
.
	gsize_fe_exŒa
<
	gexŒaF›ldBufãrSize
)

594 
	guSizeR—d
 = 
fe_šfo
.
size_fe_exŒa
;

596 
	guSizeR—d
 = 
exŒaF›ldBufãrSize
;

598 ià(
	glS“k
!=0)

600 ià(
f£ek
(
s
->
fe
,
lS“k
,
SEEK_CUR
)==0)

601 
lS“k
=0;

603 
	g”r
=
UNZ_ERRNO
;

605 ià((
	gfe_šfo
.
	gsize_fe_exŒa
>0è&& (
	gexŒaF›ldBufãrSize
>0))

606 ià(
ä—d
(
exŒaF›ld
,(
uIÁ
)
uSizeR—d
,1,
s
->
fe
)!=1)

607 
”r
=
UNZ_ERRNO
;

608 
	glS“k
 +ğ
fe_šfo
.
size_fe_exŒa
 - 
uSizeR—d
;

611 
	glS“k
+=
fe_šfo
.
size_fe_exŒa
;

614 ià((
	g”r
==
UNZ_OK
è&& (
szComm’t
!=
NULL
))

616 
uLÚg
 
uSizeR—d
 ;

617 ià(
	gfe_šfo
.
	gsize_fe_comm’t
<
	gcomm’tBufãrSize
)

619 *(
	gszComm’t
+
	gfe_šfo
.
	gsize_fe_comm’t
)='\0';

620 
	guSizeR—d
 = 
fe_šfo
.
size_fe_comm’t
;

623 
	guSizeR—d
 = 
comm’tBufãrSize
;

625 ià(
	glS“k
!=0)

627 ià(
f£ek
(
s
->
fe
,
lS“k
,
SEEK_CUR
)==0)

628 
lS“k
=0;

630 
	g”r
=
UNZ_ERRNO
;

632 ià((
	gfe_šfo
.
	gsize_fe_comm’t
>0è&& (
	gcomm’tBufãrSize
>0))

633 ià(
ä—d
(
szComm’t
,(
uIÁ
)
uSizeR—d
,1,
s
->
fe
)!=1)

634 
”r
=
UNZ_ERRNO
;

635 
	glS“k
+=
fe_šfo
.
size_fe_comm’t
 - 
uSizeR—d
;

638 
	glS“k
+=
fe_šfo
.
size_fe_comm’t
;

640 ià((
	g”r
==
UNZ_OK
è&& (
pfe_šfo
!=
NULL
))

641 *
pfe_šfo
=
fe_šfo
;

643 ià((
	g”r
==
UNZ_OK
è&& (
pfe_šfo_š‹º®
!=
NULL
))

644 *
pfe_šfo_š‹º®
=
fe_šfo_š‹º®
;

646  
	g”r
;

656 
ZEXPORT
 
unzG‘Cu¼’tFeInfo


657 Ğ
unzFe
 
fe
,

658 
unz_fe_šfo
 *
pfe_šfo
,

659 *
szFeName
,

660 
uLÚg
 
feNameBufãrSize
,

661 *
exŒaF›ld
,

662 
uLÚg
 
exŒaF›ldBufãrSize
,

663 *
szComm’t
,

664 
uLÚg
 
comm’tBufãrSize


667  
unzloÿl_G‘Cu¼’tFeInfoIÁ”Çl
(
fe
,
pfe_šfo
,
NULL
,

668 
szFeName
,
feNameBufãrSize
,

669 
exŒaF›ld
,
exŒaF›ldBufãrSize
,

670 
szComm’t
,
comm’tBufãrSize
);

677 
ZEXPORT
 
	$unzGoToFœ¡Fe
 (
unzFe
 
fe
)

679 
”r
=
UNZ_OK
;

680 
unz_s
* 
s
;

681 ià(
fe
==
NULL
)

682  
UNZ_PARAMERROR
;

683 
s
=(
unz_s
*)
fe
;

684 
s
->
pos_š_ûÁ¿l_dœ
=s->
off£t_ûÁ¿l_dœ
;

685 
s
->
num_fe
=0;

686 
”r
=
	`unzloÿl_G‘Cu¼’tFeInfoIÁ”Çl
(
fe
,&
s
->
cur_fe_šfo
,

687 &
s
->
cur_fe_šfo_š‹º®
,

688 
NULL
,0,NULL,0,NULL,0);

689 
s
->
cu¼’t_fe_ok
 = (
”r
 =ğ
UNZ_OK
);

690  
”r
;

691 
	}
}

699 
ZEXPORT
 
	$unzGoToNextFe
 (
unzFe
 
fe
)

701 
unz_s
* 
s
;

702 
”r
;

704 ià(
fe
==
NULL
)

705  
UNZ_PARAMERROR
;

706 
s
=(
unz_s
*)
fe
;

707 ià(!
s
->
cu¼’t_fe_ok
)

708  
UNZ_END_OF_LIST_OF_FILE
;

709 ià(
s
->
num_fe
+1==s->
gi
.
numb”_’Œy
)

710  
UNZ_END_OF_LIST_OF_FILE
;

712 
s
->
pos_š_ûÁ¿l_dœ
 +ğ
SIZECENTRALDIRITEM
 + s->
cur_fe_šfo
.
size_f’ame
 +

713 
s
->
cur_fe_šfo
.
size_fe_exŒa
 + s->cur_fe_šfo.
size_fe_comm’t
 ;

714 
s
->
num_fe
++;

715 
”r
 = 
	`unzloÿl_G‘Cu¼’tFeInfoIÁ”Çl
(
fe
,&
s
->
cur_fe_šfo
,

716 &
s
->
cur_fe_šfo_š‹º®
,

717 
NULL
,0,NULL,0,NULL,0);

718 
s
->
cu¼’t_fe_ok
 = (
”r
 =ğ
UNZ_OK
);

719  
”r
;

720 
	}
}

731 
ZEXPORT
 
unzLoÿ‹Fe


732 Ğ
unzFe
 
fe
,

733 cÚ¡ *
szFeName
,

734 
iCa£S’s™iv™y


737 
unz_s
* 
s
;

738 
”r
;

741 
uLÚg
 
num_feSaved
;

742 
uLÚg
 
pos_š_ûÁ¿l_dœSaved
;

745 ià(
fe
==
NULL
)

746  
UNZ_PARAMERROR
;

748 ià(
¡¾’
(
szFeName
)>=
UNZ_MAXFILENAMEINZIP
)

749  
UNZ_PARAMERROR
;

751 
s
=(
unz_s
*)
fe
;

752 ià(!
s
->
cu¼’t_fe_ok
)

753  
UNZ_END_OF_LIST_OF_FILE
;

755 
num_feSaved
 = 
s
->
num_fe
;

756 
pos_š_ûÁ¿l_dœSaved
 = 
s
->
pos_š_ûÁ¿l_dœ
;

758 
”r
 = 
unzGoToFœ¡Fe
(
fe
);

760 
”r
 =ğ
UNZ_OK
)

762 
szCu¼’tFeName
[
UNZ_MAXFILENAMEINZIP
+1];

763 
unzG‘Cu¼’tFeInfo
(
fe
,
NULL
,

764 
szCu¼’tFeName
,(szCurrentFileName)-1,

765 
NULL
,0,NULL,0);

766 ià(
unzSŒšgFeNameCom·»
(
szCu¼’tFeName
,

767 
szFeName
,
iCa£S’s™iv™y
)==0)

768  
UNZ_OK
;

769 
”r
 = 
unzGoToNextFe
(
fe
);

772 
s
->
num_fe
 = 
num_feSaved
 ;

773 
s
->
pos_š_ûÁ¿l_dœ
 = 
pos_š_ûÁ¿l_dœSaved
 ;

774  
”r
;

785 
loÿl
 
unzloÿl_CheckCu¼’tFeCoh”’cyH—d”


786 Ğ
unz_s
* 
s
,

787 
uIÁ
* 
piSizeV¬
,

788 
uLÚg
 *
poff£t_loÿl_exŒaf›ld
,

789 
uIÁ
 *
psize_loÿl_exŒaf›ld


792 
uLÚg
 
uMagic
,
uD©a
,
uFÏgs
;

793 
uLÚg
 
size_f’ame
;

794 
uLÚg
 
size_exŒa_f›ld
;

795 
”r
=
UNZ_OK
;

797 *
piSizeV¬
 = 0;

798 *
poff£t_loÿl_exŒaf›ld
 = 0;

799 *
psize_loÿl_exŒaf›ld
 = 0;

801 ià(
f£ek
(
s
->
fe
,s->
cur_fe_šfo_š‹º®
.
off£t_curfe
 +

802 
s
->
by‹_befÜe_the_zfe
,
SEEK_SET
)!=0)

803  
UNZ_ERRNO
;

806 ià(
”r
==
UNZ_OK
)

808 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uMagic
è!ğ
UNZ_OK
)

809 
”r
=
UNZ_ERRNO
;

810 ià(
uMagic
!=0x04034b50)

811 
”r
=
UNZ_BADZIPFILE
;

814 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

815 
”r
=
UNZ_ERRNO
;

820 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
uFÏgs
è!ğ
UNZ_OK
)

821 
”r
=
UNZ_ERRNO
;

823 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

824 
”r
=
UNZ_ERRNO
;

825 ià((
”r
==
UNZ_OK
è&& (
uD©a
!=
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
))

826 
”r
=
UNZ_BADZIPFILE
;

828 ià((
”r
==
UNZ_OK
è&& (
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
!=0) &&

829 (
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
!=
Z_DEFLATED
))

830 
”r
=
UNZ_BADZIPFILE
;

832 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

833 
”r
=
UNZ_ERRNO
;

835 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

836 
”r
=
UNZ_ERRNO
;

837 ià((
”r
==
UNZ_OK
è&& (
uD©a
!=
s
->
cur_fe_šfo
.
üc
) &&

838 ((
uFÏgs
 & 8)==0))

839 
”r
=
UNZ_BADZIPFILE
;

841 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

842 
”r
=
UNZ_ERRNO
;

843 ià((
”r
==
UNZ_OK
è&& (
uD©a
!=
s
->
cur_fe_šfo
.
com´es£d_size
) &&

844 ((
uFÏgs
 & 8)==0))

845 
”r
=
UNZ_BADZIPFILE
;

847 ià(
unzloÿl_g‘LÚg
(
s
->
fe
,&
uD©a
è!ğ
UNZ_OK
)

848 
”r
=
UNZ_ERRNO
;

849 ià((
”r
==
UNZ_OK
è&& (
uD©a
!=
s
->
cur_fe_šfo
.
uncom´es£d_size
) &&

850 ((
uFÏgs
 & 8)==0))

851 
”r
=
UNZ_BADZIPFILE
;

854 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
size_f’ame
è!ğ
UNZ_OK
)

855 
”r
=
UNZ_ERRNO
;

856 ià((
”r
==
UNZ_OK
è&& (
size_f’ame
!=
s
->
cur_fe_šfo
.size_filename))

857 
”r
=
UNZ_BADZIPFILE
;

859 *
piSizeV¬
 +ğ(
uIÁ
)
size_f’ame
;

861 ià(
unzloÿl_g‘ShÜt
(
s
->
fe
,&
size_exŒa_f›ld
è!ğ
UNZ_OK
)

862 
”r
=
UNZ_ERRNO
;

863 *
poff£t_loÿl_exŒaf›ld
ğ
s
->
cur_fe_šfo_š‹º®
.
off£t_curfe
 +

864 
SIZEZIPLOCALHEADER
 + 
size_f’ame
;

865 *
psize_loÿl_exŒaf›ld
 = (
uIÁ
)
size_exŒa_f›ld
;

867 *
piSizeV¬
 +ğ(
uIÁ
)
size_exŒa_f›ld
;

869  
”r
;

876 
ZEXPORT
 
	$unzO³nCu¼’tFe
 (
unzFe
 
fe
)

878 
”r
=
UNZ_OK
;

879 
StÜe
;

880 
uIÁ
 
iSizeV¬
;

881 
unz_s
* 
s
;

882 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

883 
uLÚg
 
off£t_loÿl_exŒaf›ld
;

884 
uIÁ
 
size_loÿl_exŒaf›ld
;

886 ià(
fe
==
NULL
)

887  
UNZ_PARAMERROR
;

888 
s
=(
unz_s
*)
fe
;

889 ià(!
s
->
cu¼’t_fe_ok
)

890  
UNZ_PARAMERROR
;

892 ià(
s
->
pfe_š_z_»ad
 !ğ
NULL
)

893 
	`unzClo£Cu¼’tFe
(
fe
);

895 ià(
	`unzloÿl_CheckCu¼’tFeCoh”’cyH—d”
(
s
,&
iSizeV¬
,

896 &
off£t_loÿl_exŒaf›ld
,&
size_loÿl_exŒaf›ld
)!=
UNZ_OK
)

897  
UNZ_BADZIPFILE
;

899 
pfe_š_z_»ad_šfo
 = (
fe_š_z_»ad_šfo_s
*)

900 
	`ALLOC
((
fe_š_z_»ad_šfo_s
));

901 ià(
pfe_š_z_»ad_šfo
==
NULL
)

902  
UNZ_INTERNALERROR
;

904 
pfe_š_z_»ad_šfo
->
»ad_bufãr
=(*)
	`ALLOC
(
UNZ_BUFSIZE
);

905 
pfe_š_z_»ad_šfo
->
off£t_loÿl_exŒaf›ld
 = offset_local_extrafield;

906 
pfe_š_z_»ad_šfo
->
size_loÿl_exŒaf›ld
 = size_local_extrafield;

907 
pfe_š_z_»ad_šfo
->
pos_loÿl_exŒaf›ld
=0;

909 ià(
pfe_š_z_»ad_šfo
->
»ad_bufãr
==
NULL
)

911 
	`TRYFREE
(
pfe_š_z_»ad_šfo
);

912  
UNZ_INTERNALERROR
;

915 
pfe_š_z_»ad_šfo
->
¡»am_š™Ÿli£d
=0;

917 ià((
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
!=0) &&

918 (
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
!=
Z_DEFLATED
))

919 
”r
=
UNZ_BADZIPFILE
;

920 
StÜe
 = 
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
==0;

922 
pfe_š_z_»ad_šfo
->
üc32_wa™
=
s
->
cur_fe_šfo
.
üc
;

923 
pfe_š_z_»ad_šfo
->
üc32
=0;

924 
pfe_š_z_»ad_šfo
->
com´essiÚ_m‘hod
 =

925 
s
->
cur_fe_šfo
.
com´essiÚ_m‘hod
;

926 
pfe_š_z_»ad_šfo
->
fe
=
s
->file;

927 
pfe_š_z_»ad_šfo
->
by‹_befÜe_the_zfe
=
s
->byte_before_the_zipfile;

929 
pfe_š_z_»ad_šfo
->
¡»am
.
tÙ®_out
 = 0;

931 ià(!
StÜe
)

933 
pfe_š_z_»ad_šfo
->
¡»am
.
z®loc
 = (
®loc_func
)0;

934 
pfe_š_z_»ad_šfo
->
¡»am
.
zä“
 = (
ä“_func
)0;

935 
pfe_š_z_»ad_šfo
->
¡»am
.
İaque
 = (
voidpf
)0;

937 
”r
=
	`šæ©eIn™2
(&
pfe_š_z_»ad_šfo
->
¡»am
, -
MAX_WBITS
);

938 ià(
”r
 =ğ
Z_OK
)

939 
pfe_š_z_»ad_šfo
->
¡»am_š™Ÿli£d
=1;

948 
pfe_š_z_»ad_šfo
->
»¡_»ad_com´es£d
 =

949 
s
->
cur_fe_šfo
.
com´es£d_size
 ;

950 
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
 =

951 
s
->
cur_fe_šfo
.
uncom´es£d_size
 ;

954 
pfe_š_z_»ad_šfo
->
pos_š_zfe
 =

955 
s
->
cur_fe_šfo_š‹º®
.
off£t_curfe
 + 
SIZEZIPLOCALHEADER
 +

956 
iSizeV¬
;

958 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
 = (
uIÁ
)0;

961 
s
->
pfe_š_z_»ad
 = 
pfe_š_z_»ad_šfo
;

962  
UNZ_OK
;

963 
	}
}

976 
ZEXPORT
 
unzR—dCu¼’tFe


977 Ğ
unzFe
 
fe
,

978 
voidp
 
buf
,

979 
Ën


982 
”r
=
UNZ_OK
;

983 
uIÁ
 
iR—d
 = 0;

984 
unz_s
* 
s
;

985 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

986 ià(
fe
==
NULL
)

987  
UNZ_PARAMERROR
;

988 
s
=(
unz_s
*)
fe
;

989 
pfe_š_z_»ad_šfo
=
s
->
pfe_š_z_»ad
;

991 ià(
pfe_š_z_»ad_šfo
==
NULL
)

992  
UNZ_PARAMERROR
;

995 ià((
pfe_š_z_»ad_šfo
->
»ad_bufãr
 =ğ
NULL
))

996  
UNZ_END_OF_LIST_OF_FILE
;

997 ià(
Ën
==0)

1000 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_out
 = (
By‹f
*)
buf
;

1002 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
 = (
uIÁ
)
Ën
;

1004 ià(
Ën
>
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
)

1005 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
 =

1006 (
uIÁ
)
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
;

1008 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
>0)

1010 ià((
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
==0) &&

1011 (
pfe_š_z_»ad_šfo
->
»¡_»ad_com´es£d
>0))

1013 
uIÁ
 
uR—dThis
 = 
UNZ_BUFSIZE
;

1014 ià(
pfe_š_z_»ad_šfo
->
»¡_»ad_com´es£d
<
uR—dThis
)

1015 
uR—dThis
 = (
uIÁ
)
pfe_š_z_»ad_šfo
->
»¡_»ad_com´es£d
;

1016 ià(
uR—dThis
 == 0)

1017  
UNZ_EOF
;

1018 ià(
f£ek
(
pfe_š_z_»ad_šfo
->
fe
,

1019 
pfe_š_z_»ad_šfo
->
pos_š_zfe
 +

1020 
pfe_š_z_»ad_šfo
->
by‹_befÜe_the_zfe
,
SEEK_SET
)!=0)

1021  
UNZ_ERRNO
;

1022 ià(
ä—d
(
pfe_š_z_»ad_šfo
->
»ad_bufãr
,
uR—dThis
,1,

1023 
pfe_š_z_»ad_šfo
->
fe
)!=1)

1024  
UNZ_ERRNO
;

1025 
pfe_š_z_»ad_šfo
->
pos_š_zfe
 +ğ
uR—dThis
;

1027 
pfe_š_z_»ad_šfo
->
»¡_»ad_com´es£d
-=
uR—dThis
;

1029 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_š
 =

1030 (
By‹f
*)
pfe_š_z_»ad_šfo
->
»ad_bufãr
;

1031 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
 = (
uIÁ
)
uR—dThis
;

1034 ià(
pfe_š_z_»ad_šfo
->
com´essiÚ_m‘hod
==0)

1036 
uIÁ
 
uDoCİy
,
i
 ;

1037 ià(
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
 <

1038 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
)

1039 
uDoCİy
 = 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
 ;

1041 
uDoCİy
 = 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
 ;

1043 
i
=0;i<
uDoCİy
;i++)

1044 *(
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_out
+
i
) =

1045 *(
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_š
+
i
);

1047 
pfe_š_z_»ad_šfo
->
üc32
 = crc32(pfile_in_zip_read_info->crc32,

1048 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_out
,

1049 
uDoCİy
);

1050 
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
-=
uDoCİy
;

1051 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_š
 -ğ
uDoCİy
;

1052 
pfe_š_z_»ad_šfo
->
¡»am
.
ava_out
 -ğ
uDoCİy
;

1053 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_out
 +ğ
uDoCİy
;

1054 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_š
 +ğ
uDoCİy
;

1055 
pfe_š_z_»ad_šfo
->
¡»am
.
tÙ®_out
 +ğ
uDoCİy
;

1056 
iR—d
 +ğ
uDoCİy
;

1060 
uLÚg
 
uTÙ®OutBefÜe
,
uTÙ®OutAá”
;

1061 cÚ¡ 
By‹f
 *
bufBefÜe
;

1062 
uLÚg
 
uOutThis
;

1063 
æush
=
Z_SYNC_FLUSH
;

1065 
uTÙ®OutBefÜe
 = 
pfe_š_z_»ad_šfo
->
¡»am
.
tÙ®_out
;

1066 
bufBefÜe
 = 
pfe_š_z_»ad_šfo
->
¡»am
.
Ãxt_out
;

1074 
”r
=
šæ©e
(&
pfe_š_z_»ad_šfo
->
¡»am
,
æush
);

1076 
uTÙ®OutAá”
 = 
pfe_š_z_»ad_šfo
->
¡»am
.
tÙ®_out
;

1077 
uOutThis
 = 
uTÙ®OutAá”
-
uTÙ®OutBefÜe
;

1079 
pfe_š_z_»ad_šfo
->
üc32
 =

1080 
üc32
(
pfe_š_z_»ad_šfo
->üc32,
bufBefÜe
,

1081 (
uIÁ
)(
uOutThis
));

1083 
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
 -=

1084 
uOutThis
;

1086 
iR—d
 +ğ(
uIÁ
)(
uTÙ®OutAá”
 - 
uTÙ®OutBefÜe
);

1088 ià(
”r
==
Z_STREAM_END
)

1089  (
iR—d
==0è? 
UNZ_EOF
 : iRead;

1090 ià(
”r
!=
Z_OK
)

1095 ià(
”r
==
Z_OK
)

1096  
iR—d
;

1097  
”r
;

1104 
z_off_t
 
ZEXPORT
 
	$unz‹Î
 (
unzFe
 
fe
)

1106 
unz_s
* 
s
;

1107 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

1108 ià(
fe
==
NULL
)

1109  
UNZ_PARAMERROR
;

1110 
s
=(
unz_s
*)
fe
;

1111 
pfe_š_z_»ad_šfo
=
s
->
pfe_š_z_»ad
;

1113 ià(
pfe_š_z_»ad_šfo
==
NULL
)

1114  
UNZ_PARAMERROR
;

1116  (
z_off_t
)
pfe_š_z_»ad_šfo
->
¡»am
.
tÙ®_out
;

1117 
	}
}

1123 
ZEXPORT
 
	$unzeof
 (
unzFe
 
fe
)

1125 
unz_s
* 
s
;

1126 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

1127 ià(
fe
==
NULL
)

1128  
UNZ_PARAMERROR
;

1129 
s
=(
unz_s
*)
fe
;

1130 
pfe_š_z_»ad_šfo
=
s
->
pfe_š_z_»ad
;

1132 ià(
pfe_š_z_»ad_šfo
==
NULL
)

1133  
UNZ_PARAMERROR
;

1135 ià(
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
 == 0)

1139 
	}
}

1155 
ZEXPORT
 
unzG‘LoÿlExŒaf›ld


1156 Ğ
unzFe
 
fe
,

1157 
voidp
 
buf
,

1158 
Ën


1161 
unz_s
* 
s
;

1162 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

1163 
uIÁ
 
»ad_now
;

1164 
uLÚg
 
size_to_»ad
;

1166 ià(
fe
==
NULL
)

1167  
UNZ_PARAMERROR
;

1168 
s
=(
unz_s
*)
fe
;

1169 
pfe_š_z_»ad_šfo
=
s
->
pfe_š_z_»ad
;

1171 ià(
pfe_š_z_»ad_šfo
==
NULL
)

1172  
UNZ_PARAMERROR
;

1174 
size_to_»ad
 = (
pfe_š_z_»ad_šfo
->
size_loÿl_exŒaf›ld
 -

1175 
pfe_š_z_»ad_šfo
->
pos_loÿl_exŒaf›ld
);

1177 ià(
buf
==
NULL
)

1178  ()
size_to_»ad
;

1180 ià(
Ën
>
size_to_»ad
)

1181 
»ad_now
 = (
uIÁ
)
size_to_»ad
;

1183 
»ad_now
 = (
uIÁ
)
Ën
 ;

1185 ià(
»ad_now
==0)

1188 ià(
f£ek
(
pfe_š_z_»ad_šfo
->
fe
,

1189 
pfe_š_z_»ad_šfo
->
off£t_loÿl_exŒaf›ld
 +

1190 
pfe_š_z_»ad_šfo
->
pos_loÿl_exŒaf›ld
,
SEEK_SET
)!=0)

1191  
UNZ_ERRNO
;

1193 ià(
ä—d
(
buf
,(
uIÁ
)
size_to_»ad
,1,
pfe_š_z_»ad_šfo
->
fe
)!=1)

1194  
UNZ_ERRNO
;

1196  ()
»ad_now
;

1203 
ZEXPORT
 
	$unzClo£Cu¼’tFe
 (
unzFe
 
fe
)

1205 
”r
=
UNZ_OK
;

1207 
unz_s
* 
s
;

1208 
fe_š_z_»ad_šfo_s
* 
pfe_š_z_»ad_šfo
;

1209 ià(
fe
==
NULL
)

1210  
UNZ_PARAMERROR
;

1211 
s
=(
unz_s
*)
fe
;

1212 
pfe_š_z_»ad_šfo
=
s
->
pfe_š_z_»ad
;

1214 ià(
pfe_š_z_»ad_šfo
==
NULL
)

1215  
UNZ_PARAMERROR
;

1218 ià(
pfe_š_z_»ad_šfo
->
»¡_»ad_uncom´es£d
 == 0)

1220 ià(
pfe_š_z_»ad_šfo
->
üc32
 !ğpfe_š_z_»ad_šfo->
üc32_wa™
)

1221 
”r
=
UNZ_CRCERROR
;

1225 
	`TRYFREE
(
pfe_š_z_»ad_šfo
->
»ad_bufãr
);

1226 
pfe_š_z_»ad_šfo
->
»ad_bufãr
 = 
NULL
;

1227 ià(
pfe_š_z_»ad_šfo
->
¡»am_š™Ÿli£d
)

1228 
	`šæ©eEnd
(&
pfe_š_z_»ad_šfo
->
¡»am
);

1230 
pfe_š_z_»ad_šfo
->
¡»am_š™Ÿli£d
 = 0;

1231 
	`TRYFREE
(
pfe_š_z_»ad_šfo
);

1233 
s
->
pfe_š_z_»ad
=
NULL
;

1235  
”r
;

1236 
	}
}

1244 
ZEXPORT
 
unzG‘Glob®Comm’t


1245 Ğ
unzFe
 
fe
,

1246 *
szComm’t
,

1247 
uLÚg
 
uSizeBuf


1250 
unz_s
* 
s
;

1251 
uLÚg
 
uR—dThis
 ;

1252 ià(
fe
==
NULL
)

1253  
UNZ_PARAMERROR
;

1254 
s
=(
unz_s
*)
fe
;

1256 
uR—dThis
 = 
uSizeBuf
;

1257 ià(
uR—dThis
>
s
->
gi
.
size_comm’t
)

1258 
uR—dThis
 = 
s
->
gi
.
size_comm’t
;

1260 ià(
f£ek
(
s
->
fe
,s->
ûÁ¿l_pos
+22,
SEEK_SET
)!=0)

1261  
UNZ_ERRNO
;

1263 ià(
uR—dThis
>0)

1265 *
szComm’t
='\0';

1266 ià(
ä—d
(
szComm’t
,(
uIÁ
)
uR—dThis
,1,
s
->
fe
)!=1)

1267  
UNZ_ERRNO
;

1270 ià((
szComm’t
 !ğ
NULL
è&& (
uSizeBuf
 > 
s
->
gi
.
size_comm’t
))

1271 *(
szComm’t
+
s
->
gi
.
size_comm’t
)='\0';

1272  ()
uR—dThis
;

	@emucore/unzip.h

41 #iâdeà
_unz_H


42 
	#_unz_H


	)

44 #ifdeà
__ılu¥lus


48 #iâdeà
_ZLIB_H


49 
	~<zlib.h
>

52 #ià
defšed
(
STRICTUNZIP
è|| defšed(
STRICTZIPUNZIP
)

55 
	sTagunzFe__
 { 
unu£d
; } 
	tunzFe__
;

56 
unzFe__
 *
	tunzFe
;

58 
voidp
 
	tunzFe
;

62 
	#UNZ_OK
 (0)

	)

63 
	#UNZ_END_OF_LIST_OF_FILE
 (-100)

	)

64 
	#UNZ_ERRNO
 (
Z_ERRNO
)

	)

65 
	#UNZ_EOF
 (0)

	)

66 
	#UNZ_PARAMERROR
 (-102)

	)

67 
	#UNZ_BADZIPFILE
 (-103)

	)

68 
	#UNZ_INTERNALERROR
 (-104)

	)

69 
	#UNZ_CRCERROR
 (-105)

	)

72 
	stm_unz_s


74 
uIÁ
 
	gtm_£c
;

75 
uIÁ
 
	gtm_mš
;

76 
uIÁ
 
	gtm_hour
;

77 
uIÁ
 
	gtm_mday
;

78 
uIÁ
 
	gtm_mÚ
;

79 
uIÁ
 
	gtm_y—r
;

80 } 
	ttm_unz
;

84 
	sunz_glob®_šfo_s


86 
uLÚg
 
	gnumb”_’Œy
;

88 
uLÚg
 
	gsize_comm’t
;

89 } 
	tunz_glob®_šfo
;

93 
	sunz_fe_šfo_s


95 
uLÚg
 
	gv”siÚ
;

96 
uLÚg
 
	gv”siÚ_Ãeded
;

97 
uLÚg
 
	gæag
;

98 
uLÚg
 
	gcom´essiÚ_m‘hod
;

99 
uLÚg
 
	gdosD©e
;

100 
uLÚg
 
	güc
;

101 
uLÚg
 
	gcom´es£d_size
;

102 
uLÚg
 
	guncom´es£d_size
;

103 
uLÚg
 
	gsize_f’ame
;

104 
uLÚg
 
	gsize_fe_exŒa
;

105 
uLÚg
 
	gsize_fe_comm’t
;

107 
uLÚg
 
	gdisk_num_¡¬t
;

108 
uLÚg
 
	gš‹º®_ç
;

109 
uLÚg
 
	gex‹º®_ç
;

111 
tm_unz
 
	gtmu_d©e
;

112 } 
	tunz_fe_šfo
;

114 
ZEXPORT
 
unzSŒšgFeNameCom·»
 
OF
 ((cÚ¡ * 
feName1
,

115 cÚ¡ * 
feName2
,

116 
iCa£S’s™iv™y
));

127 
unzFe
 
ZEXPORT
 
unzO³n
 
OF
((cÚ¡ *
·th
));

138 
ZEXPORT
 
unzClo£
 
OF
((
unzFe
 
fe
));

145 
ZEXPORT
 
unzG‘Glob®Info
 
OF
((
unzFe
 
fe
,

146 
unz_glob®_šfo
 *
pglob®_šfo
));

153 
ZEXPORT
 
unzG‘Glob®Comm’t
 
OF
((
unzFe
 
fe
,

154 *
szComm’t
,

155 
uLÚg
 
uSizeBuf
));

166 
ZEXPORT
 
unzGoToFœ¡Fe
 
OF
((
unzFe
 
fe
));

172 
ZEXPORT
 
unzGoToNextFe
 
OF
((
unzFe
 
fe
));

179 
ZEXPORT
 
unzLoÿ‹Fe
 
OF
((
unzFe
 
fe
,

180 cÚ¡ *
szFeName
,

181 
iCa£S’s™iv™y
));

192 
ZEXPORT
 
unzG‘Cu¼’tFeInfo
 
OF
((
unzFe
 
fe
,

193 
unz_fe_šfo
 *
pfe_šfo
,

194 *
szFeName
,

195 
uLÚg
 
feNameBufãrSize
,

196 *
exŒaF›ld
,

197 
uLÚg
 
exŒaF›ldBufãrSize
,

198 *
szComm’t
,

199 
uLÚg
 
comm’tBufãrSize
));

218 
ZEXPORT
 
unzO³nCu¼’tFe
 
OF
((
unzFe
 
fe
));

224 
ZEXPORT
 
unzClo£Cu¼’tFe
 
OF
((
unzFe
 
fe
));

231 
ZEXPORT
 
unzR—dCu¼’tFe
 
OF
((
unzFe
 
fe
,

232 
voidp
 
buf
,

233 
Ën
));

245 
z_off_t
 
ZEXPORT
 
unz‹Î
 
OF
((
unzFe
 
fe
));

250 
ZEXPORT
 
unzeof
 
OF
((
unzFe
 
fe
));

255 
ZEXPORT
 
unzG‘LoÿlExŒaf›ld
 
OF
((
unzFe
 
fe
,

256 
voidp
 
buf
,

257 
Ën
));

271 #ifdeà
__ılu¥lus


	@main.cpp

7 
	~<c¡dlib
>

8 
	~<ùime
>

9 
	~"b¥f.hxx
"

10 
	~"CÚsŞe.hxx
"

11 
	~"Ev’t.hxx
"

12 
	~"PrİsS‘.hxx
"

13 
	~"S‘tšgs.hxx
"

14 
	~"FSNode.hxx
"

15 
	~"OSy¡em.hxx
"

16 
	~"S‘tšgsUNIX.hxx
"

17 
	~"OSy¡emUNIX.hxx
"

18 
	~"fifo_cÚŒŞËr.h
"

19 
	~"š‹º®_cÚŒŞËr.h
"

20 
	~"commÚ_cÚ¡ªts.h
"

22 
¡ršg
 
	g¡r_v”
 = "0.1";

23 
¡ršg
 
	g¡r_w–come
 = "A.L.E: Ar˜2600 L—ºšg EnvœÚm’ˆ(v”siÚ " + 
¡r_v”
 + ")\n"

26 
OSy¡em
* 
	gtheOSy¡em
 = (OSy¡em*è
NULL
;

27 
GameCÚŒŞËr
* 
	gp_game_cÚŒŞÌ
 = 
NULL
;

29 
	$CËªup
() {

31 if(
theOSy¡em
) {

32 
d–‘e
 
theOSy¡em
;

35 if(
p_game_cÚŒŞÌ
) {

36 
d–‘e
 
p_game_cÚŒŞÌ
;

38 
	}
}

41 
	$maš
(
¬gc
, * 
¬gv
[]) {

42 
cout
 << 
¡r_w–come
 << 
’dl
;

43 
theOSy¡em
 = 
Ãw
 
	`OSy¡emUNIX
();

44 
S‘tšgsUNIX
 
	`£‰šgs
(
theOSy¡em
);

45 
theOSy¡em
->
	`£‰šgs
().
	`lßdCÚfig
();

48 
¡ršg
 
¾_·¿ms_loc
 = 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("working_dir") +

49 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("rl_params_file");

50 
theOSy¡em
->
	`£‰šgs
().
	`lßdCÚfig
(
¾_·¿ms_loc
.
	`c_¡r
());

53 
¡ršg
 
ş_dis_·¿ms_loc
 = 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("working_dir") +

54 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("class_disc_params_file");

55 
theOSy¡em
->
	`£‰šgs
().
	`lßdCÚfig
(
ş_dis_·¿ms_loc
.
	`c_¡r
());

58 
¡ršg
 
£¬ch_·¿ms_loc
 = 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("working_dir") +

60 
theOSy¡em
->
	`£‰šgs
().
	`lßdCÚfig
(
£¬ch_·¿ms_loc
.
	`c_¡r
());

63 
¡ršg
 
exp_·¿ms_loc
 = 
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("working_dir") +

65 
theOSy¡em
->
	`£‰šgs
().
	`lßdCÚfig
(
exp_·¿ms_loc
.
	`c_¡r
());

68 
¡ršg
 
romfe
 = 
theOSy¡em
->
	`£‰šgs
().
	`lßdCommªdLše
(
¬gc
, 
¬gv
);

72 
theOSy¡em
->
	`£‰šgs
().
	`v®id©e
();

77 
theOSy¡em
->
	`ü—‹
();

84 if(
¬gc
 =ğ1 || 
romfe
 =ğ"" || !
Fesy¡emNode
::
	`feExi¡s
(romfile)) {

85 
	`´štf
("No ROM File specified orhe ROM file was‚ot found.\n");

87 } if(
theOSy¡em
->
	`ü—‹CÚsŞe
(
romfe
)) {

88 
	`´štf
("Running ROM file...\n");

89 
theOSy¡em
->
	`£‰šgs
().
	`£tSŒšg
("rom_fe", 
romfe
);

91 
	`CËªup
();

96 ià(
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("random_seed") == "time") {

97 
cout
 << "Rªdom S“d: Time" << 
’dl
;

98 
	`¤ªd
(()
	`time
(0));

99 
	`¤ªd48
(()
	`time
(0));

101 
£ed
 = 
theOSy¡em
->
	`£‰šgs
().
	`g‘IÁ
("random_seed");

102 
	`as£¹
(
£ed
 >= 0);

103 
cout
 << "Rªdom S“d: " << 
£ed
 << 
’dl
;

104 
	`¤ªd
(()
£ed
);

105 
	`¤ªd48
(()
£ed
);

109 ià(
theOSy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("game_controller") == "fifo") {

110 
p_game_cÚŒŞÌ
 = 
Ãw
 
	`FIFOCÚŒŞËr
(
theOSy¡em
);

111 
theOSy¡em
->
	`£tGameCÚŒŞËr
(
p_game_cÚŒŞÌ
);

112 
cout
 << "Game wÈbcÚŒŞËdrhough FIFO…es." << 
’dl
;

114 
p_game_cÚŒŞÌ
 = 
Ãw
 
	`IÁ”ÇlCÚŒŞËr
(
theOSy¡em
);

115 
theOSy¡em
->
	`£tGameCÚŒŞËr
(
p_game_cÚŒŞÌ
);

116 
cout
 << "Games will be controlled internally, " <<

117 "throughhassigÃd…Ïy” Ag’t" << 
’dl
;

120 
theOSy¡em
->
	`cÚsŞe
().
	`£tP®‘‹
("standard");

126 
theOSy¡em
->
	`mašLoİ
();

129 
	`CËªup
();

131 
	}
}

	@os_dependent/FSNodePOSIX.cxx

22 
	~"FSNode.hxx
"

24 #ifdeà
MACOSX


25 
	~<sys/ty³s.h
>

28 
	~<sys/·¿m.h
>

29 
	~<sys/¡©.h
>

30 
	~<dœ’t.h
>

32 
	~<¡dio.h
>

33 
	~<uni¡d.h
>

35 
	~<s¡»am
>

41 şas 
	cPOSIXFesy¡emNode
 : 
public
 
Ab¡¿ùFesy¡emNode


43 
public
:

44 
POSIXFesy¡emNode
();

45 
POSIXFesy¡emNode
(cÚ¡ 
¡ršg
& 
·th
);

46 
POSIXFesy¡emNode
(cÚ¡ POSIXFesy¡emNode* 
node
);

48 
vœtu®
 
¡ršg
 
	$di¥ÏyName
(ècÚ¡ {  
_di¥ÏyName
; }

49 
vœtu®
 
boŞ
 
	$isV®id
(ècÚ¡ {  
_isV®id
; 
	}
}

50 
vœtu®
 
boŞ
 
	$isDœeùÜy
(ècÚ¡ {  
_isDœeùÜy
; 
	}
}

51 
vœtu®
 
¡ršg
 
	$·th
(ècÚ¡ {  
_·th
; 
	}
}

53 
vœtu®
 
FSLi¡
 
	$li¡Dœ
(
Li¡Mode
 
mode
 = 
kLi¡DœeùÜ›sOÆy
) const;

54 
vœtu®
 
Ab¡¿ùFesy¡emNode
* 
	$·»Á
() const;

56 
´Ùeùed
:

57 
¡ršg
 
_di¥ÏyName
;

58 
boŞ
 
_isDœeùÜy
;

59 
boŞ
 
_isV®id
;

60 
¡ršg
 
_·th
;

61 
	}
};

64 cÚ¡ * 
	$Ï¡P©hCompÚ’t
(cÚ¡ 
¡ršg
& 
¡r
)

66 cÚ¡ *
¡¬t
 = 
¡r
.
	`c_¡r
();

67 cÚ¡ *
cur
 = 
¡¬t
 + 
¡r
.
	`size
() - 2;

69 
cur
 > 
¡¬t
 && *cur != '/')

70 --
cur
;

72  
cur
+1;

73 
	}
}

76 
¡ršg
 
	$v®id©eP©h
(cÚ¡ 
¡ršg
& 
p
)

78 
¡ršg
 
·th
 = 
p
;

79 if(
p
.
	`size
() <= 0 ||…[0] != '/')

80 
·th
 = "/";

82  
·th
;

83 
	}
}

86 
Ab¡¿ùFesy¡emNode
* 
	gFesy¡emNode
::
	$g‘RoÙ
()

88  
Ãw
 
	`POSIXFesy¡emNode
();

89 
	}
}

92 
Ab¡¿ùFesy¡emNode
* 
	gFesy¡emNode
::
	$g‘NodeFÜP©h
(cÚ¡ 
¡ršg
& 
·th
)

94  
Ãw
 
	`POSIXFesy¡emNode
(
	`v®id©eP©h
(
·th
));

95 
	}
}

98 
	gPOSIXFesy¡emNode
::
	$POSIXFesy¡emNode
()

100 
buf
[
MAXPATHLEN
];

101 
	`g‘cwd
(
buf
, 
MAXPATHLEN
);

103 
_·th
 = 
buf
;

104 
_di¥ÏyName
 = 
	`Ï¡P©hCompÚ’t
(
_·th
);

105 
_·th
 += '/';

106 
_isV®id
 = 
Œue
;

107 
_isDœeùÜy
 = 
Œue
;

108 
	}
}

111 
	gPOSIXFesy¡emNode
::
	$POSIXFesy¡emNode
(cÚ¡ 
¡ršg
& 
p
)

113 
¡ršg
 
·th
 = 
	`v®id©eP©h
(
p
);

115 
IÁ32
 
Ën
 = 0, 
off£t
 = 
·th
.
	`size
();

116 
¡©
 
¡
;

118 
_·th
 = 
·th
;

121 cÚ¡ *
¡r
 = 
·th
.
	`c_¡r
();

122 
off£t
 > 0 && 
¡r
[offset-1] == '/')

123 
off£t
--;

124 
off£t
 > 0 && 
¡r
[offset-1] != '/')

126 
Ën
++;

127 
off£t
--;

129 
_di¥ÏyName
 = 
	`¡ršg
(
¡r
 + 
off£t
, 
Ën
);

132 
_isV®id
 = (0 =ğ
	`¡©
(
_·th
.
	`c_¡r
(), &
¡
));

133 
_isDœeùÜy
 = 
	`S_ISDIR
(
¡
.
¡_mode
);

134 
	}
}

137 
	gPOSIXFesy¡emNode
::
	$POSIXFesy¡emNode
(cÚ¡ 
POSIXFesy¡emNode
* 
node
)

139 
_di¥ÏyName
 = 
node
->_displayName;

140 
_isV®id
 = 
node
->_isValid;

141 
_isDœeùÜy
 = 
node
->_isDirectory;

142 
_·th
 = 
node
->_path;

143 
	}
}

146 
FSLi¡
 
	gPOSIXFesy¡emNode
::
	$li¡Dœ
(
Li¡Mode
 
mode
) const

148 
DIR
 *
dœp
 = 
	`İ’dœ
(
_·th
.
	`c_¡r
());

149 
¡©
 
¡
;

151 
dœ’t
 *
dp
;

152 
FSLi¡
 
myLi¡
;

154 ià(
dœp
 =ğ
NULL
)

155  
myLi¡
;

158 (
dp
 = 
	`»addœ
(
dœp
)è!ğ
NULL
)

161 ià(
dp
->
d_Çme
[0] == '.')

164 
POSIXFesy¡emNode
 
’Œy
;

165 
’Œy
.
_di¥ÏyName
 = 
dp
->
d_Çme
;

166 
’Œy
.
_·th
 = _path;

167 ià(
’Œy
.
_·th
.
	`Ëngth
() > 0 &&ƒntry._path[entry._path.length()-1] != '/')

168 
’Œy
.
_·th
 += '/';

169 
’Œy
.
_·th
 +ğ
dp
->
d_Çme
;

171 ià(
	`¡©
(
’Œy
.
_·th
.
	`c_¡r
(), &
¡
))

173 
’Œy
.
_isDœeùÜy
 = 
	`S_ISDIR
(
¡
.
¡_mode
);

176 ià((
mode
 =ğ
kLi¡FesOÆy
 && 
’Œy
.
_isDœeùÜy
) ||

177 (
mode
 =ğ
kLi¡DœeùÜ›sOÆy
 && !
’Œy
.
_isDœeùÜy
))

180 ià(
’Œy
.
_isDœeùÜy
)

181 
’Œy
.
_·th
 += "/";

183 
myLi¡
.
	`push_back
(
	`w¿p
(
Ãw
 
	`POSIXFesy¡emNode
(&
’Œy
)));

185 
	`şo£dœ
(
dœp
);

187  
myLi¡
;

188 
	}
}

191 
Ab¡¿ùFesy¡emNode
 *
	gPOSIXFesy¡emNode
::
	$·»Á
() const

193 ià(
_·th
 == "/")

196 
POSIXFesy¡emNode
* 
p
 = 
Ãw
 
	`POSIXFesy¡emNode
();

197 cÚ¡ *
¡¬t
 = 
_·th
.
	`c_¡r
();

198 cÚ¡ *
’d
 = 
	`Ï¡P©hCompÚ’t
(
_·th
);

200 
p
->
_·th
 = 
	`¡ršg
(
¡¬t
, 
’d
 - start);

201 
p
->
_di¥ÏyName
 = 
	`Ï¡P©hCompÚ’t
Õ->
_·th
);

203 
p
->
_isV®id
 = 
Œue
;

204 
p
->
_isDœeùÜy
 = 
Œue
;

206  
p
;

207 
	}
}

210 
boŞ
 
	gAb¡¿ùFesy¡emNode
::
	$feExi¡s
(cÚ¡ 
¡ršg
& 
·th
)

212 
¡©
 
¡
;

213 if(
	`¡©
(
·th
.
	`c_¡r
(), &
¡
) != 0)

214  
çl£
;

216  
	`S_ISREG
(
¡
.
¡_mode
);

217 
	}
}

220 
boŞ
 
	gAb¡¿ùFesy¡emNode
::
	$dœExi¡s
(cÚ¡ 
¡ršg
& 
·th
)

222 
¡©
 
¡
;

223 if(
	`¡©
(
·th
.
	`c_¡r
(), &
¡
) != 0)

224  
çl£
;

226  
	`S_ISDIR
(
¡
.
¡_mode
);

227 
	}
}

230 
boŞ
 
	gAb¡¿ùFesy¡emNode
::
	$makeDœ
(cÚ¡ 
¡ršg
& 
·th
)

232  
	`mkdœ
(
·th
.
	`c_¡r
(), 0777) == 0;

233 
	}
}

	@os_dependent/OSystemUNIX.cxx

19 
	~<c¡dlib
>

20 
	~<s¡»am
>

21 
	~<f¡»am
>

23 
	~<uni¡d.h
>

24 
	~<sys/¡©.h
>

25 
	~<sys/ty³s.h
>

27 
	~"b¥f.hxx
"

28 
	~"OSy¡em.hxx
"

29 
	~"OSy¡emUNIX.hxx
"

32 
	~<time.h
>

33 
	~<sys/time.h
>

47 
	gOSy¡emUNIX
::
	$OSy¡emUNIX
()

48 : 
	$OSy¡em
()

51 
¡ršg
 
ba£dœ
 = 
	`¡ršg
(".");

52 
	`£tBa£Dœ
(
ba£dœ
);

53 
	`£tCÚfigFe
(
ba£dœ
 + "/stellarc");

54 
	}
}

57 
	gOSy¡emUNIX
::~
	$OSy¡emUNIX
()

59 
	}
}

62 
uIÁ32
 
OSy¡emUNIX
::
	$g‘Ticks
() {

64 
timev®
 
now
;

65 
	`g‘timeofday
(&
now
, 0);

66  (
uIÁ32
è(
now
.
tv_£c
 * 1000000 +‚ow.
tv_u£c
);

70 
	}
}

	@os_dependent/OSystemUNIX.hxx

19 #iâdeà
OSYSTEM_UNIX_HXX


20 
	#OSYSTEM_UNIX_HXX


	)

22 
	~"b¥f.hxx
"

30 şas 
	cOSy¡emUNIX
 : 
public
 
OSy¡em


32 
public
:

36 
OSy¡emUNIX
();

41 
	mvœtu®
 ~
OSy¡emUNIX
();

48 
uIÁ32
 
g‘Ticks
();

	@os_dependent/SettingsUNIX.cxx

19 
	~"b¥f.hxx
"

20 
	~"S‘tšgs.hxx
"

21 
	~"S‘tšgsUNIX.hxx
"

24 
	gS‘tšgsUNIX
::
	$S‘tšgsUNIX
(
OSy¡em
* 
osy¡em
)

25 : 
	$S‘tšgs
(
osy¡em
)

27 
	`£tIÁ”Çl
("gl_lib", "libGL.so");

29 
	`£tIÁ”Çl
("gl_vsync", "false");

30 
	}
}

33 
	gS‘tšgsUNIX
::~
	$S‘tšgsUNIX
()

35 
	}
}

	@os_dependent/SettingsUNIX.hxx

19 #iâdeà
SETTINGS_UNIX_HXX


20 
	#SETTINGS_UNIX_HXX


	)

22 
şass
 
	gOSy¡em
;

24 
	~"b¥f.hxx
"

32 şas 
	cS‘tšgsUNIX
 : 
public
 
S‘tšgs


34 
public
:

38 
S‘tšgsUNIX
(
OSy¡em
* 
osy¡em
);

43 
	mvœtu®
 ~
S‘tšgsUNIX
();

	@player_agents/actions_summary_agent.cpp

16 
	~"aùiÚs_summ¬y_ag’t.h
"

17 
	~"¿ndom_toŞs.h
"

18 
	~"veùÜ_m©rix_toŞs.h
"

19 
	~"expÜt_toŞs.h
"

20 
	~<f¡»am
>

22 
	gAùiÚSumm¬yAg’t
::
	$AùiÚSumm¬yAg’t
Ğ
GameS‘tšgs
* 
_game_£‰šgs
,

23 
OSy¡em
* 
_osy¡em
) :

24 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
){

25 
i_cu¼_aùiÚ_šdex
 = -1;

26 
¡r_cu¼’t_aùiÚ
 = "RANDOM";

27 
i_aù_•isode_couÁ”
 = 0;

28 
i_max_•isode_³r_aù
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
(

29 "num_•isodes_to_avg_»suÉs", 
Œue
);

30 
i
 = 0; i < 
LAST_ACTION_INDEX
; i++) {

31 
v_»suÉs_sum
.
	`push_back
(0.0);

33 
mš_•is_»quœed
 = 
i_max_•isode_³r_aù
 * (
i_num_aùiÚs
 + 2);

34 ià(
i_max_num_•isodes
 != -1 &&

35 
i_max_num_•isodes
 < 
mš_•is_»quœed
) {

36 
cout
 << "MaxNumEpisode upd©ed fÜm: " << 
i_max_num_•isodes


37 << "o: " << 
mš_•is_»quœed
 << 
’dl
;

38 
i_max_num_•isodes
 = 
mš_•is_»quœed
;

40 
mš_äames_»q
 = (
mš_•is_»quœed
 + 1) *

41 (
i_max_num_äames_³r_•isode
 +

42 
p_game_£‰šgs
->
i_d–ay_aá”_»¡¬t
 + 100);

43 ià(
i_max_num_äames
 != -1 &&

44 
i_max_num_äames
 < 
mš_äames_»q
) {

45 
cout
 << "MaxNumF¿me upd©ed fÜm: " << 
i_max_num_äames


46 << "o: " << 
mš_äames_»q
 << 
’dl
;

47 
i_max_num_äames
 = 
mš_äames_»q
;

49 
	}
}

54 
AùiÚ
 
	gAùiÚSumm¬yAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

55 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

56 
äame_numb”
) {

57 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

58 
äame_numb”
);

59 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

60  
¥ecŸl_aùiÚ
;

63 ià(
i_cu¼_aùiÚ_šdex
 == -1) {

65  
choiû
 <
AùiÚ
> (
p_game_£‰šgs
->
pv_possibË_aùiÚs
);

67  (*
p_game_£‰šgs
->
pv_possibË_aùiÚs
)[
i_cu¼_aùiÚ_šdex
];

68 
	}
}

77 
	gAùiÚSumm¬yAg’t
::
	$Ú_’d_of_game
() {

78 
v_aù_•is_»w¬ds
.
	`push_back
(
f_•isode_»w¬d
);

79 
i_aù_•isode_couÁ”
++;

80 ià(
i_aù_•isode_couÁ”
 > 
i_max_•isode_³r_aù
) {

82 
av”age_»w¬d
 = 
	`g‘_veùÜ_av”age
Ğ&
v_aù_•is_»w¬ds
, 0,

83 
v_aù_•is_»w¬ds
.
	`size
());

84 
šd
;

85 ià(
i_cu¼_aùiÚ_šdex
 == -1) {

86 
šd
 = 
RANDOM
;

88 
šd
 = (*
pv_possibË_aùiÚs
)[
i_cu¼_aùiÚ_šdex
];

90 
v_»suÉs_sum
[
šd
] = 
av”age_»w¬d
;

92 
¡ršg
 
f’ame
 = "»w¬d_³r_•isode__aù_" + 
¡r_cu¼’t_aùiÚ
 + ".txt";

93 
	`expÜt_veùÜ
(&
v_aù_•is_»w¬ds
, 
f’ame
);

95 
i_cu¼_aùiÚ_šdex
++;

96 ià(
i_cu¼_aùiÚ_šdex
 =ğ
i_num_aùiÚs
) {

98 
	`§ve_»suÉs_summ¬y
();

99 
	`’d_game
();

101 
¡r_cu¼’t_aùiÚ
 = 
	`aùiÚ_to_¡ršg
(

102 (*
pv_possibË_aùiÚs
)[
i_cu¼_aùiÚ_šdex
]);

103 
cout
 << " ** Sw™chšgØaùiÚ:" << 
¡r_cu¼’t_aùiÚ
 << " **" << 
’dl
;

104 
i_aù_•isode_couÁ”
 = 0;

105 
v_aù_•is_»w¬ds
.
	`ş—r
();

107 
PÏy”Ag’t
::
	`Ú_’d_of_game
();

108 
	}
}

113 
	gAùiÚSumm¬yAg’t
::
	$§ve_»suÉs_summ¬y
() {

114 
of¡»am
 
fe
;

115 
fe
.
	`İ’
("actions_summary.txt");

116 
fe
 << "action,average_reward_over_"

117 << 
i_max_•isode_³r_aù
 << "_•isodes" << 
’dl
;

118 
fe
 << "RANDOM," << 
v_»suÉs_sum
[
RANDOM
] << 
’dl
;

119 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

120 
fe
 << 
	`aùiÚ_to_¡ršg
((*
pv_possibË_aùiÚs
)[
a
]) << ","

121 << 
v_»suÉs_sum
[(*
pv_possibË_aùiÚs
)[
a
]] << 
’dl
;

123 
fe
.
	`şo£
();

124 
	}
}

	@player_agents/actions_summary_agent.h

16 #iâdeà
ACTION_SUMMARY_AGENT_H


17 
	#ACTION_SUMMARY_AGENT_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"¶ay”_ag’t.h
"

22 şas 
	cAùiÚSumm¬yAg’t
 : 
public
 
PÏy”Ag’t
 {

24 
public
:

25 
AùiÚSumm¬yAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

30 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

31 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

32 
äame_numb”
);

41 
vœtu®
 
Ú_’d_of_game
();

43 
	m´Ùeùed
:

47 
§ve_»suÉs_summ¬y
();

49 
	mi_cu¼_aùiÚ_šdex
;

51 
¡ršg
 
	m¡r_cu¼’t_aùiÚ
;

52 
	mi_aù_•isode_couÁ”
;

53 
	mi_max_•isode_³r_aù
;

54 
FlßtVeù
 
	mv_aù_•is_»w¬ds
;

55 
FlßtVeù
 
	mv_»suÉs_sum
;

	@player_agents/background_detector.cpp

16 
	~"background_d‘eùÜ.h
"

17 
	~"game_cÚŒŞËr.h
"

18 
	~"expÜt_toŞs.h
"

21 
	gBackgroundD‘eùÜ
::
	$BackgroundD‘eùÜ
(
OSy¡em
* 
_osy¡em
) {

22 
p_osy¡em
 = 
_osy¡em
;

23 
i_äames_num
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("bg_d‘eù_äames_num", 
Œue
);

24 
i_äames_couÁ”
 = 0;

25 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

26 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

27 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

28 
v_cŞÜ_couÁs
.
	`ş—r
();

29 
i
 = 0; i < 
i_sü“n_height
 * 
i_sü“n_width
 * 
NUM_COLORS
; i++) {

30 
v_cŞÜ_couÁs
.
	`push_back
(0);

32 
	}
}

35 
	gBackgroundD‘eùÜ
::~
	$BackgroundD‘eùÜ
() {

37 
	}
}

42 
BackgroundD‘eùÜ
::
	$g‘_Ãw_sü“n
(cÚ¡ 
IÁM©rix
* 
pv_sü“n
) {

43 ià(
i_äames_couÁ”
 > 
i_äames_num
) {

46 
pix–_šd
 = 0;

47 
i
 = 0; i < 
i_sü“n_height
; i++) {

48 
j
 = 0; j < 
i_sü“n_width
; j++) {

49 
cŞÜ_šd
 = (*
pv_sü“n
)[
i
][
j
];

50 
	`as£¹
(
cŞÜ_šd
 < 
NUM_COLORS
);

51 
v_cŞÜ_couÁs
[
pix–_šd
 + 
cŞÜ_šd
] += 1;

52 
pix–_šd
 +ğ
NUM_COLORS
;

55 
i_äames_couÁ”
++;

56 ià(
i_äames_couÁ”
 =ğ
i_äames_num
) {

57 
	`exŒaù_ªd_§ve_background
();

59 
	}
}

65 
	gBackgroundD‘eùÜ
::
	$exŒaù_ªd_§ve_background
() {

67 
IÁM©rix
* 
pm_background
 = 
Ãw
 IntMatrix;

68 
i
 = 0; i < 
i_sü“n_height
; i++) {

69 
IÁVeù
 
row
;

70 
j
 = 0; j < 
i_sü“n_width
; j++) {

71 
mo¡_äq_šd
 = 
	`g‘_mo¡_äequ’t_cŞÜ_šd
(
i
, 
j
);

72 
row
.
	`push_back
(
mo¡_äq_šd
);

74 
pm_background
->
	`push_back
(
row
);

78 
	`expÜt_m©rix
(
pm_background
, "background_matrix.txt");

79 
p_osy¡em
->
p_expÜt_sü“n
->
	`expÜt_ªy_m©rix
(
pm_background
,

82 
d–‘e
 
pm_background
;

83 
	}
};

90 
	gBackgroundD‘eùÜ
::
	$g‘_mo¡_äequ’t_cŞÜ_šd
(
i
, 
j
) {

91 
pix–_num
 = (
i
 * 
i_sü“n_width
è+ 
j
;

92 
pix–_šd
 = 
pix–_num
 * 
NUM_COLORS
;

93 
highe¡_šd
 = 0;

94 
highe¡_v®
 = 
v_cŞÜ_couÁs
[
pix–_šd
];

95 
i
 = 1; i < 
NUM_COLORS
; i++ ) {

96 
v®
 = 
v_cŞÜ_couÁs
[
pix–_šd
 + 
i
];

97 ià(
v®
 > 
highe¡_v®
) {

98 
highe¡_v®
 = 
v®
;

99 
highe¡_šd
 = 
i
;

102  
highe¡_šd
;

103 
	}
}

	@player_agents/background_detector.h

16 #iâdeà
BACKGROUND_DETECTOR_H


17 
	#BACKGROUND_DETECTOR_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"OSy¡em.hxx
"

21 
	#NUM_COLORS
 256

	)

23 şas 
	cBackgroundD‘eùÜ
 {

40 
	mpublic
:

41 
BackgroundD‘eùÜ
(
OSy¡em
* 
_osy¡em
);

42 
	mvœtu®
 ~
BackgroundD‘eùÜ
();

47 
vœtu®
 
g‘_Ãw_sü“n
(cÚ¡ 
IÁM©rix
* 
pv_sü“n
);

53 
vœtu®
 
exŒaù_ªd_§ve_background
();

58 
boŞ
 
	$is_bg_exŒaùiÚ_com¶‘e
() {

59  (
i_äames_couÁ”
 > 
i_äames_num
);

62 
´Ùeùed
:

67 
	`g‘_mo¡_äequ’t_cŞÜ_šd
(
i
, 
j
);

69 
OSy¡em
* 
p_osy¡em
;

70 
i_äames_num
;

71 
i_äames_couÁ”
;

72 
IÁVeù
 
v_cŞÜ_couÁs
;

73 
i_sü“n_width
;

74 
i_sü“n_height
;

76 
	}
};

	@player_agents/blob_class.cpp

17 
	~<s¡»am
>

18 
	~"blob_şass.h
"

19 
	~"sh­e_toŞs.h
"

20 
	~"veùÜ_m©rix_toŞs.h
"

21 
	~"commÚ_cÚ¡ªts.h
"

24 
	gBlobCÏss
::
	$BlobCÏss
() {

25 
pv_»g_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

26 
i_num_äames_Ú_sü
 = 0;

27 
i_sü“n_pos_x_mš
 = -1;

28 
i_sü“n_pos_x_max
 = -1;

29 
i_sü“n_pos_y_mš
 = -1;

30 
i_sü“n_pos_y_max
 = -1;

31 
i_discov”ed_Ú_äame
 = -1;

32 
	}
}

34 
	gBlobCÏss
::~
	$BlobCÏss
() {

35 
	`ş—r_li¡_of_poš‹rs
(
pv_»g_objeùs
);

36 
d–‘e
 
pv_»g_objeùs
;

37 
	}
}

43 
	gBlobCÏss
::
	$add_objeù
(
RegiÚObjeù
* 
»g_objeù
, 
äame_num
,

44 
¡ršg
 
discov”y_txt
) {

45 
RegiÚObjeù
* 
Ãw_objeù
 = 
Ãw
 
	`RegiÚObjeù
(*
»g_objeù
);

46 
Ãw_objeù
->
i_disc_äame_num
 = 
äame_num
;

47 
Ãw_objeù
->
i_num_äames_Ú
 = 1;

48 
Ãw_objeù
->
¡r_disc_‹xt
 = 
discov”y_txt
;

49 
pv_»g_objeùs
->
	`push_back
(
Ãw_objeù
);

50 
	`upd©e_sü“n_boudÇr›s
(
»g_objeù
);

51 
	}
}

57 
	gBlobCÏss
::
	$upd©e_sü“n_boudÇr›s
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
) {

58 iàĞ
i_sü“n_pos_x_mš
 == -1 ||

59 
»g_objeù
->
i_ûÁ”_x
 < 
i_sü“n_pos_x_mš
) {

60 
i_sü“n_pos_x_mš
 = 
»g_objeù
->
i_ûÁ”_x
;

62 iàĞ
i_sü“n_pos_x_max
 == -1 ||

63 
»g_objeù
->
i_ûÁ”_x
 > 
i_sü“n_pos_x_max
) {

64 
i_sü“n_pos_x_max
 = 
»g_objeù
->
i_ûÁ”_x
;

66 iàĞ
i_sü“n_pos_y_mš
 == -1 ||

67 
»g_objeù
->
i_ûÁ”_y
 < 
i_sü“n_pos_y_mš
) {

68 
i_sü“n_pos_y_mš
 = 
»g_objeù
->
i_ûÁ”_y
;

70 iàĞ
i_sü“n_pos_y_max
 == -1 ||

71 
»g_objeù
->
i_ûÁ”_y
 > 
i_sü“n_pos_y_max
) {

72 
i_sü“n_pos_y_max
 = 
»g_objeù
->
i_ûÁ”_y
;

74 
	}
}

82 
boŞ
 
	gBlobCÏss
::
	$b–Úgs
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
,

83 
boŞ
 
®low_difã»Á_size
,

84 
boŞ
 
check_æ³d_hÜiz’Îy
,

85 
boŞ
 
check_æ³d_v”tiÿÎy
,

86 
max_sh­e_¬—_dif
) const {

87 
RegiÚObjeù
* 
æ³d_obj
 = 
NULL
;

88 ià(
check_æ³d_v”tiÿÎy
 || 
check_æ³d_hÜiz’Îy
) {

89 
æ³d_obj
 = 
Ãw
 
	`RegiÚObjeù
(*
»g_objeù
);

90 
	`æ_sh­e
(
»g_objeù
->
pm_sh­e_m©rix
, 
æ³d_obj
->pm_shape_matrix,

91 
check_æ³d_hÜiz’Îy
, 
check_æ³d_v”tiÿÎy
);

93 
boŞ
 
do_b–Úg
 = 
çl£
;

94 
i
 = 0; i < 
pv_»g_objeùs
->
	`size
(); i++) {

95 
RegiÚObjeù
* 
cu¼_objeù
 = (*
pv_»g_objeùs
)[
i
];

96 
pix–_di¡ªû
 = -1;

97 
³rc_di¡ªû
 = -1.0;

98 
boŞ
 
di¡_v®id
;

99 ià(
æ³d_obj
) {

100 
di¡_v®id
 = 
cu¼_objeù
->
	`ÿlc_di¡ªû
(
æ³d_obj
,

101 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

102 
pix–_di¡ªû
, 
³rc_di¡ªû
);

104 
di¡_v®id
 = 
cu¼_objeù
->
	`ÿlc_di¡ªû
(
»g_objeù
,

105 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

106 
pix–_di¡ªû
, 
³rc_di¡ªû
);

108 ià(
di¡_v®id
 && 
pix–_di¡ªû
 == 0) {

109 
do_b–Úg
 = 
Œue
;

113 ià(
æ³d_obj
) {

114 
d–‘e
 
æ³d_obj
;

116  
do_b–Úg
;

117 
	}
}

123 
	gBlobCÏss
::
	$šü—£_obj_Úsü“n_couÁ
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
) {

124 
i
 = 0; i < 
pv_»g_objeùs
->
	`size
(); i++) {

125 
RegiÚObjeù
* 
cu¼_objeù
 = (*
pv_»g_objeùs
)[
i
];

126 
pix–_di¡ªû
 = -1;

127 
³rc_di¡ªû
 = -1.0;

128 
boŞ
 
di¡_v®id
 = 
cu¼_objeù
->
	`ÿlc_di¡ªû
(
»g_objeù
,

129 
çl£
, 0.0,

130 
pix–_di¡ªû
, 
³rc_di¡ªû
);

131 ià(
di¡_v®id
 && 
pix–_di¡ªû
 == 0) {

132 
	`as£¹
 (
cu¼_objeù
->
i_num_äames_Ú
 > 0);

133 
cu¼_objeù
->
i_num_äames_Ú
++;

137 
¡ršg
 
”r
 = 
	`¡ršg
("BlobClass::increase_obj_onscreen_count() called") +

138 
	`¡ršg
(" on objecthat is‚ot‡ member ofhis blob-class\n");

139 
û¼
 << 
”r
;

140 
cout
 << 
”r
;

141 
	`ex™
(-1);

142 
	}
}

147 
	gBlobCÏss
::
	$m”ge_w™h
(cÚ¡ 
BlobCÏss
* 
Ùh”_şass
) {

148 cÚ¡ 
RegiÚObjeùLi¡
* 
Ùh”_objeùs
 = 
Ùh”_şass
->
	`g‘_»g_objeùs
();

149 
i
 = 0; i < 
Ùh”_objeùs
->
	`size
(); i++) {

150 
RegiÚObjeù
* 
Ãw_objeù
 = 
Ãw
 
	`RegiÚObjeù
(*((*
Ùh”_objeùs
)[
i
]));

151 
pv_»g_objeùs
->
	`push_back
(
Ãw_objeù
);

153 
i_sü“n_pos_x_max
 = 
	`max
(i_screen_pos_x_max,

154 
Ùh”_şass
->
i_sü“n_pos_x_max
);

155 
i_sü“n_pos_x_mš
 = 
	`mš
(i_screen_pos_x_min,

156 
Ùh”_şass
->
i_sü“n_pos_x_mš
);

157 
i_sü“n_pos_y_max
 = 
	`max
(i_screen_pos_y_max,

158 
Ùh”_şass
->
i_sü“n_pos_y_max
);

159 
i_sü“n_pos_y_mš
 = 
	`mš
(
i_sü“n_pos_x_mš
,

160 
Ùh”_şass
->
i_sü“n_pos_y_mš
);

161 
	}
}

167 
	gBlobCÏss
::
	$upd©e_şass_numb”
(
Ãw_num
) {

168 
i
 = 0; i < 
pv_»g_objeùs
->
	`size
(); i++) {

169 (*
pv_»g_objeùs
)[
i
]->
i_š¡ªû_of_şass
 = 
Ãw_num
;

171 
	}
}

178 
boŞ
 
	gBlobCÏss
::
	$g‘_mš_di¡ªû
ĞcÚ¡ 
BlobCÏss
* 
Ùh”_şass
,

179 
max_sh­e_¬—_dif
,

180 & 
mš_di¡
) const {

181 
mš_di¡
 = -1.0;

182 
i
 = 0; i < 
pv_»g_objeùs
->
	`size
(); i++) {

183 
RegiÚObjeù
* 
my_obj
 = (*
pv_»g_objeùs
)[
i
];

184 
j
 = 0; j < 
Ùh”_şass
->
pv_»g_objeùs
->
	`size
(); j++) {

185 
RegiÚObjeù
* 
Ùh”_obj
 = (*
Ùh”_şass
->
pv_»g_objeùs
)[
j
];

186 
pix–_di¡ªû
;

187 
³rc_di¡ªû
;

188 
boŞ
 
di¡ªû_v®id
 = 
my_obj
->
	`ÿlc_di¡ªû
(
Ùh”_obj
, 
Œue
,

189 
max_sh­e_¬—_dif
,

190 
pix–_di¡ªû
, 
³rc_di¡ªû
);

191 ià(!
di¡ªû_v®id
) {

194 ià(
mš_di¡
 < 0 || 
³rc_di¡ªû
 < min_dist) {

195 
mš_di¡
 = 
³rc_di¡ªû
;

199 ià(
mš_di¡
 < 0) {

200  
çl£
;

202  
mš_di¡
;

203 
	}
}

208 cÚ¡ 
RegiÚObjeùLi¡
* 
	gBlobCÏss
::
	$g‘_»g_objeùs
() const {

209  
pv_»g_objeùs
;

210 
	}
}

217 
¡ršg
 
	gBlobCÏss
::
	$g‘_šfo_‹xt
(
num_äames
) const {

218 
Ú_äame_¿tio
 = ()
i_num_äames_Ú_sü
 / ()
num_äames
;

219 
d–_x
 = 
i_sü“n_pos_x_max
 - 
i_sü“n_pos_x_mš
;

220 
d–_y
 = 
i_sü“n_pos_y_max
 - 
i_sü“n_pos_y_mš
;

221 
bound¬y_¬—
 = 
d–_x
 * 
d–_y
;

222 
o¡ršg¡»am
 
šfo_¡r
;

223 
šfo_¡r
 << "Numb” oàF¬me Ú Sü“n: " << 
i_num_äames_Ú_sü
 << 
’dl


224 << "OÀSü“ÀR©io: " << 
Ú_äame_¿tio
 << 
’dl


225 << "Sü“ÀPos™iÚ Bound: (" << 
i_sü“n_pos_x_mš
 << ","

226 << 
i_sü“n_pos_y_mš
 << "è- (" << 
i_sü“n_pos_x_max
 << ","

227 << 
i_sü“n_pos_y_max
 << ")" << 
’dl


228 << "Bound¬y A»a: " << 
bound¬y_¬—
 << 
’dl


229 << "Discov”ed oÀäam#" << 
i_discov”ed_Ú_äame
 << 
’dl
;

230  
šfo_¡r
.
	`¡r
();

231 
	}
}

	@player_agents/blob_class.h

17 #iâdeà
BLOB_CLASS_H


18 
	#BLOB_CLASS_H


	)

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"blob_objeù.h
"

22 
	~"»giÚ_mªag”.h
"

24 şas 
	cBlobCÏss
 {

44 
	mpublic
:

45 
BlobCÏss
();

46 
	mvœtu®
 ~
BlobCÏss
();

52 
add_objeù
(
RegiÚObjeù
* 
»g_objeù
, 
äame_num
,

53 
¡ršg
 
discov”y_txt
);

59 
upd©e_sü“n_boudÇr›s
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
);

67 
boŞ
 
	$b–Úgs
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
, 
boŞ
 
®low_difã»Á_size
,

68 
boŞ
 
check_æ³d_hÜiz’Îy
,

69 
boŞ
 
check_æ³d_v”tiÿÎy
,

70 
max_sh­e_¬—_dif
) const;

76 
	`šü—£_obj_Úsü“n_couÁ
(cÚ¡ 
RegiÚObjeù
* 
»g_objeù
);

81 
	`m”ge_w™h
(cÚ¡ 
BlobCÏss
* 
Ùh”_şass
);

87 
	`upd©e_şass_numb”
(
Ãw_num
);

94 
boŞ
 
	$g‘_mš_di¡ªû
ĞcÚ¡ 
BlobCÏss
* 
Ùh”_şass
,

95 
max_sh­e_¬—_dif
,

96 & 
mš_di¡
) const;

101 cÚ¡ 
RegiÚObjeùLi¡
* 
	$g‘_»g_objeùs
() const;

107 
¡ršg
 
	$g‘_šfo_‹xt
(
num_äames
) const;

109 
RegiÚObjeùLi¡
* 
pv_»g_objeùs
;

110 
i_num_äames_Ú_sü
;

111 
i_sü“n_pos_x_mš
;

112 
i_sü“n_pos_x_max
;

113 
i_sü“n_pos_y_mš
;

114 
i_sü“n_pos_y_max
;

115 
i_discov”ed_Ú_äame
;

	@player_agents/blob_object.cpp

15 
	~<s¡»am
>

16 
	~"blob_objeù.h
"

17 
	~"veùÜ_m©rix_toŞs.h
"

18 
	~"sh­e_toŞs.h
"

20 
	gBlobObjeù
::
	$BlobObjeù
Ğ
_ûÁ”_x
, 
_ûÁ”_y
, 
_v–oc™y_x
,

21 
_v–oc™y_y
, 
_š¡ªû_of_şass
) {

22 
i_ûÁ”_x
 = 
_ûÁ”_x
;

23 
i_ûÁ”_y
 = 
_ûÁ”_y
;

24 
i_v–oc™y_x
 = 
_v–oc™y_x
;

25 
i_v–oc™y_y
 = 
_v–oc™y_y
;

26 
i_š¡ªû_of_şass
 = 
_š¡ªû_of_şass
;

27 
	}
}

33 
	gBlobObjeù
::
	$ÿlc_di¡ªû_max_xy
Ğ
BlobObjeù
* 
Ùh”_obj
) {

34  
	`max
Ğ
	`abs
(
i_ûÁ”_x
 - 
Ùh”_obj
->i_center_x),

35 
	`abs
(
i_ûÁ”_y
 - 
Ùh”_obj
->i_center_y) );

36 
	}
}

51 
	gRegiÚObjeù
::
	$RegiÚObjeù
() :

52 
	$BlobObjeù
(0, 0) {

53 
b_is_v®id
 = 
çl£
;

54 
pm_sh­e_m©rix
 = 
NULL
;

55 
i_»giÚ_numb”
 = -1;

56 
p_´evious_objeù
 = 
NULL
;

57 
i_disc_äame_num
 = -1;

58 
i_num_äames_Ú
 = -1;

59 
¡r_disc_‹xt
 = "";

60 
i_width
 = 
i_height
 = -1;

62 
	}
}

67 
	gRegiÚObjeù
::
	$RegiÚObjeù
(cÚ¡ 
RegiÚObjeù
& 
Ùh”_obj
) :

68 
	$BlobObjeù
(
Ùh”_obj
.
i_ûÁ”_x
, oth”_obj.
i_ûÁ”_y
) {

69 
b_is_v®id
 = 
Ùh”_obj
.b_is_valid;

70 
i_width
 = 
Ùh”_obj
.i_width;

71 
i_height
 = 
Ùh”_obj
.i_height;

72 
pm_sh­e_m©rix
 = 
Ãw
 
IÁM©rix
;

73 
i
 = 0; i < 
i_height
; i++) {

74 
IÁVeù
 
row
;

75 
j
 = 0; j < 
i_width
; j++) {

76 
row
.
	`push_back
((*
Ùh”_obj
.
pm_sh­e_m©rix
)[
i
][
j
]);

78 
pm_sh­e_m©rix
->
	`push_back
(
row
);

80 
i_»giÚ_numb”
 = 
Ùh”_obj
.i_region_number;

81 
p_´evious_objeù
 = 
Ùh”_obj
.p_previous_object;

82 
i_disc_äame_num
 = 
Ùh”_obj
.i_disc_frame_num;

83 
i_num_äames_Ú
 = 
Ùh”_obj
.i_num_frames_on;

84 
¡r_disc_‹xt
 = 
Ùh”_obj
.str_disc_text;

85 
	}
}

90 
	gRegiÚObjeù
& RegiÚObjeù::
İ”©Ü
=(cÚ¡ 
RegiÚObjeù
& 
th©
) {

91 
as£¹
(
çl£
);

92 
	gcout
 << "Assignm’ˆO³¿tÜ i nÙ y‘ im¶em’‹d fÜ RegiÚObjeù"<<
	g’dl
;

93 
	gû¼
 << "Assignm’ˆO³¿tÜ i nÙ y‘ im¶em’‹d fÜ RegiÚObjeù"<<
	g’dl
;

94 
ex™
(-1);

97 
	gRegiÚObjeù
::~
	$RegiÚObjeù
() {

98 ià(
pm_sh­e_m©rix
) {

99 
d–‘e
 
pm_sh­e_m©rix
;

101 
	}
}

108 
boŞ
 
	gRegiÚObjeù
::
	$exŒaù_äom_»giÚ_m©rix
ĞcÚ¡ 
IÁM©rix
* 
»giÚ_m©rix
,

109 
»giÚ_num
) {

111 ià(
pm_sh­e_m©rix
) {

112 
d–‘e
 
pm_sh­e_m©rix
;

116 
IÁVeù
* 
pv_row_šds
 = 
Ãw
 IntVect;

117 
IÁVeù
* 
pv_cŞ_šds
 = 
Ãw
 IntVect;;

118 
	`sim¶e_wh”e
Ğ
»giÚ_m©rix
, 
»giÚ_num
, 
pv_row_šds
, 
pv_cŞ_šds
);

119 
num_pix–s
 = 
pv_row_šds
->
	`size
();

120 ià(
num_pix–s
 == 0) {

122 
b_is_v®id
 = 
çl£
;

123 
d–‘e
 
pv_row_šds
;

124 
d–‘e
 
pv_cŞ_šds
;

125  
çl£
;

129 
x_mš
, 
x_mš_šd
, 
x_max
, 
x_max_šd
;

130 
y_mš
, 
y_mš_šd
, 
y_max
, 
y_max_šd
;

131 
	`veù_mš
(
pv_cŞ_šds
, 
x_mš
, 
x_mš_šd
);

132 
	`veù_max
(
pv_cŞ_šds
, 
x_max
, 
x_max_šd
);

133 
	`veù_mš
(
pv_row_šds
, 
y_mš
, 
y_mš_šd
);

134 
	`veù_max
(
pv_row_šds
, 
y_max
, 
y_max_šd
);

135 
i_width
 = 
x_max
 - 
x_mš
 + 1;

136 
i_height
 = 
y_max
 - 
y_mš
 + 1;

137 
	`as£¹
 (
i_width
 > 0 && 
i_height
 > 0);

140 
pm_sh­e_m©rix
 = 
Ãw
 
IÁM©rix
;

141 
i
 = 0; i < 
i_height
; i++) {

142 
IÁVeù
 
row
;

143 
j
 = 0; j < 
i_width
; j++) {

144 
row
.
	`push_back
(0);

146 
pm_sh­e_m©rix
->
	`push_back
(
row
);

148 
c
 = 0; c < 
num_pix–s
; c++) {

149 
i
 = (*
pv_row_šds
)[
c
] - 
y_mš
;

150 
j
 = (*
pv_cŞ_šds
)[
c
] - 
x_mš
;

151 
	`as£¹
 (
i
 >ğ0 && 
j
 >ğ0 && i < 
i_height
 && j < 
i_width
);

152 (*
pm_sh­e_m©rix
)[
i
][
j
] = 1;

156 
i_»giÚ_numb”
 = 
»giÚ_num
;

157 
i_ûÁ”_x
 = 
x_mš
 + ()(
i_width
 / 2);

158 
i_ûÁ”_y
 = 
y_mš
 + ()(
i_height
 / 2);

159 
b_is_v®id
 = 
Œue
;

160 
d–‘e
 
pv_row_šds
;

161 
d–‘e
 
pv_cŞ_šds
;

162  
Œue
;

163 
	}
}

170 
boŞ
 
	gRegiÚObjeù
::
	$ÿlc_di¡ªû
ĞcÚ¡ 
RegiÚObjeù
* 
Ùh”_objeù
,

171 
boŞ
 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

172 & 
pix–_di¡ªû
, & 
³rc_di¡ªû
) {

173 
boŞ
 
sucûss
 = 
	`ÿlc_sh­e_di¡ªû
Ğ
pm_sh­e_m©rix
,

174 
Ùh”_objeù
->
pm_sh­e_m©rix
,

175 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

176 
pix–_di¡ªû
, 
³rc_di¡ªû
);

177  
sucûss
;

178 
	}
}

188 
RegiÚObjeù
* 
	gRegiÚObjeù
::
	$g‘_şo£¡_obj_š_li¡
(

189 cÚ¡ 
RegiÚObjeùLi¡
* 
pv_obj_li¡
,

190 
li¡_Ëngth
,

191 
max_sh­e_¬—_dif
,

192 
max_³rc_difã»nû
,

193 
max_obj_v–oc™y
) {

194 
RegiÚObjeù
* 
şo£¡_´ev_obj
 = 
NULL
;

195 
şo£¡_pix–_di¡ªû
 = -1;

196 
şo£¡_sq_di¡ªû
 = -1;

198 
i
 = 0; i < 
li¡_Ëngth
; i++) {

199 
RegiÚObjeù
* 
´ev_obj
 = (*
pv_obj_li¡
)[
i
];

200 ià(
´ev_obj
 =ğ
NULL
 ||…»v_obj->
b_is_v®id
 =ğ
çl£
) {

203 
hÜiz’l_di¡
 = 
	`abs
Ğ
i_ûÁ”_x
 -

204 
´ev_obj
->
i_ûÁ”_x
);

205 
v”tiÿl_di¡
 = 
	`abs
Ğ
i_ûÁ”_y
 -

206 
´ev_obj
->
i_ûÁ”_y
);

208 ià(
hÜiz’l_di¡
 < 
max_obj_v–oc™y
 &&

209 
v”tiÿl_di¡
 < 
max_obj_v–oc™y
) {

210 
pix–_di¡ªû
 = -1;

211 
³rc_di¡ªû
 = -1.0;

213 
boŞ
 
di¡ªû_v®id
 = 
	`ÿlc_di¡ªû
(
´ev_obj
, 
Œue
,

214 
max_sh­e_¬—_dif
,

215 
pix–_di¡ªû
, 
³rc_di¡ªû
);

216 ià(!
di¡ªû_v®id
) {

219 ià(
³rc_di¡ªû
 < 
max_³rc_difã»nû
) {

220 
sq_di¡ªû
 = (
hÜiz’l_di¡
*horizental_dist);

221 
sq_di¡ªû
 +ğ(
v”tiÿl_di¡
 * vertical_dist);

222 iàĞ
şo£¡_´ev_obj
 =ğ
NULL
 ||

223 
pix–_di¡ªû
 < 
şo£¡_pix–_di¡ªû
 ) {

224 
şo£¡_´ev_obj
 = 
´ev_obj
;

225 
şo£¡_pix–_di¡ªû
 = 
pix–_di¡ªû
;

226 
şo£¡_sq_di¡ªû
 = 
sq_di¡ªû
;

227 } iàĞ
pix–_di¡ªû
 =ğ
şo£¡_pix–_di¡ªû
 &&

228 
şo£¡_sq_di¡ªû
 > 
sq_di¡ªû
) {

232 
şo£¡_´ev_obj
 = 
´ev_obj
;

233 
şo£¡_pix–_di¡ªû
 = 
pix–_di¡ªû
;

234 
şo£¡_sq_di¡ªû
 = 
sq_di¡ªû
;

239  
şo£¡_´ev_obj
;

240 
	}
}

245 
	gRegiÚObjeù
::
	$¶Ù
(
¡ršg
& 
f’ame
,

246 cÚ¡ 
ExpÜtSü“n
* 
p_expÜt_sü“n
) const {

247 
IÁM©rix
* 
¶Ù_m©rix
 = 
Ãw
 IntMatrix;

248 
i
 = 0; i < 
i_height
; i++) {

249 
IÁVeù
 
row
;

250 
j
 = 0; j < 
i_width
; j++) {

251 if((*
pm_sh­e_m©rix
)[
i
][
j
]) {

252 
row
.
	`push_back
(256 + 
WHITE_COLOR_IND
);

254 
row
.
	`push_back
(256 + 
BLACK_COLOR_IND
);

257 
¶Ù_m©rix
->
	`push_back
(
row
);

259 
p_expÜt_sü“n
->
	`expÜt_ªy_m©rix
 (
¶Ù_m©rix
, 
f’ame
);

260 
d–‘e
 
¶Ù_m©rix
;

261 
	}
}

272 
¡ršg
 
	gRegiÚObjeù
::
	$expÜt_objeù_as_txt
() const {

273 
o¡ršg¡»am
 
exp_¡r
;

274 
exp_¡r
 << 
i_š¡ªû_of_şass
 << ",";

275 
exp_¡r
 << 
i_width
 << "," << 
i_height
 << "|";

276 
i
 = 0; i < 
i_height
; i++) {

277 
j
 = 0; j < 
i_width
; j++) {

278 
exp_¡r
 << (*
pm_sh­e_m©rix
)[
i
][
j
];

279 ià(
j
 < 
i_width
 - 1) {

280 
exp_¡r
 << ",";

282 
exp_¡r
 << "|";

286  
exp_¡r
.
	`¡r
();

287 
	}
}

293 
¡ršg
 
	gRegiÚObjeù
::
	$g‘_šfo_‹xt
() const {

294 
o¡ršg¡»am
 
šfo_¡r
;

295 
šfo_¡r
 << "Discov”ed oÀäame: " << 
i_disc_äame_num
 << 
’dl


296 << "Numb” oàäame Ú sü“n: " << 
i_num_äames_Ú
 << 
’dl


297 << "Size: " << 
i_height
 << "x" << 
i_width
 << 
’dl


298 << "Comm’t: " + 
¡r_disc_‹xt
 << 
’dl
;

299  
šfo_¡r
.
	`¡r
();

300 
	}
}

307 
boŞ
 
	$com·»_objeùs_by_sh­e_size
ĞcÚ¡ 
RegiÚObjeù
* 
obj1
,

308 cÚ¡ 
RegiÚObjeù
* 
obj2
) {

309 
obj1_¬—
 = 
obj1
->
i_width
 * obj1->
i_height
;

310 
obj2_¬—
 = 
obj2
->
i_width
 * obj2->
i_height
;

311 ià(
obj1_¬—
 > 
obj2_¬—
) {

312  
Œue
;

314  
çl£
;

316 
	}
}

	@player_agents/blob_object.h

15 #iâdeà
BLOB_OBJECT_H


16 
	#BLOB_OBJECT_H


	)

18 
	~"commÚ_cÚ¡ªts.h
"

19 
	~"expÜt_sü“n.h
"

21 şas 
	cBlobObjeù
 {

32 
	mpublic
:

33 
BlobObjeù
Ğ
_ûÁ”_x
, 
_ûÁ”_y
,

34 
_v–oc™y_x
 = 0, 
_v–oc™y_y
 = 0,

35 
_š¡ªû_of_şass
 = 0);

41 
ÿlc_di¡ªû_max_xy
Ğ
BlobObjeù
* 
Ùh”_obj
);

43 
	mi_ûÁ”_x
, 
	mi_ûÁ”_y
;

44 
	mi_v–oc™y_x
, 
	mi_v–oc™y_y
;

45 
	mi_š¡ªû_of_şass
;

49 şas 
	cRegiÚObjeù
 : 
public
 
BlobObjeù
 {

74 
public
:

80 
RegiÚObjeù
 ();

81 
RegiÚObjeù
(cÚ¡ RegiÚObjeù& 
cİyObj
);

82 
	mRegiÚObjeù
& 
	mİ”©Ü
=(cÚ¡ 
RegiÚObjeù
& 
th©
);

84 
	mvœtu®
 ~
RegiÚObjeù
();

92 
boŞ
 
exŒaù_äom_»giÚ_m©rix
(cÚ¡ 
IÁM©rix
* 
»giÚ_m©rix
,

93 
»giÚ_num
);

100 
boŞ
 
ÿlc_di¡ªû
ĞcÚ¡ 
RegiÚObjeù
* 
Ùh”_objeù
,

101 
boŞ
 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

102 & 
pix–_di¡ªû
, & 
³rc_di¡ªû
);

111 
RegiÚObjeù
* 
g‘_şo£¡_obj_š_li¡
(

112 cÚ¡ 
RegiÚObjeùLi¡
* 
pv_obj_li¡
,

113 
li¡_Ëngth
,

114 
max_sh­e_¬—_dif
,

115 
max_³rc_difã»nû
,

116 
max_obj_v–oc™y
);

121 
	$¶Ù
(
¡ršg
& 
f’ame
, cÚ¡ 
ExpÜtSü“n
* 
p_expÜt_sü“n
) const;

132 
¡ršg
 
	$expÜt_objeù_as_txt
 () const;

138 
¡ršg
 
	$g‘_šfo_‹xt
() const;

140 
IÁM©rix
* 
pm_sh­e_m©rix
;

141 
i_»giÚ_numb”
;

142 
RegiÚObjeù
* 
p_´evious_objeù
;

143 
boŞ
 
b_is_v®id
;

144 
i_disc_äame_num
;

145 
i_num_äames_Ú
;

146 
¡ršg
 
¡r_disc_‹xt
;

147 
i_width
, 
i_height
;

155 
boŞ
 
	`com·»_objeùs_by_sh­e_size
ĞcÚ¡ 
RegiÚObjeù
* 
obj1
,

156 cÚ¡ 
RegiÚObjeù
* 
obj2
);

	@player_agents/class_agent.cpp

17 
	~<s¡»am
>

18 
	~"şass_ag’t.h
"

19 
	~"expÜt_toŞs.h
"

20 
	~"game_cÚŒŞËr.h
"

21 
	~"tes2.h
"

22 
	~"¿ndom_toŞs.h
"

23 
	~"misc_toŞs.h
"

26 
	gCÏssAg’t
::
	$CÏssAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

27 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
) {

28 
S‘tšgs
& 
£‰šgs
 = 
p_osy¡em
->
	`£‰šgs
();

29 
b_šc_abs_pos™iÚs
 = 
£‰šgs
.
	`g‘BoŞ
("šşude_abs_pos™iÚs", 
Œue
);

30 
i_num_tšgs
 = 
£‰šgs
.
	`g‘IÁ
("num_tšgs", 
Œue
);

31 
i_num_»ùªgËs
 = 
£‰šgs
.
	`g‘IÁ
("num_»ùªgËs", 
Œue
);

32 
i_mem_size_muÉ
 = 
£‰šgs
.
	`g‘IÁ
("mem_size_muÉl›r", 
Œue
);

33 
i_max_obj_v–oc™y
 = 
£‰šgs
.
	`g‘IÁ
("max_obj_v–oc™y", 
Œue
);

34 
i_max_num_d‘eùed_š¡aûs
 = 
£‰šgs
.
	`g‘IÁ
("max_num_detected_instaces",

35 
Œue
);

36 
i_max_obj_v–_h®f
 = 
i_max_obj_v–oc™y
 / 2;

37 
pv_sÜ‹d_sh­e_li¡
 = 
CÏssSh­e
::
	`impÜt_sh­e_li¡
("class_shapes.txt",

38 
i_num_şas£s
);

40 
f_®pha_muÉl›r
 = 
£‰šgs
.
	`g‘Flßt
("®pha_muÉl›r", 
Œue
);

41 
i_¶Ù_şass_š¡_äq
 = 
£‰šgs
.
	`g‘IÁ
("¶Ù_şass_š¡_äq", 
Œue
);

42 
b_’d_•isode_w™h_»w¬d
 =
£‰šgs
.
	`g‘BoŞ
("’d_•isode_w™h_»w¬d",
Œue
);

46 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

47 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

48 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

51 
i_mem_size_2d
 = 
i_num_tšgs
 * 
	`pow
(
i_num_»ùªgËs
, 2è* 
i_mem_size_muÉ
;

52 
i_mem_size_4d
 = 
i_num_tšgs
 * 
	`pow
(
i_num_»ùªgËs
, 4è* 
i_mem_size_muÉ
;

53 
i_num_şass_·œs
 = 
i_num_şas£s
 * (i_num_classes - 1) / 2;

54 
	`ÿlc_ã©u»_vec_size
();

55 
cout
 << "FuÎ F—tu»-VeùÜ L’gth: " << 
i_fuÎ_ã©u»_vec_Ëngth
 << 
’dl
;

57 
p_§r§_Ïmbda_sŞv”
 = 
RLS¬§Lambda
::
	`g’”©e_¾_§r§_Ïmbda_š¡ªû
(

58 
p_osy¡em
, 
i_fuÎ_ã©u»_vec_Ëngth
, 
i_num_aùiÚs
);

61 
pv_cu¼_ã©u»_m­
 = 
Ãw
 
	`F—tu»M­
();

62 
pv_num_nÚz”o_š_f
 = 
Ãw
 
	`IÁVeù
();

63 
i
 = 0; i < 
i_num_aùiÚs
; i++) {

64 
IÁA¼
 
ã©u»_vec
 = 
	`IÁA¼
(-1, 
i_fuÎ_ã©u»_vec_Ëngth
);

65 
pv_cu¼_ã©u»_m­
->
	`push_back
(
ã©u»_vec
);

66 
pv_num_nÚz”o_š_f
->
	`push_back
(0);

70 
pm_background_m¬ix
 = 
Ãw
 
IÁM©rix
;

71 
	`impÜt_m©rix
(
pm_background_m¬ix
, "background_matrix.txt");

74 
pv_cu¼_şs_š¡_m­
 = 
Ãw
 
CÏssIn¡ªûsM­
;

75 
pv_´ev_şs_š¡_m­
 = 
Ãw
 
CÏssIn¡ªûsM­
;

76 
i
 = 0; i < 
i_num_şas£s
; i++) {

77 
veùÜ
<
BlobObjeù
> 
v_cu¼
;

78 
veùÜ
<
BlobObjeù
> 
v_´ev
;

79 
pv_cu¼_şs_š¡_m­
->
	`push_back
(
v_cu¼
);

80 
pv_´ev_şs_š¡_m­
->
	`push_back
(
v_´ev
);

84 
i
 = 0; i < 
i_sü“n_height
; i++) {

85 
veùÜ
<> 
row
;

86 
j
 = 0; j < 
i_sü“n_width
; j++) {

87 
row
.
	`push_back
(0);

89 
m_fÜground_m©rix
.
	`push_back
(
row
);

93 
f_abs_pos_sÿË_çùÜ_x
 = ()
i_num_»ùªgËs
 / ()
i_sü“n_width
;

94 
f_abs_pos_sÿË_çùÜ_y
 = ()
i_num_»ùªgËs
 / ()
i_sü“n_height
;

95 
f_»l_pos_sÿË_çùÜ_x
 = ()
i_num_»ùªgËs
 /

96 ()(2 * 
i_sü“n_width
);

97 
f_»l_pos_sÿË_çùÜ_y
 = ()
i_num_»ùªgËs
 /

98 ()(2 * 
i_sü“n_height
);

99 
f_v–_sÿË_çùÜ
 = ()
i_num_»ùªgËs
 / ()
i_max_obj_v–oc™y
;

102 
pv_tmp_abs_šd
 = 
Ãw
 
	`IÁA¼
(-1, 
i_num_tšgs
);

103 
pv_tmp_»l_šd
 = 
Ãw
 
	`IÁA¼
(-1, 
i_num_tšgs
);

105 
	}
}

108 
	gCÏssAg’t
::~
	$CÏssAg’t
() {

109 
i
 = 0; i < 
pv_sÜ‹d_sh­e_li¡
->
	`size
(); i++) {

110 
	`d–‘e
 (*
pv_sÜ‹d_sh­e_li¡
)[
i
];

112 
d–‘e
 
pv_sÜ‹d_sh­e_li¡
;

113 
d–‘e
 
pm_background_m¬ix
;

114 
d–‘e
 
pv_cu¼_şs_š¡_m­
;

115 
d–‘e
 
pv_´ev_şs_š¡_m­
;

116 
d–‘e
 
pv_cu¼_ã©u»_m­
;

117 
d–‘e
 
pv_num_nÚz”o_š_f
;

118 
d–‘e
 
p_§r§_Ïmbda_sŞv”
;

119 
d–‘e
 
pv_tmp_abs_šd
;

120 
d–‘e
 
pv_tmp_»l_šd
;

121 
	}
}

126 
	gCÏssAg’t
::
	$ÿlc_ã©u»_vec_size
() {

127 
i_fuÎ_ã©u»_vec_Ëngth
 = 0;

128 ià(
b_šc_abs_pos™iÚs
) {

129 
i_fuÎ_ã©u»_vec_Ëngth
 +ğĞ
i_num_şas£s
 *

130 (
i_mem_size_2d
 + 
i_num_aùiÚs
));

132 
i_fuÎ_ã©u»_vec_Ëngth
 +ğ(
i_num_şass_·œs
 * 
i_mem_size_2d
 * 4);

133 
	}
}

139 
AùiÚ
 
	gCÏssAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

140 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

141 
äame_numb”
) {

142 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

143 
äame_numb”
);

144 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

145  
¥ecŸl_aùiÚ
;

147 ià(
b_’d_•isode_w™h_»w¬d
 && 
b_»w¬d_Ú_this_äame
) {

148 
cout
 << "Endšgƒpisodw™h„ew¬d: VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

149 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

150 
AùiÚ
 
fœ¡_aù
 = 
	`Ú_¡¬t_of_game
();

151  
fœ¡_aù
;

154 
	`g‘_şass_š¡ªûs_Ú_sü“n
();

155 
	`ÿlc_objeù_v–oc™›s
();

156 ià((
i_¶Ù_şass_š¡_äq
 != 0) &&

157 ((
i_äame_couÁ”
 % 
i_¶Ù_şass_š¡_äq
) == 0)) {

158 
	`¶Ù_cu¼’t_şass_š¡ªûs
();

161 
	`g’”©e_ã©u»_vec
();

162 
Ãxt_aùiÚ_šd
;

163 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

164 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

165 
pv_cu¼_ã©u»_m­
,

166 
pv_num_nÚz”o_š_f
,

167 
f_cu¼_»w¬d
,

168 
i_cu¼_ex¶_aù_šdex
);

170 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

171 
pv_cu¼_ã©u»_m­
,

172 
pv_num_nÚz”o_š_f
,

173 
f_cu¼_»w¬d
);

175 
	`as£¹
(
Ãxt_aùiÚ_šd
 < 
i_num_aùiÚs
);

176  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

177 
	}
}

182 
AùiÚ
 
	gCÏssAg’t
::
	$Ú_¡¬t_of_game
() {

183 
	`g‘_şass_š¡ªûs_Ú_sü“n
();

184 
	`ÿlc_objeù_v–oc™›s
();

185 
	`g’”©e_ã©u»_vec
();

186 
Ãxt_aùiÚ_šd
;

187 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

188 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

189 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
,

190 
i_cu¼_ex¶_aù_šdex
);

192 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

193 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
);

195  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

196 
	}
}

201 
	gCÏssAg’t
::
	$Ú_’d_of_game
() {

202 
PÏy”Ag’t
::
	`Ú_’d_of_game
();

205 
cout
 << "VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

206 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

207 
	}
}

226 
	gCÏssAg’t
::
	$g’”©e_ã©u»_vec
() {

227 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

228 
¡¬t_šd
 = 0;

229 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

230 ià(
b_šc_abs_pos™iÚs
) {

232 
m
 = 0; m < 
i_num_şas£s
; m++) {

233 
num_š¡ªûs_š_şass
 = (*
pv_cu¼_şs_š¡_m­
)[
m
].
	`size
();

234 ià(
num_š¡ªûs_š_şass
 == 0) {

238 
Úe_šd
 = 
a
;

239 
Úe_šd
 +ğ
¡¬t_šd
;

240 
	`add_Úe_šdex_to_ã©u»_m­
(
Úe_šd
, 
a
);

242 
¡¬t_šd
 +ğ
i_num_aùiÚs
;

243 
obj_úŒ
 = 0;

244 
obj_úŒ
 < 
num_š¡ªûs_š_şass
; obj_cntr++) {

245 
BlobObjeù
& 
obj
 = (*
pv_cu¼_şs_š¡_m­
)[
m
][
obj_úŒ
];

246 
sÿËd_x
, 
sÿËd_y
;

247 
	`g‘_sÿËd_pos™iÚ
(
obj
, 
sÿËd_x
, 
sÿËd_y
);

248 
pf_tmp_æßt_¬r
[0] = 
sÿËd_x
;

249 
pf_tmp_æßt_¬r
[1] = 
sÿËd_y
;

250 
	`G‘Tes
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
i_mem_size_2d
,

251 
pf_tmp_æßt_¬r
, 2, 
a
);

252 (*
pv_tmp_abs_šd
è+ğ
¡¬t_šd
;

253 
	`­³nd_to_ã©u»_vec
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
a
);

255 
¡¬t_šd
 +ğ
i_mem_size_2d
;

259 
m_a
 = 0; m_¨< 
i_num_şas£s
; m_a++ ) {

260 
num_š¡ªûs_š_a
 = (*
pv_cu¼_şs_š¡_m­
)[
m_a
].
	`size
();

261 ià(
num_š¡ªûs_š_a
 > 
i_max_num_d‘eùed_š¡aûs
) {

262 
num_š¡ªûs_š_a
 = 
i_max_num_d‘eùed_š¡aûs
;

264 
m_b
 = 
m_a
 + 1; m_b < 
i_num_şas£s
; m_b++) {

265 
num_š¡ªûs_š_b
 = (*
pv_cu¼_şs_š¡_m­
)[
m_b
].
	`size
();

266 ià(
num_š¡ªûs_š_b
 > 
i_max_num_d‘eùed_š¡aûs
) {

267 
num_š¡ªûs_š_b
 = 
i_max_num_d‘eùed_š¡aûs
;

269 
obj_út_a
 = 0;

270 
obj_út_a
 < 
num_š¡ªûs_š_a
; obj_cnt_a++) {

271 
BlobObjeù
& 
obj_a
 = (*
pv_cu¼_şs_š¡_m­
)[
m_a
][
obj_út_a
];

272 
obj_út_b
 = 0;

273 
obj_út_b
 < 
num_š¡ªûs_š_b
; obj_cnt_b++) {

274 
BlobObjeù
& 
obj_b
 = (*
pv_cu¼_şs_š¡_m­
)[
m_b
]

275 [
obj_út_b
];

276 
x_»l_sÿËd
, 
y_»l_sÿËd
;

277 
	`g‘_sÿËd_»Ïtive_pos™iÚ
(
obj_a
, 
obj_b
,

278 
x_»l_sÿËd
, 
y_»l_sÿËd
);

279 
boŞ
 
is_­´ßchšg_x
, 
is_­´ßchšg_y
;

280 
	`g‘_bš¬y_»Ïtive_v–oc™y
(
obj_a
, 
obj_b
,

281 
is_­´ßchšg_x
, 
is_­´ßchšg_y
);

282 
v–_off£t
 = 0;

283 ià(
is_­´ßchšg_x
) {

284 
v–_off£t
 += 1;

286 ià(
is_­´ßchšg_y
) {

287 
v–_off£t
 += 2;

289 
	`as£¹
(
v–_off£t
 >= 0 && vel_offset <= 3);

290 
v–_off£t
 = v–_off£ˆ* 
i_mem_size_2d
;

291 
pf_tmp_æßt_¬r
[0] = 
x_»l_sÿËd
;

292 
pf_tmp_æßt_¬r
[1] = 
y_»l_sÿËd
;

293 
	`G‘Tes
(
pv_tmp_»l_šd
, 
i_num_tšgs
, 
i_mem_size_2d
,

294 
pf_tmp_æßt_¬r
, 2, 
a
);

295 (*
pv_tmp_»l_šd
è+ğ(
¡¬t_šd
 + 
v–_off£t
);

296 
	`­³nd_to_ã©u»_vec
(
pv_tmp_»l_šd
, 
i_num_tšgs
, 
a
);

299 
¡¬t_šd
 +ğ(4 * 
i_mem_size_2d
);

302 
	`as£¹
 (
¡¬t_šd
 =ğ
i_fuÎ_ã©u»_vec_Ëngth
);

304 
	}
}

311 
	gCÏssAg’t
::
	$g‘_şass_š¡ªûs_Ú_sü“n
() {

312 
	`sw­_cu¼_ªd_´ev_şass_š¡ªûs
();

313 
	`exŒaù_fÜground
();

314 
num_fÜg_pix
 = 
v_fÜground_x_šd
.
	`size
();

315  
sh­e_couÁ”
 = 0; sh­e_couÁ” < 
pv_sÜ‹d_sh­e_li¡
->
	`size
();

316 
sh­e_couÁ”
++) {

317 
CÏssSh­e
* 
cu¼_sh­e
 = (*
pv_sÜ‹d_sh­e_li¡
)[
sh­e_couÁ”
];

318 
IÁM©rix
* 
sh­e_m©rix
 = 
cu¼_sh­e
->
pm_sh­e
;

320 
row_¿nge_¡¬t
 = 0;

321 
row_¿nge_’d
 = 
cu¼_sh­e
->
i_height
;

322 
cŞ_¿nge_¡¬t
 = 0 - 
cu¼_sh­e
->
i_fœ¡_Úe_šd
;

323 
cŞ_¿nge_’d
 = 
cu¼_sh­e
->
i_width
 - cu¼_sh­e->
i_fœ¡_Úe_šd
;

324 
h®f_height
 = 
cu¼_sh­e
->
i_height
 / 2;

325 
h®f_width
 = 
cu¼_sh­e
->
i_width
 / 2;

326 
šd
 = 0; ind < 
num_fÜg_pix
; ind++) {

327 
y
 = 
v_fÜground_y_šd
[
šd
];

328 
x
 = 
v_fÜground_x_šd
[
šd
];

329 ià(
y
 + 
row_¿nge_¡¬t
 < 0 ||

330 
y
 + 
row_¿nge_’d
 > 
i_sü“n_height
 ||

331 
x
 + 
cŞ_¿nge_¡¬t
 < 0 ||

332 
x
 + 
cŞ_¿nge_’d
 > 
i_sü“n_width
) {

335 
sh­e_m©ches
 = 1;

336 
row_šd
 = 0;„ow_šd < 
cu¼_sh­e
->
i_height
;„ow_ind++) {

337 
cŞ_šd
 = 0; cŞ_šd < 
cu¼_sh­e
->
i_width
; col_ind++) {

338 ià(
m_fÜground_m©rix
[
y
 + 
row_šd
 + 
row_¿nge_¡¬t
]

339 [
x
 + 
cŞ_šd
 + 
cŞ_¿nge_¡¬t
] !=

340 (*
sh­e_m©rix
)[
row_šd
][
cŞ_šd
] ) {

341 
sh­e_m©ches
 = 0;

345 ià(!
sh­e_m©ches
) {

349 ià(
sh­e_m©ches
) {

351 
ûÁ”_x
 = 
x
 + 
cŞ_¿nge_¡¬t
 + 
h®f_width
;

352 
ûÁ”_y
 = 
y
 + 
row_¿nge_¡¬t
 + 
h®f_height
;

353 
BlobObjeù
 
	`Ãw_obj
(
ûÁ”_x
, 
ûÁ”_y
);

354 
Ãw_obj
.
i_š¡ªû_of_şass
 = 
cu¼_sh­e
->i_instance_of_class;

355 (*
pv_cu¼_şs_š¡_m­
)[
cu¼_sh­e
->
i_š¡ªû_of_şass
].
	`push_back
(
Ãw_obj
);

357 
row_šd
 = 0;„ow_šd < 
cu¼_sh­e
->
i_height
;„ow_ind++) {

358 
cŞ_šd
 = 0; cŞ_šd < 
cu¼_sh­e
->
i_width
; col_ind++){

359 
m_fÜground_m©rix
[
y
 + 
row_šd
 + 
row_¿nge_¡¬t
]

360 [
x
 + 
cŞ_šd
 + 
cŞ_¿nge_¡¬t
] = 0;

366 
	}
}

377 
	gCÏssAg’t
::
	$ÿlc_objeù_v–oc™›s
() {

378 
şass_úŒ
 = 0; cÏss_úŒ < 
i_num_şas£s
; class_cntr++) {

379 
obj_úŒ
 = 0;

380 
obj_úŒ
 < (*
pv_cu¼_şs_š¡_m­
)[
şass_úŒ
].
	`size
();

381 
obj_úŒ
++) {

382 
BlobObjeù
& 
cu¼_obj
 = (*
pv_cu¼_şs_š¡_m­
)[
şass_úŒ
][
obj_úŒ
];

384 
şo£¡_di¡ªû_sq
 = 999;

385  
´ev_obj_úŒ
 = 0;

386 
´ev_obj_úŒ
 < (*
pv_´ev_şs_š¡_m­
)[
şass_úŒ
].
	`size
();

387 
´ev_obj_úŒ
++ ) {

388 
BlobObjeù
 
´ev_obj
 = (*
pv_´ev_şs_š¡_m­
)[
şass_úŒ
]

389 [
´ev_obj_úŒ
];

390 
di¡
 = 
cu¼_obj
.
	`ÿlc_di¡ªû_max_xy
(&
´ev_obj
);

391 
	`as£¹
 (
di¡
 >= 0);

392 ià(
di¡
 <ğ
i_max_obj_v–oc™y
 &&

393 
di¡
 < 
şo£¡_di¡ªû_sq
) {

394 
cu¼_obj
.
i_v–oc™y_x
 = cu¼_obj.
i_ûÁ”_x
 -

395 
´ev_obj
.
i_ûÁ”_x
;

396 
cu¼_obj
.
i_v–oc™y_y
 = cu¼_obj.
i_ûÁ”_y
 -

397 
´ev_obj
.
i_ûÁ”_y
;

398 
şo£¡_di¡ªû_sq
 = 
di¡
;

403 
	}
}

409 
	gCÏssAg’t
::
	$sw­_cu¼_ªd_´ev_şass_š¡ªûs
() {

410 
d–‘e
 
pv_´ev_şs_š¡_m­
;

411 
pv_´ev_şs_š¡_m­
 = 
pv_cu¼_şs_š¡_m­
;

412 
pv_cu¼_şs_š¡_m­
 = 
Ãw
 
CÏssIn¡ªûsM­
;

413 
i
 = 0; i < 
i_num_şas£s
; i++) {

414 
veùÜ
<
BlobObjeù
> 
v_cu¼
;

415 
pv_cu¼_şs_š¡_m­
->
	`push_back
(
v_cu¼
);

417 
	}
}

424 
	gCÏssAg’t
::
	$exŒaù_fÜground
() {

425 
v_fÜground_x_šd
.
	`ş—r
();

426 
v_fÜground_y_šd
.
	`ş—r
();

427 
i
 = 0; i < 
i_sü“n_height
; i++) {

428 
j
 = 0; j < 
i_sü“n_width
; j++) {

429 ià((*
pm_cu¼_sü“n_m©rix
)[
i
][
j
] !ğ(*
pm_background_m¬ix
)[i][j]){

430 
v_fÜground_y_šd
.
	`push_back
(
i
);

431 
v_fÜground_x_šd
.
	`push_back
(
j
);

432 
m_fÜground_m©rix
[
i
][
j
] = 1;

434 
m_fÜground_m©rix
[
i
][
j
] = 0;

438 
	}
}

444 
	gCÏssAg’t
::
	$g‘_sÿËd_pos™iÚ
Ğ
BlobObjeù
& 
blob_obj
,

445 & 
x_sÿËd
, & 
y_sÿËd
) {

446 
x_sÿËd
 = 
blob_obj
.
i_ûÁ”_x
 * 
f_abs_pos_sÿË_çùÜ_x
;

447 
y_sÿËd
 = 
blob_obj
.
i_ûÁ”_y
 * 
f_abs_pos_sÿË_çùÜ_y
;

448 
	`as£¹
 (
x_sÿËd
 >ğ0 && x_sÿËd <ğ
i_num_»ùªgËs
 &&

449 
y_sÿËd
 >ğ0 && y_sÿËd <ğ
i_num_»ùªgËs
);

450 
	}
}

456 
	gCÏssAg’t
::
	$g‘_sÿËd_»Ïtive_pos™iÚ
Ğ
BlobObjeù
& 
obj_a
,

457 
BlobObjeù
& 
obj_b
, & 
x_sÿËd
, & 
y_sÿËd
) {

458 
»l_x
 = 
obj_a
.
i_ûÁ”_x
 - 
obj_b
.i_center_x;

459 
»l_y
 = 
obj_a
.
i_ûÁ”_y
 - 
obj_b
.i_center_y;

460 
x_sÿËd
 = ()(
»l_x
 + 
i_sü“n_width
è* 
f_»l_pos_sÿË_çùÜ_x
;

461 
y_sÿËd
 = ()(
»l_y
 + 
i_sü“n_height
è* 
f_»l_pos_sÿË_çùÜ_y
;

462 
	`as£¹
 (
x_sÿËd
 >ğ0 && x_sÿËd <ğ
i_num_»ùªgËs
 &&

463 
y_sÿËd
 >ğ0 && y_sÿËd <ğ
i_num_»ùªgËs
);

464 
	}
}

470 
	gCÏssAg’t
::
	$g‘_sÿËd_»Ïtive_v–oc™y
(
BlobObjeù
& 
obj_a
,

471 
BlobObjeù
& 
obj_b
, & 
»l_v–_x_sÿËd
, & 
»l_v–_y_sÿËd
) {

472 
»l_v–_x
 = 
obj_a
.
i_v–oc™y_x
 - 
obj_b
.i_velocity_x;

473 
»l_v–_y
 = 
obj_a
.
i_v–oc™y_y
 - 
obj_b
.i_velocity_y;

478 
	`bound
(
»l_v–_x
, -
i_max_obj_v–_h®f
, i_max_obj_vel_half);

479 
	`bound
(
»l_v–_y
, -
i_max_obj_v–_h®f
, i_max_obj_vel_half);

480 
»l_v–_x_sÿËd
 = ()(
»l_v–_x
 + 
i_max_obj_v–_h®f
) *

481 
f_v–_sÿË_çùÜ
;

482 
»l_v–_y_sÿËd
 = ()(
»l_v–_y
 + 
i_max_obj_v–_h®f
) *

483 
f_v–_sÿË_çùÜ
;

484 
	`as£¹
 (
»l_v–_x_sÿËd
 >ğ0 &&„–_v–_x_sÿËd <ğ
i_num_»ùªgËs
 &&

485 
»l_v–_y_sÿËd
 >ğ0 &&„–_v–_y_sÿËd <ğ
i_num_»ùªgËs
);

486 
	}
}

492 
	gCÏssAg’t
::
	$g‘_bš¬y_»Ïtive_v–oc™y
(
BlobObjeù
& 
obj_a
, BlobObjeù& 
obj_b
,

493 
boŞ
& 
is_­´ßchšg_x
, boŞ& 
is_­´ßchšg_y
) {

494 
»l_v–_x
, 
»l_v–_y
;

495 ià(
obj_a
.
i_ûÁ”_x
 < 
obj_b
.i_center_x) {

497 
»l_v–_x
 = 
obj_b
.
i_v–oc™y_x
 - 
obj_a
.i_velocity_x;

500 
»l_v–_x
 = 
obj_a
.
i_v–oc™y_x
 - 
obj_b
.i_velocity_x;

502 ià(
obj_a
.
i_ûÁ”_y
 < 
obj_b
.i_center_y) {

504 
»l_v–_y
 = 
obj_b
.
i_v–oc™y_y
 - 
obj_a
.i_velocity_y;

507 
»l_v–_y
 = 
obj_a
.
i_v–oc™y_y
 - 
obj_b
.i_velocity_y;

509 ià(
»l_v–_x
 < 0 ) {

510 
is_­´ßchšg_x
 = 
Œue
;

512 
is_­´ßchšg_x
 = 
çl£
;

514 ià(
»l_v–_y
 < 0 ) {

515 
is_­´ßchšg_y
 = 
Œue
;

517 
is_­´ßchšg_y
 = 
çl£
;

519 
	}
}

524 
	gCÏssAg’t
::
	$­³nd_to_ã©u»_vec
(
IÁA¼
* 
Ãw_vec
, 
size
, 
a
) {

525 
i
 = 0; i < 
size
; i++) {

526 
cu¼_šd
 = (*
pv_num_nÚz”o_š_f
)[
a
];

527 (*
pv_cu¼_ã©u»_m­
)[
a
][
cu¼_šd
] = (*
Ãw_vec
)[
i
];

528 (*
pv_num_nÚz”o_š_f
)[
a
] = (*pv_num_nonzero_in_f)[a] + 1;

530 
	}
}

536 
	gCÏssAg’t
::
	$¶Ù_cu¼’t_şass_š¡ªûs
() {

538 
IÁM©rix
* 
pv_sü“n_cİy
 = 
Ãw
 
	`IÁM©rix
(*
pm_cu¼_sü“n_m©rix
);

540 
cŞÜ_šdex
 = 300;

541 
şass_couÁ”
 = 0; cÏss_couÁ” < 
i_num_şas£s
;class_counter++) {

542 
cŞÜ_šdex
++;

543  
š¡_couÁ”
 = 0;

544 
š¡_couÁ”
 < (*
pv_cu¼_şs_š¡_m­
)[
şass_couÁ”
].
	`size
();

545 
š¡_couÁ”
++ ) {

546 
BlobObjeù
 
obj
 =(*
pv_cu¼_şs_š¡_m­
)[
şass_couÁ”
][
š¡_couÁ”
];

548 
x
 = 
obj
.
i_ûÁ”_x
 - 2; x <= obj.i_center_x + 2; x++) {

549 
y
 = 
obj
.
i_ûÁ”_y
 - 2; y <= obj.i_center_y + 2; y++) {

550 ià(
x
 >ğ0 && x < 
i_sü“n_width
 &&

551 
y
 >ğ0 && y < 
i_sü“n_height
) {

552 (*
pv_sü“n_cİy
)[
y
][
x
] = 
cŞÜ_šdex
;

557 
	`d¿w_lše
Ğ
obj
.
i_ûÁ”_x
, obj.
i_ûÁ”_y
,

558 
obj
.
i_ûÁ”_x
 + obj.
i_v–oc™y_x
,

559 
obj
.
i_ûÁ”_y
 + obj.
i_v–oc™y_y
,

560 
pv_sü“n_cİy
);

564 
o¡ršg¡»am
 
f’ame
;

565 
bufãr
 [50];

566 
	`¥rštf
 (
bufãr
, "%09Îd", 
i_äame_couÁ”
);

567 
f’ame
 << "şass_š¡ªûs__äame_" << 
bufãr
 << ".png";

568 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
pv_sü“n_cİy
, 
f’ame
.
	`¡r
());

569 
d–‘e
 
pv_sü“n_cİy
;

570 
	}
}

576 
	gCÏssAg’t
::
	$d¿w_lše
Ğ
x1
, 
y1
,

577 
x2
, 
y2
, 
IÁM©rix
* 
pv_sü“n
,

578 
cŞÜ_šd
){

579 
xdiff
 = (
x2
 - 
x1
);

580 
ydiff
 = (
y2
 - 
y1
);

582 if(
xdiff
 =ğ0 && 
ydiff
 == 0) {

583 (*
pv_sü“n
)[
y1
][
x1
] = 
cŞÜ_šd
;

587 if(
	`abs
(
xdiff
è>‡bs(
ydiff
)) {

588 
xmš
, 
xmax
;

592 ià(
x1
 < 
x2
) {

593 
xmš
 = 
x1
;

594 
xmax
 = 
x2
;

596 
xmš
 = 
x2
;

597 
xmax
 = 
x1
;

601 
¦İe
 = ()
ydiff
 / ()
xdiff
;

602 
x
 = 
xmš
; x <ğ
xmax
; x += 1) {

603 
y
 = 
y1
 + ()((
x
 - 
x1
è* 
¦İe
);

604 ià(
x
 >ğ0 && x < 
i_sü“n_width
 &&

605 
y
 >ğ0 && y < 
i_sü“n_height
) {

606 (*
pv_sü“n
)[
y
][
x
] = 
cŞÜ_šd
;

610 
ymš
, 
ymax
;

614 ià(
y1
 < 
y2
) {

615 
ymš
 = 
y1
;

616 
ymax
 = 
y2
;

618 
ymš
 = 
y2
;

619 
ymax
 = 
y1
;

623 
¦İe
 = ()
xdiff
 / ()
ydiff
;

624 
y
 = 
ymš
; y <ğ
ymax
; y += 1) {

625 
x
 = 
x1
 + ()((
y
 - 
y1
è* 
¦İe
);

626 ià(
x
 >ğ0 && x < 
i_sü“n_width
 &&

627 
y
 >ğ0 && y < 
i_sü“n_height
) {

628 (*
pv_sü“n
)[
y
][
x
] = 
cŞÜ_šd
;

632 
	}
}

	@player_agents/class_agent.h

17 #iâdeà
CLASS_AGENT_H


18 
	#CLASS_AGENT_H


	)

20 
	~<veùÜ
>

21 
	~"commÚ_cÚ¡ªts.h
"

22 
	~"¶ay”_ag’t.h
"

23 
	~"blob_objeù.h
"

24 
	~"¾_§r§_Ïmbda.h
"

25 
	~"şass_sh­e.h
"

27 
	gveùÜ
< 
	tveùÜ
<
	tBlobObjeù
> > 
	tCÏssIn¡ªûsM­
;

29 şas 
	cCÏssAg’t
 : 
public
 
PÏy”Ag’t
 {

92 
public
:

93 
CÏssAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

94 
	mvœtu®
 ~
CÏssAg’t
();

100 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

101 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

102 
äame_numb”
);

107 
vœtu®
 
Ú_’d_of_game
();

112 
vœtu®
 
AùiÚ
 
Ú_¡¬t_of_game
();

114 
	m´Ùeùed
:

118 
vœtu®
 
ÿlc_ã©u»_vec_size
();

138 
vœtu®
 
g’”©e_ã©u»_vec
();

146 
g‘_şass_š¡ªûs_Ú_sü“n
();

155 
ÿlc_objeù_v–oc™›s
();

160 
sw­_cu¼_ªd_´ev_şass_š¡ªûs
();

167 
exŒaù_fÜground
();

173 
¶Ù_cu¼’t_şass_š¡ªûs
();

178 
d¿w_lše
(
x1
, 
y1
, 
x2
, 
y2
, 
IÁM©rix
* 
pv_sü“n
,

179 
cŞÜ_šd
 = 256);

185 
g‘_sÿËd_pos™iÚ
(
BlobObjeù
& 
blob_obj
,

186 & 
x_sÿËd
, & 
y_sÿËd
);

192 
g‘_sÿËd_»Ïtive_pos™iÚ
(
BlobObjeù
& 
obj_a
, BlobObjeù& 
obj_b
,

193 & 
x_sÿËd
, & 
y_sÿËd
);

199 
g‘_sÿËd_»Ïtive_v–oc™y
(
BlobObjeù
& 
obj_a
, BlobObjeù& 
obj_b
,

200 & 
»l_v–_x_sÿËd
,

201 & 
»l_v–_y_sÿËd
);

207 
g‘_bš¬y_»Ïtive_v–oc™y
(
BlobObjeù
& 
obj_a
, BlobObjeù& 
obj_b
,

208 
boŞ
& 
is_­´ßchšg_x
,

209 
boŞ
& 
is_­´ßchšg_y
);

215 
­³nd_to_ã©u»_vec
(
IÁA¼
* 
Ãw_vec
, 
size
, 
a
);

220 
šlše
 
	$add_Úe_šdex_to_ã©u»_m­
(
Úe_šdex
, 
a
) {

221 (*
pv_cu¼_ã©u»_m­
)[
a
][(*
pv_num_nÚz”o_š_f
)[a]] = 
Úe_šdex
 ;

222 (*
pv_num_nÚz”o_š_f
)[
a
] = (*pv_num_nonzero_in_f)[a] + 1;

226 
boŞ
 
b_šc_abs_pos™iÚs
;

227 
i_num_tšgs
;

228 
i_num_»ùªgËs
;

229 
i_mem_size_muÉ
;

230 
i_mem_size_2d
;

231 
i_mem_size_4d
;

232 
F—tu»M­
* 
pv_cu¼_ã©u»_m­
;

233 
IÁVeù
* 
pv_num_nÚz”o_š_f
;

234 
RLS¬§Lambda
* 
p_§r§_Ïmbda_sŞv”
;

235 
i_fuÎ_ã©u»_vec_Ëngth
;

236 
f_®pha_muÉl›r
;

237 
i_num_şas£s
;

238 
i_num_şass_·œs
;

239 
IÁM©rix
* 
pm_background_m¬ix
;

240 
Sh­eLi¡
* 
pv_sÜ‹d_sh­e_li¡
;

241 
CÏssIn¡ªûsM­
* 
pv_cu¼_şs_š¡_m­
;

242 
CÏssIn¡ªûsM­
* 
pv_´ev_şs_š¡_m­
;

243 
IÁM©rix
 
m_fÜground_m©rix
;

244 
IÁVeù
 
v_fÜground_y_šd
;

245 
IÁVeù
 
v_fÜground_x_šd
;

246 
i_sü“n_height
;

247 
i_sü“n_width
;

248 
f_abs_pos_sÿË_çùÜ_x
;

249 
f_abs_pos_sÿË_çùÜ_y
;

250 
f_»l_pos_sÿË_çùÜ_x
;

251 
f_»l_pos_sÿË_çùÜ_y
;

252 
f_v–_sÿË_çùÜ
;

253 
IÁA¼
* 
pv_tmp_abs_šd
;

254 
IÁA¼
* 
pv_tmp_»l_šd
;

255 
pf_tmp_æßt_¬r
[
MAX_NUM_TILING_VARS
];

256 
i_¶Ù_şass_š¡_äq
;

257 
boŞ
 
b_’d_•isode_w™h_»w¬d
;

258 
i_max_obj_v–oc™y
;

259 
i_max_obj_v–_h®f
;

260 
i_max_num_d‘eùed_š¡aûs
;

261 
	}
};

	@player_agents/class_discovery.cpp

17 
	~"expÜt_toŞs.h
"

18 
	~"blob_objeù.h
"

19 
	~"veùÜ_m©rix_toŞs.h
"

20 
	~"FSNode.hxx
"

21 
	~"game_cÚŒŞËr.h
"

22 
	~"şass_discov”y.h
"

24 
	gCÏssDiscov”y
::
	$CÏssDiscov”y
(
OSy¡em
* 
_osy¡em
) {

25 
p_osy¡em
 = 
_osy¡em
;

26 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

27 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

28 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

29 
S‘tšgs
& 
£‰šgs
 = 
p_osy¡em
->
	`£‰šgs
();

30 
f_max_³rc_difã»nû
 = 
£‰šgs
.
	`g‘Flßt
("max_³rc_difã»nû", 
Œue
);

31 
i_max_obj_v–oc™y
 = 
£‰šgs
.
	`g‘IÁ
("max_obj_v–oc™y", 
Œue
);

32 
f_max_sh­e_¬—_dif
 = 
£‰šgs
.
	`g‘Flßt
("max_sh­e_¬—_dif", 
Œue
);

33 
i_max_num_sü“ns
 = 
£‰šgs
.
	`g‘IÁ
("şs_disc_äames_num", 
Œue
);

34 
f_mš_Ú_äame_¿tio
 = 
£‰šgs
.
	`g‘Flßt
("mš_Ú_äame_¿tio", 
Œue
);

35 
i_mš_bound¬y_Ëngth
 = 
£‰šgs
.
	`g‘IÁ
("mš_bound¬y_Ëngth", 
Œue
);

36 
i_max_num_şas£s
 = 
£‰šgs
.
	`g‘IÁ
("max_num_şas£s", 
Œue
);

37 
b_¶Ù_´e_f‹r_şas£s
 = 
£‰šgs
.
	`g‘BoŞ
("¶Ù_´e_f‹r_şas£s", 
Œue
);

38 
b_¶Ù_po¡_f‹r_şas£s
 = 
£‰šgs
.
	`g‘BoŞ
("¶Ù_po¡_f‹r_şas£s", 
Œue
);

39 
i_num_sü“ns
 = 0;

41 
pm_background_m©rix
 = 
Ãw
 
IÁM©rix
;

42 
	`impÜt_m©rix
(
pm_background_m©rix
, "background_matrix.txt");

44 
p_»giÚ_mªag”
 = 
Ãw
 
	`RegiÚMªag”
(
p_osy¡em
, 
pm_background_m©rix
);

46 
pv_cu¼_sü“n_objeùs
 = 
NULL
;

47 
pv_´ev_sü“n_objeùs
 = 
NULL
;

48 
pv_discov”ed_şas£s
 = 
Ãw
 
BlobCÏssLi¡
;

49 
	}
}

51 
	gCÏssDiscov”y
::~
	$CÏssDiscov”y
() {

52 
d–‘e
 
p_»giÚ_mªag”
;

53 
d–‘e
 
pm_background_m©rix
;

54 
	`ş—r_li¡_of_poš‹rs
(
pv_discov”ed_şas£s
);

55 
d–‘e
 
pv_discov”ed_şas£s
;

56 
	}
}

62 
	gCÏssDiscov”y
::
	$g‘_Ãw_sü“n
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

63 
äame_numb”
) {

64 ià(
äame_numb”
 < 1000) {

67 ià(
i_num_sü“ns
 > 
i_max_num_sü“ns
 || 
pv_discov”ed_şas£s
->
	`size
() > 200) {

70 
pv_´ev_sü“n_objeùs
 = 
pv_cu¼_sü“n_objeùs
;

72 
pv_cu¼_sü“n_objeùs
 = 
p_»giÚ_mªag”
->
	`exŒaù_objeùs_äom_Ãw_sü“n
(

73 
sü“n_m©rix
, 
äame_numb”
);

75 
i
 = 0; i < 
pv_cu¼_sü“n_objeùs
->
	`size
(); i++) {

76 
RegiÚObjeù
* 
obj
 = (*
pv_cu¼_sü“n_objeùs
)[
i
];

78 
boŞ
 
obj_š_şass_li¡
 = 
çl£
;

79 
c
 = 0; c < 
pv_discov”ed_şas£s
->
	`size
(); c++) {

80 
BlobCÏss
* 
disc_şass
 = (*
pv_discov”ed_şas£s
)[
c
];

81 
boŞ
 
æ_hÜz
, 
æ_v”t
, 
diff_size
;

82 ià(
	`objeù_b–Úgs_to_şass
(
disc_şass
, 
obj
, 
æ_hÜz
,

83 
æ_v”t
, 
diff_size
)) {

84 
obj_š_şass_li¡
 = 
Œue
;

85 
disc_şass
->
i_num_äames_Ú_sü
++;

86 
disc_şass
->
	`upd©e_sü“n_boudÇr›s
(
obj
);

87 
obj
->
i_š¡ªû_of_şass
 = 
c
;

88 ià(
æ_hÜz
 || 
æ_v”t
 || 
diff_size
) {

92 
disc_şass
->
	`add_objeù
(
obj
, 
äame_numb”
,

97 
disc_şass
->
	`šü—£_obj_Úsü“n_couÁ
(
obj
);

102 ià(
obj_š_şass_li¡
) {

108 
RegiÚObjeù
* 
´ev_obj
 = 
NULL
;

109 ià(
pv_´ev_sü“n_objeùs
) {

110 
´ev_obj
 = 
obj
->
	`g‘_şo£¡_obj_š_li¡
(

111 
pv_´ev_sü“n_objeùs
,…v_´ev_sü“n_objeùs->
	`size
(),

112 
f_max_sh­e_¬—_dif
, 
f_max_³rc_difã»nû
,

113 
i_max_obj_v–oc™y
);

115 ià(
´ev_obj
) {

118 
obj
->
i_š¡ªû_of_şass
 = 
´ev_obj
->i_instance_of_class;

119 
BlobCÏss
* 
rg‘_şass
 = (*
pv_discov”ed_şas£s
)[

120 
´ev_obj
->
i_š¡ªû_of_şass
];

121 
¡ršg
 
disc_¡r
 = "Sim-Obj on Previous Frame";

122 
rg‘_şass
->
	`add_objeù
(
obj
, 
äame_numb”
, 
disc_¡r
);

123 
rg‘_şass
->
i_num_äames_Ú_sü
++;

128 
BlobCÏss
* 
Ãw_şass
 = 
Ãw
 
	`BlobCÏss
();

129 
Ãw_şass
->
i_discov”ed_Ú_äame
 = 
äame_numb”
;

130 
Ãw_şass
->
i_num_äames_Ú_sü
 = 1;

131 
¡ršg
 
disc_¡r
 = "Brand New";

132 
Ãw_şass
->
	`add_objeù
(
obj
, 
äame_numb”
, 
disc_¡r
);

133 
obj
->
i_š¡ªû_of_şass
 = 
pv_discov”ed_şas£s
->
	`size
();

134 
pv_discov”ed_şas£s
->
	`push_back
(
Ãw_şass
);

135 ià(
pv_discov”ed_şas£s
->
	`size
() > 200) {

136 
cout
 << "Warning:‚umber of discovered classesƒxceeds 200."

137 << "Th»maššg cÏs£ w bignÜed" << 
’dl
;

141 ià(
i_num_sü“ns
 =ğ
i_max_num_sü“ns
 || 
pv_discov”ed_şas£s
->
	`size
() > 200) {

142 ià(
b_¶Ù_´e_f‹r_şas£s
) {

143 
cout
 << "Plottinghe (pre-filter) discovered classes...";

144 
	`¶Ù_şas£s
(
çl£
, false);

145 
cout
 << " dÚe." << 
’dl
;

147 
cout
 << "Filtering classes...";

148 
	`f‹r_şas£s
();

149 
cout
 << " dÚe." << 
’dl
;

150 
cout
 << "Plottinghe (post-filter) discovered classes...";

151 
	`¶Ù_şas£s
(
Œue
, 
çl£
);

152 
cout
 << " dÚe." << 
’dl
;

153 ià(
pv_discov”ed_şas£s
->
	`size
(è> 
i_max_num_şas£s
) {

154 
cout
 << "Mergingogether classes...";

155 
	`m”ge_şas£s
();

156 
cout
 << " dÚe." << 
’dl
;

157 ià(
b_¶Ù_po¡_f‹r_şas£s
) {

158 
cout
 << "Plottinghe (post-merge) discovered classes...";

159 
	`¶Ù_şas£s
(
Œue
,rue);

160 
cout
 << " dÚe." << 
’dl
;

163 
cout
 << "Exporting discovered classes...";

164 
	`expÜt_şass_sh­es
();

165 
cout
 << " dÚe." << 
’dl
;

167 
i_num_sü“ns
++;

168 
	}
}

174 
	gCÏssDiscov”y
::
	$f‹r_şas£s
() {

175 
BlobCÏssLi¡
* 
pv_f‹»d_şas£s
 = 
Ãw
 BlobClassList;

176 
mš_bound¬y_Ën_sq
 = (
i_mš_bound¬y_Ëngth
 * i_min_boundary_length);

177 
f‹»d_şas£s_couÁ”
 = 0;

178 
c
 = 0; c < 
pv_discov”ed_şas£s
->
	`size
(); c++) {

179 
BlobCÏss
* 
cu¼_şass
 = (*
pv_discov”ed_şas£s
)[
c
];

180 
Ú_äame_¿tio
 = ()
cu¼_şass
->
i_num_äames_Ú_sü
 /

181 ()
i_num_sü“ns
;

182 
boŞ
 
k“p_şass
 = 
Œue
;

183 ià(
Ú_äame_¿tio
 < 
f_mš_Ú_äame_¿tio
) {

184 
k“p_şass
 = 
çl£
;

186 
d–_x
 = 
cu¼_şass
->
i_sü“n_pos_x_max
 -

187 
cu¼_şass
->
i_sü“n_pos_x_mš
;

188 
d–_y
 = 
cu¼_şass
->
i_sü“n_pos_x_max
 -

189 
cu¼_şass
->
i_sü“n_pos_x_mš
;

190 ià(
d–_x
 < 
i_mš_bound¬y_Ëngth
 &&

191 
d–_y
 < 
i_mš_bound¬y_Ëngth
 &&

192 (
d–_x
 * 
d–_y
è< 
mš_bound¬y_Ën_sq
) {

193 
k“p_şass
 = 
çl£
;

195 ià(
k“p_şass
) {

196 
pv_f‹»d_şas£s
->
	`push_back
(
cu¼_şass
);

197 
cu¼_şass
->
	`upd©e_şass_numb”
(
f‹»d_şas£s_couÁ”
);

198 
f‹»d_şas£s_couÁ”
++;

200 
d–‘e
 
cu¼_şass
;

201 (*
pv_discov”ed_şas£s
)[
c
] = 
NULL
;

204 
BlobCÏssLi¡
* 
to_be_d–‘ed
 = 
pv_discov”ed_şas£s
;

205 
pv_discov”ed_şas£s
 = 
pv_f‹»d_şas£s
;

206 
d–‘e
 
to_be_d–‘ed
;

207 
	}
}

213 
	gCÏssDiscov”y
::
	$m”ge_şas£s
() {

214 
num_m”ges
 = 0;

215 
pv_discov”ed_şas£s
->
	`size
(è> 
i_max_num_şas£s
) {

217 
şo£¡_di¡
 = -1;

218 
m”ge_šd_a
 = -1;

219 
m”ge_šd_b
 = -1;

220 
i
 = 0; i < 
pv_discov”ed_şas£s
->
	`size
(); i++) {

221 
j
 = 
i
 + 1; j < 
pv_discov”ed_şas£s
->
	`size
(); j++) {

222 
di¡
;

223 
boŞ
 
di¡_v®id
 = (*
pv_discov”ed_şas£s
)[
i
]->
	`g‘_mš_di¡ªû
(

224 (*
pv_discov”ed_şas£s
)[
j
],

225 
f_max_sh­e_¬—_dif
, 
di¡
);

226 ià(!
di¡_v®id
) {

229 ià(
şo£¡_di¡
 < 0 || 
di¡
 < closest_dist) {

230 
şo£¡_di¡
 = 
di¡
;

231 
m”ge_šd_a
 = 
i
;

232 
m”ge_šd_b
 = 
j
;

236 ià(
m”ge_šd_a
 =ğ-1 || 
m”ge_šd_b
 == -1) {

237 
cout
 << "UÇbËØm”gşas£ dowÀtØ"<< 
i_max_num_şas£s


239 << 
’dl
;

243 (*
pv_discov”ed_şas£s
)[
m”ge_šd_b
]->
	`upd©e_şass_numb”
(
m”ge_šd_a
);

244 (*
pv_discov”ed_şas£s
)[
m”ge_šd_a
]->
	`m”ge_w™h
(

245 (*
pv_discov”ed_şas£s
)[
m”ge_šd_b
]);

246 
	`d–‘e
 (*
pv_discov”ed_şas£s
)[
m”ge_šd_b
];

247 (*
pv_discov”ed_şas£s
)[
m”ge_šd_b
] = 
NULL
;

248 
BlobCÏssLi¡
::
™”©Ü
 
d–‘e_™
 = 
pv_discov”ed_şas£s
->
	`begš
() +

249 
m”ge_šd_b
;

250 
	`as£¹
 ( (*
d–‘e_™
è=ğ
NULL
);

251 
pv_discov”ed_şas£s
->
	`”a£
(
d–‘e_™
);

252 
i
 = 
m”ge_šd_b
; i < 
pv_discov”ed_şas£s
->
	`size
(); i++) {

253 (*
pv_discov”ed_şas£s
)[
i
]->
	`upd©e_şass_numb”
(i);

259 
num_m”ges
++;

261 
cout
 << "M”ged " << 
num_m”ges
 << " cÏs£s." << 
’dl
;

262 
	}
}

269 
	gCÏssDiscov”y
::
	$¶Ù_şas£s
(
boŞ
 
po¡_f‹r
, boŞ 
po¡_m”ge
) {

270 
¡ršg
 
ba£_dœ
 = "disc_classes__";

271 ià(
po¡_m”ge
) {

272 
ba£_dœ
 += "post_merge";

273 } ià(
po¡_f‹r
) {

274 
ba£_dœ
 += "post_filter";

276 
ba£_dœ
 += "pre_filter";

278 if(!
Fesy¡emNode
::
	`dœExi¡s
(
ba£_dœ
)) {

279 
Fesy¡emNode
::
	`makeDœ
(
ba£_dœ
);

282 
c
 = 0; c < 
pv_discov”ed_şas£s
->
	`size
(); c++) {

283 
BlobCÏss
* 
cu¼_şass
 = (*
pv_discov”ed_şas£s
)[
c
];

284 
bufãr
[50];

285 
	`¥rštf
 (
bufãr
, "%03d", 
c
);

286 
¡ršg
 
sub_dœ
 = 
ba£_dœ
 + "/" + "şass_" + 
bufãr
;

287 if(!
Fesy¡emNode
::
	`dœExi¡s
(
sub_dœ
)) {

288 
Fesy¡emNode
::
	`makeDœ
(
sub_dœ
);

291 
¡ršg
 
šfo_fe
 = 
sub_dœ
 + "/class_info.txt";

292 
of¡»am
 
fe
;

293 
fe
.
	`İ’
(
šfo_fe
.
	`c_¡r
());

294 
fe
 << 
cu¼_şass
->
	`g‘_šfo_‹xt
(
i_num_sü“ns
è<< 
’dl
;

295 
fe
.
	`şo£
();

297 
j
 = 0; j < 
cu¼_şass
->
pv_»g_objeùs
->
	`size
(); j++) {

298 
RegiÚObjeù
* 
cu¼_obj
 = (*
cu¼_şass
->
pv_»g_objeùs
)[
j
];

299 
	`¥rštf
 (
bufãr
, "%04d", 
j
);

300 
šfo_fe
 = 
sub_dœ
 + "/objeù_šfo_" + 
bufãr
 + ".txt";

301 
fe
.
	`İ’
(
šfo_fe
.
	`c_¡r
());

302 
fe
 << 
cu¼_obj
->
	`g‘_šfo_‹xt
(è<< 
’dl
;

303 
fe
.
	`şo£
();

304 
¡ršg
 
¶Ù_fe
 = 
sub_dœ
 + "/objeù_šfo_" + 
bufãr
 + ".png";

305 
cu¼_obj
->
	`¶Ù
(
¶Ù_fe
,

306 
p_osy¡em
->
p_expÜt_sü“n
);

309 
	}
}

322 
	gCÏssDiscov”y
::
	$expÜt_şass_sh­es
() {

323 
RegiÚObjeùLi¡
 
sÜ‹d_objeùs
;

324 
c
 = 0; c < 
pv_discov”ed_şas£s
->
	`size
(); c++) {

325 
BlobCÏss
* 
cu¼_şass
 = (*
pv_discov”ed_şas£s
)[
c
];

326 
o
 = 0; o < 
cu¼_şass
->
pv_»g_objeùs
->
	`size
(); o++) {

327 
sÜ‹d_objeùs
.
	`push_back
((*
cu¼_şass
->
pv_»g_objeùs
)[
o
]);

330 
	`sÜt
(
sÜ‹d_objeùs
.
	`begš
(), sÜ‹d_objeùs.
	`’d
(),

331 
com·»_objeùs_by_sh­e_size
);

332 
num_sh­es
 = 
sÜ‹d_objeùs
.
	`size
();

333 
num_şas£s
 = 
pv_discov”ed_şas£s
->
	`size
();

334 
of¡»am
 
fe
;

335 
fe
.
	`İ’
("class_shapes.txt");

336 
fe
 << 
num_şas£s
 << "," << 
num_sh­es
 << 
’dl
;

337 
i
 = 0; i < 
num_sh­es
; i++) {

338 
fe
 << 
sÜ‹d_objeùs
[
i
]->
	`expÜt_objeù_as_txt
(è<< 
’dl
;

340 
	}
}

346 
boŞ
 
	gCÏssDiscov”y
::
	$objeù_b–Úgs_to_şass
(cÚ¡ 
BlobCÏss
* 
şs
,

347 cÚ¡ 
RegiÚObjeù
* 
obj
,

348 
boŞ
& 
æ_hÜz
, boŞ& 
æ_v”t
,

349 
boŞ
& 
diff_size
) {

350 
do_æ_hÜz
 = 0; do_flip_horz <= 1; do_flip_horz++) {

351 
do_æ_v”t
 = 0; do_flip_vert <= 1; do_flip_vert++) {

352 
do_diff_size
 = 0; do_diff_size <= 1; do_diff_size++) {

353 
æ_hÜz
 = (
boŞ
)
do_æ_hÜz
;

354 
æ_v”t
 = (
boŞ
)
do_æ_v”t
;

355 
diff_size
 = (
boŞ
)
do_diff_size
;

356 ià(
şs
->
	`b–Úgs
(
obj
, 
diff_size
, 
æ_hÜz
,

357 
æ_v”t
, 
f_max_sh­e_¬—_dif
)) {

358  
Œue
;

363  
çl£
;

364 
	}
}

	@player_agents/class_discovery.h

16 #iâdeà
CLASS_DISCOVERY_H


17 
	#CLASS_DISCOVERY_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"OSy¡em.hxx
"

21 
	~"»giÚ_mªag”.h
"

22 
	~"blob_objeù.h
"

23 
	~"blob_şass.h
"

25 
	gveùÜ
 < 
	tBlobCÏss
* > 
	tBlobCÏssLi¡
;

27 şas 
	cCÏssDiscov”y
 {

63 
	mpublic
:

64 
CÏssDiscov”y
(
OSy¡em
* 
_osy¡em
);

65 
	mvœtu®
 ~
CÏssDiscov”y
();

70 
vœtu®
 
g‘_Ãw_sü“n
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

71 
äame_numb”
);

76 
boŞ
 
	$is_şass_discov”y_com¶‘e
() {

77  (
i_num_sü“ns
 > 
i_max_num_sü“ns
);

80 
´Ùeùed
:

85 
boŞ
 
	`objeù_b–Úgs_to_şass
(cÚ¡ 
BlobCÏss
* 
şs
,

86 cÚ¡ 
RegiÚObjeù
* 
obj
,

87 
boŞ
& 
æ_hÜz
, boŞ& 
æ_v”t
,

88 
boŞ
& 
diff_size
);

95 
	`f‹r_şas£s
();

100 
	`m”ge_şas£s
();

107 
	`¶Ù_şas£s
(
boŞ
 
po¡_f‹r
, boŞ 
po¡_m”ge
);

120 
	`expÜt_şass_sh­es
();

122 
OSy¡em
* 
p_osy¡em
;

123 
IÁM©rix
* 
pm_background_m©rix
;

124 
RegiÚMªag”
* 
p_»giÚ_mªag”
;

125 cÚ¡ 
RegiÚObjeùLi¡
* 
pv_cu¼_sü“n_objeùs
;

126 cÚ¡ 
RegiÚObjeùLi¡
* 
pv_´ev_sü“n_objeùs
;

127 
BlobCÏssLi¡
* 
pv_discov”ed_şas£s
;

128 
i_sü“n_width
;

129 
i_sü“n_height
;

130 
i_num_sü“ns
;

131 
i_max_num_sü“ns
;

132 
f_max_³rc_difã»nû
;

133 
i_max_obj_v–oc™y
;

134 
f_max_sh­e_¬—_dif
;

135 
f_mš_Ú_äame_¿tio
;

136 
i_mš_bound¬y_Ëngth
;

137 
i_max_num_şas£s
;

138 
boŞ
 
b_¶Ù_´e_f‹r_şas£s
;

139 
boŞ
 
b_¶Ù_po¡_f‹r_şas£s
;

140 
	}
};

	@player_agents/class_shape.cpp

17 
	~<s¡»am
>

18 
	~<f¡»am
>

19 
	~"şass_sh­e.h
"

33 
	gCÏssSh­e
::
	$CÏssSh­e
Ğ
¡ršg
& 
impÜ‹d_txt
) {

34 
i¡ršg¡»am
 
	`¡»am
(
impÜ‹d_txt
);

35 
d–im
;

36 
¡»am
 >> 
i_š¡ªû_of_şass
;

37 
¡»am
.
	`g‘
(
d–im
);

38 ià(
d–im
 != ',') {

39 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

41 
¡»am
 >> 
i_width
;

42 
¡»am
.
	`g‘
(
d–im
);

43 ià(
d–im
 != ',') {

44 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

46 
¡»am
 >> 
i_height
;

47 
¡»am
.
	`g‘
(
d–im
);

48 ià(
d–im
 != '|') {

49 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

51 ià(
i_width
 <ğ0 || 
i_height
 <= 0) {

52 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

55 
pm_sh­e
 = 
Ãw
 
IÁM©rix
;

56 
b™_v®
;

57 
i
 = 0; i < 
i_height
; i++) {

58 
IÁVeù
 
row
;

59 
j
 = 0; j < 
i_width
; j++) {

60 
¡»am
 >> 
b™_v®
;

61 ià(
b™_v®
 != 0 && bit_val != 1) {

62 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

64 
¡»am
.
	`g‘
(
d–im
);

65 ià((
j
 < (
i_width
 - 1è&& 
d–im
 != ',') ||

66 (
j
 =ğ(
i_width
 - 1è&& 
d–im
 != '|')) {

67 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

69 
row
.
	`push_back
(
b™_v®
);

71 
pm_sh­e
->
	`push_back
(
row
);

74 
i_fœ¡_Úe_šd
 = -1;

75 
j
 = 0; j < 
i_width
; j++) {

76 ià((*
pm_sh­e
)[0][
j
] == 1) {

77 
i_fœ¡_Úe_šd
 = 
j
;

80 ià(
i_fœ¡_Úe_šd
 == -1) {

81 
	`com¶aš_ªd_ex™
(
impÜ‹d_txt
);

84 
cout
 << "sh­impÜ‹d sucûssfuÎy :)" << 
’dl
;

85 
	}
}

90 
	gCÏssSh­e
::~
	$CÏssSh­e
() {

91 ià(
pm_sh­e
) {

92 
d–‘e
 
pm_sh­e
;

94 
	}
}

99 
	gCÏssSh­e
::
	$´št_sh­e
() {

100 
cout
 << "In¡ªû oàCÏs #" << 
i_š¡ªû_of_şass
 << 
’dl
;

101 
cout
 << "width = " << 
i_width
 << " - heighˆğ" << 
i_height
 << 
’dl
;

102 
i
 = 0; i < 
i_height
; i++) {

103 
cout
 << "\t";

104 
j
 = 0; j < 
i_width
; j++) {

105 
cout
 << (*
pm_sh­e
)[
i
][
j
];

107 
cout
 << 
’dl
;

109 
	}
}

116 
	gCÏssSh­e
::
	$com¶aš_ªd_ex™
(
¡ršg
& 
impÜ‹d_txt
) {

117 
û¼
 << "Bad fÜm© iÀthgiv’ cÏss-sh­impÜˆ‹xt: " << 
’dl
;

118 
û¼
 << "\t" << 
impÜ‹d_txt
 << 
’dl
;

119 
û¼
 << "Th´İ” sŒšg fÜm© i a fŞlows: " << 
’dl
;

120 
û¼
 << " width,height| " << 
’dl
;

121 
û¼
 << " M[0,0], M[0,1], ..., M[0,n]| " << 
’dl
;

122 
û¼
 << " M[1,0], M[1,1], ..., M[1,n]| " << 
’dl
;

123 
û¼
 << " ... " << 
’dl
;

124 
û¼
 << " M[m,0], M[m,1], ..., M[m,n]| " << 
’dl
;

125 
	`ex™
(-1);

126 
	}
}

141 
Sh­eLi¡
* 
	gCÏssSh­e
::
	$impÜt_sh­e_li¡
(
¡ršg
 
f’ame
, & 
num_şas£s
) {

142 
if¡»am
 
šfe
;

143 
šfe
.
	`İ’
(
f’ame
.
	`c_¡r
());

144 
¡ršg
 
”r_¡r
 = "Unableo import class-shapes fromhe given file:" +

145 
f’ame
;

146 ià(!
šfe
) {

147 
throw
 
”r_¡r
;

149 
šfe
 >> 
num_şas£s
;

150 ià(
num_şas£s
 <= 0) {

151 
throw
 
”r_¡r
;

153 
d–im
;

154 
šfe
.
	`g‘
(
d–im
);

155 ià(
d–im
 != ',') {

156 
throw
 
”r_¡r
;

158 
num_sh­es
;

159 
šfe
 >> 
num_sh­es
;

160 ià(
num_sh­es
 <= 0) {

161 
throw
 
”r_¡r
;

163 
Sh­eLi¡
* 
sh­e_li¡
 = 
Ãw
 ShapeList;

164 
buff_chr
[524288];

165 
i
 = 0; i < 
num_sh­es
; i++) {

166 
šfe
.
	`ignÜe
(1);

167 
šfe
.
	`g‘
(
buff_chr
, 524200, '\n');

168 
¡ršg
 
¡r
 = 
	`¡ršg
(
buff_chr
);

169 
CÏssSh­e
* 
p_Ãw_şass_sh­e
 = 
Ãw
 
	`CÏssSh­e
(
¡r
);

170 
p_Ãw_şass_sh­e
->
	`´št_sh­e
();

171 
sh­e_li¡
->
	`push_back
(
p_Ãw_şass_sh­e
);

173  
sh­e_li¡
;

174 
	}
}

	@player_agents/class_shape.h

17 #iâdeà
CLASS_SHAPE_H


18 
	#CLASS_SHAPE_H


	)

20 
	~<veùÜ
>

21 
	~"commÚ_cÚ¡ªts.h
"

23 
şass
 
	gCÏssSh­e
;

24 
	gveùÜ
<
	tCÏssSh­e
*> 
	tSh­eLi¡
;

26 şas 
	cCÏssSh­e
 {

42 
	mpublic
:

43 
	$CÏssSh­e
(è{
	`as£¹
(
çl£
);}

54 
	`CÏssSh­e
Ğ
¡ršg
& 
impÜ‹d_txt
);

55 
vœtu®
 ~
	`CÏssSh­e
();

60 
	`´št_sh­e
();

72 
Sh­eLi¡
* 
	`impÜt_sh­e_li¡
(
¡ršg
 
f’ame
, & 
num_şas£s
);

74 
IÁM©rix
* 
pm_sh­e
;

75 
i_width
, 
i_height
;

76 
i_fœ¡_Úe_šd
;

77 
i_š¡ªû_of_şass
;

78 
´Ùeùed
:

83 
	`com¶aš_ªd_ex™
(
¡ršg
& 
impÜ‹d_txt
);

84 
	}
};

	@player_agents/common_constants.cpp

16 
	~"commÚ_cÚ¡ªts.h
"

18 
¡ršg
 
	$aùiÚ_to_¡ršg
(
AùiÚ
 
a
) {

19 
¡ršg
 
tmp_aùiÚ_to_¡ršg
[] = {

64 
	`as£¹
 (
a
 >= 0 &&‡ <= 42);

65  
tmp_aùiÚ_to_¡ršg
[
a
];

66 
	}
}

	@player_agents/common_constants.h

15 #iâdeà
COMMON_CONSTANTS_H


16 
	#COMMON_CONSTANTS_H


	)

18 
	~<ÿs£¹
>

19 
	~<veùÜ
>

20 
	~<v®¬¿y
>

21 
	~<c¡dlib
>

22 
	~"b¥f.hxx
"

26 
	eAùiÚ
 {

27 
	mPLAYER_A_NOOP
 = 0,

28 
	mPLAYER_A_FIRE
 = 1,

29 
	mPLAYER_A_UP
 = 2,

30 
	mPLAYER_A_RIGHT
 = 3,

31 
	mPLAYER_A_LEFT
 = 4,

32 
	mPLAYER_A_DOWN
 = 5,

33 
	mPLAYER_A_UPRIGHT
 = 6,

34 
	mPLAYER_A_UPLEFT
 = 7,

35 
	mPLAYER_A_DOWNRIGHT
 = 8,

36 
	mPLAYER_A_DOWNLEFT
 = 9,

37 
	mPLAYER_A_UPFIRE
 = 10,

38 
	mPLAYER_A_RIGHTFIRE
 = 11,

39 
	mPLAYER_A_LEFTFIRE
 = 12,

40 
	mPLAYER_A_DOWNFIRE
 = 13,

41 
	mPLAYER_A_UPRIGHTFIRE
 = 14,

42 
	mPLAYER_A_UPLEFTFIRE
 = 15,

43 
	mPLAYER_A_DOWNRIGHTFIRE
 = 16,

44 
	mPLAYER_A_DOWNLEFTFIRE
 = 17,

45 
	mPLAYER_B_NOOP
 = 18,

46 
	mPLAYER_B_FIRE
 = 19,

47 
	mPLAYER_B_UP
 = 20,

48 
	mPLAYER_B_RIGHT
 = 21,

49 
	mPLAYER_B_LEFT
 = 22,

50 
	mPLAYER_B_DOWN
 = 23,

51 
	mPLAYER_B_UPRIGHT
 = 24,

52 
	mPLAYER_B_UPLEFT
 = 25,

53 
	mPLAYER_B_DOWNRIGHT
 = 26,

54 
	mPLAYER_B_DOWNLEFT
 = 27,

55 
	mPLAYER_B_UPFIRE
 = 28,

56 
	mPLAYER_B_RIGHTFIRE
 = 29,

57 
	mPLAYER_B_LEFTFIRE
 = 30,

58 
	mPLAYER_B_DOWNFIRE
 = 31,

59 
	mPLAYER_B_UPRIGHTFIRE
 = 32,

60 
	mPLAYER_B_UPLEFTFIRE
 = 33,

61 
	mPLAYER_B_DOWNRIGHTFIRE
 = 34,

62 
	mPLAYER_B_DOWNLEFTFIRE
 = 35,

63 
	mRESET
 = 40,

64 
	mUNDEFINED
 = 41,

65 
	mRANDOM
 = 42,

67 
	mLAST_ACTION_INDEX
 = 50

70 
¡ršg
 
aùiÚ_to_¡ršg
(
AùiÚ
 
a
);

72 
	eEpisodeStus
 {

73 
	mINITIAL_DELAY
,

74 
	mRESTART_DELAY
,

75 
	mSTART_EPISODE
,

76 
	mACTION_EXPLOR
,

77 
	mAGENT_ACTING
,

82 
	gv®¬¿y
<> 
	tIÁA¼
;

83 
	gv®¬¿y
<
	tboŞ
> 
	tB™A¼
;

84 
	gv®¬¿y
<> 
	tFlßtA¼
;

85 
	gveùÜ
<> 
	tIÁVeù
;

86 
	gveùÜ
<
	tAùiÚ
> 
	tAùiÚVeù
;

87 
	gveùÜ
<> 
	tFlßtVeù
;

88 
	gveùÜ
<
	tIÁVeù
> 
	tIÁM©rix
;

89 
	gveùÜ
<
	tFlßtVeù
> 
	tFlßtM©rix
;

90 
	gveùÜ
<
	tIÁA¼
> 
	tF—tu»M­
;

91 
şass
 
	gRegiÚObjeù
;

92 
	gveùÜ
 < 
	tRegiÚObjeù
* > 
	tRegiÚObjeùLi¡
;

94 
	#RAM_LENGTH
 128

	)

95 
	#MAX_NUM_TILING_VARS
 10

97 
	#CUSTOM_PALETTE_SIZE
 1020

98 
	#BLACK_COLOR_IND
 1000

99 
	#RED_COLOR_IND
 1001

100 
	#WHITE_COLOR_IND
 1003

101 
	#SECAM_COLOR_IND
 1010

104 

	)

	@player_agents/freeway_agent.cpp

16 
	~<s¡»am
>

17 
	~"ä“way_ag’t.h
"

18 
	~"şass_ag’t.h
"

19 
	~"expÜt_toŞs.h
"

20 
	~"game_cÚŒŞËr.h
"

21 
	~"tes2.h
"

22 
	~"¿ndom_toŞs.h
"

23 
	~"misc_toŞs.h
"

25 
	gF»ewayAg’t
::
	$F»ewayAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

26 
	$CÏssAg’t
(
_game_£‰šgs
, 
_osy¡em
) {

30 
cu¼_fuÎ_ã©u»_vec_Ëngth
 = 
i_fuÎ_ã©u»_vec_Ëngth
;

31 
	`ÿlc_ã©u»_vec_size
();

32 ià(
i_fuÎ_ã©u»_vec_Ëngth
 !ğ
cu¼_fuÎ_ã©u»_vec_Ëngth
) {

33 
cout
 << "F—tu»-veøsiznÙ s‘ cÜ»ùly fÜ F»eway‡g’t." << 
’dl
;

34 
û¼
 << "F—tu»-veøsiznÙ s‘ cÜ»ùly fÜ F»eway‡g’t." << 
’dl
;

35 
	`ex™
(-1);

38 
boŞ
 
İtimi¡ic_š™
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("İtimi¡ic_š™", 
Œue
);

39 ià(
İtimi¡ic_š™
) {

40 
weight_š™
 = 1.0 / ()(
i_num_tšgs
 * 11);

41 
cout
 << "S‘tšg‡Î weight tØ" << 
weight_š™
 << 
’dl
;

42 
i
 = 0; i < 
i_fuÎ_ã©u»_vec_Ëngth
; i++ ) {

43 (*(
p_§r§_Ïmbda_sŞv”
->
	`g‘_weights
()))[
i
] = 
weight_š™
;

47 
pm_debug_be¡_v®
 = 
Ãw
 
	`FlßtM©rix
();

48 
ÿrs_y
[] = {175, 160, 145, 128, 111, 96, 80, 64, 47, 32};

49 
v_debug_ÿr_y_v®s
 = 
veùÜ
<>(
ÿrs_y
, cars_y + 10);

50 
ÿrs_cŞÜ_šd
[] = {26, 216, 68, 136, 36, 130, 74, 18, 220, 66};

51 
v_debug_ÿr_cŞÜ_šd
 = 
veùÜ
<>(
ÿrs_cŞÜ_šd
, cars_color_ind + 10);

52 
ÿrs_v–
[] = {0.78, 0.96, 1.26, 1.93, 3.85, -3.64, -1.92,

54 
v_debug_ÿr_v–
 = 
veùÜ
<>(
ÿrs_v–
, cars_vel + 10);

55 
v_debug_ÿr_x_v®s
.
	`ş—r
();

56 
c
 = 0; c < 10; c ++) {

57 
v_debug_ÿr_x_v®s
.
	`push_back
(-1);

59 
	}
}

62 
	gF»ewayAg’t
::~
	$F»ewayAg’t
() {

63 
d–‘e
 
pm_debug_be¡_v®
;

64 
	}
}

69 
	gF»ewayAg’t
::
	$ÿlc_ã©u»_vec_size
() {

70 
i_fuÎ_ã©u»_vec_Ëngth
 = 
i_mem_size_2d
;

71 
i_fuÎ_ã©u»_vec_Ëngth
 +ğ(
i_mem_size_2d
 * 4);

72 
i_fuÎ_ã©u»_vec_Ëngth
++;

73 
	}
}

79 
AùiÚ
 
	gF»ewayAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

80 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

81 
äame_numb”
) {

82 
AùiÚ
 
»tuº_aùiÚ
 = 
CÏssAg’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

83 
äame_numb”
);

84 ià(
i_äame_couÁ”
 % 10 == 0) {

85 
	`¶Ù_be¡_v®ue_³r_¡©e
();

87  
»tuº_aùiÚ
;

88 
	}
}

93 
	gF»ewayAg’t
::
	$Ú_’d_of_game
() {

94 
CÏssAg’t
::
	`Ú_’d_of_game
();

95 ià(
çl£
) {

96 
	`as£¹
 (
pm_debug_be¡_v®
->
	`size
() > 0);

97 
FlßtVeù
 
Ãw_row2
;

98 
j
 = 0; j < (*
pm_debug_be¡_v®
)[0].
	`size
(); j ++) {

99 
Ãw_row2
.
	`push_back
(1314.0);

101 
pm_debug_be¡_v®
->
	`push_back
(
Ãw_row2
);

102 
pm_debug_be¡_v®
->
	`push_back
(
Ãw_row2
);

104 if(
i_•isode_couÁ”
 % 10 == 0) {

105 
o¡ršg¡»am
 
f’ame2
;

106 
f’ame2
 << "¡©e_v®ues__•isode_" << 
i_•isode_couÁ”
 << ".png";

107 
FlßtM©rix
* 
tmp_m©rix
 = 
Ãw
 
	`FlßtM©rix
(*
pm_debug_be¡_v®
);

108 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_h—t_¶Ù
(
tmp_m©rix
, 
f’ame2
.
	`¡r
());

109 
d–‘e
 
tmp_m©rix
;

112 
	}
}

118 
	gF»ewayAg’t
::
	$g’”©e_ã©u»_vec
() {

119 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

120 
¡¬t_šd
 = 0;

121 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

123 
¡¬t_šd
 +ğ
i_num_aùiÚs
;

124 
chick’_y
 = 
	`g‘_chick’_y
(
pm_cu¼_sü“n_m©rix
);

125 ià(
chick’_y
 == -1) {

126 
o¡ršg¡»am
 
f’ame
;

127 
f’ame
 << "chick_nÙ_found__" << 
i_äame_couÁ”
 << ".png";

128 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
pm_cu¼_sü“n_m©rix
, 
f’ame
.
	`¡r
());

130 
	`as£¹
(
chick’_y
 != -1);

131 
BlobObjeù
 
	`chick_obj
(48, 
chick’_y
);

132 
chick_sÿËd_x
, 
chick_sÿËd_y
;

133 
	`g‘_sÿËd_pos™iÚ
(
chick_obj
, 
chick_sÿËd_x
, 
chick_sÿËd_y
);

134 
pf_tmp_æßt_¬r
[0] = 
chick_sÿËd_y
;

135 
	`G‘Tes
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
i_mem_size_2d
,

136 
pf_tmp_æßt_¬r
, 1, 
a
);

137 (*
pv_tmp_abs_šd
è+ğ
¡¬t_šd
;

138 
	`­³nd_to_ã©u»_vec
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
a
);

139 
¡¬t_šd
 +ğ
i_mem_size_2d
;

142 
	`g‘_ÿrs_x
(
pm_cu¼_sü“n_m©rix
);

143 
c
 = 0; c < 10; c++) {

144 
BlobObjeù
 
	`ÿr_obj
(
v_debug_ÿr_x_v®s
[
c
], 
v_debug_ÿr_y_v®s
[c],

145 
v_debug_ÿr_v–
[
c
], 0.0);

146 
x_»l_sÿËd
, 
y_»l_sÿËd
;

147 
	`g‘_sÿËd_»Ïtive_pos™iÚ
(
chick_obj
, 
ÿr_obj
,

148 
x_»l_sÿËd
, 
y_»l_sÿËd
);

149 
boŞ
 
is_­´ßchšg_x
, 
is_­´ßchšg_y
;

150 
	`g‘_bš¬y_»Ïtive_v–oc™y
(
chick_obj
, 
ÿr_obj
,

151 
is_­´ßchšg_x
, 
is_­´ßchšg_y
);

152 
v–_off£t
 = 0;

153 ià(
is_­´ßchšg_x
) {

154 
v–_off£t
 += 1;

156 ià(
is_­´ßchšg_y
) {

157 
v–_off£t
 += 2;

159 
	`as£¹
(
v–_off£t
 >= 0 && vel_offset <= 3);

160 
v–_off£t
 = v–_off£ˆ* 
i_mem_size_2d
;

165 
pf_tmp_æßt_¬r
[0] = 
x_»l_sÿËd
;

166 
pf_tmp_æßt_¬r
[1] = 
y_»l_sÿËd
;

172 
off£t
 = 
¡¬t_šd
 + 
v–_off£t
;

173 
	`G‘Tes
(
pv_tmp_»l_šd
, 
i_num_tšgs
, 
i_mem_size_2d
,

174 
pf_tmp_æßt_¬r
, 2, 
a
, 
off£t
);

176 
	`­³nd_to_ã©u»_vec
(
pv_tmp_»l_šd
, 
i_num_tšgs
, 
a
);

178 
¡¬t_šd
 +ğ(4 * 
i_mem_size_2d
);

181 
	}
}

190 
	gF»ewayAg’t
::
	$¶Ù_be¡_v®ue_³r_¡©e
() {

191 
FlßtVeù
 
Ãw_row
;

192 
FlßtVeù
 
v_Q
;

193 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

194 
v_Q
.
	`push_back
(0);

197 
chick’_y
 = 23; chicken_y < 192;) {

198 
BlobObjeù
 
	`obj
Ğ47, 
chick’_y
);

200 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

201 
¡¬t_šd
 = 0;

202 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

203 
¡¬t_šd
 +ğ
i_num_aùiÚs
;

204 
sÿËd_x
, 
sÿËd_y
;

205 
	`g‘_sÿËd_pos™iÚ
(
obj
, 
sÿËd_x
, 
sÿËd_y
);

206 
pf_tmp_æßt_¬r
[0] = 
sÿËd_y
;

207 
	`G‘Tes
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
i_mem_size_2d
,

208 
pf_tmp_æßt_¬r
, 1, 
a
);

209 (*
pv_tmp_abs_šd
è+ğ
¡¬t_šd
;

210 
	`­³nd_to_ã©u»_vec
(
pv_tmp_abs_šd
, 
i_num_tšgs
, 
a
);

214 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

215 
v_Q
[
a
] = 0;

216 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
a
]; j++) {

217 
v_Q
[
a
] +ğ(*
p_§r§_Ïmbda_sŞv”
->
	`g‘_weights
())[(*
pv_cu¼_ã©u»_m­
)[a][
j
]];

221 
be¡_v®ue
 = 
v_Q
[0];

222 
a
 = 1;‡ < 
i_num_aùiÚs
;‡++) {

223 ià(
v_Q
[
a
] > 
be¡_v®ue
) {

224 
be¡_v®ue
 = 
v_Q
[
a
];

227 
Ãw_row
.
	`push_back
(
be¡_v®ue
);

229 
chick’_y
 += 4;

233 ià((*
pv_cu¼_şs_š¡_m­
)[2].
	`size
() > 0) {

234 
BlobObjeù
& 
obj
 = (*
pv_cu¼_şs_š¡_m­
)[2][0];

235 
chick’_»®_y
 = 
obj
.
i_ûÁ”_y
;

236 ià(
chick’_»®_y
 >= 23 && chicken_real_y <= 191) {

237 
chick’_»®_y
 -= 23;

238 
chick’_»®_y
 = chicken_real_y / 4;

239 
Ãw_row
[
chick’_»®_y
] = 1313.0;

241 
Ãw_row
[Ãw_row.
	`size
() - 1] = 1314.0;

244 
Ãw_row
[Ãw_row.
	`size
() - 1] = 1314.0;

247 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

248 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

249 
Úe_šd
 = 
a
;

250 
	`add_Úe_šdex_to_ã©u»_m­
(
Úe_šd
, 
a
);

251 
v_Q
[
a
] = 0;

252 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
a
]; j++) {

253 
v_Q
[
a
] +ğ(*
p_§r§_Ïmbda_sŞv”
->
	`g‘_weights
())[(*
pv_cu¼_ã©u»_m­
)[a][
j
]];

256 
be¡_v®ue
 = 
v_Q
[0];

257 
a
 = 1;‡ < 
i_num_aùiÚs
;‡++) {

258 ià(
v_Q
[
a
] > 
be¡_v®ue
) {

259 
be¡_v®ue
 = 
v_Q
[
a
];

262 
pm_debug_be¡_v®
->
	`push_back
(
Ãw_row
);

263 
	}
}

270 
	gF»ewayAg’t
::
	$g‘_chick’_y
(cÚ¡ 
IÁM©rix
* 
pv_sü“n
) {

271 
chick’_cŞÜ_šd
 = 30;

272 
chick’_x_v®
 = 48;

273 
y–low_lše_y_v®1
 = 102;

274 
y–low_lše_y_v®2
 = 104;

275 
i
 = 0; i < 
i_sü“n_height
; i++) {

276 
x
 = -2; x <= 2; x++) {

277 ià((*
pv_sü“n
)[
i
][
chick’_x_v®
 + 
x
] =ğ
chick’_cŞÜ_šd
 &&

278 
i
 !ğ
y–low_lše_y_v®1
 &&

279 
i
 !ğ
y–low_lše_y_v®2
) {

280  
i
;

285 
	}
}

291 
	gF»ewayAg’t
::
	$g‘_ÿrs_x
(cÚ¡ 
IÁM©rix
* 
pm_sü“n
) {

292 
c
 = 0; c < 10; c++) {

293 
ÿr_y
 = 
v_debug_ÿr_y_v®s
[
c
];

294 
cŞÜ_šd
 = 
v_debug_ÿr_cŞÜ_šd
[
c
];

295 
boŞ
 
ÿr_found
 = 
çl£
;

296 
j
 = 0; j < 
i_sü“n_width
; j++) {

297 
y
 = -2; y <= 2; y++) {

298 ià((*
pm_sü“n
)[
ÿr_y
 + 
y
][
j
] =ğ
cŞÜ_šd
) {

299 
ÿr_found
 = 
Œue
;

300 
v_debug_ÿr_x_v®s
[
c
] = 
j
;

305 ià(!
ÿr_found
) {

306 
v_debug_ÿr_x_v®s
[
c
] = 0;

309 
	}
}

	@player_agents/freeway_agent.h

16 #iâdeà
FREEWAY_AGENT_H


17 
	#FREEWAY_AGENT_H


	)

19 
	~<veùÜ
>

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"şass_ag’t.h
"

24 şas 
	cF»ewayAg’t
 : 
public
 
CÏssAg’t
 {

33 
public
:

34 
F»ewayAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

35 
	mvœtu®
 ~
F»ewayAg’t
();

41 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

42 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

43 
äame_numb”
);

48 
vœtu®
 
Ú_’d_of_game
();

50 
	m´Ùeùed
:

54 
vœtu®
 
ÿlc_ã©u»_vec_size
();

59 
vœtu®
 
g’”©e_ã©u»_vec
();

66 
¶Ù_be¡_v®ue_³r_¡©e
();

72 
g‘_chick’_y
(cÚ¡ 
IÁM©rix
* 
pv_sü“n
);

78 
g‘_ÿrs_x
(cÚ¡ 
IÁM©rix
* 
pv_sü“n
);

80 
FlßtM©rix
* 
	mpm_debug_be¡_v®
;

81 
IÁVeù
 
	mv_debug_ÿr_y_v®s
;

82 
IÁVeù
 
	mv_debug_ÿr_x_v®s
;

83 
IÁVeù
 
	mv_debug_ÿr_cŞÜ_šd
;

84 
FlßtVeù
 
	mv_debug_ÿr_v–
;

	@player_agents/full_search_tree.cpp

18 
	~"fuÎ_£¬ch_Œ“.h
"

19 
	~"£¬ch_ag’t.h
"

20 
	~<queue
>

27 
	gFuÎS—rchT»e
::
	$FuÎS—rchT»e
(
S—rchAg’t
* 
£¬ch_ag’t
) :

28 
	$S—rchT»e
(
£¬ch_ag’t
) {

30 
	}
}

35 
FuÎS—rchT»e
::~
	$FuÎS—rchT»e
() {

37 
	}
}

42 
FuÎS—rchT»e
::
	$bud
ĞcÚ¡ 
¡ršg
 
¡¬t_¡©e
,

43 
¡¬t_äame_num
) {

44 
	`as£¹
(
p_roÙ
 =ğ
NULL
);

45 
p_roÙ
 = 
Ãw
 
	`T»eNode
(
NULL
, 
¡¬t_¡©e
, 
¡¬t_äame_num
,

46 
p_£¬ch_ag’t
, 0, 
UNDEFINED
);

47 
	`upd©e_Œ“
();

48 
is_but
 = 
Œue
;

49 
	}
}

55 
	gFuÎS—rchT»e
::
	$upd©e_Œ“
() {

56 
	`ex·nd_Œ“
(
p_roÙ
);

57 
	}
}

65 
	gFuÎS—rchT»e
::
	$ex·nd_Œ“
(
T»eNode
* 
¡¬t_node
) {

67 
queue
<
T»eNode
*> 
q
;

68 
q
.
	`push
(
¡¬t_node
);

69 !
q
.
	`em±y
()) {

70 ià(
p_£¬ch_ag’t
->
	`g‘_num_simuÏ‹d_¡•s
(è> 
i_max_sim_¡•s_³r_Œ“
) {

73 
T»eNode
* 
cu¼_node
 = 
q
.
	`äÚt
();

74 
q
.
	`pİ
();

75 
a
 = 0;‡ < 
p_£¬ch_ag’t
->
i_num_aùiÚs
;‡++) {

76 
AùiÚ
 
aù
 = (*
p_£¬ch_ag’t
->
p_game_£‰šgs
->
pv_possibË_aùiÚs
)[
a
];

77 
T»eNode
* 
Ãw_chd
 = 
Ãw
 
	`T»eNode
Ğ
cu¼_node
,

78 
cu¼_node
->
¡r_¡©e
,

79 
cu¼_node
->
i_äame_num
,

80 
p_£¬ch_ag’t
,

81 
i_sim_¡•s_³r_node
,

82 
aù
);

83 
cu¼_node
->
v_chd»n
.
	`push_back
(
Ãw_chd
);

84 ià(
Ãw_chd
->
i_äame_num
 > 
i_d“³¡_node_äame_num
) {

85 
i_d“³¡_node_äame_num
 = 
Ãw_chd
->
i_äame_num
;

87 ià(!
Ãw_chd
->
b_is_d—d
) {

88 
q
.
	`push
(
Ãw_chd
);

124 
	`upd©e_b¿nch_»w¬d
(
¡¬t_node
);

125 
	}
}

133 
	gFuÎS—rchT»e
::
	$upd©e_b¿nch_»w¬d
(
T»eNode
* 
node
) {

134 
	`as£¹
 (!
node
->
v_chd»n
.
	`em±y
());

137 
node
->
b_is_d—d
 = 
Œue
;

138 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

139 
T»eNode
* 
cu¼_chd
 = 
node
->
v_chd»n
[
c
];

140 ià(!
cu¼_chd
->
v_chd»n
.
	`em±y
()) {

141 
	`upd©e_b¿nch_»w¬d
(
cu¼_chd
);

143 
node
->
b_is_d—d
 = (‚ode->b_is_d—d && 
cu¼_chd
->b_is_dead );

148 
be¡_b¿nch_»w
 = -1;

149 
be¡_b¿nch
 = -1;

150 ià(
node
->
b_is_d—d
) {

152 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

153 
T»eNode
* 
cu¼_chd
 = 
node
->
v_chd»n
[
c
];

154 ià(
be¡_b¿nch
 == -1 ||

155 
cu¼_chd
->
f_b¿nch_»w¬d
 > 
be¡_b¿nch_»w
) {

156 
be¡_b¿nch_»w
 = 
cu¼_chd
->
f_b¿nch_»w¬d
;

157 
be¡_b¿nch
 = 
c
;

163 
fœ¡_šd
 = -1;

164 
fœ¡_šd
 = 0; fœ¡_šd < 
node
->
v_chd»n
.
	`size
(); first_ind++) {

165 ià(!
node
->
v_chd»n
[
fœ¡_šd
]->
b_is_d—d
) {

166 
be¡_b¿nch_»w
 = 
node
->
v_chd»n
[
fœ¡_šd
]->
f_b¿nch_»w¬d
;

167 
be¡_b¿nch
 = 
fœ¡_šd
;

171 
	`as£¹
 (
fœ¡_šd
 != -1);

172 
c
 = 
fœ¡_šd
 + 1;

173 
c
 < 
node
->
v_chd»n
.
	`size
(); c++) {

174 ià((!
node
->
v_chd»n
[
c
]->
b_is_d—d
) &&

175 
node
->
v_chd»n
[
c
]->
f_b¿nch_»w¬d
 > 
be¡_b¿nch_»w
) {

176 
be¡_b¿nch_»w
 = 
node
->
v_chd»n
[
c
]->
f_b¿nch_»w¬d
;

177 
be¡_b¿nch
 = 
c
;

181 
node
->
f_b¿nch_»w¬d
 = (‚ode->
f_node_»w¬d
 +

182 
be¡_b¿nch_»w
 * 
f_discouÁ_çùÜ
);

183 
node
->
i_be¡_b¿nch
 = 
be¡_b¿nch
;

184 
	`as£¹
 (
node
->
b_is_d—d
 =ğnode->
v_chd»n
[
be¡_b¿nch
]->b_is_dead);

185 
	}
}

	@player_agents/full_search_tree.h

17 #iâdeà
FULL_SEARCH_TREE_H


18 
	#FULL_SEARCH_TREE_H


	)

20 
	~"£¬ch_Œ“.h
"

24 şas 
	cFuÎS—rchT»e
 : 
public
 
S—rchT»e
 {

30 
public
:

36 
FuÎS—rchT»e
(
S—rchAg’t
* 
£¬ch_ag’t
);

41 
	mvœtu®
 ~
FuÎS—rchT»e
();

46 
vœtu®
 
bud
ĞcÚ¡ 
¡ršg
 
¡¬t_¡©e
, 
¡¬t_äame_num
);

51 
vœtu®
 
upd©e_Œ“
();

53 
	m´Ùeùed
:

58 
vœtu®
 
ex·nd_Œ“
(
T»eNode
* 
¡¬t
);

65 
upd©e_b¿nch_»w¬d
(
T»eNode
* 
node
);

	@player_agents/game_settings.cpp

18 
	~"game_£‰šgs.h
"

32 
	gGameS‘tšgs
::
	$GameS‘tšgs
Ğ
¡ršg
 
_rom_fe
,

33 
boŞ
 
_u£s_sü“n_m©rix
, boŞ 
_u£s_cÚsŞe_¿m
,

34 
_sk_äames_num
, 
_d–ay_aá”_»¡¬t
,

35 
AùiÚ
 
_fœ¡_aùiÚ
) :

36 
	`s_rom_fe
(
_rom_fe
),

37 
	`b_u£s_sü“n_m©rix
(
_u£s_sü“n_m©rix
),

38 
	`b_u£s_cÚsŞe_¿m
(
_u£s_cÚsŞe_¿m
),

39 
	`i_sk_äames_num
(
_sk_äames_num
),

40 
	`i_d–ay_aá”_»¡¬t
(
_d–ay_aá”_»¡¬t
),

41 
	$e_fœ¡_aùiÚ
(
_fœ¡_aùiÚ
) {

42 
pv_possibË_aùiÚs
 = 
Ãw
 
AùiÚVeù
;

43 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

44 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

45 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

46 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

47 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

48 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

49 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPRIGHT
);

50 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPLEFT
);

51 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNRIGHT
);

52 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNLEFT
);

53 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

54 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

55 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

56 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

57 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPRIGHTFIRE
);

58 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPLEFTFIRE
);

59 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNRIGHTFIRE
);

60 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNLEFTFIRE
);

61 
i_´ev_scÜe
 = 0;

62 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

63 
	}
}

68 
	gGameS‘tšgs
::~
	$GameS‘tšgs
() {

69 ià(
pv_possibË_aùiÚs
) {

70 
d–‘e
 
pv_possibË_aùiÚs
;

72 
	}
}

81 
GameS‘tšgs
* 
	gGameS‘tšgs
::
	$g’”©e_game_S‘tšgs_š¡ªû
(
¡ršg
 
rom_fe
) {

82 
GameS‘tšgs
* 
Ãw_game_£‰šgs
 = 
NULL
;

83 
size_t
 
¦ash_šd
 = 
rom_fe
.
	`fšd_Ï¡_of
("/\\");

84 
rom_fe
 =„om_fe.
	`sub¡r
(
¦ash_šd
 + 1);

86 ià(
rom_fe
 == "freeway.bin") {

87 
Ãw_game_£‰šgs
 = 
Ãw
 
	`F»ewayS‘tšgs
();

88 } ià(
rom_fe
 == "space_invaders.bin") {

89 
Ãw_game_£‰šgs
 = 
Ãw
 
	`S·ûInvad”sS‘tšgs
();

90 } ià(
rom_fe
 == "asterix.bin") {

91 
Ãw_game_£‰šgs
 = 
Ãw
 
	`A¡rixS‘tšgs
();

92 } ià(
rom_fe
 == "seaquest.bin") {

93 
Ãw_game_£‰šgs
 = 
Ãw
 
	`S—que¡S‘tšgs
();

94 } ià(
rom_fe
 == "tennis.bin") {

95 
Ãw_game_£‰šgs
 = 
Ãw
 
	`T’niS‘tšgs
();

96 } ià(
rom_fe
 == "wizard_of_wor.bin") {

97 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Wiz¬dofWÜS‘tšgs
();

98 } ià(
rom_fe
 == "krull.bin") {

99 
Ãw_game_£‰šgs
 = 
Ãw
 
	`KruÎS‘tšgs
();

100 } ià(
rom_fe
 == "atlantis.bin") {

101 
Ãw_game_£‰šgs
 = 
Ãw
 
	`AªtisS‘tšgs
();

102 } ià(
rom_fe
 == "hero.bin") {

103 
Ãw_game_£‰šgs
 = 
Ãw
 
	`HEROS‘tšgs
();

104 } ià(
rom_fe
 == "riverraid.bin") {

105 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Riv”RaidS‘tšgs
();

106 } ià(
rom_fe
 == "venture.bin") {

107 
Ãw_game_£‰šgs
 = 
Ãw
 
	`V’tu»S‘tšgs
();

108 } ià(
rom_fe
 == "crazy_climber.bin") {

109 
Ãw_game_£‰šgs
 = 
Ãw
 
	`C¿zyClimb”S‘tšgs
();

110 } ià(
rom_fe
 == "chopper_command.bin") {

111 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Chİ³rCommªdS‘tšgs
();

112 } ià(
rom_fe
 == "ice_hockey.bin") {

113 
Ãw_game_£‰šgs
 = 
Ãw
 
	`IûHockeyS‘tšgs
();

114 } ià(
rom_fe
 == "montezuma_revenge.bin") {

115 
Ãw_game_£‰šgs
 = 
Ãw
 
	`MÚ‹zumaRev’geS‘tšgs
();

116 } ià(
rom_fe
 == "gravitar.bin") {

117 
Ãw_game_£‰šgs
 = 
Ãw
 
	`G¿v™¬S‘tšgs
();

118 } ià(
rom_fe
 == "carnival.bin") {

119 
Ãw_game_£‰šgs
 = 
Ãw
 
	`C¬niv®S‘tšgs
();

120 } ià(
rom_fe
 == "beam_rider.bin") {

121 
Ãw_game_£‰šgs
 = 
Ãw
 
	`B—mRid”S‘tšgs
();

122 } ià(
rom_fe
 == "boxing.bin") {

123 
Ãw_game_£‰šgs
 = 
Ãw
 
	`BoxšgS‘tšgs
();

124 } ià(
rom_fe
 == "berzerk.bin") {

125 
Ãw_game_£‰šgs
 = 
Ãw
 
	`B”z”kS‘tšgs
();

126 } ià(
rom_fe
 == "star_gunner.bin") {

127 
Ãw_game_£‰šgs
 = 
Ãw
 
	`SrGuÂ”S‘tšgs
();

128 } ià(
rom_fe
 == "amidar.bin") {

129 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Amid¬S‘tšgs
();

130 } ià(
rom_fe
 == "video_pinball.bin") {

131 
Ãw_game_£‰šgs
 = 
Ãw
 
	`VideoPšb®lS‘tšgs
();

132 } ià(
rom_fe
 == "gopher.bin") {

133 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Gİh”S‘tšgs
();

134 } ià(
rom_fe
 == "time_pilot.bin") {

135 
Ãw_game_£‰šgs
 = 
Ãw
 
	`TimePÙS‘tšgs
();

136 } ià(
rom_fe
 == "fishing_derby.bin") {

137 
Ãw_game_£‰šgs
 = 
Ãw
 
	`FishšgD”byS‘tšgs
();

138 } ià(
rom_fe
 == "battle_zone.bin") {

139 
Ãw_game_£‰šgs
 = 
Ãw
 
	`B©eZÚeS‘tšgs
();

140 } ià(
rom_fe
 == "pitfall.bin") {

141 
Ãw_game_£‰šgs
 = 
Ãw
 
	`P™çÎS‘tšgs
();

142 } ià(
rom_fe
 == "robotank.bin") {

143 
Ãw_game_£‰šgs
 = 
Ãw
 
	`RoboTªkS‘tšgs
();

144 } ià(
rom_fe
 == "jamesbond.bin") {

145 
Ãw_game_£‰šgs
 = 
Ãw
 
	`JamesBÚdS‘tšgs
();

146 } ià(
rom_fe
 == "road_runnerr.bin") {

147 
Ãw_game_£‰šgs
 = 
Ãw
 
	`RßdRuÂ”S‘tšgs
();

148 } ià(
rom_fe
 == "astroids.bin") {

149 
Ãw_game_£‰šgs
 = 
Ãw
 
	`A¡roidsS‘tšgs
();

150 } ià(
rom_fe
 == "tutankham.bin") {

151 
Ãw_game_£‰šgs
 = 
Ãw
 
	`TunkhamS‘tšgs
();

152 } ià(
rom_fe
 == "enduro.bin") {

153 
Ãw_game_£‰šgs
 = 
Ãw
 
	`EnduroS‘tšgs
();

154 } ià(
rom_fe
 == "pooyan.bin") {

155 
Ãw_game_£‰šgs
 = 
Ãw
 
	`PooyªS‘tšgs
();

156 } ià(
rom_fe
 == "air_raid.bin") {

157 
Ãw_game_£‰šgs
 = 
Ãw
 
	`AœRaidS‘tšgs
();

158 } ià(
rom_fe
 == "alien.bin") {

159 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Al›nS‘tšgs
();

160 } ià(
rom_fe
 == "centipede.bin") {

161 
Ãw_game_£‰šgs
 = 
Ãw
 
	`C’tedeS‘tšgs
();

162 } ià(
rom_fe
 == "solaris.bin") {

163 
Ãw_game_£‰šgs
 = 
Ãw
 
	`SŞ¬isS‘tšgs
();

164 } ià(
rom_fe
 == "bank_heist.bin") {

165 
Ãw_game_£‰šgs
 = 
Ãw
 
	`BªkHei¡S‘tšgs
();

166 } ià(
rom_fe
 == "zaxxon.bin") {

167 
Ãw_game_£‰šgs
 = 
Ãw
 
	`ZaxxÚS‘tšgs
();

168 } ià(
rom_fe
 == "ms_pacman.bin") {

169 
Ãw_game_£‰šgs
 = 
Ãw
 
	`MsPacmª
();

170 } ià(
rom_fe
 == "skiing.bin") {

171 
Ãw_game_£‰šgs
 = 
Ãw
 
	`SkišgS‘tšgs
();

172 } ià(
rom_fe
 == "double_dunk.bin") {

173 
Ãw_game_£‰šgs
 = 
Ãw
 
	`DoubËDunkS‘tšgs
();

174 } ià(
rom_fe
 == "joust.bin") {

175 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Jou¡S‘tšgs
();

176 } ià(
rom_fe
 == "kung_fu_master.bin") {

177 
Ãw_game_£‰šgs
 = 
Ãw
 
	`KungFuMa¡”S‘tšgs
();

178 } ià(
rom_fe
 == "canyon_bomber.bin") {

179 
Ãw_game_£‰šgs
 = 
Ãw
 
	`CªyÚBomb”S‘tšgs
();

180 } ià(
rom_fe
 == "miner_2049r.bin") {

181 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Mš”2049RS‘tšgs
();

182 } ià(
rom_fe
 == "bowling.bin") {

183 
Ãw_game_£‰šgs
 = 
Ãw
 
	`BowlšgS‘tšgs
();

184 } ià(
rom_fe
 == "assault.bin") {

185 
Ãw_game_£‰šgs
 = 
Ãw
 
	`As§uÉS‘tšgs
();

186 } ià(
rom_fe
 == "up_n_down.bin") {

187 
Ãw_game_£‰šgs
 = 
Ãw
 
	`UpNDownS‘tšgs
();

188 } ià(
rom_fe
 == "kangaroo.bin") {

189 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Kªg¬ooS‘tšgs
();

190 } ià(
rom_fe
 == "defender.bin") {

191 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Deãnd”S‘tšgs
();

192 } ià(
rom_fe
 == "name_this_game.bin") {

193 
Ãw_game_£‰šgs
 = 
Ãw
 
	`NameThisGameS‘tšgs
();

194 } ià(
rom_fe
 == "pitfall2.bin") {

195 
Ãw_game_£‰šgs
 = 
Ãw
 
	`P™çÎ2S‘tšgs
();

196 } ià(
rom_fe
 == "private_eye.bin") {

197 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Priv©eEyeS‘tšgs
();

198 } ià(
rom_fe
 == "demon_attack.bin") {

199 
Ãw_game_£‰šgs
 = 
Ãw
 
	`DemÚA‰ackS‘tšgs
();

200 } ià(
rom_fe
 == "elevator_action.bin") {

201 
Ãw_game_£‰šgs
 = 
Ãw
 
	`EËv©ÜAùiÚS‘tšgs
();

202 } ià(
rom_fe
 == "journey_escape.bin") {

203 
Ãw_game_£‰šgs
 = 
Ãw
 
	`JouºeyEsÿ³S‘tšgs
();

204 } ià(
rom_fe
 == "phoenix.bin") {

205 
Ãw_game_£‰šgs
 = 
Ãw
 
	`PhÛnixS‘tšgs
();

206 } ià(
rom_fe
 == "frostbite.bin") {

207 
Ãw_game_£‰šgs
 = 
Ãw
 
	`Fro¡b™eS‘tšgs
();

208 } ià(
rom_fe
 == ".bin") {

209 
Ãw_game_£‰šgs
 = 
Ãw
 
	`F»ewayS‘tšgs
();

210 } ià(
rom_fe
 == ".bin") {

211 
Ãw_game_£‰šgs
 = 
Ãw
 
	`F»ewayS‘tšgs
();

213 
û¼
 << "GameSettings::generate_game_Settings_instance: I don't know" <<

214 " wh© gam£‰šg tØu£ fÜ " << 
rom_fe
 << 
’dl
;

215 
û¼
 << "make surehe ROM is†isted in "

216 << "GameS‘tšgs::g’”©e_game_S‘tšgs_š¡ªû" << 
’dl
;

217 
	`ex™
(-1);

219  
Ãw_game_£‰šgs
;

220 
	}
}

227 
	gGameS‘tšgs
::
	$g‘_two_decim®_scÜe
(
low”_šdex
, 
high”_šdex
,

228 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

229 
scÜe
 = 0;

230 
low”_dig™s_v®
 = (*
cÚsŞe_¿m
)[
low”_šdex
];

231 
low”_right_dig™
 = 
low”_dig™s_v®
 & 15;

232 
low”_Ëá_dig™
 = (
low”_dig™s_v®
 - 
low”_right_dig™
) >> 4;

233 
scÜe
 +ğ((10 * 
low”_Ëá_dig™
è+ 
low”_right_dig™
);

234 ià(
high”_šdex
 < 0) {

235  
scÜe
;

237 
high”_dig™s_v®
 = (*
cÚsŞe_¿m
)[
high”_šdex
];

238 
high”_right_dig™
 = 
high”_dig™s_v®
 & 15;

239 
high”_Ëá_dig™
 = (
high”_dig™s_v®
 - 
high”_right_dig™
) >> 4;

240 
scÜe
 +ğ((1000 * 
high”_Ëá_dig™
è+ 100 * 
high”_right_dig™
);

241  
scÜe
;

243 
	}
}

250 
	gGameS‘tšgs
::
	$g‘_th»e_decim®_scÜe
(
low”_šdex
, 
middË_šdex
,

251 
high”_šdex
,

252 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

253 
scÜe
 = 
	`g‘_two_decim®_scÜe
(
low”_šdex
, 
middË_šdex
, 
cÚsŞe_¿m
);

254 
high”_dig™s_v®
 = (*
cÚsŞe_¿m
)[
high”_šdex
];

255 
high”_right_dig™
 = 
high”_dig™s_v®
 & 15;

256 
high”_Ëá_dig™
 = (
high”_dig™s_v®
 - 
high”_right_dig™
) >> 4;

257 
scÜe
 +ğ((100000 * 
high”_Ëá_dig™
è+ 10000 * 
high”_right_dig™
);

258  
scÜe
;

259 
	}
}

265 
	gGameS‘tšgs
::
	$»£t_¡©e
() {

266 
i_´ev_scÜe
 = 0;

267 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

268 
	}
}

274 
	gGameS‘tšgs
::
	$§ve_¡©e
(
S”Ÿliz”
& 
out
) {

275 
out
.
	`putIÁ
(
i_´ev_scÜe
);

276 
out
.
	`putIÁ
(
i_äames_sšû_Ï¡_»¡¬t
);

277 
	}
}

283 
	gGameS‘tšgs
::
	$lßd_¡©e
(
De£rŸliz”
& 
š
) {

284 
i_´ev_scÜe
 = (
IÁ32
è
š
.
	`g‘IÁ
();

285 
i_äames_sšû_Ï¡_»¡¬t
 = (
IÁ32
è
š
.
	`g‘IÁ
();

286 
	}
}

289 
	gF»ewayS‘tšgs
::
	$F»ewayS‘tšgs
() :

290 
	`GameS‘tšgs
( "freeway.bin",

295 
UNDEFINED


297 
pv_possibË_aùiÚs
->
	`ş—r
();

298 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

299 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

300 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

301 
	}
}

303 
	gF»ewayS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

304 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

305 
scÜe
 = 
	`g‘_two_decim®_scÜe
(103, -1, 
cÚsŞe_¿m
);

306 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

307 ià(
»w¬d
 < 0) {

308 
»w¬d
 = 0;

310 ià(
»w¬d
 > 1) {

311 
»w¬d
 = 1;

313 
i_´ev_scÜe
 = 
scÜe
;

314  ()
»w¬d
;

315 
	}
}

317 
boŞ
 
	gF»ewayS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

318 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

319 
äame_couÁ”
) {

320 
i_äames_sšû_Ï¡_»¡¬t
++;

321 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 2000) {

322 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

323 
i_´ev_scÜe
 = 0;

324  
Œue
;

326  
çl£
;

327 
	}
}

330 
	gS·ûInvad”sS‘tšgs
::
	$S·ûInvad”sS‘tšgs
() :

331 
	`GameS‘tšgs
( "spaceinvaders.bin",

336 
PLAYER_A_FIRE


338 
pv_possibË_aùiÚs
->
	`ş—r
();

339 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

340 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

341 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

342 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

343 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

344 
	}
}

346 
	gS·ûInvad”sS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

347 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

348 
scÜe
 = 
	`g‘_two_decim®_scÜe
(104, 102, 
cÚsŞe_¿m
);

349 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

350 
i_´ev_scÜe
 = 
scÜe
;

351  ()
»w¬d
;

352 
	}
}

354 
boŞ
 
	gS·ûInvad”sS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

355 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

356 
äame_couÁ”
) {

357 
»£t_v®
 = (*
cÚsŞe_¿m
)[42];

358 
»£t_v®
 = (reset_val - (reset_val & 15)) >> 4;

359 ià(
»£t_v®
 == 8) {

360 
i_´ev_scÜe
 = 0;

361  
Œue
;

363 
Ãw_lives
 = (*
cÚsŞe_¿m
)[73];

364 ià(
Ãw_lives
 == 3) {

365  
çl£
;

367 
i_´ev_scÜe
 = 0;

368  
Œue
;

370 
	}
}

372 
	gA¡rixS‘tšgs
::
	$A¡rixS‘tšgs
() :

373 
	`GameS‘tšgs
( "asterix.bin",

374 
çl£
,

375 
Œue
,

378 
PLAYER_A_FIRE


380 
pv_possibË_aùiÚs
->
	`ş—r
();

381 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

382 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

383 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

384 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

385 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

387 
	}
}

389 
	gA¡rixS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

390 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

391 
scÜe
 = 
	`g‘_two_decim®_scÜe
(96, 95, 
cÚsŞe_¿m
);

392 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

393 
i_´ev_scÜe
 = 
scÜe
;

394  ()
»w¬d
;

395 
	}
}

397 
boŞ
 
	gA¡rixS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

398 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

399 
äame_couÁ”
) {

400 
by‹_v®
 = (*
cÚsŞe_¿m
)[83];

401 
Ãw_lives
 = 
by‹_v®
 & 15;

402 ià(
Ãw_lives
 < 3) {

403 
i_´ev_scÜe
 = 0;

404  
Œue
;

406  
çl£
;

408 
	}
}

410 
	gS—que¡S‘tšgs
::
	$S—que¡S‘tšgs
() :

411 
	`GameS‘tšgs
( "seaquest.bin",

412 
çl£
,

413 
Œue
,

416 
UNDEFINED


418 
pv_possibË_aùiÚs
->
	`ş—r
();

419 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

420 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

421 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

422 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

423 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

424 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

425 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

426 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

427 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

428 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

429 
	}
}

432 
	gS—que¡S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

433 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

434 
scÜe
 = 
	`g‘_two_decim®_scÜe
(58, 57, 
cÚsŞe_¿m
);

435 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

436 
i_´ev_scÜe
 = 
scÜe
;

437  ()
»w¬d
;

438 
	}
}

440 
boŞ
 
	gS—que¡S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

441 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

442 
äame_couÁ”
) {

443 
by‹_v®
 = (*
cÚsŞe_¿m
)[59];

444 
Ãw_lives
 = 
by‹_v®
 & 15;

445 ià(
Ãw_lives
 < 3) {

446 
i_´ev_scÜe
 = 0;

447  
Œue
;

449  
çl£
;

451 
	}
}

453 
	gT’niS‘tšgs
::
	$T’niS‘tšgs
() :

454 
	`GameS‘tšgs
( "tennis.bin",

455 
çl£
,

456 
Œue
,

459 
PLAYER_A_FIRE


461 
pv_possibË_aùiÚs
->
	`ş—r
();

462 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

463 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

464 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

465 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

466 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

467 
	}
}

469 
	gT’niS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

470 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

471 
my_scÜe
 = (*
cÚsŞe_¿m
)[69];

472 
İ±_scÜe
 = (*
cÚsŞe_¿m
)[70];

473 ià(
my_scÜe
 > 0) {

476 ià(
İ±_scÜe
 > 0) {

480 
	}
}

482 
boŞ
 
	gT’niS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

483 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

484 
äame_couÁ”
) {

485 
my_scÜe
 = (*
cÚsŞe_¿m
)[69];

486 
İ±_scÜe
 = (*
cÚsŞe_¿m
)[70];

487 ià(
my_scÜe
 > 0 || 
İ±_scÜe
 > 0) {

488  
Œue
;

490  
çl£
;

492 
	}
}

494 
	gWiz¬dofWÜS‘tšgs
::
	$Wiz¬dofWÜS‘tšgs
() :

495 
	`GameS‘tšgs
( "wizard_of_wor.bin",

496 
çl£
,

497 
Œue
,

500 
PLAYER_A_UP


502 
pv_possibË_aùiÚs
->
	`ş—r
();

503 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

504 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

505 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

506 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

507 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

508 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

509 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

510 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

511 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

512 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

514 
	}
}

516 
	gWiz¬dofWÜS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

517 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

518 
scÜe
 = 
	`g‘_two_decim®_scÜe
(6, 8, 
cÚsŞe_¿m
);

519 
scÜe
 -= 8000;

520 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

521 
i_´ev_scÜe
 = 
scÜe
;

522  ()
»w¬d
;

523 
	}
}

525 
boŞ
 
	gWiz¬dofWÜS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

526 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

527 
äame_couÁ”
) {

528 
by‹_v®
 = (*
cÚsŞe_¿m
)[13];

529 
Ãw_lives
 = 
by‹_v®
 & 15;

530 ià(
Ãw_lives
 < 2) {

531 
i_´ev_scÜe
 = 0;

532  
Œue
;

534  
çl£
;

536 
	}
}

539 
	gKruÎS‘tšgs
::
	$KruÎS‘tšgs
() :

540 
	`GameS‘tšgs
( "krull.bin",

541 
çl£
,

542 
Œue
,

545 
UNDEFINED


547 
pv_possibË_aùiÚs
->
	`ş—r
();

548 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

549 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

550 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

551 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

552 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

553 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

554 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

555 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

556 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

557 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

559 
	}
}

561 
	gKruÎS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

562 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

563 
scÜe
 = 
	`g‘_two_decim®_scÜe
(30, 29, 
cÚsŞe_¿m
);

564 
scÜe
 -= 8000;

565 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

566 
i_´ev_scÜe
 = 
scÜe
;

567  ()
»w¬d
;

568 
	}
}

570 
boŞ
 
	gKruÎS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

571 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

572 
äame_couÁ”
) {

573 
by‹_v®
 = (*
cÚsŞe_¿m
)[31];

574 
Ãw_lives
 = 
by‹_v®
 & 15;

575 ià(
Ãw_lives
 < 2) {

576 
i_´ev_scÜe
 = 0;

577  
Œue
;

579 
	`as£¹
(
Ãw_lives
 == 2);

580  
çl£
;

582 
	}
}

584 
	gAªtisS‘tšgs
::
	$AªtisS‘tšgs
() :

585 
	`GameS‘tšgs
( "atlantis.bin",

586 
çl£
,

587 
Œue
,

590 
UNDEFINED


592 
pv_possibË_aùiÚs
->
	`ş—r
();

593 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

594 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

595 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

596 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

597 
	}
}

599 
	gAªtisS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

600 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

601 
scÜe
 = 
	`g‘_two_decim®_scÜe
(34, 35, 
cÚsŞe_¿m
);

602 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

603 
i_´ev_scÜe
 = 
scÜe
;

604  ()
»w¬d
;

605 
	}
}

607 
boŞ
 
	gAªtisS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

608 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

609 
äame_couÁ”
) {

610 
i_äames_sšû_Ï¡_»¡¬t
++;

611 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 10000) {

612 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

613 
i_´ev_scÜe
 = 0;

614  
Œue
;

616  
çl£
;

617 
	}
}

619 
	gHEROS‘tšgs
::
	$HEROS‘tšgs
() :

620 
	`GameS‘tšgs
( "hero.bin",

621 
çl£
,

622 
Œue
,

625 
UNDEFINED


627 
pv_possibË_aùiÚs
->
	`ş—r
();

628 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

629 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

630 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

631 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

632 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

633 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

634 
	}
}

636 
	gHEROS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

637 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

638 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(57, 56, 55, 
cÚsŞe_¿m
);

639 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

640 
i_´ev_scÜe
 = 
scÜe
;

641  ()
»w¬d
;

642 
	}
}

644 
boŞ
 
	gHEROS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

645 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

646 
äame_couÁ”
) {

647 
by‹_v®
 = (*
cÚsŞe_¿m
)[51];

648 
Ãw_lives
 = 
by‹_v®
 & 15;

649 ià(
Ãw_lives
 < 4) {

650 
i_´ev_scÜe
 = 0;

651  
Œue
;

653  
çl£
;

655 
	}
}

657 
	gRiv”RaidS‘tšgs
::
	$Riv”RaidS‘tšgs
() :

658 
	`GameS‘tšgs
( "riverraid.bin",

659 
çl£
,

660 
Œue
,

663 
PLAYER_A_FIRE


665 
pv_possibË_aùiÚs
->
	`ş—r
();

666 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

667 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

668 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

669 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

670 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

671 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

672 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

673 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

674 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

675 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

676 
m_¿m_v®s_to_dig™s
[0] = 0;

677 
m_¿m_v®s_to_dig™s
[8] = 1;

678 
m_¿m_v®s_to_dig™s
[16] = 2;

679 
m_¿m_v®s_to_dig™s
[24] = 3;

680 
m_¿m_v®s_to_dig™s
[32] = 4;

681 
m_¿m_v®s_to_dig™s
[40] = 5;

682 
m_¿m_v®s_to_dig™s
[48] = 6;

683 
m_¿m_v®s_to_dig™s
[56] = 7;

684 
m_¿m_v®s_to_dig™s
[64] = 8;

685 
m_¿m_v®s_to_dig™s
[72] = 9;

687 
	}
}

689 
	gRiv”RaidS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

690 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

691 
scÜe
 = 0;

692 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[87]];

693 
scÜe
 +ğ
dig™
;

694 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[85]];

695 
scÜe
 +ğ10 * 
dig™
;

696 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[83]];

697 
scÜe
 +ğ100 * 
dig™
;

698 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[81]];

699 
scÜe
 +ğ1000 * 
dig™
;

700 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[79]];

701 
scÜe
 +ğ10000 * 
dig™
;

702 
dig™
 = 
m_¿m_v®s_to_dig™s
[(*
cÚsŞe_¿m
)[77]];

703 
scÜe
 +ğ100000 * 
dig™
;

704 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

705 
i_´ev_scÜe
 = 
scÜe
;

706  ()
»w¬d
;

707 
	}
}

709 
boŞ
 
	gRiv”RaidS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

710 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

711 
äame_couÁ”
) {

712 
by‹_v®
 = (*
cÚsŞe_¿m
)[64];

713 
Ãw_lives
 = 
m_¿m_v®s_to_dig™s
[
by‹_v®
];

714 ià(
Ãw_lives
 < 3) {

715 
i_´ev_scÜe
 = 0;

716  
Œue
;

718  
çl£
;

720 
	}
}

722 
	gV’tu»S‘tšgs
::
	$V’tu»S‘tšgs
() :

723 
	`GameS‘tšgs
( "venture.bin",

724 
çl£
,

725 
Œue
,

728 
UNDEFINED


730 
pv_possibË_aùiÚs
->
	`ş—r
();

731 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

732 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

733 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

734 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

735 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

736 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

737 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

738 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

739 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

740 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

741 
	}
}

743 
	gV’tu»S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

744 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

745 
scÜe
 = 
	`g‘_two_decim®_scÜe
(72, 71, 
cÚsŞe_¿m
);

746 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

747 
i_´ev_scÜe
 = 
scÜe
;

748  ()
»w¬d
;

749 
	}
}

751 
boŞ
 
	gV’tu»S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

752 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

753 
äame_couÁ”
) {

754 
by‹_v®
 = (*
cÚsŞe_¿m
)[70];

755 
Ãw_lives
 = 
by‹_v®
 & 15;

756 ià(
Ãw_lives
 < 3) {

757 
i_´ev_scÜe
 = 0;

758  
Œue
;

760  
çl£
;

762 
	}
}

764 
	gC¿zyClimb”S‘tšgs
::
	$C¿zyClimb”S‘tšgs
() :

765 
	`GameS‘tšgs
( "crazy_climber.bin",

766 
çl£
,

767 
Œue
,

770 
UNDEFINED


772 
pv_possibË_aùiÚs
->
	`ş—r
();

773 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

774 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

775 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

776 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

777 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

778 
	}
}

780 
	gC¿zyClimb”S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

781 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

782 
scÜe
 = 0;

783 
dig™
 = (*
cÚsŞe_¿m
)[2];

784 
scÜe
 +ğ
dig™
;

785 
dig™
 = (*
cÚsŞe_¿m
)[3];

786 
scÜe
 +ğ10 * 
dig™
;

787 
dig™
 = (*
cÚsŞe_¿m
)[4];

788 
scÜe
 +ğ100 * 
dig™
;

789 
dig™
 = (*
cÚsŞe_¿m
)[5];

790 
scÜe
 +ğ1000 * 
dig™
;

791 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

792 ià(
»w¬d
 < 0) {

793 
»w¬d
 = 0;

796 
i_´ev_scÜe
 = 
scÜe
;

797  
»w¬d
;

798 
	}
}

800 
boŞ
 
	gC¿zyClimb”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

801 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

802 
äame_couÁ”
) {

803 
by‹_v®
 = (*
cÚsŞe_¿m
)[122];

804 
Ãw_lives
 = 
by‹_v®
 & 15;

805 ià(
Ãw_lives
 < 5) {

806 
i_´ev_scÜe
 = 0;

807  
Œue
;

809  
çl£
;

811 
	}
}

813 
	gFrÚtLšeS‘tšgs
::
	$FrÚtLšeS‘tšgs
() :

814 
	`GameS‘tšgs
( "frontline.bin",

815 
çl£
,

816 
Œue
,

819 
UNDEFINED


821 
pv_possibË_aùiÚs
->
	`ş—r
();

822 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

823 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

824 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

825 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

826 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

827 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

828 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

829 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

830 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

831 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

832 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNLEFTFIRE
);

833 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNRIGHTFIRE
);

834 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPRIGHTFIRE
);

835 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPLEFTFIRE
);

837 
	}
}

839 
	gFrÚtLšeS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

840 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

841 
scÜe
 = 
	`g‘_two_decim®_scÜe
(5, 3, 
cÚsŞe_¿m
);

842 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

843 
i_´ev_scÜe
 = 
scÜe
;

844  ()
»w¬d
;

845 
	}
}

847 
boŞ
 
	gFrÚtLšeS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

848 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

849 
äame_couÁ”
) {

850  
çl£
;

851 
	}
}

853 
	gChİ³rCommªdS‘tšgs
::
	$Chİ³rCommªdS‘tšgs
() :

854 
	`GameS‘tšgs
( "chopper_command.bin",

855 
çl£
,

856 
Œue
,

859 
UNDEFINED


861 
pv_possibË_aùiÚs
->
	`ş—r
();

862 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

863 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

864 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

865 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

866 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

867 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

868 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

869 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

870 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

871 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

872 
	}
}

874 
	gChİ³rCommªdS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

875 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

876 
scÜe
 = 
	`g‘_two_decim®_scÜe
(110, 108, 
cÚsŞe_¿m
);

877 
»w¬d
 = 
scÜe
 - 
i_´ev_scÜe
;

878 
i_´ev_scÜe
 = 
scÜe
;

879  ()
»w¬d
;

880 
	}
}

882 
boŞ
 
	gChİ³rCommªdS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

883 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

884 
äame_couÁ”
) {

885 
by‹_v®
 = (*
cÚsŞe_¿m
)[100];

886 
Ãw_lives
 = 
by‹_v®
 & 15;

887 ià(
Ãw_lives
 < 3) {

888 
i_´ev_scÜe
 = 0;

889  
Œue
;

891  
çl£
;

893 
	}
}

896 
	gIûHockeyS‘tšgs
::
	$IûHockeyS‘tšgs
() :

897 
	`GameS‘tšgs
( "ice_hockey.bin",

898 
çl£
,

899 
Œue
,

902 
UNDEFINED


904 
pv_possibË_aùiÚs
->
	`ş—r
();

905 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

906 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

907 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

908 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

909 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

910 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

911 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

912 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

913 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

914 
	}
}

916 
	gIûHockeyS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

917 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

918 
my_scÜe
 = (*
cÚsŞe_¿m
)[10];

919 
İ±_scÜe
 = (*
cÚsŞe_¿m
)[11];

920 
my_scÜe
 = 
	`max
(my_score, 0);

921 
İ±_scÜe
 = 
	`max
(oppt_score, 0);

922 
scÜe
 = 
my_scÜe
 - 
İ±_scÜe
;

923 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

924 ià(
»w¬d
 > 1.0) {

925 
»w¬d
 = 1.0;

927 
i_´ev_scÜe
 = 
scÜe
;

928  
»w¬d
;

929 
	}
}

931 
boŞ
 
	gIûHockeyS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

932 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

933 
äame_couÁ”
) {

934 
i_äames_sšû_Ï¡_»¡¬t
++;

935 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 4500) {

936 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

937 
i_´ev_scÜe
 = 0;

938  
Œue
;

940  
çl£
;

941 
	}
}

944 
	gMÚ‹zumaRev’geS‘tšgs
::
	$MÚ‹zumaRev’geS‘tšgs
() :

945 
	`GameS‘tšgs
( "montezuma_revenge.bin",

946 
çl£
,

947 
Œue
,

950 
UNDEFINED


952 
pv_possibË_aùiÚs
->
	`ş—r
();

953 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

954 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

955 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

956 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

957 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

958 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

959 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

960 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

961 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

962 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNLEFTFIRE
);

963 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNRIGHTFIRE
);

964 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPRIGHTFIRE
);

965 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPLEFTFIRE
);

966 
	}
}

968 
	gMÚ‹zumaRev’geS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

969 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

970 
scÜe
 = 
	`g‘_two_decim®_scÜe
(20, 19, 
cÚsŞe_¿m
);

971 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

972 
i_´ev_scÜe
 = 
scÜe
;

973  
»w¬d
;

974 
	}
}

976 
boŞ
 
	gMÚ‹zumaRev’geS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

977 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

978 
äame_couÁ”
) {

979 
by‹_v®
 = (*
cÚsŞe_¿m
)[58];

980 
Ãw_lives
 = 
by‹_v®
 & 15;

981 ià(
Ãw_lives
 < 5) {

982 
i_´ev_scÜe
 = 0;

983  
Œue
;

985  
çl£
;

987 
	}
}

991 
	gG¿v™¬S‘tšgs
::
	$G¿v™¬S‘tšgs
() :

992 
	`GameS‘tšgs
( "gravitar.bin",

993 
çl£
,

994 
Œue
,

997 
PLAYER_A_FIRE


999 
pv_possibË_aùiÚs
->
	`ş—r
();

1000 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1001 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1002 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1003 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1004 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1005 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1006 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1007 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1008 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1010 
	}
}

1012 
	gG¿v™¬S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1013 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1014 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(9, 8, 7, 
cÚsŞe_¿m
);

1015 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1016 
i_´ev_scÜe
 = 
scÜe
;

1017  
»w¬d
;

1018 
	}
}

1020 
boŞ
 
	gG¿v™¬S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1021 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1022 
äame_couÁ”
) {

1023 
by‹_v®
 = (*
cÚsŞe_¿m
)[4];

1024 
Ãw_lives
 = 
by‹_v®
 & 15;

1025 ià(
Ãw_lives
 == 0) {

1027  
çl£
;

1029 ià(
Ãw_lives
 < 5) {

1030 
i_´ev_scÜe
 = 0;

1031  
Œue
;

1033  
çl£
;

1035 
	}
}

1038 
	gC¬niv®S‘tšgs
::
	$C¬niv®S‘tšgs
() :

1039 
	`GameS‘tšgs
( "carnival.bin",

1040 
çl£
,

1041 
Œue
,

1044 
PLAYER_A_FIRE


1046 
pv_possibË_aùiÚs
->
	`ş—r
();

1047 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1048 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1049 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1050 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1051 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1052 
	}
}

1054 
	gC¬niv®S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1055 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1056 
scÜe
 = 
	`g‘_two_decim®_scÜe
(46, 45, 
cÚsŞe_¿m
);

1057 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1058 
i_´ev_scÜe
 = 
scÜe
;

1059  
»w¬d
;

1060 
	}
}

1062 
boŞ
 
	gC¬niv®S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1063 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1064 
äame_couÁ”
) {

1065 
by‹_v®
 = (*
cÚsŞe_¿m
)[3];

1066 ià(
by‹_v®
 < 1) {

1067 
i_´ev_scÜe
 = 0;

1068  
Œue
;

1070  
çl£
;

1072 
	}
}

1074 
	gB—mRid”S‘tšgs
::
	$B—mRid”S‘tšgs
() :

1075 
	`GameS‘tšgs
( "beam_rider.bin",

1076 
çl£
,

1077 
Œue
,

1080 
PLAYER_A_UP


1082 
pv_possibË_aùiÚs
->
	`ş—r
();

1083 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1084 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1085 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1086 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1087 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1088 
	}
}

1090 
	gB—mRid”S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1091 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1092 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(9, 10, 11, 
cÚsŞe_¿m
);

1093 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1094 
i_´ev_scÜe
 = 
scÜe
;

1095  
»w¬d
;

1096 
	}
}

1098 
boŞ
 
	gB—mRid”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1099 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1100 
äame_couÁ”
) {

1101 
by‹_v®
 = (*
cÚsŞe_¿m
)[5];

1102 ià(
by‹_v®
 == 255) {

1104 
i_´ev_scÜe
 = 0;

1105  
Œue
;

1107 
by‹_v®
 = byte_val & 15;

1108 ià(
by‹_v®
 < 2) {

1109 
i_´ev_scÜe
 = 0;

1110  
Œue
;

1112  
çl£
;

1114 
	}
}

1116 
	gBoxšgS‘tšgs
::
	$BoxšgS‘tšgs
() :

1117 
	`GameS‘tšgs
( "boxing.bin",

1118 
çl£
,

1119 
Œue
,

1122 
UNDEFINED


1124 
pv_possibË_aùiÚs
->
	`ş—r
();

1125 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1126 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1127 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1128 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1129 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1130 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1131 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1132 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1133 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1134 
	}
}

1136 
	gBoxšgS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1137 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1138 
my_scÜe
 = (*
cÚsŞe_¿m
)[18];

1139 
İ±_scÜe
 = (*
cÚsŞe_¿m
)[19];

1140 
my_scÜe
 = 
	`max
(my_score, 0);

1141 
İ±_scÜe
 = 
	`max
(oppt_score, 0);

1142 
scÜe
 = 
my_scÜe
 - 
İ±_scÜe
;

1143 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1144 
i_´ev_scÜe
 = 
scÜe
;

1145  
»w¬d
;

1146 
	}
}

1148 
boŞ
 
	gBoxšgS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1149 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1150 
äame_couÁ”
) {

1151 
i_äames_sšû_Ï¡_»¡¬t
++;

1152 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 4500) {

1153 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

1154 
i_´ev_scÜe
 = 0;

1155  
Œue
;

1157  
çl£
;

1158 
	}
}

1161 
	gB”z”kS‘tšgs
::
	$B”z”kS‘tšgs
() :

1162 
	`GameS‘tšgs
( "berzerk.bin",

1163 
çl£
,

1164 
Œue
,

1167 
UNDEFINED


1169 
pv_possibË_aùiÚs
->
	`ş—r
();

1170 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1171 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1172 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1173 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1174 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1175 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1176 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1177 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1178 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1180 
	}
}

1182 
	gB”z”kS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1183 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1184 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(95, 94, 93, 
cÚsŞe_¿m
);

1185 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1186 
i_´ev_scÜe
 = 
scÜe
;

1187  
»w¬d
;

1188 
	}
}

1190 
boŞ
 
	gB”z”kS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1191 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1192 
äame_couÁ”
) {

1193 
by‹_v®
 = (*
cÚsŞe_¿m
)[89];

1194 
by‹_v®
 = byte_val & 15;

1195 ià(
by‹_v®
 < 2) {

1196 
i_´ev_scÜe
 = 0;

1197  
Œue
;

1199  
çl£
;

1200 
	}
}

1203 
	gSrGuÂ”S‘tšgs
::
	$SrGuÂ”S‘tšgs
() :

1204 
	`GameS‘tšgs
( "star_gunner.bin",

1205 
çl£
,

1206 
Œue
,

1209 
UNDEFINED


1211 
pv_possibË_aùiÚs
->
	`ş—r
();

1212 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1213 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1214 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1215 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1216 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1217 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1218 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1219 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1220 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1221 
	}
}

1223 
	gSrGuÂ”S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1224 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1225 
low”_dig™
 = (*
cÚsŞe_¿m
)[3] & 15;

1226 ià(
low”_dig™
 == 10) {

1227 
low”_dig™
 = 0;

1229 
middË_dig™
 = (*
cÚsŞe_¿m
)[4] & 15;

1230 ià(
middË_dig™
 == 10) {

1231 
middË_dig™
 = 0;

1233 
high”_dig™
 = (*
cÚsŞe_¿m
)[5] & 15;

1234 ià(
high”_dig™
 == 10) {

1235 
high”_dig™
 = 0;

1238 
scÜe
 = 
low”_dig™
 + 10 * 
middË_dig™
 + 100 * 
high”_dig™
;

1239 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1240 
i_´ev_scÜe
 = 
scÜe
;

1241  
»w¬d
;

1242 
	}
}

1244 
boŞ
 
	gSrGuÂ”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1245 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1246 
äame_couÁ”
) {

1247 
by‹_v®
 = (*
cÚsŞe_¿m
)[7];

1248 
by‹_v®
 = byte_val & 15;

1249 ià(
by‹_v®
 < 5) {

1250 
i_´ev_scÜe
 = 0;

1251  
Œue
;

1253  
çl£
;

1254 
	}
}

1256 
	gQB”tS‘tšgs
::
	$QB”tS‘tšgs
() :

1257 
	`GameS‘tšgs
( "qbert.bin",

1258 
çl£
,

1259 
Œue
,

1262 
UNDEFINED


1264 
pv_possibË_aùiÚs
->
	`ş—r
();

1265 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1266 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1267 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1268 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1269 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1270 
	}
}

1272 
	gQB”tS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1273 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1274 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(91, 90, 89, 
cÚsŞe_¿m
);

1275 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1276 
i_´ev_scÜe
 = 
scÜe
;

1277  
»w¬d
;

1278 
	}
}

1280 
boŞ
 
	gQB”tS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1281 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1282 
äame_couÁ”
) {

1283  
çl£
;

1284 
	}
}

1286 
	gAmid¬S‘tšgs
::
	$Amid¬S‘tšgs
() :

1287 
	`GameS‘tšgs
( "amidar.bin",

1288 
çl£
,

1289 
Œue
,

1292 
UNDEFINED


1294 
pv_possibË_aùiÚs
->
	`ş—r
();

1295 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1296 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1297 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1298 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1299 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1300 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1301 
	}
}

1303 
	gAmid¬S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1304 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1305 
scÜe
 = 
	`g‘_two_decim®_scÜe
(89, 90, 
cÚsŞe_¿m
);

1306 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1307 
i_´ev_scÜe
 = 
scÜe
;

1308  
»w¬d
;

1309 
	}
}

1311 
boŞ
 
	gAmid¬S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1312 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1313 
äame_couÁ”
) {

1314 
by‹_v®
 = (*
cÚsŞe_¿m
)[86];

1315 
by‹_v®
 = byte_val & 15;

1316 ià(
by‹_v®
 < 3) {

1317 
i_´ev_scÜe
 = 0;

1318  
Œue
;

1320  
çl£
;

1321 
	}
}

1323 
	gVideoPšb®lS‘tšgs
::
	$VideoPšb®lS‘tšgs
() :

1324 
	`GameS‘tšgs
( "video_pinball.bin",

1325 
çl£
,

1326 
Œue
,

1329 
PLAYER_A_DOWN


1331 
pv_possibË_aùiÚs
->
	`ş—r
();

1332 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1333 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1334 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1335 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1336 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1337 
	}
}

1339 
	gVideoPšb®lS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1340 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1341 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(48, 50, 52, 
cÚsŞe_¿m
);

1342 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1343 
i_´ev_scÜe
 = 
scÜe
;

1344  
»w¬d
;

1345 
	}
}

1347 
boŞ
 
	gVideoPšb®lS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1348 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1349 
äame_couÁ”
) {

1350 
by‹_v®
 = (*
cÚsŞe_¿m
)[25];

1351 
by‹_v®
 = byte_val & 15;

1352 ià(
by‹_v®
 > 1) {

1353 
i_´ev_scÜe
 = 0;

1354  
Œue
;

1356  
çl£
;

1357 
	}
}

1360 
	gGİh”S‘tšgs
::
	$Gİh”S‘tšgs
() :

1361 
	`GameS‘tšgs
( "gopher.bin",

1362 
çl£
,

1363 
Œue
,

1366 
PLAYER_A_FIRE


1368 
pv_possibË_aùiÚs
->
	`ş—r
();

1369 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1370 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1371 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1372 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1373 
	}
}

1375 
	gGİh”S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1376 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1377 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(50, 49, 48, 
cÚsŞe_¿m
);

1378 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1379 
i_´ev_scÜe
 = 
scÜe
;

1380  
»w¬d
;

1381 
	}
}

1383 
boŞ
 
	gGİh”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1384 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1385 
äame_couÁ”
) {

1386 
by‹_v®
 = (*
cÚsŞe_¿m
)[52];

1387 
by‹_v®
 = byte_val & 15;

1388 ià(
by‹_v®
 < 7) {

1389 
i_´ev_scÜe
 = 0;

1390  
Œue
;

1392  
çl£
;

1393 
	}
}

1395 
	gTimePÙS‘tšgs
::
	$TimePÙS‘tšgs
() :

1396 
	`GameS‘tšgs
( "time_pilot.bin",

1397 
çl£
,

1398 
Œue
,

1401 
UNDEFINED


1403 
pv_possibË_aùiÚs
->
	`ş—r
();

1404 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1405 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1406 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1407 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1408 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1409 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1410 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1411 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1412 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1413 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1414 
	}
}

1416 
	gTimePÙS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1417 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1418 
scÜe
 = 
	`g‘_two_decim®_scÜe
(13, 15, 
cÚsŞe_¿m
);

1419 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1420 
i_´ev_scÜe
 = 
scÜe
;

1421  
»w¬d
;

1422 
	}
}

1424 
boŞ
 
	gTimePÙS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1425 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1426 
äame_couÁ”
) {

1427 
by‹_v®
 = (*
cÚsŞe_¿m
)[11];

1428 
by‹_v®
 = byte_val & 15;

1429 ià(
by‹_v®
 < 4) {

1430 
i_´ev_scÜe
 = 0;

1431  
Œue
;

1433  
çl£
;

1434 
	}
}

1438 
	gFishšgD”byS‘tšgs
::
	$FishšgD”byS‘tšgs
() :

1439 
	`GameS‘tšgs
( "fishing_derby.bin",

1440 
çl£
,

1441 
Œue
,

1444 
UNDEFINED


1446 
pv_possibË_aùiÚs
->
	`ş—r
();

1447 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1448 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1449 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1450 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1451 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1452 
	}
}

1454 
	gFishšgD”byS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1455 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1456 
my_scÜe
 = 
	`g‘_two_decim®_scÜe
(61, -1, 
cÚsŞe_¿m
);

1457 
İ±_scÜe
 = 
	`g‘_two_decim®_scÜe
(62, -1, 
cÚsŞe_¿m
);

1458 
my_scÜe
 = 
	`max
(my_score, 0);

1459 
İ±_scÜe
 = 
	`max
(oppt_score, 0);

1460 
scÜe
 = 
my_scÜe
 - 
İ±_scÜe
;

1461 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1462 
i_´ev_scÜe
 = 
scÜe
;

1463  
»w¬d
;

1464 
	}
}

1466 
boŞ
 
	gFishšgD”byS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1467 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1468 
äame_couÁ”
) {

1469 
i_äames_sšû_Ï¡_»¡¬t
++;

1470 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 4500) {

1471 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

1472 
i_´ev_scÜe
 = 0;

1473  
Œue
;

1475  
çl£
;

1476 
	}
}

1478 
	gB©eZÚeS‘tšgs
::
	$B©eZÚeS‘tšgs
() :

1479 
	`GameS‘tšgs
( "battle_zone.bin",

1480 
çl£
,

1481 
Œue
,

1484 
UNDEFINED


1486 
pv_possibË_aùiÚs
->
	`ş—r
();

1487 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1488 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1489 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1490 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1491 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1492 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1493 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1494 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1495 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1496 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1497 
	}
}

1499 
	gB©eZÚeS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1500 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1501 
fœ¡_v®
 = (*
cÚsŞe_¿m
)[29];

1502 
fœ¡_right_dig™
 = 
fœ¡_v®
 & 15;

1503 
fœ¡_Ëá_dig™
 = (
fœ¡_v®
 - 
fœ¡_right_dig™
) >> 4;

1504 ià(
fœ¡_Ëá_dig™
 == 10) {

1505 
fœ¡_Ëá_dig™
 = 0;

1507 
£cÚd_v®
 = (*
cÚsŞe_¿m
)[30];

1508 
£cÚd_right_dig™
 = 
£cÚd_v®
 & 15;

1509 
£cÚd_Ëá_dig™
 = (
£cÚd_v®
 - 
£cÚd_right_dig™
) >> 4;

1510 ià(
£cÚd_right_dig™
 == 10) {

1511 
£cÚd_right_dig™
 = 0;

1513 ià(
£cÚd_Ëá_dig™
 == 10) {

1514 
£cÚd_Ëá_dig™
 = 0;

1516 
scÜe
 = 
fœ¡_Ëá_dig™
 +

1517 10 * 
£cÚd_right_dig™
 +

1518 100 * 
£cÚd_Ëá_dig™
;

1519 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1520 
i_´ev_scÜe
 = 
scÜe
;

1521  
»w¬d
;

1522 
	}
}

1524 
boŞ
 
	gB©eZÚeS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1525 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1526 
äame_couÁ”
) {

1527 
by‹_v®
 = (*
cÚsŞe_¿m
)[58];

1528 
by‹_v®
 = byte_val & 15;

1529 ià(
by‹_v®
 < 5) {

1530 
i_´ev_scÜe
 = 0;

1531  
Œue
;

1533  
çl£
;

1534 
	}
}

1537 
	gP™çÎS‘tšgs
::
	$P™çÎS‘tšgs
() :

1538 
	`GameS‘tšgs
( "pitfall.bin",

1539 
çl£
,

1540 
Œue
,

1543 
UNDEFINED


1546 
	}
}

1548 
	gP™çÎS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1549 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1550 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(87, 86, 85, 
cÚsŞe_¿m
);

1551 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1552 
i_´ev_scÜe
 = 
scÜe
;

1553  
»w¬d
;

1554 
	}
}

1556 
boŞ
 
	gP™çÎS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1557 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1558 
äame_couÁ”
) {

1559 
by‹_v®
 = (*
cÚsŞe_¿m
)[0];

1560 
by‹_v®
 = (byte_val - (byte_val & 15)) >> 4;

1561 ià(
by‹_v®
 < 10) {

1562 
i_´ev_scÜe
 = 0;

1563  
Œue
;

1565  
çl£
;

1566 
	}
}

1568 
	gRoboTªkS‘tšgs
::
	$RoboTªkS‘tšgs
() :

1569 
	`GameS‘tšgs
( "robotank.bin",

1570 
çl£
,

1571 
Œue
,

1574 
UNDEFINED


1576 
pv_possibË_aùiÚs
->
	`ş—r
();

1577 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1578 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1579 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1580 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1581 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1582 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1583 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1584 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1585 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1586 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1587 
	}
}

1589 
	gRoboTªkS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1590 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1591 
scÜe
 = 
	`g‘_two_decim®_scÜe
(53, -1, 
cÚsŞe_¿m
);

1592 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1593 
i_´ev_scÜe
 = 
scÜe
;

1594  
»w¬d
;

1595 
	}
}

1597 
boŞ
 
	gRoboTªkS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1598 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1599 
äame_couÁ”
) {

1600 
by‹_v®
 = (*
cÚsŞe_¿m
)[40];

1601 
by‹_v®
 = byte_val & 15;

1602 ià(
by‹_v®
 < 3) {

1603 
i_´ev_scÜe
 = 0;

1604  
Œue
;

1606  
çl£
;

1607 
	}
}

1609 
	gJamesBÚdS‘tšgs
::
	$JamesBÚdS‘tšgs
() :

1610 
	`GameS‘tšgs
( "jamesbond.bin",

1611 
çl£
,

1612 
Œue
,

1615 
UNDEFINED


1617 
pv_possibË_aùiÚs
->
	`ş—r
();

1618 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1619 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1620 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1621 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1622 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1623 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1624 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1625 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1626 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1627 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1628 
	}
}

1630 
	gJamesBÚdS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1631 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1632 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(92, 93, 94, 
cÚsŞe_¿m
);

1633 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1634 
i_´ev_scÜe
 = 
scÜe
;

1635  
»w¬d
;

1636 
	}
}

1638 
boŞ
 
	gJamesBÚdS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1639 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1640 
äame_couÁ”
) {

1641 
by‹_v®
 = (*
cÚsŞe_¿m
)[111];

1642 
by‹_v®
 = byte_val & 15;

1643 ià(
by‹_v®
 < 5) {

1644 
i_´ev_scÜe
 = 0;

1645  
Œue
;

1647  
çl£
;

1648 
	}
}

1650 
	gRßdRuÂ”S‘tšgs
::
	$RßdRuÂ”S‘tšgs
() :

1651 
	`GameS‘tšgs
( "road_runner.bin",

1652 
çl£
,

1653 
Œue
,

1656 
UNDEFINED


1658 
pv_possibË_aùiÚs
->
	`ş—r
();

1659 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1660 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1661 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1662 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1663 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1664 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1665 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1666 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1667 
	}
}

1669 
	gRßdRuÂ”S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1670 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1671 
low”_dig™
 = (*
cÚsŞe_¿m
)[73] & 15;

1672 ià(
low”_dig™
 == 10) {

1673 
low”_dig™
 = 0;

1675 
middË_dig™
 = (*
cÚsŞe_¿m
)[74] & 15;

1676 ià(
middË_dig™
 == 10) {

1677 
middË_dig™
 = 0;

1679 
high”_dig™
 = (*
cÚsŞe_¿m
)[75] & 15;

1680 ià(
high”_dig™
 == 10) {

1681 
high”_dig™
 = 0;

1683 
highe¡_dig™
 = (*
cÚsŞe_¿m
)[76] & 15;

1684 ià(
highe¡_dig™
 == 10) {

1685 
highe¡_dig™
 = 0;

1689 
scÜe
 = 
low”_dig™
 + 10 * 
middË_dig™
 + 100 * 
high”_dig™
 +

1690 
highe¡_dig™
 * 1000;

1691 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1692 
i_´ev_scÜe
 = 
scÜe
;

1693  
»w¬d
;

1695 
	}
}

1697 
boŞ
 
	gRßdRuÂ”S‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1698 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1699 
äame_couÁ”
) {

1700 
by‹_v®
 = (*
cÚsŞe_¿m
)[68];

1701 
by‹_v®
 = byte_val & 15;

1702 ià(
by‹_v®
 < 2) {

1703 
i_´ev_scÜe
 = 0;

1704  
Œue
;

1706  
çl£
;

1707 
	}
}

1709 
	gA¡roidsS‘tšgs
::
	$A¡roidsS‘tšgs
() :

1710 
	`GameS‘tšgs
( "astroids.bin",

1711 
çl£
,

1712 
Œue
,

1715 
UNDEFINED


1717 
pv_possibË_aùiÚs
->
	`ş—r
();

1718 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1719 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1720 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1721 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1722 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1723 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1724 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1725 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1726 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1727 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1728 
	}
}

1730 
	gA¡roidsS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1731 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1732 
scÜe
 = 
	`g‘_two_decim®_scÜe
(62, 61, 
cÚsŞe_¿m
);

1733 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1734 
i_´ev_scÜe
 = 
scÜe
;

1735  
»w¬d
;

1736 
	}
}

1738 
boŞ
 
	gA¡roidsS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1739 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1740 
äame_couÁ”
) {

1741 
by‹_v®
 = (*
cÚsŞe_¿m
)[60];

1742 
by‹_v®
 = (byte_val - (byte_val & 15)) >> 4;

1743 ià(
by‹_v®
 < 4) {

1744 
i_´ev_scÜe
 = 0;

1745  
Œue
;

1747  
çl£
;

1748 
	}
}

1750 
	gTunkhamS‘tšgs
::
	$TunkhamS‘tšgs
() :

1751 
	`GameS‘tšgs
( "tutankham.bin",

1752 
çl£
,

1753 
Œue
,

1756 
UNDEFINED


1758 
pv_possibË_aùiÚs
->
	`ş—r
();

1759 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1760 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1761 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1762 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1763 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1764 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1765 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1766 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1767 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1768 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1769 
	}
}

1771 
	gTunkhamS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1772 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1773 
scÜe
 = 
	`g‘_two_decim®_scÜe
(28, 26, 
cÚsŞe_¿m
);

1774 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1775 
i_´ev_scÜe
 = 
scÜe
;

1776  
»w¬d
;

1777 
	}
}

1779 
boŞ
 
	gTunkhamS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1780 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1781 
äame_couÁ”
) {

1782 
by‹_v®
 = (*
cÚsŞe_¿m
)[30];

1783 
by‹_v®
 = (byte_val & 3);

1784 ià(
by‹_v®
 < 3) {

1785 
i_´ev_scÜe
 = 0;

1786  
Œue
;

1788  
çl£
;

1789 
	}
}

1792 
	gEnduroS‘tšgs
::
	$EnduroS‘tšgs
() :

1793 
	`GameS‘tšgs
( "enduro.bin",

1794 
çl£
,

1795 
Œue
,

1798 
PLAYER_A_FIRE


1800 
pv_possibË_aùiÚs
->
	`ş—r
();

1801 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1802 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1803 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1804 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1805 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1806 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1807 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1808 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1809 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1810 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1811 
	}
}

1813 
	gEnduroS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1814 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1815 
scÜe
 = 
	`g‘_two_decim®_scÜe
(43, 44, 
cÚsŞe_¿m
);

1816 
»w¬d
 = ()(
i_´ev_scÜe
 - 
scÜe
);

1817 
i_´ev_scÜe
 = 
scÜe
;

1818  
»w¬d
;

1819 
	}
}

1821 
boŞ
 
	gEnduroS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1822 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1823 
äame_couÁ”
) {

1824 
i_äames_sšû_Ï¡_»¡¬t
++;

1825 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 4500) {

1826 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

1827 
i_´ev_scÜe
 = 0;

1828  
Œue
;

1830  
çl£
;

1831 
	}
}

1833 
	gPooyªS‘tšgs
::
	$PooyªS‘tšgs
() :

1834 
	`GameS‘tšgs
( "pooyan.bin",

1835 
çl£
,

1836 
Œue
,

1839 
UNDEFINED


1841 
pv_possibË_aùiÚs
->
	`ş—r
();

1842 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1843 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1844 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1845 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1846 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1847 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1848 
	}
}

1850 
	gPooyªS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1851 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1852 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(10, 9, 8, 
cÚsŞe_¿m
);

1853 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1854 
i_´ev_scÜe
 = 
scÜe
;

1855  
»w¬d
;

1856 
	}
}

1858 
boŞ
 
	gPooyªS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1859 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1860 
äame_couÁ”
) {

1861 
by‹_v®
 = (*
cÚsŞe_¿m
)[22];

1862 
by‹_v®
 = (byte_val & 15);

1863 ià(
by‹_v®
 < 2) {

1864 
i_´ev_scÜe
 = 0;

1865  
Œue
;

1867  
çl£
;

1868 
	}
}

1870 
	gAœRaidS‘tšgs
::
	$AœRaidS‘tšgs
() :

1871 
	`GameS‘tšgs
( "air_raid.bin",

1872 
çl£
,

1873 
Œue
,

1876 
PLAYER_A_FIRE


1878 
pv_possibË_aùiÚs
->
	`ş—r
();

1879 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1880 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1881 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1882 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1883 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1884 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1885 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1886 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1887 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1888 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1889 
	}
}

1891 
	gAœRaidS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1892 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1893 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(42, 41, 40, 
cÚsŞe_¿m
);

1894 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1895 
i_´ev_scÜe
 = 
scÜe
;

1896  
»w¬d
;

1897 
	}
}

1899 
boŞ
 
	gAœRaidS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1900 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1901 
äame_couÁ”
) {

1902 
by‹_v®
 = (*
cÚsŞe_¿m
)[39];

1903 
by‹_v®
 = (byte_val & 15);

1904 ià(
by‹_v®
 < 2) {

1905 
i_´ev_scÜe
 = 0;

1906  
Œue
;

1908  
çl£
;

1909 
	}
}

1911 
	gAl›nS‘tšgs
::
	$Al›nS‘tšgs
() :

1912 
	`GameS‘tšgs
( "alien.bin",

1913 
çl£
,

1914 
Œue
,

1917 
PLAYER_A_FIRE


1919 
pv_possibË_aùiÚs
->
	`ş—r
();

1920 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1921 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1922 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1923 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1924 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1925 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1926 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1927 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1928 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1929 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1930 
	}
}

1932 
	gAl›nS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1933 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1934 
scÜe
 = (*
cÚsŞe_¿m
)[91];

1935 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1936 
i_´ev_scÜe
 = 
scÜe
;

1937  
»w¬d
;

1938 
	}
}

1940 
boŞ
 
	gAl›nS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1941 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1942 
äame_couÁ”
) {

1943 
by‹_v®
 = (*
cÚsŞe_¿m
)[64];

1944 
by‹_v®
 = (byte_val & 15);

1945 ià(
by‹_v®
 < 3) {

1946 
i_´ev_scÜe
 = 0;

1947  
Œue
;

1949  
çl£
;

1950 
	}
}

1952 
	gC’tedeS‘tšgs
::
	$C’tedeS‘tšgs
() :

1953 
	`GameS‘tšgs
( "centipede.bin",

1954 
çl£
,

1955 
Œue
,

1958 
UNDEFINED


1960 
pv_possibË_aùiÚs
->
	`ş—r
();

1961 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

1962 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

1963 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

1964 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

1965 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

1966 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

1967 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

1968 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

1969 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

1970 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

1971 
	}
}

1973 
	gC’tedeS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1974 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

1975 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(118, 117, 116, 
cÚsŞe_¿m
);

1976 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

1977 
i_´ev_scÜe
 = 
scÜe
;

1978  
»w¬d
;

1979 
	}
}

1981 
boŞ
 
	gC’tedeS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

1982 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

1983 
äame_couÁ”
) {

1984 
by‹_v®
 = (*
cÚsŞe_¿m
)[109];

1985 
by‹_v®
 = (byte_val - (byte_val & 15)) >> 4;

1986 ià(
by‹_v®
 < 2) {

1987 
i_´ev_scÜe
 = 0;

1988  
Œue
;

1990  
çl£
;

1991 
	}
}

1993 
	gSŞ¬isS‘tšgs
::
	$SŞ¬isS‘tšgs
() :

1994 
	`GameS‘tšgs
( "solaris.bin",

1995 
çl£
,

1996 
Œue
,

1999 
UNDEFINED


2001 
pv_possibË_aùiÚs
->
	`ş—r
();

2002 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2003 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2004 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2005 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2006 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2007 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2008 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2009 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2010 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2011 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2012 
	}
}

2014 
	gSŞ¬isS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2015 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2016 
scÜe
 = 
	`g‘_two_decim®_scÜe
(92, 93, 
cÚsŞe_¿m
);

2017 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2018 
i_´ev_scÜe
 = 
scÜe
;

2019  
»w¬d
;

2020 
	}
}

2022 
boŞ
 
	gSŞ¬isS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2023 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2024 
äame_couÁ”
) {

2025 
by‹_v®
 = (*
cÚsŞe_¿m
)[89];

2026 
by‹_v®
 = byte_val & 15;

2027 ià(
by‹_v®
 < 3) {

2028 
i_´ev_scÜe
 = 0;

2029  
Œue
;

2031  
çl£
;

2032 
	}
}

2034 
	gBªkHei¡S‘tšgs
::
	$BªkHei¡S‘tšgs
() :

2035 
	`GameS‘tšgs
( "bank_heist.bin",

2036 
çl£
,

2037 
Œue
,

2040 
UNDEFINED


2042 
pv_possibË_aùiÚs
->
	`ş—r
();

2043 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2044 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2045 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2046 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2047 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2048 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2049 
	}
}

2051 
	gBªkHei¡S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2052 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2053 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(90, 89, 88, 
cÚsŞe_¿m
);

2054 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2055 
i_´ev_scÜe
 = 
scÜe
;

2056  
»w¬d
;

2057 
	}
}

2059 
boŞ
 
	gBªkHei¡S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2060 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2061 
äame_couÁ”
) {

2062 
by‹_v®
 = (*
cÚsŞe_¿m
)[85];

2063 
by‹_v®
 = byte_val & 15;

2064 ià(
by‹_v®
 < 4) {

2065 
i_´ev_scÜe
 = 0;

2066  
Œue
;

2068  
çl£
;

2069 
	}
}

2071 
	gZaxxÚS‘tšgs
::
	$ZaxxÚS‘tšgs
() :

2072 
	`GameS‘tšgs
( "zaxxon.bin",

2073 
çl£
,

2074 
Œue
,

2077 
UNDEFINED


2079 
pv_possibË_aùiÚs
->
	`ş—r
();

2080 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2081 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2082 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2083 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2084 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2085 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2086 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2087 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2088 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2089 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2090 
	}
}

2092 
	gZaxxÚS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2093 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2094 
scÜe
 = 
	`g‘_two_decim®_scÜe
(105, 104, 
cÚsŞe_¿m
);

2095 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2096 
i_´ev_scÜe
 = 
scÜe
;

2097  
»w¬d
;

2098 
	}
}

2100 
boŞ
 
	gZaxxÚS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2101 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2102 
äame_couÁ”
) {

2103 
by‹_v®
 = (*
cÚsŞe_¿m
)[106];

2104 
by‹_v®
 = byte_val & 15;

2105 ià(
by‹_v®
 < 5) {

2106 
i_´ev_scÜe
 = 0;

2107  
Œue
;

2109  
çl£
;

2110 
	}
}

2112 
	gMsPacmª
::
	$MsPacmª
() :

2113 
	`GameS‘tšgs
( "ms_pacman.bin",

2114 
çl£
,

2115 
Œue
,

2118 
PLAYER_A_FIRE


2120 
pv_possibË_aùiÚs
->
	`ş—r
();

2121 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2122 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2123 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2124 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2125 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2127 
	}
}

2129 
	gMsPacmª
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2130 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2131 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(120, 121, 122, 
cÚsŞe_¿m
);

2132 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2133 
i_´ev_scÜe
 = 
scÜe
;

2134  
»w¬d
;

2135 
	}
}

2137 
boŞ
 
	gMsPacmª
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2138 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2139 
äame_couÁ”
) {

2140 
by‹_v®
 = (*
cÚsŞe_¿m
)[123];

2141 
by‹_v®
 = byte_val & 15;

2142 ià(
by‹_v®
 < 2) {

2143 
i_´ev_scÜe
 = 0;

2144  
Œue
;

2146  
çl£
;

2147 
	}
}

2150 
	gSkišgS‘tšgs
::
	$SkišgS‘tšgs
() :

2151 
	`GameS‘tšgs
( "skiing.bin",

2152 
çl£
,

2153 
Œue
,

2156 
UNDEFINED


2158 
pv_possibË_aùiÚs
->
	`ş—r
();

2159 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2160 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2161 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2162 
	}
}

2164 
	gSkišgS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2165 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2166 
scÜe
 = 
	`g‘_two_decim®_scÜe
(107, -1, 
cÚsŞe_¿m
);

2167 
»w¬d
 = 
i_´ev_scÜe
 - 
scÜe
;

2168 ià(
»w¬d
 < 0) {

2169 
»w¬d
 = 0;

2171 
i_´ev_scÜe
 = 
scÜe
;

2172  ()
»w¬d
;

2173 
	}
}

2175 
boŞ
 
	gSkišgS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2176 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2177 
äame_couÁ”
) {

2178 
i_äames_sšû_Ï¡_»¡¬t
++;

2179 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 2500) {

2180 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

2181 
i_´ev_scÜe
 = 0;

2182  
Œue
;

2184  
çl£
;

2185 
	}
}

2187 
	gDoubËDunkS‘tšgs
::
	$DoubËDunkS‘tšgs
() :

2188 
	`GameS‘tšgs
( "double_dunk.bin",

2189 
çl£
,

2190 
Œue
,

2193 
PLAYER_A_RIGHTFIRE


2195 
pv_possibË_aùiÚs
->
	`ş—r
();

2196 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2197 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2198 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2199 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2200 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2201 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2202 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2203 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2204 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2205 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2206 
	}
}

2208 
	gDoubËDunkS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2209 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2210 
my_scÜe
 = (*
cÚsŞe_¿m
)[118];

2211 
İ±_scÜe
 = (*
cÚsŞe_¿m
)[119];

2212 
scÜe
 = 
my_scÜe
 - 
İ±_scÜe
;

2213 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2214 
i_´ev_scÜe
 = 
scÜe
;

2215  
»w¬d
;

2216 
	}
}

2218 
boŞ
 
	gDoubËDunkS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2219 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2220 
äame_couÁ”
) {

2221 
i_äames_sšû_Ï¡_»¡¬t
++;

2222 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 1000) {

2223 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

2224 
i_´ev_scÜe
 = 0;

2225  
Œue
;

2227  
çl£
;

2229 
	}
}

2231 
	gJou¡S‘tšgs
::
	$Jou¡S‘tšgs
() :

2232 
	`GameS‘tšgs
( "joust.bin",

2233 
çl£
,

2234 
Œue
,

2237 
PLAYER_A_FIRE


2239 
pv_possibË_aùiÚs
->
	`ş—r
();

2240 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2241 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2242 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2243 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2244 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2245 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2246 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2247 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2248 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2249 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2250 
	}
}

2252 
	gJou¡S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2253 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2254 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(7, 5, 3, 
cÚsŞe_¿m
);

2255 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2256 
i_´ev_scÜe
 = 
scÜe
;

2257  
»w¬d
;

2258 
	}
}

2260 
boŞ
 
	gJou¡S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2261 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2262 
äame_couÁ”
) {

2263 
by‹_v®
 = (*
cÚsŞe_¿m
)[1];

2264 
by‹_v®
 = byte_val & 15;

2265 ià(
by‹_v®
 < 4) {

2266 
i_´ev_scÜe
 = 0;

2267  
Œue
;

2269  
çl£
;

2270 
	}
}

2272 
	gKungFuMa¡”S‘tšgs
::
	$KungFuMa¡”S‘tšgs
() :

2273 
	`GameS‘tšgs
( "kung_fu_master.bin",

2274 
çl£
,

2275 
Œue
,

2278 
PLAYER_A_FIRE


2280 
pv_possibË_aùiÚs
->
	`ş—r
();

2281 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2282 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2283 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2284 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2285 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2286 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2287 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2288 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2290 
	}
}

2292 
	gKungFuMa¡”S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2293 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2294 
scÜe
 = 
	`g‘_two_decim®_scÜe
(25, 24, 
cÚsŞe_¿m
);

2295 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2296 
i_´ev_scÜe
 = 
scÜe
;

2297  
»w¬d
;

2298 
	}
}

2300 
boŞ
 
	gKungFuMa¡”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2301 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2302 
äame_couÁ”
) {

2303 
by‹_v®
 = (*
cÚsŞe_¿m
)[29];

2304 
by‹_v®
 = byte_val & 15;

2305 ià(
by‹_v®
 < 3) {

2306 
i_´ev_scÜe
 = 0;

2307  
Œue
;

2309  
çl£
;

2310 
	}
}

2312 
	gCªyÚBomb”S‘tšgs
::
	$CªyÚBomb”S‘tšgs
() :

2313 
	`GameS‘tšgs
( "canyon_bomber.bin",

2314 
çl£
,

2315 
Œue
,

2318 
PLAYER_A_FIRE


2320 
pv_possibË_aùiÚs
->
	`ş—r
();

2321 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2322 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2323 
	}
}

2325 
	gCªyÚBomb”S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2326 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2327 
my_scÜe
 = 
	`g‘_two_decim®_scÜe
(75, 74, 
cÚsŞe_¿m
);

2328 
İ±_scÜe
 = 
	`g‘_two_decim®_scÜe
(73, 72, 
cÚsŞe_¿m
);;

2329 
scÜe
 = 
my_scÜe
 - 
İ±_scÜe
;

2330 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2331 
i_´ev_scÜe
 = 
scÜe
;

2332  
»w¬d
;

2333 
	}
}

2335 
boŞ
 
	gCªyÚBomb”S‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2336 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2337 
äame_couÁ”
) {

2338 
i_äames_sšû_Ï¡_»¡¬t
++;

2339 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 3000) {

2340 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

2341 
i_´ev_scÜe
 = 0;

2342  
Œue
;

2344  
çl£
;

2346 
	}
}

2348 
	gMš”2049RS‘tšgs
::
	$Mš”2049RS‘tšgs
() :

2349 
	`GameS‘tšgs
( "miner_2049r.bin",

2350 
çl£
,

2351 
Œue
,

2354 
UNDEFINED


2356 
pv_possibË_aùiÚs
->
	`ş—r
();

2357 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2358 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2359 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2360 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2361 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2362 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2363 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2364 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2366 
	}
}

2368 
	gMš”2049RS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2369 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2370 
dig™1
 = (*
cÚsŞe_¿m
)[35];

2371 
dig™2
 = (*
cÚsŞe_¿m
)[34];

2372 
dig™3
 = (*
cÚsŞe_¿m
)[33];

2373 
dig™4
 = (*
cÚsŞe_¿m
)[32];

2374 
scÜe
 = 
dig™1
 + 10 * 
dig™2
 + 100 * 
dig™3
 + 1000 * 
dig™4
;

2375 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2376 
i_´ev_scÜe
 = 
scÜe
;

2377  
»w¬d
;

2378 
	}
}

2380 
boŞ
 
	gMš”2049RS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2381 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2382 
äame_couÁ”
) {

2383 
by‹_v®
 = (*
cÚsŞe_¿m
)[79];

2384 
by‹_v®
 = byte_val & 15;

2385 ià(
by‹_v®
 < 3) {

2386 
i_´ev_scÜe
 = 0;

2387  
Œue
;

2389  
çl£
;

2390 
	}
}

2392 
	gBowlšgS‘tšgs
::
	$BowlšgS‘tšgs
() :

2393 
	`GameS‘tšgs
( "bowling.bin",

2394 
çl£
,

2395 
Œue
,

2398 
UNDEFINED


2400 
pv_possibË_aùiÚs
->
	`ş—r
();

2401 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2402 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2403 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2404 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2405 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2406 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2407 
	}
}

2409 
	gBowlšgS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2410 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2411 
scÜe
 = 
	`g‘_two_decim®_scÜe
(33, 38, 
cÚsŞe_¿m
);

2412 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2413 
i_´ev_scÜe
 = 
scÜe
;

2414  
»w¬d
;

2415 
	}
}

2417 
boŞ
 
	gBowlšgS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2418 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2419 
äame_couÁ”
) {

2420 
by‹_v®
 = (*
cÚsŞe_¿m
)[36];

2421 
by‹_v®
 = byte_val & 15;

2422 ià(
by‹_v®
 > 10) {

2423 
i_´ev_scÜe
 = 0;

2424  
Œue
;

2426  
çl£
;

2427 
	}
}

2429 
	gAs§uÉS‘tšgs
::
	$As§uÉS‘tšgs
() :

2430 
	`GameS‘tšgs
( "assault.bin",

2431 
çl£
,

2432 
Œue
,

2435 
UNDEFINED


2437 
pv_possibË_aùiÚs
->
	`ş—r
();

2438 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2439 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2440 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2441 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2442 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2443 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2444 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2446 
	}
}

2448 
	gAs§uÉS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2449 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2450 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(2, 1, 0, 
cÚsŞe_¿m
);

2451 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2452 
i_´ev_scÜe
 = 
scÜe
;

2453  
»w¬d
;

2454 
	}
}

2456 
boŞ
 
	gAs§uÉS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2457 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2458 
äame_couÁ”
) {

2459 
by‹_v®
 = (*
cÚsŞe_¿m
)[101];

2460 
by‹_v®
 = byte_val & 15;

2461 ià(
by‹_v®
 < 4) {

2462 
i_´ev_scÜe
 = 0;

2463  
Œue
;

2465  
çl£
;

2466 
	}
}

2468 
	gUpNDownS‘tšgs
::
	$UpNDownS‘tšgs
() :

2469 
	`GameS‘tšgs
( "up_n_down.bin",

2470 
çl£
,

2471 
Œue
,

2474 
PLAYER_A_FIRE


2476 
pv_possibË_aùiÚs
->
	`ş—r
();

2477 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2478 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2479 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2480 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2481 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2482 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2483 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2484 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2485 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2486 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2487 
	}
}

2489 
	gUpNDownS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2490 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2491 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(2, 1, 0, 
cÚsŞe_¿m
);

2492 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2493 
i_´ev_scÜe
 = 
scÜe
;

2494  
»w¬d
;

2495 
	}
}

2497 
boŞ
 
	gUpNDownS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2498 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2499 
äame_couÁ”
) {

2500 
by‹_v®
 = (*
cÚsŞe_¿m
)[6];

2501 
by‹_v®
 = byte_val & 15;

2502 ià(
by‹_v®
 < 4) {

2503 
i_´ev_scÜe
 = 0;

2504  
Œue
;

2506  
çl£
;

2507 
	}
}

2509 
	gKªg¬ooS‘tšgs
::
	$Kªg¬ooS‘tšgs
() :

2510 
	`GameS‘tšgs
( "kangaroo.bin",

2511 
çl£
,

2512 
Œue
,

2515 
UNDEFINED


2517 
pv_possibË_aùiÚs
->
	`ş—r
();

2518 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2519 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2520 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2521 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2522 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2523 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPRIGHT
);

2524 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPLEFT
);

2525 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2526 
	}
}

2528 
	gKªg¬ooS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2529 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2530 
scÜe
 = 
	`g‘_two_decim®_scÜe
(40, 39, 
cÚsŞe_¿m
);

2531 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2532 
i_´ev_scÜe
 = 
scÜe
;

2533  
»w¬d
;

2534 
	}
}

2536 
boŞ
 
	gKªg¬ooS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2537 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2538 
äame_couÁ”
) {

2539 
by‹_v®
 = (*
cÚsŞe_¿m
)[45];

2540 
by‹_v®
 = byte_val & 15;

2541 ià(
by‹_v®
 < 2) {

2542 
i_´ev_scÜe
 = 0;

2543  
Œue
;

2545  
çl£
;

2546 
	}
}

2548 
	gDeãnd”S‘tšgs
::
	$Deãnd”S‘tšgs
() :

2549 
	`GameS‘tšgs
( "defender.bin",

2550 
çl£
,

2551 
Œue
,

2554 
UNDEFINED


2556 
pv_possibË_aùiÚs
->
	`ş—r
();

2557 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2558 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2559 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2560 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2561 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2562 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2563 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2564 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2565 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2566 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2567 
	}
}

2569 
	gDeãnd”S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2570 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2571 
dig™1
 = (*
cÚsŞe_¿m
)[28] & 15;

2572 ià(
dig™1
 == 10) {

2573 
dig™1
 = 0;

2575 
dig™2
 = (*
cÚsŞe_¿m
)[29] & 15;

2576 ià(
dig™2
 == 10) {

2577 
dig™2
 = 0;

2579 
dig™3
 = (*
cÚsŞe_¿m
)[30] & 15;

2580 ià(
dig™3
 == 10) {

2581 
dig™3
 = 0;

2583 
dig™4
 = (*
cÚsŞe_¿m
)[31] & 15;

2584 ià(
dig™4
 == 10) {

2585 
dig™4
 = 0;

2587 
scÜe
 = 
dig™1
 + 10 * 
dig™2
 + 100 * 
dig™3
 + 1000 * 
dig™4
;

2588 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2589 
i_´ev_scÜe
 = 
scÜe
;

2590  
»w¬d
;

2591 
	}
}

2593 
boŞ
 
	gDeãnd”S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2594 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2595 
äame_couÁ”
) {

2596 
by‹_v®
 = (*
cÚsŞe_¿m
)[66];

2597 
by‹_v®
 = byte_val & 15;

2598 ià(
by‹_v®
 < 3) {

2599 
i_´ev_scÜe
 = 0;

2600  
Œue
;

2602  
çl£
;

2603 
	}
}

2605 
	gNameThisGameS‘tšgs
::
	$NameThisGameS‘tšgs
() :

2606 
	`GameS‘tšgs
( "name_this_game.bin",

2607 
çl£
,

2608 
Œue
,

2611 
PLAYER_A_FIRE


2613 
pv_possibË_aùiÚs
->
	`ş—r
();

2614 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2615 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2616 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2617 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2618 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2619 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2620 
	}
}

2622 
	gNameThisGameS‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2623 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2624 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(70, 69, 68, 
cÚsŞe_¿m
);

2625 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2626 
i_´ev_scÜe
 = 
scÜe
;

2627  
»w¬d
;

2628 
	}
}

2630 
boŞ
 
	gNameThisGameS‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2631 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2632 
äame_couÁ”
) {

2633 
by‹_v®
 = (*
cÚsŞe_¿m
)[71];

2634 
by‹_v®
 = byte_val & 15;

2635 ià(
by‹_v®
 < 3) {

2636 
i_´ev_scÜe
 = 0;

2637  
Œue
;

2639  
çl£
;

2640 
	}
}

2643 
	gP™çÎ2S‘tšgs
::
	$P™çÎ2S‘tšgs
() :

2644 
	`GameS‘tšgs
( "pitfall2.bin",

2645 
çl£
,

2646 
Œue
,

2649 
UNDEFINED


2651 
	}
}

2653 
	gP™çÎ2S‘tšgs
::
	$g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2654 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2655 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(73, 72, 71, 
cÚsŞe_¿m
);

2656 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2657 
i_´ev_scÜe
 = 
scÜe
;

2658  
»w¬d
;

2659 
	}
}

2661 
boŞ
 
	gP™çÎ2S‘tšgs
::
	$is_’d_of_game
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2662 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2663 
äame_couÁ”
) {

2664  
çl£
;

2665 
	}
}

2667 
	gPriv©eEyeS‘tšgs
::
	$Priv©eEyeS‘tšgs
() :

2668 
	`GameS‘tšgs
( "private_eye.bin",

2669 
çl£
,

2670 
Œue
,

2673 
PLAYER_A_FIRE


2675 
pv_possibË_aùiÚs
->
	`ş—r
();

2676 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2677 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2678 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2679 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2680 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2681 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2682 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2683 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2684 
	}
}

2686 
	gPriv©eEyeS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2687 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2688 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(74, 73, 72, 
cÚsŞe_¿m
);

2689 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2690 
i_´ev_scÜe
 = 
scÜe
;

2691  
»w¬d
;

2692 
	}
}

2694 
boŞ
 
	gPriv©eEyeS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2695 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2696 
äame_couÁ”
) {

2697 
i_äames_sšû_Ï¡_»¡¬t
++;

2698 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 3600) {

2699 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

2700 
i_´ev_scÜe
 = 0;

2701  
Œue
;

2703  
çl£
;

2705 
	}
}

2707 
	gDemÚA‰ackS‘tšgs
::
	$DemÚA‰ackS‘tšgs
() :

2708 
	`GameS‘tšgs
( "demon_attack.bin",

2709 
çl£
,

2710 
Œue
,

2713 
PLAYER_A_FIRE


2715 
pv_possibË_aùiÚs
->
	`ş—r
();

2716 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2717 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2718 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2719 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2720 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2721 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2722 
	}
}

2724 
	gDemÚA‰ackS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2725 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2726 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(5, 3, 1, 
cÚsŞe_¿m
);

2727 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2728 
i_´ev_scÜe
 = 
scÜe
;

2729  
»w¬d
;

2730 
	}
}

2732 
boŞ
 
	gDemÚA‰ackS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2733 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2734 
äame_couÁ”
) {

2735 
by‹_v®
 = (*
cÚsŞe_¿m
)[114];

2736 
by‹_v®
 = byte_val & 15;

2737 ià(
by‹_v®
 < 3) {

2738 
i_´ev_scÜe
 = 0;

2739  
Œue
;

2741  
çl£
;

2742 
	}
}

2744 
	gEËv©ÜAùiÚS‘tšgs
::
	$EËv©ÜAùiÚS‘tšgs
() :

2745 
	`GameS‘tšgs
( "elevator_action.bin",

2746 
çl£
,

2747 
Œue
,

2750 
PLAYER_A_FIRE


2752 
pv_possibË_aùiÚs
->
	`ş—r
();

2753 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2754 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2755 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2756 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2757 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2758 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2759 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2760 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UPFIRE
);

2761 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWNFIRE
);

2762 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2763 
	}
}

2765 
	gEËv©ÜAùiÚS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2766 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2767 
scÜe
 = 
	`g‘_two_decim®_scÜe
(8, 7, 
cÚsŞe_¿m
);

2768 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2769 
i_´ev_scÜe
 = 
scÜe
;

2770  
»w¬d
;

2771 
	}
}

2773 
boŞ
 
	gEËv©ÜAùiÚS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2774 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2775 
äame_couÁ”
) {

2776 
by‹_v®
 = (*
cÚsŞe_¿m
)[3];

2777 
by‹_v®
 = byte_val & 15;

2778 ià(
by‹_v®
 == 0) {

2781  
çl£
;

2783 ià(
by‹_v®
 < 4) {

2784 
i_´ev_scÜe
 = 0;

2785  
Œue
;

2787  
çl£
;

2788 
	}
}

2791 
	gJouºeyEsÿ³S‘tšgs
::
	$JouºeyEsÿ³S‘tšgs
() :

2792 
	`GameS‘tšgs
( "journey_escape.bin",

2793 
çl£
,

2794 
Œue
,

2797 
PLAYER_A_FIRE


2799 
pv_possibË_aùiÚs
->
	`ş—r
();

2800 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2801 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2802 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2803 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2804 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2805 
	}
}

2807 
	gJouºeyEsÿ³S‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2808 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2809 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(18, 17, 16, 
cÚsŞe_¿m
);

2810 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2811 
i_´ev_scÜe
 = 
scÜe
;

2812  
»w¬d
;

2813 
	}
}

2815 
boŞ
 
	gJouºeyEsÿ³S‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2816 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2817 
äame_couÁ”
) {

2818 
i_äames_sšû_Ï¡_»¡¬t
++;

2819 ià(
i_äames_sšû_Ï¡_»¡¬t
 > 3600) {

2820 
i_äames_sšû_Ï¡_»¡¬t
 = 0;

2821 
i_´ev_scÜe
 = 0;

2822  
Œue
;

2824  
çl£
;

2826 
	}
}

2828 
	gPhÛnixS‘tšgs
::
	$PhÛnixS‘tšgs
() :

2829 
	`GameS‘tšgs
( "phoenix.bin",

2830 
çl£
,

2831 
Œue
,

2834 
UNDEFINED


2836 
pv_possibË_aùiÚs
->
	`ş—r
();

2837 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2838 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2839 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2840 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2841 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHTFIRE
);

2842 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFTFIRE
);

2843 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_FIRE
);

2844 
	}
}

2846 
	gPhÛnixS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2847 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2848 
scÜe
 = 
	`g‘_two_decim®_scÜe
(72, 73,
cÚsŞe_¿m
) * 10;

2849 
scÜe
 +ğ((*
cÚsŞe_¿m
)[71] - ((*console_ram)[71] & 15)) >> 4;

2850 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2851 
i_´ev_scÜe
 = 
scÜe
;

2852  
»w¬d
;

2853 
	}
}

2855 
boŞ
 
	gPhÛnixS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2856 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2857 
äame_couÁ”
) {

2858 
by‹_v®
 = (*
cÚsŞe_¿m
)[75];

2859 
by‹_v®
 = byte_val & 15;

2860 ià(
by‹_v®
 < 5) {

2861 
i_´ev_scÜe
 = 0;

2862  
Œue
;

2864  
çl£
;

2865 
	}
}

2868 
	gFro¡b™eS‘tšgs
::
	$Fro¡b™eS‘tšgs
() :

2869 
	`GameS‘tšgs
( "frostbite.bin",

2870 
çl£
,

2871 
Œue
,

2874 
PLAYER_A_FIRE


2876 
pv_possibË_aùiÚs
->
	`ş—r
();

2877 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_NOOP
);

2878 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_RIGHT
);

2879 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_LEFT
);

2880 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_DOWN
);

2881 
pv_possibË_aùiÚs
->
	`push_back
(
PLAYER_A_UP
);

2882 
	}
}

2884 
	gFro¡b™eS‘tšgs
::
	$g‘_»w¬d
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2885 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) {

2886 
scÜe
 = 
	`g‘_th»e_decim®_scÜe
(74, 73, 72, 
cÚsŞe_¿m
);

2887 
»w¬d
 = ()(
scÜe
 - 
i_´ev_scÜe
);

2888 
i_´ev_scÜe
 = 
scÜe
;

2889  
»w¬d
;

2890 
	}
}

2892 
boŞ
 
	gFro¡b™eS‘tšgs
::
	$is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

2893 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

2894 
äame_couÁ”
) {

2895 
by‹_v®
 = (*
cÚsŞe_¿m
)[76];

2896 
by‹_v®
 = byte_val & 15;

2897 ià(
by‹_v®
 < 3) {

2898 
i_´ev_scÜe
 = 0;

2899  
Œue
;

2901  
çl£
;

2902 
	}
}

	@player_agents/game_settings.h

17 #iâdeà
GAME_SETTINGS_H


18 
	#GAME_SETTINGS_H


	)

21 
	~"commÚ_cÚ¡ªts.h
"

22 
	~"S”Ÿliz”.hxx
"

23 
	~"De£rŸliz”.hxx
"

24 
	~<m­
>

26 şas 
	cGameS‘tšgs
 {

56 
	mpublic
:

60 
GameS‘tšgs
Ğ
¡ršg
 
_rom_fe
,

61 
boŞ
 
_u£s_sü“n_m©rix
, boŞ 
_u£s_cÚsŞe_¿m
,

62 
_sk_äames_num
, 
_d–ay_aá”_»¡¬t
,

63 
AùiÚ
 
_fœ¡_aùiÚ
);

68 
	mvœtu®
 ~
GameS‘tšgs
();

74 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

75 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
) = 0;

82 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

83 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

84 
äame_couÁ”
) = 0;

90 
vœtu®
 
»£t_¡©e
();

96 
vœtu®
 
§ve_¡©e
(
S”Ÿliz”
& 
out
);

102 
vœtu®
 
lßd_¡©e
(
De£rŸliz”
& 
š
);

111 
GameS‘tšgs
* 
g’”©e_game_S‘tšgs_š¡ªû
(
¡ršg
 
rom_fe
);

114 
¡ršg
 
	ms_rom_fe
;

115 
AùiÚVeù
* 
	mpv_possibË_aùiÚs
;

116 
boŞ
 
	mb_u£s_sü“n_m©rix
;

119 
boŞ
 
	mb_u£s_cÚsŞe_¿m
;

122 
	mi_sk_äames_num
;

125 
	mi_d–ay_aá”_»¡¬t
;

129 
AùiÚ
 
	me_fœ¡_aùiÚ
;

133 
	mi_´ev_scÜe
;

134 
	mi_äames_sšû_Ï¡_»¡¬t
;

136 
	m´Ùeùed
:

142 
g‘_two_decim®_scÜe
Ğ
low”_šdex
, 
high”_šdex
,

143 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

150 
g‘_th»e_decim®_scÜe
(
low”_šdex
, 
middË_šdex
,

151 
high”_šdex
,

152 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

158 şas 
	cF»ewayS‘tšgs
 : 
public
 
GameS‘tšgs
 {

159 
public
:

160 
F»ewayS‘tšgs
();

161 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

162 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

163 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

164 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

165 
äame_couÁ”
);

169 şas 
	cS·ûInvad”sS‘tšgs
 : 
public
 
GameS‘tšgs
 {

170 
public
:

171 
S·ûInvad”sS‘tšgs
();

172 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

173 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

174 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

175 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

176 
äame_couÁ”
);

179 şas 
	cA¡rixS‘tšgs
 : 
public
 
GameS‘tšgs
 {

180 
public
:

181 
A¡rixS‘tšgs
();

182 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

183 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

184 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

185 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

186 
äame_couÁ”
);

189 şas 
	cS—que¡S‘tšgs
 : 
public
 
GameS‘tšgs
 {

190 
public
:

191 
S—que¡S‘tšgs
();

192 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

193 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

194 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

195 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

196 
äame_couÁ”
);

199 şas 
	cT’niS‘tšgs
 : 
public
 
GameS‘tšgs
 {

200 
public
:

201 
T’niS‘tšgs
();

202 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

203 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

204 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

205 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

206 
äame_couÁ”
);

210 şas 
	cWiz¬dofWÜS‘tšgs
 : 
public
 
GameS‘tšgs
 {

211 
public
:

212 
Wiz¬dofWÜS‘tšgs
();

213 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

214 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

215 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

216 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

217 
äame_couÁ”
);

220 şas 
	cKruÎS‘tšgs
 : 
public
 
GameS‘tšgs
 {

221 
public
:

222 
KruÎS‘tšgs
();

223 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

224 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

225 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

226 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

227 
äame_couÁ”
);

230 şas 
	cAªtisS‘tšgs
 : 
public
 
GameS‘tšgs
 {

231 
public
:

232 
AªtisS‘tšgs
();

233 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

234 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

235 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

236 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

237 
äame_couÁ”
);

240 şas 
	cHEROS‘tšgs
 : 
public
 
GameS‘tšgs
 {

241 
public
:

242 
HEROS‘tšgs
();

243 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

244 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

245 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

246 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

247 
äame_couÁ”
);

250 şas 
	cRiv”RaidS‘tšgs
 : 
public
 
GameS‘tšgs
 {

251 
public
:

252 
Riv”RaidS‘tšgs
();

253 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

254 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

255 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

256 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

257 
äame_couÁ”
);

258 
	m´iv©e
:

259 
m­
<, > 
	mm_¿m_v®s_to_dig™s
;

264 şas 
	cV’tu»S‘tšgs
 : 
public
 
GameS‘tšgs
 {

265 
public
:

266 
V’tu»S‘tšgs
();

267 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

268 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

269 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

270 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

271 
äame_couÁ”
);

274 şas 
	cC¿zyClimb”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

275 
public
:

276 
C¿zyClimb”S‘tšgs
();

277 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

278 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

279 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

280 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

281 
äame_couÁ”
);

284 şas 
	cFrÚtLšeS‘tšgs
 : 
public
 
GameS‘tšgs
 {

285 
public
:

286 
FrÚtLšeS‘tšgs
();

287 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

288 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

289 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

290 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

291 
äame_couÁ”
);

294 şas 
	cChİ³rCommªdS‘tšgs
 : 
public
 
GameS‘tšgs
 {

295 
public
:

296 
Chİ³rCommªdS‘tšgs
();

297 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

298 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

299 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

300 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

301 
äame_couÁ”
);

304 şas 
	cIûHockeyS‘tšgs
 : 
public
 
GameS‘tšgs
 {

305 
public
:

306 
IûHockeyS‘tšgs
();

307 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

308 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

309 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

310 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

311 
äame_couÁ”
);

314 şas 
	cMÚ‹zumaRev’geS‘tšgs
 : 
public
 
GameS‘tšgs
 {

315 
public
:

316 
MÚ‹zumaRev’geS‘tšgs
();

317 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

318 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

319 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

320 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

321 
äame_couÁ”
);

324 şas 
	cG¿v™¬S‘tšgs
 : 
public
 
GameS‘tšgs
 {

325 
public
:

326 
G¿v™¬S‘tšgs
();

327 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

328 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

329 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

330 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

331 
äame_couÁ”
);

334 şas 
	cC¬niv®S‘tšgs
 : 
public
 
GameS‘tšgs
 {

335 
public
:

336 
C¬niv®S‘tšgs
();

337 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

338 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

339 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

340 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

341 
äame_couÁ”
);

344 şas 
	cB—mRid”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

345 
public
:

346 
B—mRid”S‘tšgs
();

347 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

348 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

349 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

350 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

351 
äame_couÁ”
);

354 şas 
	cBoxšgS‘tšgs
 : 
public
 
GameS‘tšgs
 {

355 
public
:

356 
BoxšgS‘tšgs
();

357 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

358 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

359 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

360 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

361 
äame_couÁ”
);

364 şas 
	cB”z”kS‘tšgs
 : 
public
 
GameS‘tšgs
 {

365 
public
:

366 
B”z”kS‘tšgs
();

367 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

368 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

369 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

370 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

371 
äame_couÁ”
);

374 şas 
	cSrGuÂ”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

375 
public
:

376 
SrGuÂ”S‘tšgs
();

377 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

378 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

379 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

380 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

381 
äame_couÁ”
);

384 şas 
	cQB”tS‘tšgs
 : 
public
 
GameS‘tšgs
 {

385 
public
:

386 
QB”tS‘tšgs
();

387 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

388 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

389 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

390 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

391 
äame_couÁ”
);

394 şas 
	cAmid¬S‘tšgs
 : 
public
 
GameS‘tšgs
 {

395 
public
:

396 
Amid¬S‘tšgs
();

397 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

398 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

399 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

400 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

401 
äame_couÁ”
);

404 şas 
	cVideoPšb®lS‘tšgs
 : 
public
 
GameS‘tšgs
 {

405 
public
:

406 
VideoPšb®lS‘tšgs
();

407 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

408 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

409 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

410 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

411 
äame_couÁ”
);

414 şas 
	cGİh”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

415 
public
:

416 
Gİh”S‘tšgs
();

417 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

418 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

419 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

420 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

421 
äame_couÁ”
);

424 şas 
	cTimePÙS‘tšgs
 : 
public
 
GameS‘tšgs
 {

425 
public
:

426 
TimePÙS‘tšgs
();

427 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

428 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

429 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

430 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

431 
äame_couÁ”
);

434 şas 
	cFishšgD”byS‘tšgs
 : 
public
 
GameS‘tšgs
 {

435 
public
:

436 
FishšgD”byS‘tšgs
();

437 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

438 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

439 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

440 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

441 
äame_couÁ”
);

444 şas 
	cB©eZÚeS‘tšgs
 : 
public
 
GameS‘tšgs
 {

445 
public
:

446 
B©eZÚeS‘tšgs
();

447 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

448 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

449 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

450 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

451 
äame_couÁ”
);

454 şas 
	cP™çÎS‘tšgs
 : 
public
 
GameS‘tšgs
 {

455 
public
:

456 
P™çÎS‘tšgs
();

457 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

458 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

459 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

460 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

461 
äame_couÁ”
);

464 şas 
	cRoboTªkS‘tšgs
 : 
public
 
GameS‘tšgs
 {

465 
public
:

466 
RoboTªkS‘tšgs
();

467 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

468 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

469 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

470 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

471 
äame_couÁ”
);

474 şas 
	cJamesBÚdS‘tšgs
 : 
public
 
GameS‘tšgs
 {

475 
public
:

476 
JamesBÚdS‘tšgs
();

477 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

478 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

479 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

480 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

481 
äame_couÁ”
);

484 şas 
	cRßdRuÂ”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

485 
public
:

486 
RßdRuÂ”S‘tšgs
();

487 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

488 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

489 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

490 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

491 
äame_couÁ”
);

494 şas 
	cA¡roidsS‘tšgs
 : 
public
 
GameS‘tšgs
 {

495 
public
:

496 
A¡roidsS‘tšgs
();

497 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

498 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

499 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

500 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

501 
äame_couÁ”
);

504 şas 
	cTunkhamS‘tšgs
 : 
public
 
GameS‘tšgs
 {

505 
public
:

506 
TunkhamS‘tšgs
();

507 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

508 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

509 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

510 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

511 
äame_couÁ”
);

514 şas 
	cEnduroS‘tšgs
 : 
public
 
GameS‘tšgs
 {

515 
public
:

516 
EnduroS‘tšgs
();

517 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

518 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

519 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

520 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

521 
äame_couÁ”
);

524 şas 
	cPooyªS‘tšgs
 : 
public
 
GameS‘tšgs
 {

525 
public
:

526 
PooyªS‘tšgs
();

527 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

528 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

529 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

530 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

531 
äame_couÁ”
);

534 şas 
	cAœRaidS‘tšgs
 : 
public
 
GameS‘tšgs
 {

535 
public
:

536 
AœRaidS‘tšgs
();

537 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

538 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

539 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

540 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

541 
äame_couÁ”
);

544 şas 
	cAl›nS‘tšgs
 : 
public
 
GameS‘tšgs
 {

545 
public
:

546 
Al›nS‘tšgs
();

547 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

548 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

549 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

550 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

551 
äame_couÁ”
);

554 şas 
	cC’tedeS‘tšgs
 : 
public
 
GameS‘tšgs
 {

555 
public
:

556 
C’tedeS‘tšgs
();

557 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

558 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

559 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

560 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

561 
äame_couÁ”
);

564 şas 
	cSŞ¬isS‘tšgs
 : 
public
 
GameS‘tšgs
 {

565 
public
:

566 
SŞ¬isS‘tšgs
();

567 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

568 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

569 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

570 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

571 
äame_couÁ”
);

574 şas 
	cBªkHei¡S‘tšgs
 : 
public
 
GameS‘tšgs
 {

575 
public
:

576 
BªkHei¡S‘tšgs
();

577 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

578 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

579 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

580 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

581 
äame_couÁ”
);

584 şas 
	cZaxxÚS‘tšgs
 : 
public
 
GameS‘tšgs
 {

585 
public
:

586 
ZaxxÚS‘tšgs
();

587 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

588 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

589 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

590 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

591 
äame_couÁ”
);

594 şas 
	cMsPacmª
 : 
public
 
GameS‘tšgs
 {

595 
public
:

596 
MsPacmª
();

597 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

598 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

599 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

600 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

601 
äame_couÁ”
);

604 şas 
	cSkišgS‘tšgs
 : 
public
 
GameS‘tšgs
 {

605 
public
:

606 
SkišgS‘tšgs
();

607 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

608 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

609 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

610 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

611 
äame_couÁ”
);

614 şas 
	cDoubËDunkS‘tšgs
 : 
public
 
GameS‘tšgs
 {

615 
public
:

616 
DoubËDunkS‘tšgs
();

617 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

618 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

619 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

620 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

621 
äame_couÁ”
);

624 şas 
	cJou¡S‘tšgs
 : 
public
 
GameS‘tšgs
 {

625 
public
:

626 
Jou¡S‘tšgs
();

627 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

628 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

629 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

630 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

631 
äame_couÁ”
);

634 şas 
	cKungFuMa¡”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

635 
public
:

636 
KungFuMa¡”S‘tšgs
();

637 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

638 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

639 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

640 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

641 
äame_couÁ”
);

644 şas 
	cCªyÚBomb”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

645 
public
:

646 
CªyÚBomb”S‘tšgs
();

647 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

648 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

649 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

650 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

651 
äame_couÁ”
);

654 şas 
	cMš”2049RS‘tšgs
 : 
public
 
GameS‘tšgs
 {

655 
public
:

656 
Mš”2049RS‘tšgs
();

657 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

658 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

659 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

660 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

661 
äame_couÁ”
);

664 şas 
	cBowlšgS‘tšgs
 : 
public
 
GameS‘tšgs
 {

665 
public
:

666 
BowlšgS‘tšgs
();

667 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

668 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

669 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

670 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

671 
äame_couÁ”
);

674 şas 
	cAs§uÉS‘tšgs
 : 
public
 
GameS‘tšgs
 {

675 
public
:

676 
As§uÉS‘tšgs
();

677 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

678 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

679 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

680 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

681 
äame_couÁ”
);

684 şas 
	cUpNDownS‘tšgs
 : 
public
 
GameS‘tšgs
 {

685 
public
:

686 
UpNDownS‘tšgs
();

687 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

688 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

689 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

690 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

691 
äame_couÁ”
);

694 şas 
	cKªg¬ooS‘tšgs
 : 
public
 
GameS‘tšgs
 {

695 
public
:

696 
Kªg¬ooS‘tšgs
();

697 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

698 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

699 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

700 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

701 
äame_couÁ”
);

704 şas 
	cDeãnd”S‘tšgs
 : 
public
 
GameS‘tšgs
 {

705 
public
:

706 
Deãnd”S‘tšgs
();

707 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

708 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

709 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

710 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

711 
äame_couÁ”
);

714 şas 
	cNameThisGameS‘tšgs
 : 
public
 
GameS‘tšgs
 {

715 
public
:

716 
NameThisGameS‘tšgs
();

717 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

718 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

719 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

720 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

721 
äame_couÁ”
);

724 şas 
	cP™çÎ2S‘tšgs
 : 
public
 
GameS‘tšgs
 {

725 
public
:

726 
P™çÎ2S‘tšgs
();

727 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

728 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

729 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

730 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

731 
äame_couÁ”
);

734 şas 
	cPriv©eEyeS‘tšgs
 : 
public
 
GameS‘tšgs
 {

735 
public
:

736 
Priv©eEyeS‘tšgs
();

737 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

738 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

739 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

740 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

741 
äame_couÁ”
);

744 şas 
	cDemÚA‰ackS‘tšgs
 : 
public
 
GameS‘tšgs
 {

745 
public
:

746 
DemÚA‰ackS‘tšgs
();

747 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

748 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

749 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

750 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

751 
äame_couÁ”
);

754 şas 
	cEËv©ÜAùiÚS‘tšgs
 : 
public
 
GameS‘tšgs
 {

755 
public
:

756 
EËv©ÜAùiÚS‘tšgs
();

757 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

758 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

759 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

760 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

761 
äame_couÁ”
);

764 şas 
	cJouºeyEsÿ³S‘tšgs
 : 
public
 
GameS‘tšgs
 {

765 
public
:

766 
JouºeyEsÿ³S‘tšgs
();

767 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

768 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

769 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

770 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

771 
äame_couÁ”
);

774 şas 
	cPhÛnixS‘tšgs
 : 
public
 
GameS‘tšgs
 {

775 
public
:

776 
PhÛnixS‘tšgs
();

777 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

778 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

779 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

780 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

781 
äame_couÁ”
);

784 şas 
	cFro¡b™eS‘tšgs
 : 
public
 
GameS‘tšgs
 {

785 
public
:

786 
Fro¡b™eS‘tšgs
();

787 
vœtu®
 
g‘_»w¬d
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

788 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
);

789 
vœtu®
 
boŞ
 
is_’d_of_game
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

790 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

791 
äame_couÁ”
);

	@player_agents/grid_screen_agent.cpp

16 
	~<s¡»am
>

17 
	~"expÜt_toŞs.h
"

18 
	~"game_cÚŒŞËr.h
"

19 
	~"grid_sü“n_ag’t.h
"

22 
	gGridSüAg’t
::
	$GridSüAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

23 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
) {

25 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

26 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

27 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

28 
i_num_cŞÜs
 = 8;

29 
b_do_subŒaù_bg
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("do_subtract_background",

30 
Œue
);

31 
i_num_block_³r_row
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("num_block_per_row",

32 
Œue
);

33 
i_num_block_³r_cŞ
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("num_block_per_col",

34 
Œue
);

35 iàĞ(
i_sü“n_width
 % 
i_num_block_³r_cŞ
 != 0) ||

36 (
i_sü“n_height
 % 
i_num_block_³r_row
 != 0) ) {

37 
û¼
 << "WARNING: Invalid i_num_block_per_row or i_num_block_per_col value."

40 << 
’dl
;

41 
	`ex™
(-1);

43 
i_block_height
 = 
i_sü“n_height
 / 
i_num_block_³r_row
;

44 
i_block_width
 = 
i_sü“n_width
 / 
i_num_block_³r_cŞ
;

45 
i_blocks_b™s_Ëngth
 = 
i_num_block_³r_row
*
i_num_block_³r_cŞ
*
i_num_cŞÜs
;

47 
i_ba£_Ëngth
 = 
i_blocks_b™s_Ëngth
 +

48 (
i_blocks_b™s_Ëngth
 * (i_blocks_bits_length / 2) -

49 (
i_blocks_b™s_Ëngth
 / 2));

51 
i_fuÎ_ã©u»_vec_Ëngth
 = 
i_ba£_Ëngth
 * 
i_num_aùiÚs
;

52 
cout
 << "FuÎ F—tu»-VeùÜ L’gth: " << 
i_fuÎ_ã©u»_vec_Ëngth
 << 
’dl
;

53 
p_§r§_Ïmbda_sŞv”
 = 
RLS¬§Lambda
::
	`g’”©e_¾_§r§_Ïmbda_š¡ªû
(

54 
p_osy¡em
, 
i_fuÎ_ã©u»_vec_Ëngth
, 
i_num_aùiÚs
);

55 
pv_cu¼_ã©u»_m­
 = 
Ãw
 
	`F—tu»M­
();

56 
pv_num_nÚz”o_š_f
 = 
Ãw
 
	`IÁVeù
();

57 
i
 = 0; i < 
i_num_aùiÚs
; i++) {

58 
IÁA¼
 
ã©u»_vec
 = 
	`IÁA¼
(-1, 
i_ba£_Ëngth
);

59 
pv_cu¼_ã©u»_m­
->
	`push_back
(
ã©u»_vec
);

60 
pv_num_nÚz”o_š_f
->
	`push_back
(0);

62 
pv_tmp_fv_fœ¡_·¹
 = 
Ãw
 
	`IÁA¼
(-1, 
i_blocks_b™s_Ëngth
);

63 
pv_tmp_cŞÜ_b™s
 = 
Ãw
 
IÁVeù
;

64 
c
 = 0; c < 
i_num_cŞÜs
; c++) {

65 
pv_tmp_cŞÜ_b™s
->
	`push_back
(0);

67 
pv_subveùÜ_pos™iÚs
 = 
Ãw
 
IÁVeù
;

68 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

69 
pv_subveùÜ_pos™iÚs
->
	`push_back
(
a
 * 
i_ba£_Ëngth
);

72 
b_’d_•isode_w™h_»w¬d
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
(

73 "’d_•isode_w™h_»w¬d", 
Œue
);

74 
b_¶Ù_dœsü_grids
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
("plot_gridscr_grids",

75 
Œue
);

76 ià(
b_do_subŒaù_bg
) {

78 
pm_background_m©rix
 = 
Ãw
 
IÁM©rix
;

79 
	`impÜt_m©rix
(
pm_background_m©rix
, "background_matrix.txt");

81 
pm_background_m©rix
 = 
NULL
;

83 
	}
}

85 
	gGridSüAg’t
::~
	$GridSüAg’t
() {

86 
d–‘e
 
p_§r§_Ïmbda_sŞv”
;

87 
d–‘e
 
pv_cu¼_ã©u»_m­
;

88 
d–‘e
 
pv_num_nÚz”o_š_f
;

89 
d–‘e
 
pv_tmp_fv_fœ¡_·¹
;

90 
d–‘e
 
pv_tmp_cŞÜ_b™s
;

91 
d–‘e
 
pv_subveùÜ_pos™iÚs
;

92 ià(
pm_background_m©rix
) {

93 
d–‘e
 
pm_background_m©rix
;

95 
	}
}

100 
AùiÚ
 
	gGridSüAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

101 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
, 
äame_numb”
) {

102 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

103 
äame_numb”
);

104 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

105  
¥ecŸl_aùiÚ
;

107 ià(
b_’d_•isode_w™h_»w¬d
 && 
b_»w¬d_Ú_this_äame
) {

108 
cout
 << "Endšgƒpisodw™h„ew¬d: VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

109 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

110 
AùiÚ
 
fœ¡_aù
 = 
	`Ú_¡¬t_of_game
();

111  
fœ¡_aù
;

113 
	`g’”©e_ã©u»_vec
();

114 ià(
b_¶Ù_dœsü_grids
) {

115 
	`¶Ù_exŒaùed_grid
();

118 
Ãxt_aùiÚ_šd
;

119 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

120 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

121 
pv_cu¼_ã©u»_m­
,

122 
pv_num_nÚz”o_š_f
,

123 
f_cu¼_»w¬d
,

124 
i_cu¼_ex¶_aù_šdex
);

125 
	`as£¹
(
Ãxt_aùiÚ_šd
 =ğ
i_cu¼_ex¶_aù_šdex
);

127 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

128 
pv_cu¼_ã©u»_m­
,

129 
pv_num_nÚz”o_š_f
,

130 
f_cu¼_»w¬d
);

132  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

133 
	}
}

138 
AùiÚ
 
	gGridSüAg’t
::
	$Ú_¡¬t_of_game
() {

139 
	`g’”©e_ã©u»_vec
();

140 
	`as£¹
((*
pv_num_nÚz”o_š_f
)[0] > 0);

141 
Ãxt_aùiÚ_šd
;

142 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

143 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

144 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
,

145 
i_cu¼_ex¶_aù_šdex
);

147 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

148 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
);

150  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

152 
	}
}

158 
	gGridSüAg’t
::
	$Ú_’d_of_game
() {

159 
PÏy”Ag’t
::
	`Ú_’d_of_game
();

160 
cout
 << "VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

161 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

162 
	}
}

164 
	gGridSüAg’t
::
	$g’”©e_ã©u»_vec
() {

165 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

166 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

168 
fuÎ_veù_šdex
 = 0;

169 
i
, 
j
, 
c
, 
b™_v®
;

172 
c
 = 0; c < 
i_num_cŞÜs
; c++) {

173 (*
pv_tmp_cŞÜ_b™s
)[
c
] = 0;

175 
i
 = 0; i < 
i_num_block_³r_row
; i++) {

176 
j
 = 0; j < 
i_num_block_³r_cŞ
; j++) {

177 
	`g‘_cŞÜ_šd_äom_block
(
i
, 
j
, 
pv_tmp_cŞÜ_b™s
);

178 
c
 = 0; c < 
i_num_cŞÜs
; c++) {

179 
b™_v®
 = (*
pv_tmp_cŞÜ_b™s
)[
c
];

180 (*
pv_tmp_fv_fœ¡_·¹
)[
fuÎ_veù_šdex
] = 
b™_v®
;

181 ià(
b™_v®
 == 1) {

182 
	`add_Úe_šdex_to_ã©u»_m­
(
fuÎ_veù_šdex
);

184 
fuÎ_veù_šdex
++;

189 
i
 = 0; i < 
i_blocks_b™s_Ëngth
; i++) {

195 
j
 = 
i
 + 1; j < 
i_blocks_b™s_Ëngth
; j++) {

196 ià((*
pv_tmp_fv_fœ¡_·¹
)[
i
] == 1 &&

197 (*
pv_tmp_fv_fœ¡_·¹
)[
j
] == 1) {

198 
	`add_Úe_šdex_to_ã©u»_m­
(
fuÎ_veù_šdex
);

200 
fuÎ_veù_šdex
++;

203 
	`as£¹
(
fuÎ_veù_šdex
 =ğ
i_ba£_Ëngth
);

204 
	}
}

214 
	gGridSüAg’t
::
	$g‘_cŞÜ_šd_äom_block
(
i
, 
j
, 
IÁVeù
* 
cŞÜ_b™s
) {

216 
c
 = 0; c < 
i_num_cŞÜs
; c++) {

217 (*
cŞÜ_b™s
)[
c
] = 0;

219 
	`as£¹
 (
i
 >ğ0 && i < 
i_num_block_³r_row
);

220 
	`as£¹
 (
j
 >ğ0 && j < 
i_num_block_³r_cŞ
);

221 
img_i
 = 
i
 * 
i_block_height
;

222 
img_j
 = 
j
 * 
i_block_width
;

223 
block_row
 = 0; block_row < 
i_block_height
; block_row++) {

224 
block_cŞ
 = 0; block_cŞ < 
i_block_width
; block_col++) {

225 
y
 = 
img_i
 + 
block_row
;

226 
x
 = 
img_j
 + 
block_cŞ
;

227 
	`as£¹
 (
y
 >ğ0 && y < 
i_sü“n_height
);

228 
	`as£¹
 (
x
 >ğ0 && x < 
i_sü“n_width
);

229 
cŞÜ_šd
 = (*
pm_cu¼_sü“n_m©rix
)[
y
][
x
];

230 ià(
b_do_subŒaù_bg
 &&

231 
cŞÜ_šd
 =ğ(*
pm_background_m©rix
)[
y
][
x
] ) {

234 
	`as£¹
(
cŞÜ_šd
 >= 0 && color_ind < 256);

235 
	`as£¹
(
cŞÜ_šd
 % 2 == 0);

236 
cŞÜ_b™
 = 
pi_eight_b™_·Î‘e
[
cŞÜ_šd
];

237 (*
cŞÜ_b™s
)[
cŞÜ_b™
] = 1;

240 
	}
}

246 
	gGridSüAg’t
::
	$¶Ù_exŒaùed_grid
() {

247 
box_Ën
 = 4;

249 
IÁM©rix
* 
grid_¶Ù
 = 
Ãw
 IntMatrix;

250 
¶Ù_rows
 = (
i_num_block_³r_row
 * 
box_Ën
) + i_num_block_per_row + 1;

251 
¶Ù_cŞs
 = (
i_num_block_³r_cŞ
 * 
box_Ën
) + i_num_block_per_col + 1;

252 
i
 = 0; i < 
¶Ù_rows
; i++) {

253 
IÁVeù
 
row
;

254 
j
 = 0; j < 
¶Ù_cŞs
; j++) {

255 
row
.
	`push_back
(256 + 
BLACK_COLOR_IND
);

257 
grid_¶Ù
->
	`push_back
(
row
);

260 
row_num
 = 0;

261 
i
 = 0; i <ğ
i_num_block_³r_row
; i++) {

262 
cŞ_num
 = 0; cŞ_num < 
¶Ù_cŞs
; col_num++) {

263 (*
grid_¶Ù
)[
row_num
][
cŞ_num
] = 256 + 
WHITE_COLOR_IND
;

265 
row_num
 +ğ(
box_Ën
 + 1);

267 
cŞ_num
 = 0;

268 
j
 = 0; j <ğ
i_num_block_³r_cŞ
; j++) {

269 
row_num
 = 0;„ow_num < 
¶Ù_rows
;„ow_num++) {

270 (*
grid_¶Ù
)[
row_num
][
cŞ_num
] = 256 + 
WHITE_COLOR_IND
;

272 
cŞ_num
 +ğ(
box_Ën
 + 1);

276 
cu¼_row
 = 1;

277 
IÁVeù
 
block_cŞÜs
;

278 
i
 = 0; i < 
i_num_block_³r_row
; i++) {

279 
cu¼_cŞ
 = 1;

280 
j
 = 0; j < 
i_num_block_³r_cŞ
; j++) {

282 
	`g‘_cŞÜ_šd_äom_block
(
i
, 
j
, 
pv_tmp_cŞÜ_b™s
);

283 
block_cŞÜs
.
	`ş—r
();

284 
c
 = 0; c < 
i_num_cŞÜs
; c++) {

285 ià((*
pv_tmp_cŞÜ_b™s
)[
c
]) {

286 
block_cŞÜs
.
	`push_back
(256 + 
SECAM_COLOR_IND
 + 
c
);

291 ià(
block_cŞÜs
.
	`size
() > 0) {

292 
cu¼_cŞÜ_šd
 = 0;

293 
box_i
 = 0; box_˜< 
box_Ën
; box_i++) {

294 
box_j
 = 0; box_j < 
box_Ën
; box_j++) {

295 (*
grid_¶Ù
)[
cu¼_row
+
box_i
][
cu¼_cŞ
+
box_j
] =

296 
block_cŞÜs
[
cu¼_cŞÜ_šd
];

297 
cu¼_cŞÜ_šd
++;

298 ià(
cu¼_cŞÜ_šd
 =ğ
block_cŞÜs
.
	`size
()) {

299 
cu¼_cŞÜ_šd
 = 0;

305 
cu¼_cŞ
 +ğ(
box_Ën
 + 1);

307 
cu¼_row
 +ğ(
box_Ën
 + 1);

311 
o¡ršg¡»am
 
f’ame
;

312 
bufãr
 [50];

313 
	`¥rštf
 (
bufãr
, "%09d", 
i_äame_couÁ”
);

314 
f’ame
 << "exŒaùed_grid__äame_" << 
bufãr
 << ".png";

315 
p_osy¡em
->
p_expÜt_sü“n
->
	`expÜt_ªy_m©rix
(
grid_¶Ù
, 
f’ame
.
	`¡r
());

316 
d–‘e
 
grid_¶Ù
;

317 
	}
}

321 
uIÁ32
 
	gGridSüAg’t
::
pi_eight_b™_·Î‘e
 [256] = {

	@player_agents/grid_screen_agent.h

16 #iâdeà
DIRECT_SCREEN_AGENT_H


17 
	#DIRECT_SCREEN_AGENT_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"¶ay”_ag’t.h
"

21 
	~"¾_§r§_Ïmbda.h
"

23 şas 
	cGridSüAg’t
 : 
public
 
PÏy”Ag’t
 {

65 
public
:

67 
GridSüAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

68 
	mvœtu®
 ~
GridSüAg’t
();

73 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

74 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

75 
äame_numb”
);

80 
vœtu®
 
Ú_’d_of_game
();

82 
	m´Ùeùed
:

96 
vœtu®
 
g’”©e_ã©u»_vec
();

101 
šlše
 
	$add_Úe_šdex_to_ã©u»_m­
(
Úe_šdex
) {

102 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

103 (*
pv_cu¼_ã©u»_m­
)[
a
][(*
pv_num_nÚz”o_š_f
)[a]] =

104 
Úe_šdex
 + (*
pv_subveùÜ_pos™iÚs
)[
a
];

105 (*
pv_num_nÚz”o_š_f
)[
a
] = (*pv_num_nonzero_in_f)[a] + 1;

113 
vœtu®
 
AùiÚ
 
	`Ú_¡¬t_of_game
();

120 
	`g‘_cŞÜ_šd_äom_block
(
i
, 
j
, 
IÁVeù
* 
cŞÜ_šds
);

125 
	`¶Ù_exŒaùed_grid
();

127 
F—tu»M­
* 
pv_cu¼_ã©u»_m­
;

128 
IÁVeù
* 
pv_num_nÚz”o_š_f
;

129 
RLS¬§Lambda
* 
p_§r§_Ïmbda_sŞv”
;

130 
IÁA¼
* 
pv_tmp_fv_fœ¡_·¹
;

131 
IÁVeù
* 
pv_tmp_cŞÜ_b™s
;

132 
IÁM©rix
* 
pm_background_m©rix
;

133 
f_®pha_muÉl›r
;

134 
i_num_block_³r_row
;

135 
i_num_block_³r_cŞ
;

136 
i_num_cŞÜs
;

137 
i_blocks_b™s_Ëngth
;

138 
i_ba£_Ëngth
;

139 
i_fuÎ_ã©u»_vec_Ëngth
;

140 
IÁVeù
* 
pv_subveùÜ_pos™iÚs
;

141 
boŞ
 
b_’d_•isode_w™h_»w¬d
;

142 
uIÁ32
 
pi_eight_b™_·Î‘e
[256];

143 
i_block_height
;

144 
i_block_width
;

145 
i_sü“n_height
;

146 
i_sü“n_width
;

147 
boŞ
 
b_do_subŒaù_bg
;

148 
boŞ
 
b_¶Ù_dœsü_grids
;

149 
	}
};

	@player_agents/mountain_car_test.cpp

15 
	~<m©h.h
>

16 
	~"OSy¡em.hxx
"

17 
	~"mouÁaš_ÿr_‹¡.h
"

18 
	~"tes2.h
"

19 
	~"expÜt_toŞs.h
"

24 
	gMouÁªC¬
::
	$MouÁªC¬
(
OSy¡em
* 
_osy¡em
) {

25 
mš_pos™iÚ
 = -1.2;

26 
max_pos™iÚ
 = 0.6;

27 
gßl_pos™iÚ
 = 0.5;

28 
max_v–oc™y
 = 0.07;

29 
possibË_aùiÚs
[0]= -1.0;

30 
possibË_aùiÚs
[1]= 0.0;

31 
possibË_aùiÚs
[2]= 1.0;

32 
num_aùiÚs
 = 3;

33 
num_ob£rv©iÚs
 = 2;

34 
is_š_‹rmš®
 = 
çl£
;

35 
max_num_¡•s
 = 1000000;

36 
cu¼_¡•_num
 = 0;

38 
num_tšgs
 = 14;

39 
memÜy_size
 = 10000;

40 
pos_sÿË
 = 1.7 / 8.0;

41 
v–_sÿË
 = 0.14 / 8.0;

42 
¡©e_pos™iÚ
 = 0.0;

43 
¡©e_v–oc™y
 = 0.0;

44 
pv_cu¼_ã©u»_m­
 = 
Ãw
 
	`F—tu»M­
();

45 
pv_num_nÚz”o_š_f
 = 
Ãw
 
	`IÁVeù
();

46 
i
 = 0; i < 
num_aùiÚs
; i++) {

47 
IÁA¼
 
ã©u»_vec
 = 
	`IÁA¼
(-1, 
num_tšgs
);

48 
pv_cu¼_ã©u»_m­
->
	`push_back
(
ã©u»_vec
);

49 
pv_num_nÚz”o_š_f
->
	`push_back
(
num_tšgs
);

51 
®pha
 = 0.5 / 
num_tšgs
;

52 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("epsilon", 0.1);

53 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("lambda", 0.95);

54 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("gamma", 1.0);

55 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("®pha", 
®pha
);

56 
_osy¡em
->
	`£‰šgs
().
	`£tBoŞ
("İtimi¡ic_š™", 
Œue
);

57 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("trace_vec_size_ratio", 0.1);

58 
_osy¡em
->
	`£‰šgs
().
	`£tFlßt
("minimum_trace_value", 0.01);

59 
§r§_Ïmbda_sŞv”
 = 
RLS¬§Lambda
::
	`g’”©e_¾_§r§_Ïmbda_š¡ªû
(

60 
_osy¡em
, 
memÜy_size
, 
num_aùiÚs
);

62 
	}
}

67 
	gMouÁªC¬
::~
	$MouÁªC¬
() {

68 
d–‘e
 
pv_cu¼_ã©u»_m­
;

69 
d–‘e
 
pv_num_nÚz”o_š_f
;

70 
d–‘e
 
§r§_Ïmbda_sŞv”
;

71 
	}
}

76 
	gMouÁªC¬
::
	$run_sšgË_•isode
() {

77 
	`š™Ÿlize_¡©e_to_¿ndom
();

79 
cout
 << "In™ŸÈPos: " << 
¡©e_pos™iÚ
 << " - ";

80 
cout
 << "In™ŸÈV–: "<< 
¡©e_v–oc™y
 << " - ";

81 
tÙ®_»w¬d
 = 0.0;

82 
	`g’”©e_ã©u»_vec
();

83 
Ãxt_aùiÚ_šd
 = 
§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

84 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
);

85 
Ãxt_aùiÚ
 = 
possibË_aùiÚs
[
Ãxt_aùiÚ_šd
];

86 
boŞ
 
•isode_‹rmš©ed
 = 
çl£
;

87 
cu¼_¡•_num
 = 0;

88 
Œue
) {

89 
cu¼_¡•_num
++;

91 
	`upd©e_¡©e
(
Ãxt_aùiÚ
);

92 
•isode_‹rmš©ed
 = 
	`is_š_‹rmš©šg_¡©e
();

93 ià(
•isode_‹rmš©ed
) {

94 
§r§_Ïmbda_sŞv”
->
	`•isode_’d
(-1.0, -1.0);

98 
	`g’”©e_ã©u»_vec
();

99 
»w¬d
 = -1.0;

100 
tÙ®_»w¬d
 +ğ
»w¬d
;

102 
Ãxt_aùiÚ_šd
 = 
§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

103 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
, 
»w¬d
);

104 
Ãxt_aùiÚ
 = 
possibË_aùiÚs
[
Ãxt_aùiÚ_šd
];

106  
tÙ®_»w¬d
;

107 
	}
}

112 
	gMouÁªC¬
::
	$run_ex³rim’t
(
num_•isodes
) {

113 
FlßtVeù
 
v_»w¬ds
;

114 
i
 = 0; i < 
num_•isodes
; i++) {

115 
cout
 << "EpsidÛ " << 
i
 << ": ";

116 
tÙ®_»w¬d
 = 
	`run_sšgË_•isode
();

117 
v_»w¬ds
.
	`push_back
(
tÙ®_»w¬d
);

118 
cout
 << "Sum Rew¬d = " << 
tÙ®_»w¬d
 << " \n";

120 
	`expÜt_veùÜ
(&
v_»w¬ds
, "mountain_car_rewards.txt");

121 
	}
}

126 
	gMouÁªC¬
::
	$š™Ÿlize_¡©e_to_¿ndom
() {

127 
¡©e_pos™iÚ
 = (
	`d¿nd48
()*(
gßl_pos™iÚ
 + 
	`çbs
(
mš_pos™iÚ
)) + min_position);

128 
¡©e_v–oc™y
 = (
	`d¿nd48
()*(
max_v–oc™y
*2) - max_velocity);

129 
	}
}

134 
	gMouÁªC¬
::
	$š™Ÿlize_¡©e_to_bÙtom
() {

135 
¡©e_pos™iÚ
 = -
M_PI
/6.0;

136 
¡©e_v–oc™y
 = 0.0;

137 
	}
}

143 
	gMouÁªC¬
::
	$upd©e_¡©e
(
aùiÚ
) {

146 
¡©e_v–oc™y
 +ğ((
aùiÚ
 * 0.001è+ 
	`cos
(3.0 * 
¡©e_pos™iÚ
) * (-0.0025));

147 ià(
¡©e_v–oc™y
 > 
max_v–oc™y
) {

148 
¡©e_v–oc™y
 = 
max_v–oc™y
;

150 ià(
¡©e_v–oc™y
 < -
max_v–oc™y
) {

151 
¡©e_v–oc™y
 = -
max_v–oc™y
;

155 
¡©e_pos™iÚ
 +ğ
¡©e_v–oc™y
;

156 ià(
¡©e_pos™iÚ
 > 
max_pos™iÚ
) {

157 
¡©e_pos™iÚ
 = 
max_pos™iÚ
;

159 ià(
¡©e_pos™iÚ
 < 
mš_pos™iÚ
) {

160 
¡©e_pos™iÚ
 = 
mš_pos™iÚ
;

162 ià(
¡©e_pos™iÚ
 =ğ
mš_pos™iÚ
 && 
¡©e_v–oc™y
 < 0) {

163 
¡©e_v–oc™y
 = 0;

165 
	}
}

170 
boŞ
 
	gMouÁªC¬
::
	$is_š_‹rmš©šg_¡©e
() {

171 iàĞ
¡©e_pos™iÚ
 >ğ
gßl_pos™iÚ
 ||

172 
cu¼_¡•_num
 > 
max_num_¡•s
) {

173  
Œue
;

175  
çl£
;

177 
	}
}

182 
	gMouÁªC¬
::
	$g’”©e_ã©u»_vec
() {

183 
æßt_vec
[2];

184 
æßt_vec
[0] = 
¡©e_pos™iÚ
 / 
pos_sÿË
;

185 
æßt_vec
[1] = 
¡©e_v–oc™y
 / 
v–_sÿË
;

187 
a
 = 0;‡ < 
num_aùiÚs
;‡++) {

189 
	`G‘Tes
(&((*
pv_cu¼_ã©u»_m­
)[
a
]), 
num_tšgs
, 
memÜy_size
,

190 
æßt_vec
, 
num_ob£rv©iÚs
, 
a
);

195 
	}
}

	@player_agents/mountain_car_test.h

16 #iâdeà
MOUNTAIN_CAR_TEST_H


17 
	#MOUNTAIN_CAR_TEST_H


	)

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"¾_§r§_Ïmbda.h
"

22 
şass
 
	gOSy¡em
;

24 şas 
	cMouÁªC¬
 {

25 
	mpublic
:

29 
MouÁªC¬
(
OSy¡em
* 
_osy¡em
);

34 ~
MouÁªC¬
();

39 
run_sšgË_•isode
();

44 
run_ex³rim’t
(
num_•isodes
);

50 
š™Ÿlize_¡©e_to_¿ndom
();

55 
š™Ÿlize_¡©e_to_bÙtom
();

60 
upd©e_¡©e
(
aùiÚ
);

65 
boŞ
 
is_š_‹rmš©šg_¡©e
();

70 
g’”©e_ã©u»_vec
();

71 
	mmš_pos™iÚ
;

72 
	mmax_pos™iÚ
;

73 
	mgßl_pos™iÚ
;

74 
	mmax_v–oc™y
;

75 
	mpossibË_aùiÚs
[3];

76 
	mnum_aùiÚs
;

77 
	mnum_ob£rv©iÚs
;

78 
boŞ
 
	mis_š_‹rmš®
;

79 
	mmax_num_¡•s
;

80 
	mcu¼_¡•_num
;

81 
	mnum_tšgs
;

82 
	mmemÜy_size
;

83 
	mpos_sÿË
;

84 
	mv–_sÿË
;

85 
	m¡©e_pos™iÚ
;

86 
	m¡©e_v–oc™y
;

87 
F—tu»M­
* 
	mpv_cu¼_ã©u»_m­
;

88 
IÁVeù
* 
	mpv_num_nÚz”o_š_f
;

89 
RLS¬§Lambda
* 
	m§r§_Ïmbda_sŞv”
;

	@player_agents/player_agent.cpp

14 
	~<s¡»am
>

15 
	~"¶ay”_ag’t.h
"

16 
	~"¿ndom_ag’t.h
"

17 
	~"¿m_ag’t.h
"

18 
	~"şass_ag’t.h
"

19 
	~"grid_sü“n_ag’t.h
"

20 
	~"£¬ch_ag’t.h
"

21 
	~"sšgË_aùiÚ_ag’t.h
"

22 
	~"aùiÚs_summ¬y_ag’t.h
"

23 
	~"ä“way_ag’t.h
"

24 
	~"expÜt_toŞs.h
"

25 
	~"game_cÚŒŞËr.h
"

26 
	~"¿ndom_toŞs.h
"

27 
	~"veùÜ_m©rix_toŞs.h
"

28 
	~"FSNode.hxx
"

33 
	gPÏy”Ag’t
::
	$PÏy”Ag’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

34 
	`p_osy¡em
(
_osy¡em
), 
	$p_game_£‰šgs
(
_game_£‰šgs
) {

35 
pv_possibË_aùiÚs
 = 
p_game_£‰šgs
->pv_possible_actions;

36 
pm_cu¼_sü“n_m©rix
 = 
NULL
;

37 
pv_cu¼_cÚsŞe_¿m
 = 
NULL
;

38 
i_num_aùiÚs
 = 
p_game_£‰šgs
->
pv_possibË_aùiÚs
->
	`size
();

39 
e_•isode_¡©us
 = 
INITIAL_DELAY
;

40 
i_äame_couÁ”
 = 0;

41 
i_•isode_fœ¡_äame
 = 0;

42 
i_•isode_couÁ”
 = 0;

43 
f_•isode_»w¬d
 = 0;

44 
pv_»w¬d_³r_•isode
 = 
Ãw
 
FlßtVeù
;

45 
pv_»w¬d_³r_äame
 = 
Ãw
 
FlßtVeù
;

46 
pv_•isodes_¡¬t_äame
 = 
Ãw
 
IÁVeù
;

47 
pv_•isodes_’d_äame
 = 
Ãw
 
IÁVeù
;

48 
S‘tšgs
& 
£‰šgs
 = 
p_osy¡em
->
	`£‰šgs
();

49 
i_š™Ÿl_d–ay_couÁ”
 = 
£‰šgs
.
	`g‘IÁ
("š™Ÿl_d–ay", 
Œue
);

50 
i_»¡¬t_d–ay_couÁ”
 = 
p_game_£‰šgs
->
i_d–ay_aá”_»¡¬t
;

51 
i_expÜt_»w¬ds_äq
 = 
£‰šgs
.
	`g‘IÁ
("expÜt_»w¬ds_äq", 
Œue
);

52 
b_expÜt_scÜe_sü“ns
 = 
£‰šgs
.
	`g‘BoŞ
("expÜt_scÜe_sü“ns", 
Œue
);

53 
b_expÜt_d—th_sü“ns
 = 
£‰šgs
.
	`g‘BoŞ
("expÜt_d—th_sü“ns", 
Œue
);

54 
i_max_num_•isodes
 = 
£‰šgs
.
	`g‘IÁ
("max_num_•isodes", 
Œue
);

55 
i_max_num_äames
 = 
£‰šgs
.
	`g‘IÁ
("max_num_äames", 
Œue
);

56 
i_max_num_äames_³r_•isode
 = 
£‰šgs
.
	`g‘IÁ
("max_num_frames_per_episode",

57 
Œue
);

58 
i_š™_aù_ex¶Ü_couÁ
 = 
£‰šgs
.
	`g‘IÁ
("š™_aù_ex¶Ü_couÁ", 
Œue
);

59 
b_mšus_Úe_z”o_»w¬d
 = 
£‰šgs
.
	`g‘BoŞ
("mšus_Úe_z”o_»w¬d", 
Œue
);

60 
b_’d_game_w™h_scÜe
 = 
£‰šgs
.
	`g‘BoŞ
("’d_game_w™h_scÜe", 
Œue
);

61 ià(
b_mšus_Úe_z”o_»w¬d
) {

62 
cout
 << "Mªu®ly infÜcšg -1/0„ew¬d sy¡em" << 
’dl
;

64 
b_do_bg_d‘eùiÚ
 = 
£‰šgs
.
	`g‘BoŞ
("do_bg_d‘eùiÚ", 
Œue
);

65 ià(
b_do_bg_d‘eùiÚ
) {

66 
cout
 << "Background-D‘eùiÚ EÇbËd" << 
’dl
;

67 
p_background_d‘eù
 = 
Ãw
 
	`BackgroundD‘eùÜ
(
p_osy¡em
);

69 
p_background_d‘eù
 = 
NULL
;

71 
b_do_şass_disc
 = 
£‰šgs
.
	`g‘BoŞ
("do_şass_disc", 
Œue
);

72 ià(
b_do_şass_disc
) {

73 
cout
 << "CÏss-Discov”y EÇbËd" << 
’dl
;

74 
p_şass_dicov”y
 = 
Ãw
 
	`CÏssDiscov”y
(
p_osy¡em
);

76 
p_şass_dicov”y
 = 
NULL
;

78 
i_expÜt_sü“n_äq
 = 
£‰šgs
.
	`g‘IÁ
("expÜt_äames_äq", 
Œue
);

79 
i_expÜt_sü“n_aá”
 = 
£‰šgs
.
	`g‘IÁ
("expÜt_äames_aá”", 
Œue
);

80 
i_expÜt_sü“n_befÜe
 = 
£‰šgs
.
	`g‘IÁ
("expÜt_äames_befÜe", 
Œue
);

81 
i_expÜt_sü“ns_Ú_Ï¡_n_sü“ns
 = 
£‰šgs
.
	`g‘IÁ
(

82 "expÜt_sü“ns_Ú_Ï¡_n_sü“ns", 
Œue
);

83 
i_expÜt_sü“ns_Ú_Ï¡_n_•isodes
 = 
£‰šgs
.
	`g‘IÁ
(

84 "expÜt_sü“ns_Ú_Ï¡_n_•isodes", 
Œue
);

85 ià(
i_expÜt_sü“ns_Ú_Ï¡_n_sü“ns
 > 0) {

86 ià(
i_expÜt_sü“n_äq
 <= 0) {

87 
i_expÜt_sü“n_äq
 = 1;

89 ià(
i_max_num_äames
 <= 0) {

90 
û¼
 << "Cannot inforceƒxport_screens_on_last_n_screens, when "

91 << "max_num_äame i undefšed" << 
’dl
;

92 
	`ex™
(-1);

94 
i_expÜt_sü“n_aá”
 = 
i_max_num_äames
 -

95 
i_expÜt_sü“ns_Ú_Ï¡_n_sü“ns
;

96 
cout
 << "PlayerAgent: will start Eporting screens‡fter frame #"

97 << 
i_expÜt_sü“n_aá”
 << 
’dl
;

99 
i_sk_expÜt_Ú_äame
 = -1;

100 ià(
i_expÜt_sü“n_äq
 > 0 &&

101 (!
Fesy¡emNode
::
	`dœExi¡s
("exported_screens"))) {

103 
Fesy¡emNode
::
	`makeDœ
("exported_screens");

105 ià(
i_expÜt_sü“ns_Ú_Ï¡_n_•isodes
 > 0) {

106 ià(
i_max_num_•isodes
 <= 0) {

107 
û¼
 << "Cannot inforce i_export_screens_on_last_n_episodes, when "

108 << "i_max_num_•isode i undefšed" << 
’dl
;

109 
	`ex™
(-1);

111 
i_expÜt_sü“n_äq
 = 0;

114 
i_cu¼_ex¶_aù_šdex
 = 0;

115 
i_cu¼_aù_äame_couÁ
 = 
i_š™_aù_ex¶Ü_couÁ
;

116 
b_»w¬d_Ú_this_äame
 = 
çl£
;

117 
	}
}

122 
	gPÏy”Ag’t
::~
	$PÏy”Ag’t
() {

123 
d–‘e
 
pv_»w¬d_³r_•isode
;

124 
d–‘e
 
pv_»w¬d_³r_äame
;

125 
d–‘e
 
pv_•isodes_¡¬t_äame
;

126 
d–‘e
 
pv_•isodes_’d_äame
;

127 ià(
p_background_d‘eù
) {

128 
d–‘e
 
p_background_d‘eù
;

130 ià(
p_şass_dicov”y
) {

131 
d–‘e
 
p_şass_dicov”y
;

133 
	}
}

144 
AùiÚ
 
	gPÏy”Ag’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

145 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

146 
äame_numb”
) {

147 
i_äame_couÁ”
 = 
äame_numb”
;

150 ià(
i_max_num_äames
 != -1 &&

151 
i_äame_couÁ”
 > 
i_max_num_äames
) {

152 
cout
 << "Max‚umb” oàäames: " << 
i_max_num_äames


153 << "„—ched" << 
’dl
;

154 
	`’d_game
();

157 
pm_cu¼_sü“n_m©rix
 = 
sü“n_m©rix
;

158 
pv_cu¼_cÚsŞe_¿m
 = 
cÚsŞe_¿m
;

161 iàĞ
i_expÜt_sü“n_äq
 != 0 &&

162 (
i_äame_couÁ”
 % 
i_expÜt_sü“n_äq
 == 0) &&

163 (
i_äame_couÁ”
 >ğ
i_expÜt_sü“n_aá”
) &&

164 (
i_expÜt_sü“n_befÜe
 == -1 ||

165 
i_äame_couÁ”
 <ğ
i_expÜt_sü“n_befÜe
)) {

166 
	`expÜt_sü“n
(
pm_cu¼_sü“n_m©rix
);

169 
f_cu¼_»w¬d
 = 
p_game_£‰šgs
->
	`g‘_»w¬d
(
sü“n_m©rix
, 
cÚsŞe_¿m
);

170 
pv_»w¬d_³r_äame
->
	`push_back
(
f_cu¼_»w¬d
);

171 ià(
f_cu¼_»w¬d
 > 0) {

172 
b_»w¬d_Ú_this_äame
 = 
Œue
;

174 
b_»w¬d_Ú_this_äame
 = 
çl£
;

176 ià(
b_mšus_Úe_z”o_»w¬d
) {

178 ià(
f_cu¼_»w¬d
 > 0) {

179 
f_cu¼_»w¬d
 = 0.0;

181 
f_cu¼_»w¬d
 = -1.0;

185 ià(
e_•isode_¡©us
 =ğ
AGENT_ACTING
 ||

186 
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

187 
f_•isode_»w¬d
 +ğ
f_cu¼_»w¬d
;

190 ià((
b_expÜt_scÜe_sü“ns
 =ğ
Œue
è&& 
b_»w¬d_Ú_this_äame
) {

191 
o¡ršg¡»am
 
f’ame
;

192 
f’ame
 << "»w¬d_sü“n__äame_" << 
i_äame_couÁ”
 <<

193 "__»w¬d_" << (è
f_cu¼_»w¬d
 << ".png";

194 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
sü“n_m©rix
, 
f’ame
.
	`¡r
());

197 
e_•isode_¡©us
) {

198 
INITIAL_DELAY
:

201 ià(
i_š™Ÿl_d–ay_couÁ”
 > 0) {

202 
i_š™Ÿl_d–ay_couÁ”
--;

203  
choiû
 <
AùiÚ
> (
p_game_£‰šgs
->
pv_possibË_aùiÚs
);;

207 
e_•isode_¡©us
 = 
RESTART_DELAY
;

208 
i_»¡¬t_d–ay_couÁ”
 = 
p_game_£‰šgs
->
i_d–ay_aá”_»¡¬t
;

209  
RESET
;

212 
RESTART_DELAY
:

215 ià(
i_»¡¬t_d–ay_couÁ”
 > 0) {

216 
i_»¡¬t_d–ay_couÁ”
--;

217  
PLAYER_A_NOOP
;

222 
i_•isode_fœ¡_äame
 = 
i_äame_couÁ”
;

223 ià(
p_game_£‰šgs
->
e_fœ¡_aùiÚ
 !ğ
UNDEFINED
) {

224 
e_•isode_¡©us
 = 
START_EPISODE
;

225 
cout
 << "³rfÜmed fœ¡_aùiÚ oÀäam #" << 
i_äame_couÁ”
 << 
’dl
;

226  
p_game_£‰šgs
->
e_fœ¡_aùiÚ
;

228 ià(
i_š™_aù_ex¶Ü_couÁ
 > 0 &&

229 
i_cu¼_ex¶_aù_šdex
 < 
i_num_aùiÚs
) {

230 
e_•isode_¡©us
 = 
ACTION_EXPLOR
;

231 
cout
 << "Ex¶Üšg‡ùiÚ: " << 
i_cu¼_ex¶_aù_šdex
 <<

233 
	`aùiÚ_to_¡ršg
((*
pv_possibË_aùiÚs
)[
i_cu¼_ex¶_aù_šdex
])

234 << "èfÜ " << 
i_cu¼_aù_äame_couÁ
 <<

235 " mÜäames." << 
’dl
;

237 
e_•isode_¡©us
 = 
AGENT_ACTING
;

239  
	`Ú_¡¬t_of_game
();

243 
START_EPISODE
: {

245 ià(
i_š™_aù_ex¶Ü_couÁ
 > 0 &&

246 
i_cu¼_ex¶_aù_šdex
 < 
i_num_aùiÚs
) {

247 
e_•isode_¡©us
 = 
ACTION_EXPLOR
;

248 
cout
 << "Ex¶Üšg‡ùiÚ: " << 
i_cu¼_ex¶_aù_šdex
 <<

250 
	`aùiÚ_to_¡ršg
((*
pv_possibË_aùiÚs
)[
i_cu¼_ex¶_aù_šdex
])

251 << "èfÜ " << 
i_cu¼_aù_äame_couÁ
 <<

252 " mÜäames." << 
’dl
;

254 
e_•isode_¡©us
 = 
AGENT_ACTING
;

256  
	`Ú_¡¬t_of_game
();

259 
ACTION_EXPLOR
:

261 ià(
i_cu¼_aù_äame_couÁ
 == 0) {

263 
i_cu¼_ex¶_aù_šdex
++;

264 
i_cu¼_aù_äame_couÁ
 = 
i_š™_aù_ex¶Ü_couÁ
;

265 ià(
i_cu¼_ex¶_aù_šdex
 =ğ
i_num_aùiÚs
) {

267 
e_•isode_¡©us
 = 
AGENT_ACTING
;

269 
cout
 << "Ex¶Üšg‡ùiÚ: " << 
i_cu¼_ex¶_aù_šdex


271 << 
	`aùiÚ_to_¡ršg
((*
pv_possibË_aùiÚs
)[
i_cu¼_ex¶_aù_šdex
])

272 << "èfÜ " << 
i_cu¼_aù_äame_couÁ
 << " f¿mes." << 
’dl
;

275 
i_cu¼_aù_äame_couÁ
--;

280 
AGENT_ACTING
: {

283 
boŞ
 
game_’ded
 = 
p_game_£‰šgs
->
	`is_’d_of_game
(
sü“n_m©rix
,

284 
cÚsŞe_¿m
, 
i_äame_couÁ”
);

285 ià(
b_’d_game_w™h_scÜe
 && 
b_»w¬d_Ú_this_äame
) {

286 
game_’ded
 = 
Œue
;

288 
num_äames_š_•isode
 = 
i_äame_couÁ”
 - 
i_•isode_fœ¡_äame
;

289 ià(
i_max_num_äames_³r_•isode
 != -1 &&

290 
num_äames_š_•isode
 > 
i_max_num_äames_³r_•isode
) {

291 
cout
 << "R—ched maximum f¿me ³¸•isode. "<< 
’dl
;

292 
p_game_£‰šgs
->
	`»£t_¡©e
();

293 
game_’ded
 = 
Œue
;

295 ià(
game_’ded
) {

297 
	`Ú_’d_of_game
();

300 
e_•isode_¡©us
 = 
RESTART_DELAY
;

301 
i_»¡¬t_d–ay_couÁ”
=
p_game_£‰šgs
->
i_d–ay_aá”_»¡¬t
;

302  
RESET
;

304 ià(
b_do_bg_d‘eùiÚ
) {

306 
p_background_d‘eù
->
	`g‘_Ãw_sü“n
(
pm_cu¼_sü“n_m©rix
);

307 ià(
p_background_d‘eù
->
	`is_bg_exŒaùiÚ_com¶‘e
()) {

308 
cout
 << "Background D‘eùiÚ Com¶‘e." << 
’dl
;

309 
	`’d_game
();

312 ià(
b_do_şass_disc
) {

314 
p_şass_dicov”y
->
	`g‘_Ãw_sü“n
(
pm_cu¼_sü“n_m©rix
,

315 
i_äame_couÁ”
);

316 ià(
p_şass_dicov”y
->
	`is_şass_discov”y_com¶‘e
()) {

317 
cout
 << "CÏs Discov”y Com¶‘e." << 
’dl
;

318 
	`’d_game
();

321  
UNDEFINED
;

326 
	`as£¹
(
çl£
);

328 
	`as£¹
(
çl£
);

329  
UNDEFINED
;

330 
	}
}

339 
	gPÏy”Ag’t
::
	$Ú_’d_of_game
() {

340 
pv_»w¬d_³r_•isode
->
	`push_back
(
f_•isode_»w¬d
);

341 
num_äames
 = 
i_äame_couÁ”
 - 
i_•isode_fœ¡_äame
;

342 
pv_•isodes_¡¬t_äame
->
	`push_back
(
i_•isode_fœ¡_äame
);

343 
pv_•isodes_’d_äame
->
	`push_back
(
i_äame_couÁ”
);

345 
cout
 << "Episod#" << 
i_•isode_couÁ”
 <<

346 ", F¿m#" << 
i_äame_couÁ”
 <<

347 ", Num F¿me ğ" << 
num_äames
 <<

348 ", Sum Rew¬d = " << 
f_•isode_»w¬d
 << 
’dl
;

349 
f_•isode_»w¬d
 = 0;

350 
i_•isode_couÁ”
++;

352 ià((
i_expÜt_»w¬ds_äq
 != 0) &&

353 (
i_•isode_couÁ”
 % 
i_expÜt_»w¬ds_äq
 == 0)) {

355 
o¡ršg¡»am
 
f’ame
;

356 
f’ame
 << "»w¬d_³r_•isode__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

357 
	`expÜt_veùÜ
(
pv_»w¬d_³r_•isode
, 
f’ame
.
	`¡r
());

358 
f’ame
.
	`¡r
("");

359 
f’ame
 << "»w¬d_³r_äame__äame_0_" << 
i_äame_couÁ”
 << ".txt";

360 
	`expÜt_veùÜ
(
pv_»w¬d_³r_äame
, 
f’ame
.
	`¡r
());

361 
f’ame
.
	`¡r
("");

362 
f’ame
 << "•is_¡¬t_äame__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

363 
	`expÜt_veùÜ
(
pv_•isodes_¡¬t_äame
, 
f’ame
.
	`¡r
());

364 
f’ame
.
	`¡r
("");

365 
f’ame
 << "•is_’d_äame__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

366 
	`expÜt_veùÜ
(
pv_•isodes_’d_äame
, 
f’ame
.
	`¡r
());

368 ià(
b_expÜt_d—th_sü“ns
 =ğ
Œue
) {

369 
o¡ršg¡»am
 
f’ame
;

370 
f’ame
 << "d—th_sü“n__äame_" << 
i_äame_couÁ”
 << ".png";

371 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
pm_cu¼_sü“n_m©rix
,

372 
f’ame
.
	`¡r
());

374 ià(
i_expÜt_sü“ns_Ú_Ï¡_n_•isodes
 > 0 &&

375 Ğ
i_max_num_•isodes
 - 
i_•isode_couÁ”
 <=

376 
i_expÜt_sü“ns_Ú_Ï¡_n_•isodes
)) {

377 
i_expÜt_sü“n_äq
 = 1;

379 ià((
i_max_num_•isodes
 != -1) &&

380 (
i_•isode_couÁ”
 > 
i_max_num_•isodes
)) {

381 
cout
 << "Max‚umb” oà•isodes: " << 
i_max_num_•isodes


382 << "„—ched." << 
’dl
;

383 
	`’d_game
();

385 
	}
}

395 
PÏy”Ag’t
* 
	gPÏy”Ag’t
::
	$g’”©e_ag’t_š¡ªû
(

396 
GameS‘tšgs
* 
_game_£‰šgs
,

397 
OSy¡em
* 
_osy¡em
) {

398 
¡ršg
 
¶ay”_ag’t
 = 
_osy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("player_agent");

399 
PÏy”Ag’t
* 
Ãw_ag’t
 = 
NULL
;

400 ià(
¶ay”_ag’t
 == "random_agent") {

401 
cout
 << "GamwÈbcÚŒŞËd by Rªdom Ag’t" << 
’dl
;

402 
Ãw_ag’t
 = 
Ãw
 
	`RªdomAg’t
(
_game_£‰šgs
, 
_osy¡em
);

403 } ià(
¶ay”_ag’t
 == "ram_agent") {

404 
cout
 << "GamwÈbcÚŒŞËd by RAM Ag’t" << 
’dl
;

405 
Ãw_ag’t
 = 
Ãw
 
	`RAMAg’t
(
_game_£‰šgs
, 
_osy¡em
);

406 } ià(
¶ay”_ag’t
 == "class_agent") {

407 
cout
 << "GamwÈbcÚŒŞËd by CÏs Ag’t" << 
’dl
;

408 
Ãw_ag’t
 = 
Ãw
 
	`CÏssAg’t
(
_game_£‰šgs
, 
_osy¡em
);

409 } ià(
¶ay”_ag’t
 == "gridscr_agent") {

410 
cout
 << "GamwÈbcÚŒŞËd by Dœeù-Sü“ÀAg’t" << 
’dl
;

411 
Ãw_ag’t
 = 
Ãw
 
	`GridSüAg’t
(
_game_£‰šgs
, 
_osy¡em
);

412 } ià(
¶ay”_ag’t
 == "search_agent") {

413 
cout
 << "GamwÈbcÚŒŞËd by S—rch-Ag’t" << 
’dl
;

414 
Ãw_ag’t
 = 
Ãw
 
	`S—rchAg’t
(
_game_£‰šgs
, 
_osy¡em
);

415 } ià(
¶ay”_ag’t
 == "single_action") {

416 
cout
 << "Game will be controlled by Single-Action Agent, with "

418 << 
_osy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("sšgË_aùiÚ_šdex"è<< 
’dl
;

420 
Ãw_ag’t
 = 
Ãw
 
	`SšgËAùiÚAg’t
(
_game_£‰šgs
, 
_osy¡em
);

421 } ià(
¶ay”_ag’t
 == "actions_summary") {

422 
cout
 << "GamwÈbcÚŒŞËd by AùiÚ-Summ¬y Ag’t" << 
’dl
;

423 
Ãw_ag’t
 = 
Ãw
 
	`AùiÚSumm¬yAg’t
(
_game_£‰šgs
, 
_osy¡em
);

424 }ià(
¶ay”_ag’t
 == "freeway_agent") {

425 
cout
 << "GamwÈbcÚŒŞËd by F»eway-Ag’t" << 
’dl
;

426 
Ãw_ag’t
 = 
Ãw
 
	`F»ewayAg’t
(
_game_£‰šgs
, 
_osy¡em
);

428 
û¼
 << "PlayerAgent::generate_agent_instance: I don't know" <<

430 
¶ay”_ag’t
 << 
’dl
;

431 
	`ex™
(-1);

433  
Ãw_ag’t
;

434 
	}
}

439 
	gPÏy”Ag’t
::
	$’d_game
() {

440 
cout
 << "qu™tšg..." << 
’dl
;

441 
o¡ršg¡»am
 
f’ame
;

442 
f’ame
 << "»w¬d_³r_•isode__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

443 
	`expÜt_veùÜ
(
pv_»w¬d_³r_•isode
, 
f’ame
.
	`¡r
());

444 
f’ame
.
	`¡r
("");

445 
f’ame
 << "»w¬d_³r_äame__äame_0_" << 
i_äame_couÁ”
 << ".txt";

446 
	`expÜt_veùÜ
(
pv_»w¬d_³r_äame
, 
f’ame
.
	`¡r
());

447 
f’ame
.
	`¡r
("");

448 
f’ame
 << "•is_¡¬t_äame__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

449 
	`expÜt_veùÜ
(
pv_•isodes_¡¬t_äame
, 
f’ame
.
	`¡r
());

450 
f’ame
.
	`¡r
("");

451 
f’ame
 << "•is_’d_äame__•is_0_" << 
i_•isode_couÁ”
 << ".txt";

452 
	`expÜt_veùÜ
(
pv_•isodes_’d_äame
, 
f’ame
.
	`¡r
());

454 
avg_äames_num
 = 
i_max_num_äames_³r_•isode
 * 1000;

455 ià(
i_äame_couÁ”
 > 
avg_äames_num
) {

456 
Ï¡_¡•s_avg
 = 
	`g‘_veùÜ_av”age
(
pv_»w¬d_³r_äame
,

457 
i_äame_couÁ”
 - 
avg_äames_num
,

458 
i_äame_couÁ”
);

459 
cout
 << 
’dl
 << "Av”ag»w¬d fÜhÏ¡ " << 
avg_äames_num


460 << " f¿me i " << 
Ï¡_¡•s_avg
 << 
’dl
;

462 
of¡»am
 
fe
;

463 
fe
.
	`İ’
("run_summary.txt");

464 
fe
 << "Player Agent: "

465 << 
p_osy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("¶ay”_ag’t", 
Œue
è<< 
’dl


466 << "Game: " << 
p_game_£‰šgs
->
s_rom_fe
 << 
’dl


467 << "Numb” oàF¿mes: " << 
i_äame_couÁ”
 << 
’dl


468 << "Numb” oàEpisodes: " << 
i_•isode_couÁ”
 << 
’dl


469 << "Av”agRew¬d oÀÏ¡ " << 
avg_äames_num
 << " frames: "

470 << 
Ï¡_¡•s_avg
 << 
’dl
;

471 
fe
.
	`şo£
();

473 
cout
 << "Did‚ot„ecieveƒnough frameso generate‡verage„eward for "

474 << 
avg_äames_num
 << " f¿mes." << 
’dl
;

476 
p_osy¡em
->
	`qu™
();

477 
	}
}

483 
	gPÏy”Ag’t
::
	$expÜt_sü“n
(cÚ¡ 
IÁM©rix
 * 
sü“n_m©rix
) {

484 ià(
i_äame_couÁ”
 =ğ
i_sk_expÜt_Ú_äame
) {

488 
o¡ršg¡»am
 
f’ame
;

489 
bufãr
 [50];

490 
	`¥rštf
 (
bufãr
, "%09d", 
i_äame_couÁ”
);

491 
f’ame
 << "expÜ‹d_sü“ns/äame_" << 
bufãr
 << ".png";

492 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
sü“n_m©rix
, 
f’ame
.
	`¡r
());

493 
	}
}

	@player_agents/player_agent.h

15 #iâdeà
PLAYER_AGENT_H


16 
	#PLAYER_AGENT_H


	)

18 
	~"OSy¡em.hxx
"

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"game_£‰šgs.h
"

21 
	~"background_d‘eùÜ.h
"

22 
	~"şass_discov”y.h
"

24 şas 
	cPÏy”Ag’t
 {

68 
	mpublic
:

69 
PÏy”Ag’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

70 
	mvœtu®
 ~
PÏy”Ag’t
();

81 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

82 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

83 
äame_numb”
);

91 
vœtu®
 
Ú_’d_of_game
();

96 
vœtu®
 
AùiÚ
 
	$Ú_¡¬t_of_game
() {

97  
UNDEFINED
;

103 
	`expÜt_sü“n
(cÚ¡ 
IÁM©rix
 * 
sü“n_m©rix
);

112 
PÏy”Ag’t
* 
	`g’”©e_ag’t_š¡ªû
(
GameS‘tšgs
* 
_game_£‰šgs
,

113 
OSy¡em
* 
_osy¡em
);

115 
i_•isode_couÁ”
;

116 
i_äame_couÁ”
;

117 
i_•isode_fœ¡_äame
;

118 
f_•isode_»w¬d
;

119 
FlßtVeù
* 
pv_»w¬d_³r_•isode
;

120 
FlßtVeù
* 
pv_»w¬d_³r_äame
;

121 
IÁVeù
* 
pv_•isodes_¡¬t_äame
;

122 
IÁVeù
* 
pv_•isodes_’d_äame
;

124 
´Ùeùed
:

128 
	`’d_game
();

130 
OSy¡em
* 
p_osy¡em
;

131 
GameS‘tšgs
* 
p_game_£‰šgs
;

132 cÚ¡ 
IÁM©rix
* 
pm_cu¼_sü“n_m©rix
;

133 cÚ¡ 
IÁVeù
* 
pv_cu¼_cÚsŞe_¿m
;

134 
BackgroundD‘eùÜ
* 
p_background_d‘eù
;

135 
CÏssDiscov”y
* 
p_şass_dicov”y
;

138 
f_cu¼_»w¬d
;

139 
i_num_aùiÚs
;

140 
EpisodeStus
 
e_•isode_¡©us
;

141 
i_š™Ÿl_d–ay_couÁ”
;

142 
i_»¡¬t_d–ay_couÁ”
;

143 cÚ¡ 
AùiÚVeù
* 
pv_possibË_aùiÚs
;

144 
i_expÜt_»w¬ds_äq
;

146 
i_max_num_•isodes
;

148 
i_max_num_äames
;

150 
i_max_num_äames_³r_•isode
;

151 
boŞ
 
b_expÜt_scÜe_sü“ns
;

153 
boŞ
 
b_expÜt_d—th_sü“ns
;

155 
i_š™_aù_ex¶Ü_couÁ
;

156 
i_cu¼_ex¶_aù_šdex
;

158 
i_cu¼_aù_äame_couÁ
;

160 
boŞ
 
b_mšus_Úe_z”o_»w¬d
;

162 
boŞ
 
b_»w¬d_Ú_this_äame
;

164 
boŞ
 
b_’d_game_w™h_scÜe
;

166 
boŞ
 
b_do_bg_d‘eùiÚ
;

168 
boŞ
 
b_do_şass_disc
;

169 
i_expÜt_sü“n_äq
;

171 
i_expÜt_sü“n_aá”
;

173 
i_expÜt_sü“n_befÜe
;

175 
i_expÜt_sü“ns_Ú_Ï¡_n_sü“ns
;

177 
i_expÜt_sü“ns_Ú_Ï¡_n_•isodes
;

179 
i_sk_expÜt_Ú_äame
;

184 
	}
};

	@player_agents/ram_agent.cpp

16 
	~<s¡»am
>

17 
	~"¿m_ag’t.h
"

18 
	~"expÜt_toŞs.h
"

20 
	gRAMAg’t
::
	$RAMAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

21 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
) {

22 
i_¿m_b™s_Ëngth
 = 
RAM_LENGTH
 * 8;

23 
i_ba£_Ëngth
 = 
i_¿m_b™s_Ëngth
 +

24 (
i_¿m_b™s_Ëngth
 * (i_ram_bits_length / 2) -

25 (
i_¿m_b™s_Ëngth
 / 2));

26 
	`as£¹
 (
i_ba£_Ëngth
 == 1024 + 523776);

27 
i_fuÎ_ã©u»_vec_Ëngth
 = 
i_ba£_Ëngth
 * 
i_num_aùiÚs
;

28 
cout
 << "FuÎ F—tu»-VeùÜ L’gth: " << 
i_fuÎ_ã©u»_vec_Ëngth
 << 
’dl
;

29 
p_§r§_Ïmbda_sŞv”
 = 
RLS¬§Lambda
::
	`g’”©e_¾_§r§_Ïmbda_š¡ªû
(

30 
p_osy¡em
, 
i_fuÎ_ã©u»_vec_Ëngth
, 
i_num_aùiÚs
);

32 
pv_cu¼_ã©u»_m­
 = 
Ãw
 
	`F—tu»M­
();

33 
pv_num_nÚz”o_š_f
 = 
Ãw
 
	`IÁVeù
();

34 
i
 = 0; i < 
i_num_aùiÚs
; i++) {

35 
IÁA¼
 
ã©u»_vec
 = 
	`IÁA¼
(-1, 
i_ba£_Ëngth
);

36 
pv_cu¼_ã©u»_m­
->
	`push_back
(
ã©u»_vec
);

37 
pv_num_nÚz”o_š_f
->
	`push_back
(0);

39 
pv_tmp_fv_fœ¡_·¹
 = 
Ãw
 
	`IÁA¼
(-1, 
RAM_LENGTH
 * 8);

40 
pv_subveùÜ_pos™iÚs
 = 
Ãw
 
IÁVeù
;

41 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

42 
pv_subveùÜ_pos™iÚs
->
	`push_back
(
a
 * 
i_ba£_Ëngth
);

45 
b_’d_•isode_w™h_»w¬d
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
(

46 "’d_•isode_w™h_»w¬d", 
Œue
);

47 
	}
}

49 
	gRAMAg’t
::~
	$RAMAg’t
() {

50 
d–‘e
 
p_§r§_Ïmbda_sŞv”
;

51 
d–‘e
 
pv_cu¼_ã©u»_m­
;

52 
d–‘e
 
pv_num_nÚz”o_š_f
;

53 
d–‘e
 
pv_tmp_fv_fœ¡_·¹
;

54 
d–‘e
 
pv_subveùÜ_pos™iÚs
;

56 
	}
}

61 
AùiÚ
 
	gRAMAg’t
::
	$ag’t_¡•
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

62 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

63 
äame_numb”
) {

64 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

65 
äame_numb”
);

66 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

67  
¥ecŸl_aùiÚ
;

69 ià(
b_’d_•isode_w™h_»w¬d
 && 
b_»w¬d_Ú_this_äame
) {

70 
cout
 << "Endšgƒpisodw™h„ew¬d: VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

71 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

72 
AùiÚ
 
fœ¡_aù
 = 
	`Ú_¡¬t_of_game
();

73  
fœ¡_aù
;

75 
	`g’”©e_ã©u»_vec
();

76 
Ãxt_aùiÚ_šd
;

77 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

78 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

79 
pv_cu¼_ã©u»_m­
,

80 
pv_num_nÚz”o_š_f
,

81 
f_cu¼_»w¬d
,

82 
i_cu¼_ex¶_aù_šdex
);

83 
	`as£¹
(
Ãxt_aùiÚ_šd
 =ğ
i_cu¼_ex¶_aù_šdex
);

85 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡•
(

86 
pv_cu¼_ã©u»_m­
,

87 
pv_num_nÚz”o_š_f
,

88 
f_cu¼_»w¬d
);

90  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

91 
	}
}

96 
AùiÚ
 
	gRAMAg’t
::
	$Ú_¡¬t_of_game
() {

97 
	`g’”©e_ã©u»_vec
();

98 
	`as£¹
((*
pv_num_nÚz”o_š_f
)[0] > 0);

99 
Ãxt_aùiÚ_šd
;

100 ià(
e_•isode_¡©us
 =ğ
ACTION_EXPLOR
) {

101 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

102 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
,

103 
i_cu¼_ex¶_aù_šdex
);

105 
Ãxt_aùiÚ_šd
 = 
p_§r§_Ïmbda_sŞv”
->
	`•isode_¡¬t
(

106 
pv_cu¼_ã©u»_m­
, 
pv_num_nÚz”o_š_f
);

108  (*(
p_game_£‰šgs
->
pv_possibË_aùiÚs
))[
Ãxt_aùiÚ_šd
];

110 
	}
}

115 
	gRAMAg’t
::
	$Ú_’d_of_game
() {

116 
PÏy”Ag’t
::
	`Ú_’d_of_game
();

117 
cout
 << "VÓndèğ" << 
f_cu¼_»w¬d
 << 
’dl
;

118 
p_§r§_Ïmbda_sŞv”
->
	`•isode_’d
(
f_cu¼_»w¬d
, f_curr_reward);

119 
	}
}

132 
	gRAMAg’t
::
	$g’”©e_ã©u»_vec
() {

133 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

134 (*
pv_num_nÚz”o_š_f
)[
a
] = 0;

136 
fuÎ_veù_šdex
 = 0;

137 
by‹_v®
, 
b™_v®
;

140 
i
 = 0; i < 
RAM_LENGTH
; i++) {

141 
by‹_v®
 = (*
pv_cu¼_cÚsŞe_¿m
)[
i
];

142 
k
 = 7; k >= 0; k--) {

143 
b™_v®
 = (
by‹_v®
 >> 
k
) & 1;

144 (*
pv_tmp_fv_fœ¡_·¹
)[
fuÎ_veù_šdex
] = 
b™_v®
;

145 ià(
b™_v®
 == 1) {

146 
	`add_Úe_šdex_to_ã©u»_m­
(
fuÎ_veù_šdex
);

148 
fuÎ_veù_šdex
++;

153 
i
 = 0; i < 
i_¿m_b™s_Ëngth
; i++) {

159 
j
 = 
i
 + 1; j < 
i_¿m_b™s_Ëngth
; j++) {

160 ià((*
pv_tmp_fv_fœ¡_·¹
)[
i
] == 1 &&

161 (*
pv_tmp_fv_fœ¡_·¹
)[
j
] == 1) {

162 
	`add_Úe_šdex_to_ã©u»_m­
(
fuÎ_veù_šdex
);

164 
fuÎ_veù_šdex
++;

167 
	`as£¹
(
fuÎ_veù_šdex
 =ğ
i_ba£_Ëngth
);

168 
	}
}

	@player_agents/ram_agent.h

16 #iâdeà
RAM_AGENT_H


17 
	#RAM_AGENT_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"¶ay”_ag’t.h
"

21 
	~"¾_§r§_Ïmbda.h
"

23 şas 
	cRAMAg’t
 : 
public
 
PÏy”Ag’t
 {

52 
public
:

54 
RAMAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

55 
	mvœtu®
 ~
RAMAg’t
();

60 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

61 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

62 
äame_numb”
);

67 
vœtu®
 
Ú_’d_of_game
();

69 
	m´Ùeùed
:

80 
vœtu®
 
g’”©e_ã©u»_vec
();

85 
šlše
 
	$add_Úe_šdex_to_ã©u»_m­
(
Úe_šdex
) {

86 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

87 (*
pv_cu¼_ã©u»_m­
)[
a
][(*
pv_num_nÚz”o_š_f
)[a]] =

88 
Úe_šdex
 + (*
pv_subveùÜ_pos™iÚs
)[
a
];

89 (*
pv_num_nÚz”o_š_f
)[
a
] = (*pv_num_nonzero_in_f)[a] + 1;

97 
vœtu®
 
AùiÚ
 
	`Ú_¡¬t_of_game
();

99 
F—tu»M­
* 
pv_cu¼_ã©u»_m­
;

100 
IÁVeù
* 
pv_num_nÚz”o_š_f
;

101 
RLS¬§Lambda
* 
p_§r§_Ïmbda_sŞv”
;

102 
IÁA¼
* 
pv_tmp_fv_fœ¡_·¹
;

103 
i_¿m_b™s_Ëngth
;

104 
i_ba£_Ëngth
;

105 
i_fuÎ_ã©u»_vec_Ëngth
;

106 
f_®pha_muÉl›r
;

107 
IÁVeù
* 
pv_subveùÜ_pos™iÚs
;

108 
boŞ
 
b_’d_•isode_w™h_»w¬d
;

109 
	}
};

	@player_agents/random_agent.cpp

16 
	~"¿ndom_ag’t.h
"

17 
	~"¿ndom_toŞs.h
"

18 
	~"S”Ÿliz”.hxx
"

19 
	~"De£rŸliz”.hxx
"

20 
	~"Sy¡em.hxx
"

21 
	~<s¡»am
>

23 
	gRªdomAg’t
::
	$RªdomAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

24 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
) {

25 
	}
}

30 
AùiÚ
 
	gRªdomAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

31 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

32 
äame_numb”
) {

33 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

34 
äame_numb”
);

35 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

36  
¥ecŸl_aùiÚ
;

40  
choiû
 <
AùiÚ
> (
p_game_£‰šgs
->
pv_possibË_aùiÚs
);

41 
	}
}

	@player_agents/random_agent.h

16 #iâdeà
RANODM_AGENT_H


17 
	#RANDOM_AGENT_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"¶ay”_ag’t.h
"

22 şas 
	cRªdomAg’t
 : 
public
 
PÏy”Ag’t
 {

24 
public
:

25 
RªdomAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

30 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

31 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

32 
äame_numb”
);

	@player_agents/region_manager.cpp

17 
	~<s¡»am
>

18 
	~"game_cÚŒŞËr.h
"

19 
	~"veùÜ_m©rix_toŞs.h
"

20 
	~"»giÚ_mªag”.h
"

23 
	gRegiÚMªag”
::
	$RegiÚMªag”
(
OSy¡em
* 
_osy¡em
, 
IÁM©rix
* 
background_m©rix
) {

24 
p_osy¡em
 = 
_osy¡em
;

25 
pm_background_m©rix
 = 
background_m©rix
;

26 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

27 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

28 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

31 
pm_»giÚ_m©rix
 = 
Ãw
 
IÁM©rix
;

32 
i
 = 0; i < 
i_sü“n_height
; i++) {

33 
IÁVeù
 
row
;

34 
j
 = 0; j < 
i_sü“n_width
; j++) {

35 
row
.
	`push_back
(-1);

37 
pm_»giÚ_m©rix
->
	`push_back
(
row
);

39 
i_cu¼_num_»giÚs
 = 0;

40 
i_´ev_num_»giÚs
 = 0;

43 
pv_cu¼_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

44 
pv_´ev_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

45 
i
 = 0; i < 
MAX_NUM_OBJECTS
; i++) {

46 
pv_cu¼_objeùs
->
	`push_back
(
NULL
);

47 
pv_´ev_objeùs
->
	`push_back
(
NULL
);

49 
pv_cu¼_m”ged_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

50 
pv_´ev_m”ged_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

52 
b_¶Ù_»giÚ_m©rix_´e_m”ge
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
(

54 
b_¶Ù_»giÚ_m©rix_po¡_m”ge
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘BoŞ
(

56 
f_max_³rc_difã»nû
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘Flßt
(

57 "max_³rc_difã»nû", 
Œue
);

58 
i_max_obj_v–oc™y
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("max_obj_v–oc™y", 
Œue
);

59 
f_max_sh­e_¬—_dif
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘Flßt
(

60 "max_sh­e_¬—_dif", 
Œue
);

61 
	}
}

63 
	gRegiÚMªag”
::~
	$RegiÚMªag”
() {

64 
d–‘e
 
pm_»giÚ_m©rix
;

65 
	`ş—r_li¡_of_poš‹rs
(
pv_cu¼_objeùs
);

66 
	`ş—r_li¡_of_poš‹rs
(
pv_´ev_objeùs
);

67 
	`ş—r_li¡_of_poš‹rs
(
pv_cu¼_m”ged_objeùs
);

68 
	`ş—r_li¡_of_poš‹rs
(
pv_´ev_m”ged_objeùs
);

69 
d–‘e
 
pv_cu¼_objeùs
;

70 
d–‘e
 
pv_´ev_objeùs
;

71 
d–‘e
 
pv_cu¼_m”ged_objeùs
;

72 
d–‘e
 
pv_´ev_m”ged_objeùs
;

73 
	}
}

82 cÚ¡ 
RegiÚObjeùLi¡
* 
	gRegiÚMªag”
::
	$exŒaù_objeùs_äom_Ãw_sü“n
(

83 cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

84 
äame_numb”
) {

85 
	`sw­_cu¼_ªd_´ev_»giÚ_objeùs
();

87 
i_cu¼_num_»giÚs
 = 
	`exŒaù_»giÚs
(
sü“n_m©rix
);

88 ià(
i_cu¼_num_»giÚs
 > 
MAX_NUM_OBJECTS
) {

89 
¡ršg¡»am
 
”r
;

90 
”r
 << "RegionManager:‚umber of discovered„egions ("

91 << 
i_cu¼_num_»giÚs
 << ") is higherhan MAX_NUM_OBJECTS ("

92 << 
MAX_NUM_OBJECTS
 << ")\n" << 
’dl
;

93 
û¼
 << 
”r
;

94 
cout
 << 
”r
;

95 
	`ex™
(-1);

98 ià(
b_¶Ù_»giÚ_m©rix_´e_m”ge
) {

99 
	`¶Ù_»giÚ_m©rix
("´e_m”ge", 
äame_numb”
);

103 
»g_num
 = 1;„eg_num <ğ
i_cu¼_num_»giÚs
;„eg_num++) {

104 
RegiÚObjeù
* 
Ãw_objeù
 = 
Ãw
 
	`RegiÚObjeù
();

105 
Ãw_objeù
->
	`exŒaù_äom_»giÚ_m©rix
(
pm_»giÚ_m©rix
, 
»g_num
);

106 ià(
Ãw_objeù
->
b_is_v®id
) {

107 (*
pv_cu¼_objeùs
)[
»g_num
] = 
Ãw_objeù
;

109 
RegiÚObjeù
* 
´evious_objeù
 = 
Ãw_objeù
->
	`g‘_şo£¡_obj_š_li¡
(

110 
pv_´ev_objeùs
, 
i_´ev_num_»giÚs
, 
f_max_sh­e_¬—_dif
,

111 
f_max_³rc_difã»nû
, 
i_max_obj_v–oc™y
);

113 
Ãw_objeù
->
p_´evious_objeù
 = 
´evious_objeù
;

114 
	`ÿlc_objeù_v–oc™y
(
Ãw_objeù
);

120 
	`m”ge_equiv®’t_»giÚs
();

122 ià(
b_¶Ù_»giÚ_m©rix_po¡_m”ge
) {

123 
	`¶Ù_»giÚ_m©rix
("po¡_m”ge", 
äame_numb”
);

127 
»g_num
 = 1;„eg_num <ğ
i_cu¼_num_»giÚs
;„eg_num++) {

128 
RegiÚObjeù
* 
Ãw_objeù
 = 
Ãw
 
	`RegiÚObjeù
();

129 
Ãw_objeù
->
	`exŒaù_äom_»giÚ_m©rix
(
pm_»giÚ_m©rix
, 
»g_num
);

130 ià(!
Ãw_objeù
->
b_is_v®id
) {

133 ià(
Ãw_objeù
->
i_width
 == 1 &&

134 
Ãw_objeù
->
i_height
 == 1) {

137 
RegiÚObjeù
* 
´em”ge_obj
 = (*
pv_cu¼_objeùs
)[
»g_num
];

138 
	`as£¹
(
´em”ge_obj
 !ğ
NULL
);

139 
Ãw_objeù
->
i_v–oc™y_x
 = 
´em”ge_obj
->i_velocity_x;

140 
Ãw_objeù
->
i_v–oc™y_y
 = 
´em”ge_obj
->i_velocity_y;

141 
pv_cu¼_m”ged_objeùs
->
	`push_back
(
Ãw_objeù
);

143  
pv_cu¼_m”ged_objeùs
;

144 
	}
}

177 
	gRegiÚMªag”
::
	$exŒaù_»giÚs
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
) {

178 
num_ÃighbÜs
 = 4;

179 
ÃighbÜs_y
[] = {-1, -1, -1, 0};

181 
ÃighbÜs_x
[] = {-1, 0, 1, -1};

183 
i
 = 0; i < 
i_sü“n_height
; i++) {

184 
j
 = 0; j < 
i_sü“n_width
; j++) {

185 (*
pm_»giÚ_m©rix
)[
i
][
j
] = -1;

188 
»giÚ_couÁ”
 = 1;

191 
i
, 
j
, 
y
, 
x
, 
cŞÜ_šd
, 
ÃighbÜs_šd
, 
found_»giÚ
;

192 
i
 = 0; i < 
i_sü“n_height
; i++) {

193 
j
 = 0; j < 
i_sü“n_width
; j++) {

194 
cŞÜ_šd
 = (*
sü“n_m©rix
)[
i
][
j
];

195 ià(
cŞÜ_šd
 =ğ(*
pm_background_m©rix
)[
i
][
j
]) {

197 (*
pm_»giÚ_m©rix
)[
i
][
j
] = 0;

201 
found_»giÚ
 = -1;

202 
ÃighbÜs_šd
 = 0;‚eighbÜs_šd < 
num_ÃighbÜs
;

203 
ÃighbÜs_šd
++) {

204 
y
 = 
i
 + 
ÃighbÜs_y
[
ÃighbÜs_šd
];

205 
x
 = 
j
 + 
ÃighbÜs_x
[
ÃighbÜs_šd
];

206 ià(
x
 < 0 || x >ğ
i_sü“n_width
 ||

207 
y
 < 0 || y >ğ
i_sü“n_height
) {

210 ià((*
pm_»giÚ_m©rix
)[
y
][
x
] != 0 &&

211 (*
pm_»giÚ_m©rix
)[
y
][
x
] != -1 &&

212 (*
sü“n_m©rix
)[
y
][
x
] =ğ
cŞÜ_šd
) {

213 
found_»giÚ
 = (*
pm_»giÚ_m©rix
)[
y
][
x
];

217 ià(
found_»giÚ
 == -1) {

219 (*
pm_»giÚ_m©rix
)[
i
][
j
] = 
»giÚ_couÁ”
;

220 
»giÚ_couÁ”
++;

222 (*
pm_»giÚ_m©rix
)[
i
][
j
] = 
found_»giÚ
;

227 
my_»giÚ
, 
nb_»giÚ
, 
my_cŞÜ_šd
, 
nb_cŞÜ_šd
;

228 
nb_x
, 
nb_y
, 
šd_i
, 
šd_j
, 
low”_»giÚ
, 
high”_»giÚ
;

229 
i
 = 0; i < 
i_sü“n_height
; i++) {

230 
j
 = 0; j < 
i_sü“n_width
; j++) {

231 
my_»giÚ
 = (*
pm_»giÚ_m©rix
)[
i
][
j
];

232 ià(
my_»giÚ
 == 0) {

235 
my_cŞÜ_šd
 = (*
sü“n_m©rix
)[
i
][
j
];

236 
y
 = -1; y <= 1; y++) {

237 
x
 = -1; x <= 1; x++) {

238 
nb_y
 = 
i
 + 
y
;

239 
nb_x
 = 
j
 + 
x
;

240 ià(
nb_x
 < 0 ||‚b_x >ğ
i_sü“n_width
 ||

241 
nb_y
 < 0 ||‚b_y >ğ
i_sü“n_height
) {

244 
nb_»giÚ
 = (*
pm_»giÚ_m©rix
)[
nb_y
][
nb_x
];

245 ià(
nb_»giÚ
 == 0) {

248 
nb_cŞÜ_šd
 = (*
sü“n_m©rix
)[
nb_y
][
nb_x
];

249 ià(
nb_cŞÜ_šd
 =ğ
my_cŞÜ_šd
 &&

250 
nb_»giÚ
 !ğ
my_»giÚ
) {

252 ià(
my_»giÚ
 > 
nb_»giÚ
) {

253 
high”_»giÚ
 = 
my_»giÚ
;

254 
low”_»giÚ
 = 
nb_»giÚ
;

256 
high”_»giÚ
 = 
nb_»giÚ
;

257 
low”_»giÚ
 = 
my_»giÚ
;

261 
šd_i
 = 0; ind_˜< 
i_sü“n_height
; ind_i++) {

262 
šd_j
 = 0; ind_j < 
i_sü“n_width
; ind_j++) {

263 ià((*
pm_»giÚ_m©rix
)[
šd_i
][
šd_j
] =ğ
high”_»giÚ
) {

264 (*
pm_»giÚ_m©rix
)[
šd_i
][
šd_j
] = 
low”_»giÚ
;

273  
»giÚ_couÁ”
 - 1;

274 
	}
}

280 
	gRegiÚMªag”
::
	$m”ge_equiv®’t_»giÚs
() {

281 
i
, 
j
, 
shiá_x
, 
shiá_y
, 
y
, 
x
, 
šd_i
, 
šd_j
;

282 
my_»giÚ_num
, 
ÃighbÜ_»giÚ_num
;

283 
RegiÚObjeù
 *
my_obj
, *
nb_obj
;

284 
high_»giÚ_num
, 
low_»giÚ_num
;

285 
i
 = 0; i < 
i_sü“n_height
; i++) {

286 
j
 = 0; j <
i_sü“n_width
; j++) {

287 
my_»giÚ_num
 = (*
pm_»giÚ_m©rix
)[
i
][
j
];

288 ià(
my_»giÚ_num
 == 0) {

291 
my_obj
 = (*
pv_cu¼_objeùs
)[
my_»giÚ_num
];

292 ià(
my_obj
 =ğ
NULL
) {

295 
shiá_y
 = -3; shift_y <= 3; shift_y++) {

296 
shiá_x
 = -3; shift_x <= -3; shift_x++) {

297 
y
 = 
i
 + 
shiá_y
;

298 
x
 = 
j
 + 
shiá_x
;

299 ià(
x
 < 0 || x >ğ
i_sü“n_width
 ||

300 
y
 < 0 || y >ğ
i_sü“n_height
) {

303 
ÃighbÜ_»giÚ_num
 = (*
pm_»giÚ_m©rix
)[
y
][
x
];

304 ià(
ÃighbÜ_»giÚ_num
 == 0) {

307 
nb_obj
 = (*
pv_cu¼_objeùs
)[
ÃighbÜ_»giÚ_num
];

308 ià(
nb_obj
 =ğ
NULL
) {

311 ià((
my_»giÚ_num
 !ğ
ÃighbÜ_»giÚ_num
) &&

312 (
my_obj
->
i_v–oc™y_x
 =ğ
nb_obj
->i_velocity_x) &&

313 (
my_obj
->
i_v–oc™y_y
 =ğ
nb_obj
->i_velocity_y)) {

315 ià(
my_»giÚ_num
 > 
ÃighbÜ_»giÚ_num
) {

316 
high_»giÚ_num
 = 
my_»giÚ_num
;

317 
low_»giÚ_num
 = 
ÃighbÜ_»giÚ_num
;

319 
high_»giÚ_num
 = 
ÃighbÜ_»giÚ_num
;

320 
low_»giÚ_num
 = 
my_»giÚ_num
;

324 
šd_i
 = 0; ind_˜< 
i_sü“n_height
; ind_i++) {

325 
šd_j
 = 0; ind_j < 
i_sü“n_width
; ind_j++) {

326 ià((*
pm_»giÚ_m©rix
)[
šd_i
][
šd_j
] ==

327 
high_»giÚ_num
) {

328 (*
pm_»giÚ_m©rix
)[
šd_i
][
šd_j
] =

329 
low_»giÚ_num
;

338 
	}
}

347 
	gRegiÚMªag”
::
	$ÿlc_objeù_v–oc™y
(
RegiÚObjeù
* 
obj
) {

348 ià(
obj
->
p_´evious_objeù
 =ğ
NULL
) {

349 
obj
->
i_v–oc™y_x
 = 0;

350 
obj
->
i_v–oc™y_y
 = 0;

352 
x_di¡
 = 
obj
->
i_ûÁ”_x
 - obj->
p_´evious_objeù
->i_center_x;

353 
y_di¡
 = 
obj
->
i_ûÁ”_y
 - obj->
p_´evious_objeù
->i_center_y;

354 
obj
->
i_v–oc™y_x
 = 
x_di¡
;

355 
obj
->
i_v–oc™y_y
 = 
y_di¡
;

357 
	}
}

364 
	gRegiÚMªag”
::
	$sw­_cu¼_ªd_´ev_»giÚ_objeùs
() {

365 
	`ş—r_li¡_of_poš‹rs
(
pv_´ev_objeùs
);

366 
RegiÚObjeùLi¡
* 
pv_tmp
 = 
pv_´ev_objeùs
;

367 
pv_´ev_objeùs
 = 
pv_cu¼_objeùs
;

368 
pv_cu¼_objeùs
 = 
pv_tmp
;

369 
i_´ev_num_»giÚs
 = 
i_cu¼_num_»giÚs
;

370 
i_cu¼_num_»giÚs
 = 0;

371 
	`ş—r_li¡_of_poš‹rs
(
pv_´ev_m”ged_objeùs
);

372 
d–‘e
 
pv_´ev_m”ged_objeùs
;

373 
pv_´ev_m”ged_objeùs
 = 
pv_cu¼_m”ged_objeùs
;

374 
pv_cu¼_m”ged_objeùs
 = 
Ãw
 
RegiÚObjeùLi¡
;

376 
	}
}

384 
	gRegiÚMªag”
::
	$¶Ù_»giÚ_m©rix
(
¡ršg
 
´e_po¡
, 
äame_numb”
) {

386 
IÁM©rix
* 
»giÚ_m©rix_cİy
 = 
Ãw
 IntMatrix;

387 
i
 = 0; i < 
i_sü“n_height
; i++) {

388 
IÁVeù
 
row
;

389 
j
 = 0; j < 
i_sü“n_width
; j++) {

390 
»giÚ_num
 = (*
pm_»giÚ_m©rix
)[
i
][
j
];

391 ià(
»giÚ_num
 == 0) {

392 
row
.
	`push_back
(
BLACK_COLOR_IND
 + 256);

394 
row
.
	`push_back
(
»giÚ_num
 + 256);

397 
»giÚ_m©rix_cİy
->
	`push_back
(
row
);

399 
o¡ršg¡»am
 
f’ame
;

400 
bufãr
 [50];

401 
	`¥rštf
 (
bufãr
, "%09d", 
äame_numb”
);

402 
f’ame
 << "»giÚ_m©rx__" << 
´e_po¡
 << "__äame_" << 
bufãr
 << ".png";

403 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(

404 
»giÚ_m©rix_cİy
, 
f’ame
.
	`¡r
());

405 
d–‘e
 
»giÚ_m©rix_cİy
;

406 
	}
}

	@player_agents/region_manager.h

17 #iâdeà
REGION_MANAGER_H


18 
	#REGION_MANAGER_H


	)

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"OSy¡em.hxx
"

22 
	~"blob_objeù.h
"

24 
	#MAX_NUM_OBJECTS
 1000

	)

27 şas 
	cRegiÚMªag”
 {

62 
	mpublic
:

63 
RegiÚMªag”
(
OSy¡em
* 
_osy¡em
, 
IÁM©rix
* 
background_m©rix
);

64 
	mvœtu®
 ~
RegiÚMªag”
();

73 cÚ¡ 
RegiÚObjeùLi¡
* 
exŒaù_objeùs_äom_Ãw_sü“n
(

74 cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

75 
äame_numb”
);

77 
	m´Ùeùed
:

107 
exŒaù_»giÚs
(cÚ¡ 
IÁM©rix
* 
sü“n_m©rix
);

113 
m”ge_equiv®’t_»giÚs
();

121 
ÿlc_objeù_v–oc™y
(
RegiÚObjeù
* 
obj
);

127 
sw­_cu¼_ªd_´ev_»giÚ_objeùs
();

134 
¶Ù_»giÚ_m©rix
(
¡ršg
 
´e_po¡
, 
äame_numb”
);

136 
OSy¡em
* 
	mp_osy¡em
;

137 
IÁM©rix
* 
	mpm_background_m©rix
;

138 
IÁM©rix
* 
	mpm_»giÚ_m©rix
;

139 
	mi_cu¼_num_»giÚs
;

140 
	mi_´ev_num_»giÚs
;

141 
RegiÚObjeùLi¡
* 
	mpv_cu¼_objeùs
;

142 
RegiÚObjeùLi¡
* 
	mpv_´ev_objeùs
;

143 
RegiÚObjeùLi¡
* 
	mpv_cu¼_m”ged_objeùs
;

144 
RegiÚObjeùLi¡
* 
	mpv_´ev_m”ged_objeùs
;

145 
boŞ
 
	mb_¶Ù_»giÚ_m©rix_´e_m”ge
;

146 
boŞ
 
	mb_¶Ù_»giÚ_m©rix_po¡_m”ge
;

147 
	mi_sü“n_width
;

148 
	mi_sü“n_height
;

149 
	mf_max_³rc_difã»nû
;

150 
	mi_max_obj_v–oc™y
;

151 
	mf_max_sh­e_¬—_dif
;

	@player_agents/rl_sarsa_lambda.cpp

19 
	~<s¡»am
>

21 
	~"veùÜ_m©rix_toŞs.h
"

22 
	~"¾_§r§_Ïmbda.h
"

23 
	~"OSy¡em.hxx
"

24 
	~"expÜt_toŞs.h
"

25 
	~"¿ndom_toŞs.h
"

30 
	gRLS¬§Lambda
::
	$RLS¬§Lambda
Ğ
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

31 
num_aùiÚs
, 
®pha
,

32 
§ve_weights_äeq
) {

33 
p_osy¡em
 = 
_osy¡em
;

34 
i_ã©u»_vec_size
 = 
ã©u»_vec_size
;

35 
i_§ve_weights_äeq
 = 
§ve_weights_äeq
;

36 
i_num_aùiÚs
 = 
num_aùiÚs
;

37 
S‘tšgs
& 
£‰šgs
 = 
p_osy¡em
->
	`£‰šgs
();

38 
f_•sÚ
 = 
£‰šgs
.
	`g‘Flßt
("•sÚ", 
Œue
);

39 
f_Ïmbda
 = 
£‰šgs
.
	`g‘Flßt
("Ïmbda", 
Œue
);

40 
f_gamma
 = 
£‰šgs
.
	`g‘Flßt
("gamma", 
Œue
);

41 
•s_dim_¡¬t_r
 = 
£‰šgs
.
	`g‘Flßt
("•sÚ_dim_¡¬t", 
Œue
);

42 
max_num_•isodes
 = 
£‰šgs
.
	`g‘IÁ
("max_num_•isodes", 
Œue
);

43 ià(
•s_dim_¡¬t_r
 >= 0) {

45 
i_•sÚ_dim_¡¬t
 = ()(
max_num_•isodes
 * 
•s_dim_¡¬t_r
);

46 
num_dimšishšg_•isodes
 = 
max_num_•isodes
 - 
i_•sÚ_dim_¡¬t
;

47 
f_•s_dim_d–
 = 
f_•sÚ
 / (è
num_dimšishšg_•isodes
;

48 
cout
 << "WÈdimšishƒpsÚ " << 
f_•s_dim_d–
 << "…erƒpisode, "

49 << "aá”ƒpisodnumb”: " << 
i_•sÚ_dim_¡¬t
 << 
’dl
;

52 
i_•sÚ_dim_¡¬t
 = 
max_num_•isodes
;

53 
f_•s_dim_d–
 = 0.0;

55 
i_shršk_weights_äq
 = 
£‰šgs
.
	`g‘IÁ
("shršk_weights_äq", 
Œue
);

56 ià(
i_shršk_weights_äq
 > 0) {

57 
f_shršk_weights_cÚ¡
 = 
£‰šgs
.
	`g‘Flßt
("shršk_weights_cÚ¡",
Œue
);

58 
s_shršk_weights_m‘hod
=
£‰šgs
.
	`g‘SŒšg
("shršk_weights_m‘hod",
Œue
);

60 
f_shršk_weights_cÚ¡
 = 0.0;

61 
s_shršk_weights_m‘hod
 = "";

63 
f_®pha
 = 
®pha
;

64 
i_´ev_aùiÚ
 = -1;

65 
i_cu¼_aùiÚ
 = -1;

66 
i
 = 0; i < 
i_num_aùiÚs
; i++) {

67 
v_Q
.
	`push_back
(0);

69 
pv_cu¼_ã©u»s_m­
 = 
NULL
;

70 
pv_num_nÚz”o_š_f
 = 
NULL
;

71 
i_•isode_couÁ”
 = 0;

72 
i_äame_couÁ”
 = 0;

73 
Œaû_vec_size_¿tio
 = 
£‰šgs
.
	`g‘Flßt
("Œaû_vec_size_¿tio",
Œue
);

74 
i_max_nÚz”o_Œaûs
 = ()(
ã©u»_vec_size
 * 
Œaû_vec_size_¿tio
);

75 
i_num_nÚz”o_Œaûs
 = 0;

76 
f_mšimum_Œaû
 = 
£‰šgs
.
	`g‘Flßt
("mšimum_Œaû_v®ue", 
Œue
);

77 
b_İtimi¡ic_š™
 = 
£‰šgs
.
	`g‘BoŞ
("İtimi¡ic_š™", 
Œue
);

78 
weight_š™
 = 0.0;

79 ià(
b_İtimi¡ic_š™
) {

80 
cout
 << "Optimitic Initialization:‡ll weights‡re initilizedo"

81 << " 1.0/ã©u»_vec_size" << 
’dl
;

82 
weight_š™
 = 1.0 / ()
ã©u»_vec_size
;

85 
pv_weights
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

86 
pv_Œaûs
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

87 
pv_nÚz”o_Œaûs_šv_šd
 = 
Ãw
 
	`IÁVeù
(
i_ã©u»_vec_size
);

88 
i
 = 0; i < 
i_ã©u»_vec_size
; i++ ) {

89 (*
pv_weights
)[
i
] = 
weight_š™
;

90 (*
pv_Œaûs
)[
i
] = 0.0;

91 (*
pv_nÚz”o_Œaûs_šv_šd
)[
i
] = -1;

93 
pv_nÚz”o_Œaûs_šd
 = 
Ãw
 
	`IÁVeù
(
i_max_nÚz”o_Œaûs
);

94 
i
 = 0; i < 
i_max_nÚz”o_Œaûs
; i++) {

95 (*
pv_nÚz”o_Œaûs_šd
)[
i
] = -1;

97 
i_´ev_aùiÚ
 = -1;

98 
b_nÜm®ize_fv
 = 
£‰šgs
.
	`g‘BoŞ
("nÜm®ize_ã©u»_veùÜ", 
Œue
);

99 ià(
b_nÜm®ize_fv
) {

100 
cout
 << "NÜm®izšghF—tu»-VeøtØsum u°tØ1.0" << 
’dl
;

103 
¡ršg
 
impÜt_fe
 = 
£‰šgs
.
	`g‘SŒšg
("impÜt_weights_fe", 
Œue
);

104 ià(
impÜt_fe
.
	`size
() > 0) {

105 
cout
 << "ImpÜtšghweight veùÜ from: << " << 
impÜt_fe
 << 
’dl
;

106 
	`impÜt_¬¿y
(
pv_weights
, 
impÜt_fe
);

108 
	}
}

113 
	gRLS¬§Lambda
::~
	$RLS¬§Lambda
() {

114 
d–‘e
 
pv_weights
;

115 
d–‘e
 
pv_Œaûs
;

116 
d–‘e
 
pv_nÚz”o_Œaûs_šd
;

117 
d–‘e
 
pv_nÚz”o_Œaûs_šv_šd
;

118 
	}
}

125 
	gRLS¬§Lambda
::
	$•isode_¡¬t
Ğ
F—tu»M­
* 
Ãw_ã©u»_m­
,

126 
IÁVeù
* 
num_nÚz”o_š_f
,

127 
fÜûd_aùiÚ_šd
) {

128 
	`DeÿyT¿ûs
(0.0);

129 
pv_cu¼_ã©u»s_m­
 = 
Ãw_ã©u»_m­
;

130 
pv_num_nÚz”o_š_f
 = 
num_nÚz”o_š_f
;

131 
	`compu‹AùiÚV®ues
();

132 ià(
fÜûd_aùiÚ_šd
 == -1) {

133 
i_´ev_aùiÚ
 = 
	`£ËùEpsÚG»edyAùiÚ
();

135 
i_´ev_aùiÚ
 = 
fÜûd_aùiÚ_šd
;

137  
i_´ev_aùiÚ
;

138 
	}
}

153 
	gRLS¬§Lambda
::
	$•isode_¡•
(
F—tu»M­
* 
Ãw_ã©u»_m­
,

154 
IÁVeù
* 
num_nÚz”o_š_f
, 
Ãw_»w¬d
,

155 
fÜûd_aùiÚ_šd
) {

156 
i_äame_couÁ”
++;

157 
	`as£¹
(
i_´ev_aùiÚ
 != -1);

158 
d–
 = 
Ãw_»w¬d
 - 
v_Q
[
i_´ev_aùiÚ
];

159 
pv_cu¼_ã©u»s_m­
 = 
Ãw_ã©u»_m­
;

160 
pv_num_nÚz”o_š_f
 = 
num_nÚz”o_š_f
;

161 
	`compu‹AùiÚV®ues
();

162 ià(
fÜûd_aùiÚ_šd
 == -1) {

163 
i_´ev_aùiÚ
 = 
	`£ËùEpsÚG»edyAùiÚ
();

165 
i_´ev_aùiÚ
 = 
fÜûd_aùiÚ_šd
;

167 
d–
 +ğ(
f_gamma
 * 
v_Q
[
i_´ev_aùiÚ
]);

168 ià(!(
d–
 - 1.0 < delta)) {

169 
cout
 << "D– = inf.:(" << 
’dl
;

170 
û¼
 << "D– = inf. :(" << 
’dl
;

171 
	`ex™
(-1);

173 
	`upd©eWeights
(
d–
);

174 
	`upd©eT¿ûs
();

175 
	`compu‹AùiÚV®ues
(
i_´ev_aùiÚ
);

176  
i_´ev_aùiÚ
;

177 
	}
}

186 
	gRLS¬§Lambda
::
	$•isode_’d
(
»w¬d
, 
v®ue_of_fš®_¡©e
) {

187 
d–
 = 
»w¬d
 - 
v_Q
[
i_´ev_aùiÚ
];

188 
d–
 +ğ(
f_gamma
 * 
v®ue_of_fš®_¡©e
);

189 
	`upd©eWeights
(
d–
);

190 
i_•isode_couÁ”
++;

191 ià((
f_•s_dim_d–
 > 0.0 || f_eps_dim_delta < 0.0 ) &&

192 
i_•isode_couÁ”
 > 
i_•sÚ_dim_¡¬t
) {

194 
f_•sÚ
 -ğ
f_•s_dim_d–
;

195 ià(
f_•sÚ
 < 0) {

196 
f_•sÚ
 = 0;

198 
cout
 << "•sÚ upd©edo: " << 
f_•sÚ
 << 
’dl
;

201 
	`shršk_weights_veù
();

203 ià((
i_§ve_weights_äeq
 != 0) &&

204 (
i_•isode_couÁ”
 % 
i_§ve_weights_äeq
 == 0)) {

205 
cout
 << "Exportinghe weights... ";

206 
o¡ršg¡»am
 
f’ame
;

207 
f’ame
 << "expÜ‹d_weights__•isode_" << 
i_•isode_couÁ”
 << ".txt";

208 
	`expÜt_weights
(
f’ame
.
	`¡r
());

209 
cout
 << "dÚe." << 
’dl
;

211 
	}
}

216 
	gRLS¬§Lambda
::
	$compu‹AùiÚV®ues
() {

217 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

218 
v_Q
[
a
] = 0;

219 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
a
]; j++) {

220 
v_Q
[
a
] +ğ(*
pv_weights
)[(*
pv_cu¼_ã©u»s_m­
)[a][
j
]];

222 ià(
b_nÜm®ize_fv
) {

223 
v_Q
[
a
] = v_Q[a] / ((*
pv_num_nÚz”o_š_f
)[a]);

226 
	}
}

232 
	gRLS¬§Lambda
::
	$compu‹AùiÚV®ues
(
a
) {

233 
v_Q
[
a
] = 0;

234 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
a
]; j++) {

235 
v_Q
[
a
] +ğ(*
pv_weights
)[(*
pv_cu¼_ã©u»s_m­
)[a][
j
]];

237 ià(
b_nÜm®ize_fv
) {

238 
v_Q
[
a
] = v_Q[a] / ((*
pv_num_nÚz”o_š_f
)[a]);

240 
	}
}

247 
	gRLS¬§Lambda
::
	$¬gmax
(
FlßtVeù
& 
QSA
) {

248 
be¡_aùiÚ
 = 0;

249 
be¡_v®ue
 = 
QSA
[0];

250 
num_t›s
 = 1;

251 
v®ue
;

253 
a
 = 1;‡ < 
i_num_aùiÚs
;‡++) {

254 
v®ue
 = 
QSA
[
a
];

255 ià(
v®ue
 >ğ
be¡_v®ue
) {

256 ià(
v®ue
 > 
be¡_v®ue
)

258 
be¡_v®ue
 = 
v®ue
;

259 
be¡_aùiÚ
 = 
a
;

261 
num_t›s
++;

262 ià(0 =ğ()(
	`d¿nd48
()*
num_t›s
)) {

263 
be¡_v®ue
 = 
v®ue
;

264 
be¡_aùiÚ
 = 
a
;

269  
be¡_aùiÚ
;

271 
	}
}

275 
	gRLS¬§Lambda
::
	$£ËùEpsÚG»edyAùiÚ
() {

276 if(
	`d¿nd48
(è<ğ
f_•sÚ
) {

277 
ºd
 = ()(
	`d¿nd48
()*(
i_num_aùiÚs
));

278  
ºd
;

281  
	`¬gmax
(
v_Q
);

283 
	}
}

289 
	gRLS¬§Lambda
::
	$upd©eT¿ûs
() {

290 
	`DeÿyT¿ûs
(
f_gamma
 * 
f_Ïmbda
);

291 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

292 ià(
a
 !ğ
i_´ev_aùiÚ
) {

293 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
a
]; j++) {

294 
	`CË¬T¿û
((*
pv_cu¼_ã©u»s_m­
)[
a
][
j
]);

298 
j
 = 0; j < (*
pv_num_nÚz”o_š_f
)[
i_´ev_aùiÚ
]; j++) {

300 
	`S‘T¿û
((*
pv_cu¼_ã©u»s_m­
)[
i_´ev_aùiÚ
][
j
], 1.0);

302 
	}
}

307 
	gRLS¬§Lambda
::
	$upd©eWeights
(
d–
) {

308 
	`as£¹
(
f_®pha
 >= 0);

309 
‹mp
 = 
f_®pha
 * 
d–
;

310 
i
 = 0; i < 
i_num_nÚz”o_Œaûs
; i++) {

311 
šdex
 = (*
pv_nÚz”o_Œaûs_šd
)[
i
];

312 (*
pv_weights
)[
šdex
] +ğ(
‹mp
 * (*
pv_Œaûs
)[index]);

315 
	}
}

321 
	gRLS¬§Lambda
::
	$´št_Ïrge¡_weight
() {

322 
Ïrge¡_weight
 = 0;

323 
sm®Ë¡_weight
 = 0;

324 
Ïrge¡_Œaû
 = 0;

325 
sm®Ë¡_Œaû
 = 0;

326 
i
 = 0; i < 
i_ã©u»_vec_size
; i++) {

327 ià((*
pv_weights
)[
i
] > 
Ïrge¡_weight
) {

328 
Ïrge¡_weight
 = (*
pv_weights
)[
i
];

330 ià((*
pv_weights
)[
i
] < 
sm®Ë¡_weight
) {

331 
sm®Ë¡_weight
 = (*
pv_weights
)[
i
];

333 ià((*
pv_Œaûs
)[
i
] > 
Ïrge¡_Œaû
) {

334 
Ïrge¡_Œaû
 = (*
pv_Œaûs
)[
i
];

336 ià((*
pv_Œaûs
)[
i
] < 
sm®Ë¡_Œaû
) {

337 
sm®Ë¡_Œaû
 = (*
pv_Œaûs
)[
i
];

340 
cout
 << "L¬ge¡ Weight: " << 
Ïrge¡_weight
 << " - ";

341 
cout
 << "Sm®Ë¡ Weight: " << 
sm®Ë¡_weight
 << 
’dl
;

342 
cout
 << "L¬ge¡ T¿û: " << 
Ïrge¡_Œaû
 << " - ";

343 
cout
 << "Sm®Ë¡ T¿û: " << 
sm®Ë¡_Œaû
 << 
’dl
;

344 
cout
 << "*********************************************************" << 
’dl
;

345 
	}
}

350 
	gRLS¬§Lambda
::
	$CË¬T¿û
(
f
) {

351 ià(!((*
pv_Œaûs
)[
f
] == 0.0)) {

352 
	`CË¬Exi¡’tT¿û
(
f
, (*
pv_nÚz”o_Œaûs_šv_šd
)[f]);

354 
	}
}

359 
	gRLS¬§Lambda
::
	$CË¬Exi¡’tT¿û
(
f
, 
loc
) {

360 (*
pv_Œaûs
)[
f
] = 0.0;

361 
i_num_nÚz”o_Œaûs
--;

362 (*
pv_nÚz”o_Œaûs_šd
)[
loc
] = (*pv_nÚz”o_Œaûs_šd)[
i_num_nÚz”o_Œaûs
];

363 (*
pv_nÚz”o_Œaûs_šv_šd
)[(*
pv_nÚz”o_Œaûs_šd
)[
loc
]] =†oc;

364 
	}
}

369 
	gRLS¬§Lambda
::
	$DeÿyT¿ûs
(
deÿy_¿‹
) {

370 
loc
 = 
i_num_nÚz”o_Œaûs
 - 1;†oc >= 0;†oc--) {

371 
f
 = (*
pv_nÚz”o_Œaûs_šd
)[
loc
];

372 (*
pv_Œaûs
)[
f
] *ğ
deÿy_¿‹
;

373 ià((*
pv_Œaûs
)[
f
] < 
f_mšimum_Œaû
) {

374 
	`CË¬Exi¡’tT¿û
(
f
, 
loc
);

377 
	}
}

382 
	gRLS¬§Lambda
::
	$S‘T¿û
(
f
, 
Ãw_Œaû_v®ue
) {

383 ià((*
pv_Œaûs
)[
f
] >ğ
f_mšimum_Œaû
) {

384 (*
pv_Œaûs
)[
f
] = 
Ãw_Œaû_v®ue
;

386 
i_num_nÚz”o_Œaûs
 >ğ
i_max_nÚz”o_Œaûs
) {

387 
	`Inü—£MšT¿û
();

389 (*
pv_Œaûs
)[
f
] = 
Ãw_Œaû_v®ue
;

390 (*
pv_nÚz”o_Œaûs_šd
)[
i_num_nÚz”o_Œaûs
] = 
f
;

391 (*
pv_nÚz”o_Œaûs_šv_šd
)[
f
] = 
i_num_nÚz”o_Œaûs
;

392 
i_num_nÚz”o_Œaûs
++;

394 
	}
}

400 
	gRLS¬§Lambda
::
	$Inü—£MšT¿û
() {

401 
f_mšimum_Œaû
 += (0.1 * f_minimum_trace);

402 
loc
 = 
i_num_nÚz”o_Œaûs
 - 1;†oc >= 0;†oc--) {

403 
f
 = (*
pv_nÚz”o_Œaûs_šd
)[
loc
];

404 iàĞ(*
pv_Œaûs
)[
f
] < 
f_mšimum_Œaû
) {

405 
	`CË¬Exi¡’tT¿û
(
f
, 
loc
);

408 
	}
}

415 
	gRLS¬§Lambda
::
	$expÜt_weights
(cÚ¡ 
¡ršg
& 
f’ame
) {

416 
	`expÜt_¬¿y
(
pv_weights
, 
f’ame
);

417 
i
 = 0; i < 10; i++) {

418 
cout
 << (*
pv_weights
)[
i
] << ", ";

420 
i
 = 1; i <= 10; i++) {

421 
cout
 << (*
pv_weights
)[pv_weights->
	`size
(è- 
i
] << ", ";

423 
	}
}

428 
	gRLS¬§Lambda
::
	$impÜt_weights
(cÚ¡ 
¡ršg
& 
f’ame
) {

429 
	`impÜt_¬¿y
(
pv_weights
, 
f’ame
);

430 
cout
 << "Weight VeùÜ impÜtd fromfe" + 
f’ame
 << 
’dl
;

431 
cout
 << "First 10 values: ";

432 
i
 = 0; i < 10; i++) {

433 
cout
 << (*
pv_weights
)[
i
] << ", ";

435 
cout
 << 
’dl
 << "Last 10 values: ";

436 
i
 = 1; i <= 10; i++) {

437 
cout
 << (*
pv_weights
)[pv_weights->
	`size
(è- 
i
] << ", ";

439 
	}
}

444 
	gRLS¬§Lambda
::
	$shršk_weights_veù
() {

445 ià((
i_shršk_weights_äq
 <= 0) ||

446 (
i_•isode_couÁ”
 % 
i_shršk_weights_äq
 != 0)) {

449 
num_nÚ_z”o
 = 0;

450 
i
 = 0; i < 
pv_weights
->
	`size
(); i++) {

451 ià((*
pv_weights
)[
i
] != 0.0) {

452 
num_nÚ_z”o
++;

455 
num_v®s_to_k“p
;

456 ià(
s_shršk_weights_m‘hod
 == "sqr_root_num_frames") {

457 
num_v®s_to_k“p
 = ()
	`pow
(()
i_äame_couÁ”
,

459 
num_v®s_to_k“p
 = (èÒum_v®s_to_k“°* 
f_shršk_weights_cÚ¡
);

460 } ià(
s_shršk_weights_m‘hod
 == "linear_shrink") {

461 
num_v®s_to_k“p
 = (è(
num_nÚ_z”o
 * 
f_shršk_weights_cÚ¡
);

462 } ià(
s_shršk_weights_m‘hod
 == "const_shrink") {

463 
num_v®s_to_k“p
 = 
num_nÚ_z”o
 - ()
f_shršk_weights_cÚ¡
;

465 
û¼
 << "Inv®id v®ufÜ shršk_weights_m‘hod" << 
’dl
;

466 
	`ex™
(-1);

469 
cout
 << "Had " << 
num_nÚ_z”o
 << "‚on-zero values in w.";

470 
	`shršk_¬¿y
(
pv_weights
, 
num_v®s_to_k“p
);

471 
num_nÚ_z”o
 = 0;

472 
i
 = 0; i < 
pv_weights
->
	`size
(); i++) {

473 ià((*
pv_weights
)[
i
] != 0) {

474 
num_nÚ_z”o
++;

477 
cout
 << "K•ˆ" << 
num_nÚ_z”o
 << " v®ues." << 
’dl
;

478 
	}
}

485 
RLS¬§Lambda
* 
	gRLS¬§Lambda
::
	$g’”©e_¾_§r§_Ïmbda_š¡ªû
(

486 
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

487 
num_aùiÚs
) {

488 
S‘tšgs
& 
£‰šgs
 = 
_osy¡em
->
	`£‰šgs
();

489 
®pha_muÉl›r
 = 
£‰šgs
.
	`g‘Flßt
("®pha_muÉl›r", 
Œue
);

490 
®pha
 = 
£‰šgs
.
	`g‘Flßt
("®pha", 
Œue
);

491 
boŞ
 
u£_d–_b¬_d–
 = 
£‰šgs
.
	`g‘BoŞ
("u£_d–_b¬_d–",
Œue
);

492 
boŞ
 
u£_idbd
 = 
£‰šgs
.
	`g‘BoŞ
("u£_idbd",
Œue
);

493 ià(!
u£_idbd
) {

494 ià(
®pha
 == -1.0) {

495 
cout
 << "Alpha is determined‡utomatically: ";

496 
®pha
 = 1.0 / ( (
ã©u»_vec_size
 / 2 ) * 
®pha_muÉl›r
);

498 
cout
 << "Alpha is seto: " ;

500 
cout
 << 
®pha
 << 
’dl
;

501 
	`as£¹
 (
®pha
 >= 0);

503 
exp_w_äq
 = 
£‰šgs
.
	`g‘IÁ
("expÜt_weights_äq",
Œue
);

504 ià(
u£_idbd
 && 
u£_d–_b¬_d–
) {

505 
û¼
 << "u£_idbd‡nd u£_d–_b¬_d– cªnÙ bÙh bŒue" << 
’dl
;

506 
	`ex™
(-1);

508 
RLS¬§Lambda
* 
§r§_Ïmbda_sŞv”
 = 
NULL
;

509 ià(
u£_d–_b¬_d–
) {

510 
•s_¡¬t
 = 
®pha
;

511 
k
 = (
®pha
 / 2.0);

512 
phi
 = 0.1;

513 
th‘a
 = 0.1;

514 
cout
 << "Usšg D–-B¬-D–: " << 
’dl


515 << "\ˆ•s_¡¬ˆğ" << 
•s_¡¬t
 << 
’dl


516 << "\ˆk = " << 
k
 << 
’dl


517 << "\ˆph˜ğ" << 
phi
 << 
’dl


518 << "\ˆth‘¨ğ" << 
th‘a
 << 
’dl
;

519 
§r§_Ïmbda_sŞv”
 = 
Ãw
 
	`RLS¬§LambdaW™hD–B¬D–
Ğ
_osy¡em
,

520 
ã©u»_vec_size
,

521 
num_aùiÚs
,

522 
•s_¡¬t
, 
k
, 
phi
, 
th‘a
,

523 
exp_w_äq
);

524 } ià(
u£_idbd
) {

525 
cout
 << "Usšg iDBD. " << 
’dl
 ;

526 
§r§_Ïmbda_sŞv”
 = 
Ãw
 
	`RLS¬§LambdaW™hIDBD
(
_osy¡em
,

527 
ã©u»_vec_size
,

528 
num_aùiÚs
,

529 
exp_w_äq
);

531 
cout
 << "Usšg stiøAÍha. " << 
’dl
 ;

532 
§r§_Ïmbda_sŞv”
 = 
Ãw
 
	`RLS¬§Lambda
Ğ
_osy¡em
,

533 
ã©u»_vec_size
,

534 
num_aùiÚs
, 
®pha
,

535 
exp_w_äq
);

537  
§r§_Ïmbda_sŞv”
;

539 
	}
}

555 
	gRLS¬§LambdaW™hIDBD
::
	$RLS¬§LambdaW™hIDBD
Ğ
OSy¡em
* 
_osy¡em
,

556 
ã©u»_vec_size
, 
num_aùiÚs
,

557 
§ve_weights_äeq
) :

558 
	`RLS¬§Lambda
Ğ
_osy¡em
, 
ã©u»_vec_size
, 
num_aùiÚs
,

559 -1.0, 
§ve_weights_äeq
) {

560 
S‘tšgs
& 
£‰šgs
 = 
p_osy¡em
->
	`£‰šgs
();

561 
f_th‘a
 = 
£‰šgs
.
	`g‘Flßt
("th‘a", 
Œue
);

562 
cout
 << "Th‘¨(iDBD m‘a-Ë¬nšg„©eèğ" << 
f_th‘a
 << 
’dl
;

563 
pv_h
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

564 
pv_b‘a
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

565 
i
 = 0; i < 
i_ã©u»_vec_size
; i++ ) {

566 (*
pv_h
)[
i
] = 0;

567 (*
pv_b‘a
)[
i
] = 0;

569 
	}
}

574 
	gRLS¬§LambdaW™hIDBD
::~
	$RLS¬§LambdaW™hIDBD
() {

575 
d–‘e
 
pv_h
;

576 
d–‘e
 
pv_b‘a
;

577 
	}
}

583 
	gRLS¬§LambdaW™hIDBD
::
	$upd©eWeights
(
d–
) {

584 
®pha
, 
deÿy
;

585 
i
 = 0; i < 
i_num_nÚz”o_Œaûs
; i++) {

586 
šdex
 = (*
pv_nÚz”o_Œaûs_šd
)[
i
];

587 (*
pv_b‘a
)[
šdex
] +ğĞ
f_th‘a
 * 
d–
 * (*
pv_Œaûs
)[index] *

588 (*
pv_h
)[
šdex
] );

589 
®pha
 = 
	`pow
(
M_E
, (*
pv_b‘a
)[
šdex
]);

590 
deÿy
 = 1.0 - (
®pha
 * (*
pv_Œaûs
)[
šdex
] * (*pv_traces)[index]);

591 ià(
deÿy
 < 0) {

592 
deÿy
 = 0;

594 
deÿy
 = deÿy * (*
pv_h
)[
šdex
];

595 (*
pv_h
)[
šdex
] = 
deÿy
 + 
®pha
 * 
d–
 * (*
pv_Œaûs
)[index];

596 (*
pv_weights
)[
šdex
] +ğ(
®pha
 * 
d–
 * (*
pv_Œaûs
)[index]);

598 
	}
}

616 
	gRLS¬§LambdaW™hD–B¬D–
::
	$RLS¬§LambdaW™hD–B¬D–
(

617 
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

618 
num_aùiÚs
, 
•s_¡¬t
, 
k
, 
phi
, 
th‘a
,

619 
§ve_weights_äeq
) :

620 
	`RLS¬§Lambda
Ğ
_osy¡em
, 
ã©u»_vec_size
, 
num_aùiÚs
,

621 -1.0, 
§ve_weights_äeq
) {

622 
f_k
 = 
k
;

623 
f_phi
 = 
phi
;

624 
f_th‘a
 = 
th‘a
;

625 
pv_•s
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

626 
pv_d–_b¬
 = 
Ãw
 
	`FlßtA¼
(
i_ã©u»_vec_size
);

627 
i
 = 0; i < 
i_ã©u»_vec_size
; i++ ) {

628 (*
pv_•s
)[
i
] = 
•s_¡¬t
;

629 (*
pv_d–_b¬
)[
i
] = 0.0;

632 
	}
}

636 
	gRLS¬§LambdaW™hD–B¬D–
::~
	$RLS¬§LambdaW™hD–B¬D–
() {

637 
d–‘e
 
pv_•s
;

638 
d–‘e
 
pv_d–_b¬
;

639 
	}
}

644 
	gRLS¬§LambdaW™hD–B¬D–
::
	$upd©eWeights
(
d–
) {

645 
Ãw_d–
, 
d–_b¬_d–
;

646 
i
 = 0; i < 
i_num_nÚz”o_Œaûs
; i++) {

647 
šdex
 = (*
pv_nÚz”o_Œaûs_šd
)[
i
];

649 
Ãw_d–
 = 
d–
 * (*
pv_Œaûs
)[
šdex
];

652 
d–_b¬_d–
 = 
Ãw_d–
 * (*
pv_d–_b¬
)[
šdex
];

653 ià(
d–_b¬_d–
 > 0) {

654 (*
pv_•s
)[
šdex
] +ğ
f_k
;

655 } ià(
d–_b¬_d–
 < 0) {

656 (*
pv_•s
)[
šdex
] -ğ
f_phi
 * (*pv_eps)[index];

660 (*
pv_d–_b¬
)[
šdex
] = ((1 - 
f_th‘a
è* 
Ãw_d–
) +

661 (
f_th‘a
 * (*
pv_d–_b¬
)[
šdex
]);

663 (*
pv_weights
)[
šdex
] +ğ((*
pv_•s
)[šdex] * 
Ãw_d–
);

666 
	}
}

	@player_agents/rl_sarsa_lambda.h

20 #iâdeà
RL_SARSA_LAMBDA_H


21 
	#RL_SARSA_LAMBDA_H


	)

23 
	~"commÚ_cÚ¡ªts.h
"

24 
şass
 
	gOSy¡em
;

26 şas 
	cRLS¬§Lambda
 {

27 
	mpublic
:

31 
RLS¬§Lambda
(
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

32 
num_aùiÚs
, 
®pha
, 
§ve_weights_äeq
) ;

36 
	mvœtu®
 ~
RLS¬§Lambda
();

43 
vœtu®
 
•isode_¡¬t
Ğ
F—tu»M­
* 
Ãw_ã©u»_m­
,

44 
IÁVeù
* 
num_nÚz”o_š_f
,

45 
fÜûd_aùiÚ_šd
 = -1);

55 
vœtu®
 
•isode_¡•
Ğ
F—tu»M­
* 
Ãw_ã©u»_m­
,

56 
IÁVeù
* 
num_nÚz”o_š_f
, 
Ãw_»w¬d
,

57 
fÜûd_aùiÚ_šd
 = -1);

65 
vœtu®
 
•isode_’d
(
»w¬d
, 
v®ue_of_fš®_¡©e
);

70 
šlše
 
	$£t_®pha
(
Ãw_®pha
) {

71 
f_®pha
 = 
Ãw_®pha
;

78 
vœtu®
 
	`expÜt_weights
(cÚ¡ 
¡ršg
& 
f’ame
);

83 
vœtu®
 
	`impÜt_weights
(cÚ¡ 
¡ršg
& 
f’ame
);

88 
šlše
 
FlßtA¼
* 
	$g‘_weights
(è{ 
pv_weights
;
	}
};

95 
RLS¬§Lambda
* 
g’”©e_¾_§r§_Ïmbda_š¡ªû
(

96 
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

97 
num_aùiÚs
);

99 
	g´Ùeùed
:

103 
vœtu®
 
compu‹AùiÚV®ues
();

109 
vœtu®
 
compu‹AùiÚV®ues
(
a
);

116 
vœtu®
 
¬gmax
(
FlßtVeù
& 
QSA
);

121 
vœtu®
 
£ËùEpsÚG»edyAùiÚ
();

127 
vœtu®
 
upd©eT¿ûs
();

132 
vœtu®
 
upd©eWeights
(
d–
);

138 
´št_Ïrge¡_weight
();

143 
CË¬T¿û
(
f
);

148 
CË¬Exi¡’tT¿û
(
f
, 
loc
);

153 
DeÿyT¿ûs
(
deÿy_¿‹
);

158 
S‘T¿û
(
f
, 
Ãw_Œaû_v®ue
);

164 
Inü—£MšT¿û
();

169 
shršk_weights_veù
();

171 
OSy¡em
* 
	gp_osy¡em
;

172 
	gf_•sÚ
;

173 
	gf_®pha
;

174 
	gf_Ïmbda
;

175 
	gf_gamma
;

176 
boŞ
 
	gb_İtimi¡ic_š™
;

177 
boŞ
 
	gb_nÜm®ize_fv
;

178 
	gi_num_aùiÚs
;

179 
	gi_ã©u»_vec_size
;

180 
FlßtA¼
* 
	gpv_weights
;

181 
FlßtA¼
* 
	gpv_Œaûs
;

182 
	gi_´ev_aùiÚ
;

183 
	gi_cu¼_aùiÚ
;

184 
FlßtVeù
 
	gv_Q
;

185 
F—tu»M­
* 
	gpv_cu¼_ã©u»s_m­
;

188 
IÁVeù
* 
	gpv_num_nÚz”o_š_f
;

190 
	gi_•isode_couÁ”
;

191 
	gi_äame_couÁ”
;

192 
	gi_shršk_weights_äq
;

194 
¡ršg
 
	gs_shršk_weights_m‘hod
;

206 
	gf_shršk_weights_cÚ¡
;

207 
	gi_§ve_weights_äeq
;

210 
	gi_•sÚ_dim_¡¬t
;

212 
	gf_•s_dim_d–
;

213 
	gi_max_nÚz”o_Œaûs
;

214 
	gi_num_nÚz”o_Œaûs
;

215 
	gf_mšimum_Œaû
;

216 
IÁVeù
* 
	gpv_nÚz”o_Œaûs_šd
;

217 
IÁVeù
* 
	gpv_nÚz”o_Œaûs_šv_šd
;

223 şas 
	cRLS¬§LambdaW™hIDBD
 : 
public
 
RLS¬§Lambda
 {

231 
public
:

235 
RLS¬§LambdaW™hIDBD
Ğ
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

236 
num_aùiÚs
,

237 
§ve_weights_äeq
) ;

241 
	mvœtu®
 ~
RLS¬§LambdaW™hIDBD
();

246 
vœtu®
 
upd©eWeights
(
d–
);

248 
	mf_th‘a
;

249 
FlßtA¼
* 
	mpv_h
;

250 
FlßtA¼
* 
	mpv_b‘a
;

253 şas 
	cRLS¬§LambdaW™hD–B¬D–
 : 
public
 
RLS¬§Lambda
 {

261 
public
:

265 
RLS¬§LambdaW™hD–B¬D–
Ğ
OSy¡em
* 
_osy¡em
, 
ã©u»_vec_size
,

266 
num_aùiÚs
, 
•s_¡¬t
,

267 
k
, 
phi
, 
th‘a
,

268 
§ve_weights_äeq
) ;

272 
	mvœtu®
 ~
RLS¬§LambdaW™hD–B¬D–
();

277 
vœtu®
 
upd©eWeights
(
d–
);

279 
	mf_k
, 
	mf_phi
, 
	mf_th‘a
;

280 
FlßtA¼
* 
	mpv_•s
;

281 
FlßtA¼
* 
	mpv_d–_b¬
;

	@player_agents/search_agent.cpp

16 
	~"£¬ch_ag’t.h
"

17 
	~"S”Ÿliz”.hxx
"

18 
	~"De£rŸliz”.hxx
"

19 
	~"Sy¡em.hxx
"

20 
	~<s¡»am
>

21 
	~"¿ndom_toŞs.h
"

22 
	~"game_cÚŒŞËr.h
"

23 
	~"Œ“_node.h
"

24 
	~"fuÎ_£¬ch_Œ“.h
"

25 
	~"uù_£¬ch_Œ“.h
"

27 
	gS—rchAg’t
::
	$S—rchAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
) :

28 
	`PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
),

29 
	`p_£¬ch_Œ“
(
NULL
),

30 
	`¡r_cu¼_¡©e
(""),

31 
	$i_Ãxt_aù_äame
(0) {

32 
i_sim_¡•s_³r_node
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("sim_¡•s_³r_node", 
Œue
);

33 
¡r_£¬ch_m‘hod
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘SŒšg
("£¬ch_m‘hod", 
Œue
);

34 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

35 
i_sü“n_width
 = 
medŸ¤c
.
	`width
();

36 
i_sü“n_height
 = 
medŸ¤c
.
	`height
();

37 
s_ÿ¹ridge_md5
 = 
p_osy¡em
->
	`cÚsŞe
().
	`´İ”t›s
().
	`g‘
(
C¬Œidge_MD5
);

38 
	`š™_simuÏtiÚ_’gše
();

39 
e_cu¼_aùiÚ
 = 
UNDEFINED
;

40 ià(
p_game_£‰šgs
->
i_sk_äames_num
 != 0) {

41 
p_game_£‰šgs
->
i_sk_äames_num
 = 0;

42 
cout
 << "Forcing i_skip_frames_numo 0, since "

43 << "Skpšg f¿me š‹rã» w™h simuÏtšghgame" << 
’dl
;

46 ià(
¡r_£¬ch_m‘hod
 == "fulltree") {

47 
p_£¬ch_Œ“
 = 
Ãw
 
	`FuÎS—rchT»e
(
this
);

48 } ià(
¡r_£¬ch_m‘hod
 == "uct") {

49 
p_£¬ch_Œ“
 = 
Ãw
 
	`UCTS—rchT»e
(
this
);

51 
û¼
 << "UnknowÀ£¬ch M‘hod: " << 
¡r_£¬ch_m‘hod
 << 
’dl
;

52 
	`ex™
(-1);

54 
	}
}

56 
	gS—rchAg’t
::~
	$S—rchAg’t
() {

57 
d–‘e
 
p_£¬ch_Œ“
;

58 
d–‘e
 
pm_sim_sü_m©rix
;

59 
d–‘e
 
pv_sim_¿m_cÚ‹Á
;

60 
	}
}

66 
	gS—rchAg’t
::
	$š™_simuÏtiÚ_’gše
() {

67 
p_sim_ev’t_obj
 = 
p_osy¡em
->
	`ev’t
();

68 
p_sim_cÚsŞe
 = &(
p_osy¡em
->
	`cÚsŞe
());

69 
p_sim_sy¡em
 = &(
p_sim_cÚsŞe
->
	`sy¡em
());

72 ià(
p_game_£‰šgs
->
b_u£s_sü“n_m©rix
) {

73 
pm_sim_sü_m©rix
 = 
Ãw
 
IÁM©rix
;

74 
	`as£¹
(
i_sü“n_height
 > 0);

75 
	`as£¹
(
i_sü“n_width
 > 0);

76 
i
 = 0; i < 
i_sü“n_height
; i++) {

77 
IÁVeù
 
row
;

78 
j
 = 0; j < 
i_sü“n_width
; j++) {

79 
row
.
	`push_back
(-1);

81 
pm_sim_sü_m©rix
->
	`push_back
(
row
);

84 
pm_sim_sü_m©rix
 = 
NULL
;

86 
pv_sim_¿m_cÚ‹Á
 = 
Ãw
 
	`IÁVeù
(
RAM_LENGTH
);

87 
	}
}

92 
AùiÚ
 
	gS—rchAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

93 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

94 
äame_numb”
) {

95 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

96 
äame_numb”
);

97 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

98  
¥ecŸl_aùiÚ
;

101 
i_cu¼_num_sim_¡•s
 = 0;

102 ià(
i_äame_couÁ”
 >ğ
i_Ãxt_aù_äame
) {

104 
i_Ãxt_aù_äame
 = 
i_äame_couÁ”
 + 
i_sim_¡•s_³r_node
;

105 
¡r_cu¼_¡©e
 = 
	`§ve_¡©e
();

106 ià(
¡r_£¬ch_m‘hod
 == "fulltree") {

107 
p_£¬ch_Œ“
->
	`ş—r
();

110 
cout
 << "F¿me: " << 
i_äame_couÁ”
 << ", ";

111 ià(
p_£¬ch_Œ“
->
is_but
) {

113 
p_£¬ch_Œ“
->
	`move_to_be¡_sub_b¿nch
();

114 
	`as£¹
 (
p_£¬ch_Œ“
->
	`g‘_roÙ_äame_numb”
(è=ğ
i_äame_couÁ”
);

115 
p_£¬ch_Œ“
->
	`upd©e_Œ“
();

116 
cout
 << "Tree Updated: ";

119 
p_£¬ch_Œ“
->
	`ş—r
();

120 
p_£¬ch_Œ“
->
	`bud
(
¡r_cu¼_¡©e
, 
i_äame_couÁ”
);

121 
cout
 << "Tree Re-Constructed: ";

123 
e_cu¼_aùiÚ
 = 
p_£¬ch_Œ“
->
	`g‘_be¡_aùiÚ
();

124 
cout
 << " RoÙ V®uğ" << 
p_£¬ch_Œ“
->
	`g‘_roÙ_v®ue
();

125 
cout
 << " - Deepest Node Frame: "

126 << 
p_£¬ch_Œ“
->
i_d“³¡_node_äame_num
 << 
’dl
;

127 
	`lßd_¡©e
(
¡r_cu¼_¡©e
);

131 
i_sk_expÜt_Ú_äame
 = 
i_äame_couÁ”
 + 1;

133  
e_cu¼_aùiÚ
;

134 
	}
}

141 
	gS—rchAg’t
::
	$Ú_’d_of_game
() {

142 
PÏy”Ag’t
::
	`Ú_’d_of_game
();

144 
p_£¬ch_Œ“
->
	`ş—r
();

145 
	}
}

155 
	gS—rchAg’t
::
	$simuÏ‹_game
(
AùiÚ
 
aù
, 
num_¡•s
, 
¡¬t_äame_num
,

156 & 
»w¬d
, 
boŞ
& 
game_’ded
) {

157 
»w¬d
 = 0.0;

158 
game_’ded
 = 
çl£
;

159 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

160 
i
 = 0; i < 
num_¡•s
; i++) {

161 
i_cu¼_num_sim_¡•s
++;

162 ià(
aù
 =ğ
RANDOM
 &&

163 
i
 % 
i_sim_¡•s_³r_node
 == 0) {

164 
aù
 = 
	`choiû
(
p_game_£‰šgs
->
pv_possibË_aùiÚs
);

166 
GameCÚŒŞËr
::
	`­¶y_aùiÚ
Ğ
p_sim_ev’t_obj
, 
aù
, 
PLAYER_B_NOOP
);

167 
p_osy¡em
->
myTimšgInfo
.
¡¬t
 =…_osy¡em->
	`g‘Ticks
();

168 
medŸ¤c
.
	`upd©e
();

169 ià(
p_game_£‰šgs
->
b_u£s_sü“n_m©rix
) {

170 
	`cİy_simuÏ‹d_äamebufãr
();

172 
	`cİy_simuÏ‹d_¿m_cÚ‹Á
();

173 
cu¼_»w¬d
 = 
p_game_£‰šgs
->
	`g‘_»w¬d
(
pm_sim_sü_m©rix
,

174 
pv_sim_¿m_cÚ‹Á
);

175 ià(
cu¼_»w¬d
 > 0) {

176 
cu¼_»w¬d
 = 1.0;

177 } ià(
cu¼_»w¬d
 < 0) {

178 
cu¼_»w¬d
 = -1.0;

180 
cu¼_»w¬d
 = 0.0;

182 
»w¬d
 +ğ
cu¼_»w¬d
;

183 
game_’ded
 = 
p_game_£‰šgs
->
	`is_’d_of_game
(
pm_sim_sü_m©rix
,

184 
pv_sim_¿m_cÚ‹Á
,

185 
¡¬t_äame_num
 + 
i
);

186 ià(
game_’ded
) {

190 
	}
}

196 
¡ršg
 
	gS—rchAg’t
::
	$§ve_¡©e
() const {

197 
S”Ÿliz”
 
£r
;

198 
p_osy¡em
->
	`cÚsŞe
().
	`sy¡em
().
	`§veS‹
(
s_ÿ¹ridge_md5
, 
£r
);

199 
p_game_£‰šgs
->
	`§ve_¡©e
(
£r
);

200  
£r
.
	`g‘_¡r
();

201 
	}
}

206 
	gS—rchAg’t
::
	$lßd_¡©e
(cÚ¡ 
¡ršg
 
¡©e_¡r
) {

207 
De£rŸliz”
 
	`de£r
(
¡©e_¡r
);

208 
p_osy¡em
->
	`cÚsŞe
().
	`sy¡em
().
	`lßdS‹
(
s_ÿ¹ridge_md5
, 
de£r
);

209 
p_game_£‰šgs
->
	`lßd_¡©e
(
de£r
);

210 
	}
}

216 
	gS—rchAg’t
::
	$cİy_simuÏ‹d_äamebufãr
() {

217 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

218 
uIÁ8
* 
pi_cu¼_äame_bufãr
 = 
medŸ¤c
.
	`cu¼’tF¿meBufãr
();

220 
šd_i
, 
šd_j
;

221 
i
 = 0; i < 
i_sü“n_width
 * 
i_sü“n_height
; i++) {

222 
uIÁ8
 
v
 = 
pi_cu¼_äame_bufãr
[
i
];

223 
šd_i
 = 
i
 / 
i_sü“n_width
;

224 
šd_j
 = 
i
 - (
šd_i
 * 
i_sü“n_width
);

225 (*
pm_sim_sü_m©rix
)[
šd_i
][
šd_j
] = 
v
;

227 
	}
}

232 
	gS—rchAg’t
::
	$cİy_simuÏ‹d_¿m_cÚ‹Á
() {

233 
i
 = 0; i< 
RAM_LENGTH
; i++) {

234 (*
pv_sim_¿m_cÚ‹Á
)[
i
] = 
	`»ad_simuÏ‹d_¿m
(i);

236 
	}
}

242 
	gS—rchAg’t
::
	$»ad_simuÏ‹d_¿m
(
off£t
) {

243 
off£t
 &= 0x7f;

244  
p_sim_sy¡em
->
	`³ek
(
off£t
 + 0x80);

245 
	}
}

252 
AùiÚ
 
	gS—rchAg’t
::
	$tmp_´•¬e_demo_vid
() {

253 ià(
i_äame_couÁ”
 < 1250) {

254  
PLAYER_A_NOOP
;

256 ià(
i_äame_couÁ”
 < 1300) {

257  
PLAYER_A_DOWN
;

259 
¡r_cu¼_¡©e
 = 
	`§ve_¡©e
();

261 ià(
pm_sim_sü_m©rix
 =ğ
NULL
) {

262 
pm_sim_sü_m©rix
 = 
Ãw
 
IÁM©rix
;

263 
	`as£¹
(
i_sü“n_height
 > 0);

264 
	`as£¹
(
i_sü“n_width
 > 0);

265 
i
 = 0; i < 
i_sü“n_height
; i++) {

266 
IÁVeù
 
row
;

267 
j
 = 0; j < 
i_sü“n_width
; j++) {

268 
row
.
	`push_back
(-1);

270 
pm_sim_sü_m©rix
->
	`push_back
(
row
);

273 
bufãr
 [50];

274 
o¡ršg¡»am
 
f’ame
;

275 
MedŸSourû
& 
medŸ¤c
 = 
p_osy¡em
->
	`cÚsŞe
().
	`medŸSourû
();

276 
a
 = 0;‡ < 
i_num_aùiÚs
;‡++) {

277 
	`lßd_¡©e
(
¡r_cu¼_¡©e
);

278 
GameCÚŒŞËr
::
	`­¶y_aùiÚ
(
p_sim_ev’t_obj
, 
PLAYER_A_NOOP
, 
PLAYER_B_NOOP
);

279 
p_osy¡em
->
myTimšgInfo
.
¡¬t
 =…_osy¡em->
	`g‘Ticks
();

280 
medŸ¤c
.
	`upd©e
();

281 
AùiÚ
 
cu¼_aù
 = (*
p_game_£‰šgs
->
pv_possibË_aùiÚs
)[
a
];

282 
f’ame
.
	`¡r
("");

283 
f’ame
 << "aùiÚ_" << 
	`aùiÚ_to_¡ršg
(
cu¼_aù
) << "_00.png";

284 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
pm_sim_sü_m©rix
, 
f’ame
.
	`¡r
());

285 
i
 = 0; i < 15; i++) {

286 
GameCÚŒŞËr
::
	`­¶y_aùiÚ
(
p_sim_ev’t_obj
, 
cu¼_aù
, 
PLAYER_B_NOOP
);

287 
p_osy¡em
->
myTimšgInfo
.
¡¬t
 =…_osy¡em->
	`g‘Ticks
();

288 
medŸ¤c
.
	`upd©e
();

289 
	`cİy_simuÏ‹d_äamebufãr
();

290 
	`¥rštf
 (
bufãr
, "%02d", 
i
 + 1);

291 
f’ame
.
	`¡r
("");

292 
f’ame
 << "aùiÚ_" << 
	`aùiÚ_to_¡ršg
(
cu¼_aù
) << "_"

293 << 
bufãr
 << ".png";

294 
p_osy¡em
->
p_expÜt_sü“n
->
	`§ve_²g
(
pm_sim_sü_m©rix
, 
f’ame
.
	`¡r
());

297 
	`’d_game
();

298  
UNDEFINED
;

300 
	}
}

	@player_agents/search_agent.h

17 #iâdeà
SEARCH_AGENT_H


18 
	#SEARCH_AGENT_H


	)

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"¶ay”_ag’t.h
"

22 
	~"OSy¡em.hxx
"

23 
	~"S‘tšgsUNIX.hxx
"

24 
	~"OSy¡emUNIX.hxx
"

25 
	~"£¬ch_Œ“.h
"

27 şas 
	cS—rchAg’t
 : 
public
 
PÏy”Ag’t
 {

28 
ä›nd
 
şass
 
S—rchT»e
;

29 
ä›nd
 
şass
 
	mFuÎS—rchT»e
;

30 
ä›nd
 
şass
 
	mUCTS—rchT»e
;

31 
ä›nd
 
şass
 
	mT»eNode
;

32 
	mpublic
:

33 
S—rchAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

34 
	mvœtu®
 ~
S—rchAg’t
();

39 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

40 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

41 
äame_numb”
);

45 
vœtu®
 
Ú_’d_of_game
();

50 
	$g‘_num_simuÏ‹d_¡•s
(ècÚ¡ { 
i_cu¼_num_sim_¡•s
;}

53 
´Ùeùed
:

59 
	`š™_simuÏtiÚ_’gše
();

66 
	`simuÏ‹_game
(
AùiÚ
 
aù
, 
num_¡•s
, 
¡¬t_äame_num
,

67 & 
»w¬d
, 
boŞ
& 
game_’ded
);

72 
¡ršg
 
	$§ve_¡©e
() const;

77 
	`lßd_¡©e
(cÚ¡ 
¡ršg
 
¡©e_¡r
);

82 
	`cİy_simuÏ‹d_äamebufãr
();

87 
	`cİy_simuÏ‹d_¿m_cÚ‹Á
();

92 
	`»ad_simuÏ‹d_¿m
(
off£t
);

98 
AùiÚ
 
	`tmp_´•¬e_demo_vid
();

102 
¡ršg
 
¡r_£¬ch_m‘hod
;

103 
AùiÚ
 
e_cu¼_aùiÚ
;

104 
S—rchT»e
* 
p_£¬ch_Œ“
;

106 
CÚsŞe
* 
p_sim_cÚsŞe
;

107 
Sy¡em
* 
p_sim_sy¡em
;

108 
S‘tšgsUNIX
* 
p_sim_£‰šgs
;

109 
Ev’t
* 
p_sim_ev’t_obj
;

110 
IÁM©rix
* 
pm_sim_sü_m©rix
;

111 
IÁVeù
* 
pv_sim_¿m_cÚ‹Á
;

112 
¡ršg
 
s_ÿ¹ridge_md5
;

113 
¡ršg
 
¡r_cu¼_¡©e
;

114 
i_sim_¡•s_³r_node
;

116 
i_Ãxt_aù_äame
;

118 
i_cu¼_num_sim_¡•s
;

120 
i_sü“n_height
;

121 
i_sü“n_width
;

122 
	}
};

	@player_agents/search_tree.cpp

16 
	~"£¬ch_Œ“.h
"

17 
	~"¿ndom_toŞs.h
"

18 
	~"£¬ch_ag’t.h
"

26 
	gS—rchT»e
::
	$S—rchT»e
Ğ
S—rchAg’t
* 
£¬ch_ag’t
):

27 
	`is_but
(
çl£
),

28 
	`p_roÙ
(
NULL
),

29 
	$p_£¬ch_ag’t
(
£¬ch_ag’t
) {

30 
S‘tšgs
& 
£‰šgs
 = 
p_£¬ch_ag’t
->
p_osy¡em
->
	`£‰šgs
();

31 
i_sim_¡•s_³r_node
 = 
£‰šgs
.
	`g‘IÁ
("sim_¡•s_³r_node", 
Œue
);

32 
max_sim_¡•s_³r_äame
 = 
£‰šgs
.
	`g‘IÁ
("max_sim_¡•s_³r_äame",
Œue
);

33 
i_max_sim_¡•s_³r_Œ“
 = 
max_sim_¡•s_³r_äame
 * 
i_sim_¡•s_³r_node
;

34 
f_discouÁ_çùÜ
 = 
£‰šgs
.
	`g‘Flßt
("discouÁ_çùÜ", 
Œue
);

35 
i_d“³¡_node_äame_num
 = 0;

36 
	}
}

43 
	gS—rchT»e
::
	$ş—r
() {

44 ià(
p_roÙ
 !ğ
NULL
) {

45 
	`d–‘e_b¿nch
(
p_roÙ
);

46 
p_roÙ
 = 
NULL
;

48 
is_but
 = 
çl£
;

49 
i_d“³¡_node_äame_num
 = 0;

50 
	}
}

55 
	gS—rchT»e
::~
	$S—rchT»e
() {

56 
	`ş—r
();

57 
	}
}

62 
AùiÚ
 
	gS—rchT»e
::
	$g‘_be¡_aùiÚ
() {

63 
	`as£¹
 (
p_roÙ
 !ğ
NULL
);

64 
be¡_b¿nch
 = 
p_roÙ
->
i_be¡_b¿nch
;

65 
T»eNode
* 
be¡_chd
 = 
p_roÙ
->
v_chd»n
[
be¡_b¿nch
];

66 
	`as£¹
(
be¡_b¿nch
 != -1);

67 
veùÜ
<> 
be¡_b¿nches
;

68 
be¡_b¿nches
.
	`push_back
(
be¡_b¿nch
);

69 
c
 = 0; c < 
p_roÙ
->
v_chd»n
.
	`size
(); c++) {

70 
T»eNode
* 
cu¼_chd
 = 
p_roÙ
->
v_chd»n
[
c
];

71 ià(
c
 !ğ
be¡_b¿nch
 &&

72 
cu¼_chd
->
f_b¿nch_»w¬d
 =ğ
be¡_chd
->f_branch_reward &&

73 
cu¼_chd
->
b_is_d—d
 =ğ
be¡_chd
->b_is_dead) {

74 
be¡_b¿nches
.
	`push_back
(
c
);

77 ià(
be¡_b¿nches
.
	`size
() > 1) {

79 
cout
 << "randomly choosing‡ branch‡mong "

80 << 
be¡_b¿nches
.
	`size
() << " branches: "

81 << "was: " << 
be¡_b¿nch
 << " - ";

82 
be¡_b¿nch
 = 
	`choiû
(&
be¡_b¿nches
);

83 
cout
 << "i now: " << 
be¡_b¿nch
 << 
’dl
;

86 
AùiÚ
 
be¡_aù
 = (*
p_£¬ch_ag’t
->
p_game_£‰šgs
->

87 
pv_possibË_aùiÚs
)[
be¡_b¿nch
];

88  
be¡_aù
;

89 
	}
}

95 
	gS—rchT»e
::
	$move_to_be¡_sub_b¿nch
() {

96 
	`as£¹
(
p_roÙ
->
v_chd»n
.
	`size
() > 0);

97 
	`as£¹
(
p_roÙ
->
i_be¡_b¿nch
 != -1);

98 
d–
 = 0; d– < 
p_roÙ
->
v_chd»n
.
	`size
(); del++) {

99 ià(
d–
 !ğ
p_roÙ
->
i_be¡_b¿nch
) {

100 
	`d–‘e_b¿nch
(
p_roÙ
->
v_chd»n
[
d–
]);

103 
T»eNode
* 
Şd_roÙ
 = 
p_roÙ
;

104 
p_roÙ
 =…_roÙ->
v_chd»n
[p_roÙ->
i_be¡_b¿nch
];

106 
Şd_roÙ
->
v_chd»n
[Şd_roÙ->
i_be¡_b¿nch
] = 
NULL
;

107 
d–‘e
 
Şd_roÙ
;

108 
p_roÙ
->
p_·»Á
 = 
NULL
;

109 
	}
}

115 
	gS—rchT»e
::
	$d–‘e_b¿nch
(
T»eNode
* 
node
) {

116 ià(!
node
->
v_chd»n
.
	`em±y
()) {

117 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

118 
	`d–‘e_b¿nch
(
node
->
v_chd»n
[
c
]);

121 
d–‘e
 
node
;

122 
	}
}

129 
	gS—rchT»e
::
	$´št
(
T»eNode
* 
node
) const {

130 ià(
node
 =ğ
NULL
) {

131 
node
 = 
p_roÙ
;

133 
queue
<
T»eNode
*> 
q
;

134 
q
.
	`push
(
node
);

135 
cu¼_Ëv–
 = 0;

136 !
q
.
	`em±y
()) {

137 
T»eNode
* 
node
 = 
q
.
	`äÚt
();

138 
q
.
	`pİ
();

139 ià(
node
->
i_äame_num
 > 
cu¼_Ëv–
) {

140 
cu¼_Ëv–
 = 
node
->
i_äame_num
;

141 
cout
 << 
’dl
 << 
cu¼_Ëv–
 << ": ";

143 
cout
 << "(" << 
node
->
b_is_d—d
 << ", " <<‚ode->
f_b¿nch_»w¬d
 << "),";

144 
c
 = 1; c < 
node
->
v_chd»n
.
	`size
(); c++) {

145 
q
.
	`push
(
node
->
v_chd»n
[
c
]);

148 
cout
 << 
’dl
;

149 
	}
}

	@player_agents/search_tree.h

16 #iâdeà
SEARCH_TREE_H


17 
	#SEARCH_TREE_H


	)

19 
	~<queue
>

20 
	~"commÚ_cÚ¡ªts.h
"

21 
	~"Œ“_node.h
"

23 
şass
 
	gS—rchAg’t
;

26 şas 
	cS—rchT»e
 {

31 
	mpublic
:

37 
S—rchT»e
(
S—rchAg’t
* 
£¬ch_ag’t
);

42 
	mvœtu®
 ~
S—rchT»e
();

47 
vœtu®
 
bud
ĞcÚ¡ 
¡ršg
 
¡¬t_¡©e
, 
¡¬t_äame_num
) = 0;

52 
vœtu®
 
upd©e_Œ“
() = 0;

57 
vœtu®
 
ş—r
();

62 
vœtu®
 
AùiÚ
 
g‘_be¡_aùiÚ
();

67 
vœtu®
 
move_to_be¡_sub_b¿nch
();

73 
	$g‘_roÙ_äame_numb”
() {

74  
p_roÙ
->
i_äame_num
;

80 
	$g‘_roÙ_v®ue
() {

81  
p_roÙ
->
v_chd»n
[p_roÙ->
i_be¡_b¿nch
]->
f_b¿nch_»w¬d
;

82 
	}
}

88 
vœtu®
 
	$´št
(
T»eNode
* 
node
 = 
NULL
) const;

91 
boŞ
 
is_but
;

92 
i_d“³¡_node_äame_num
;

94 
´Ùeùed
:

100 
	`d–‘e_b¿nch
(
T»eNode
* 
node
);

103 
T»eNode
* 
p_roÙ
;

104 
i_sim_¡•s_³r_node
;

106 
i_max_sim_¡•s_³r_Œ“
;

108 
f_discouÁ_çùÜ
;

110 
S—rchAg’t
* 
p_£¬ch_ag’t
;

112 
	}
};

	@player_agents/shape_tools.cpp

14 
	~"sh­e_toŞs.h
"

15 
	~"veùÜ_m©rix_toŞs.h
"

20 
	$æ_sh­e
(cÚ¡ 
IÁM©rix
* 
Üig_m©rix
, IÁM©rix* 
Ãw_m©rix
,

21 
boŞ
 
do_hÜiz’l
, boŞ 
do_v”tiÿl
) {

22 
Ãw_m©rix
->
	`ş—r
();

23 
m
 = 
Üig_m©rix
->
	`size
();

24 
n
 = (*
Üig_m©rix
)[0].
	`size
();

25 
row_¡¬t
, 
row_’d
, 
row_upd©e
;

26 
cŞ_¡¬t
, 
cŞ_’d
, 
cŞ_upd©e
;

27 ià(
do_hÜiz’l
) {

28 
cŞ_¡¬t
 = 
n
 - 1;

29 
cŞ_’d
 = 0;

30 
cŞ_upd©e
 = -1;

32 
cŞ_¡¬t
 = 0;

33 
cŞ_’d
 = 
n
 - 1;

34 
cŞ_upd©e
 = 1;

36 ià(
do_v”tiÿl
) {

37 
row_¡¬t
 = 
m
 - 1;

38 
row_’d
 = 0;

39 
row_upd©e
 = -1;

41 
row_¡¬t
 = 0;

42 
row_’d
 = 
m
 - 1;

43 
row_upd©e
 = 1;

45 
i
 = 
row_¡¬t
;

46 
Œue
) {

47 
IÁVeù
 
row
;

48 
j
 = 
cŞ_¡¬t
;

49 
Œue
) {

50 
row
.
	`push_back
((*
Üig_m©rix
)[
i
][
j
]);

51 ià(
j
 =ğ
cŞ_’d
) {

54 
j
 = j + 
cŞ_upd©e
;

56 
Ãw_m©rix
->
	`push_back
(
row
);

57 ià(
i
 =ğ
row_’d
) {

60 
i
 = i + 
row_upd©e
;

62 
	}
}

69 
boŞ
 
	$ÿlc_sh­e_di¡ªû
ĞcÚ¡ 
IÁM©rix
* 
pm_sh­e_a
, cÚ¡ IÁM©rix* 
pm_sh­e_b
,

70 
boŞ
 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

71 & 
pix–_di¡ªû
, & 
³rc_di¡ªû
) {

72 
a_height
 = 
pm_sh­e_a
->
	`size
();

73 
a_width
 = (*
pm_sh­e_a
)[0].
	`size
();

74 
b_height
 = 
pm_sh­e_b
->
	`size
();

75 
b_width
 = (*
pm_sh­e_b
)[0].
	`size
();

77 
a_¬—
 = 
a_width
 * 
a_height
;

78 
b_¬—
 = 
b_width
 * 
b_height
;

79 ià(
a_width
 =ğ
b_width
 &&

80 
a_height
 =ğ
b_height
) {

82 
pix–_di¡ªû
 = 
	`g‘_l2_di¡ªû
(
pm_sh­e_a
, 
pm_sh­e_b
);

85 ià(!
®low_difã»Á_size
) {

86 
pix–_di¡ªû
 = -1;

87 
³rc_di¡ªû
 = -1.0;

88  
çl£
;

94 iàĞĞ()
a_¬—
 > (
max_sh­e_¬—_dif
 * 
b_¬—
) ) ||

95 Ğ()
b_¬—
 > (
max_sh­e_¬—_dif
 * 
a_¬—
) ) ) {

97 
pix–_di¡ªû
 = -1;

98 
³rc_di¡ªû
 = -1.0;

99  
çl£
;

102 cÚ¡ 
IÁM©rix
 *
bigg”_sh­e
, *
sm®Ër_sh­e
;

103 
width_dif
, 
height_dif
, 
sm®Ër_height
, 
sm®Ër_width
;

104 ià(
a_width
 <ğ
b_width
 &&

105 
a_height
 <ğ
b_height
) {

106 
bigg”_sh­e
 = 
pm_sh­e_b
;

107 
sm®Ër_sh­e
 = 
pm_sh­e_a
;

108 
sm®Ër_height
 = 
a_height
;

109 
sm®Ër_width
 = 
a_width
;

110 
width_dif
 = 
b_width
 - 
a_width
;

111 
height_dif
 = 
b_height
 - 
a_height
;

112 } iàĞ
a_width
 >ğ
b_width
 &&

113 
a_height
 >ğ
b_height
) {

114 
bigg”_sh­e
 = 
pm_sh­e_a
;

115 
sm®Ër_sh­e
 = 
pm_sh­e_b
;

116 
sm®Ër_height
 = 
b_height
;

117 
sm®Ër_width
 = 
b_width
;

118 
width_dif
 = 
a_width
 - 
b_width
;

119 
height_dif
 = 
a_height
 - 
b_height
;

122 
pix–_di¡ªû
 = -1;

123 
³rc_di¡ªû
 = -1.0;

124  
çl£
;

127 
	`as£¹
 (
width_dif
 >ğ0 && 
height_dif
 >= 0);

133 
sm®Ë¡_di¡ªû
 = -1;

134 
i
 = 0; i <ğ
height_dif
; i++) {

135 
j
 = 0; j <ğ
width_dif
; j++) {

136 
l2_di¡
 = 0;

137 
y
 = 0; y < 
sm®Ër_height
; y++) {

138 
x
 = 0; x < 
sm®Ër_width
; x++) {

139 
dif
 = (*
bigg”_sh­e
)[
i
+
y
][
j
+
x
] -

140 (*
sm®Ër_sh­e
)[
y
][
x
];

141 
l2_di¡
 +ğ
dif
 * dif;

144 ià(
sm®Ë¡_di¡ªû
 =ğ-1 || 
l2_di¡
 < smallest_distance) {

145 
sm®Ë¡_di¡ªû
 = 
l2_di¡
;

149 
pix–_di¡ªû
 = 
sm®Ë¡_di¡ªû
;

151 
num_pix–s
 = 
a_¬—
 + 
b_¬—
;

152 
³rc_di¡ªû
 = (
pix–_di¡ªû
è/ (
num_pix–s
);

153  
Œue
;

154 
	}
}

	@player_agents/shape_tools.h

14 #iâdeà
SHAPE_TOOLS_H


15 
	#SHAPE_TOOLS_H


	)

17 
	~"commÚ_cÚ¡ªts.h
"

22 
æ_sh­e
(cÚ¡ 
IÁM©rix
* 
Üig_m©rix
, IÁM©rix* 
Ãw_m©rix
,

23 
boŞ
 
do_hÜiz’l
, boŞ 
do_v”tiÿl
);

31 
boŞ
 
ÿlc_sh­e_di¡ªû
ĞcÚ¡ 
IÁM©rix
* 
pm_sh­e_a
, cÚ¡ IÁM©rix* 
pm_sh­e_b
,

32 
boŞ
 
®low_difã»Á_size
, 
max_sh­e_¬—_dif
,

33 & 
pix–_di¡ªû
, & 
³rc_di¡ªû
);

	@player_agents/single_action_agent.cpp

16 
	~"sšgË_aùiÚ_ag’t.h
"

19 
	gSšgËAùiÚAg’t
::
	$SšgËAùiÚAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
,

20 
OSy¡em
* 
_osy¡em
) :

21 
	$PÏy”Ag’t
(
_game_£‰šgs
, 
_osy¡em
) {

22 
aùiÚ_šdex
 = 
p_osy¡em
->
	`£‰šgs
().
	`g‘IÁ
("sšgË_aùiÚ_šdex", 
Œue
);

23 ià(
aùiÚ_šdex
 < 0 ||‡ùiÚ_šdex >ğ
pv_possibË_aùiÚs
->
	`size
()) {

24 
cout
<<"Inv®id v®ufÜ sšgË_aùiÚ_šdex: " << 
aùiÚ_šdex
 << 
’dl
;

25 
û¼
<<"Inv®id v®ufÜ sšgË_aùiÚ_šdex: " << 
aùiÚ_šdex
 << 
’dl
;

26 
	`ex™
(-1);

28 
e_aùiÚ
 = (*
p_game_£‰šgs
->
pv_possibË_aùiÚs
)[
aùiÚ_šdex
];

29 
cout
 << "OÆy‡µlyšg‡ùiÚ: " << 
	`aùiÚ_to_¡ršg
(
e_aùiÚ
è<< 
’dl
;

30 
	}
}

35 
AùiÚ
 
	gSšgËAùiÚAg’t
::
	$ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

36 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

37 
äame_numb”
) {

38 
AùiÚ
 
¥ecŸl_aùiÚ
 = 
PÏy”Ag’t
::
	`ag’t_¡•
(
sü“n_m©rix
, 
cÚsŞe_¿m
,

39 
äame_numb”
);

40 ià(
¥ecŸl_aùiÚ
 !ğ
UNDEFINED
) {

41  
¥ecŸl_aùiÚ
;

43  
e_aùiÚ
;

44 
	}
}

	@player_agents/single_action_agent.h

16 #iâdeà
SINGLE_ACTION_AGENT_H


17 
	#SINGLE_ACTION_AGENT_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
	~"¶ay”_ag’t.h
"

22 şas 
	cSšgËAùiÚAg’t
 : 
public
 
PÏy”Ag’t
 {

24 
public
:

25 
SšgËAùiÚAg’t
(
GameS‘tšgs
* 
_game_£‰šgs
, 
OSy¡em
* 
_osy¡em
);

30 
vœtu®
 
AùiÚ
 
ag’t_¡•
ĞcÚ¡ 
IÁM©rix
* 
sü“n_m©rix
,

31 cÚ¡ 
IÁVeù
* 
cÚsŞe_¿m
,

32 
äame_numb”
);

34 
AùiÚ
 
	me_aùiÚ
;

	@player_agents/tiles2.cpp

24 
	~<io¡»am
>

25 
	~"tes2.h
"

26 
	~"¡dlib.h
"

27 
	~"m©h.h
"

29 
	$mod
(
n
, 
k
è{ (À>ğ0è?‚%k : k-1-((-n-1)%k);
	}
}

31 
	$G‘Tes
(

32 
tes
[],

33 
num_tšgs
,

34 
memÜy_size
,

35 
æßts
[],

36 
num_æßts
,

37 
šts
[],

38 
num_šts
)

40 
i
,
j
;

41 
q¡©e
[
MAX_NUM_VARS
];

42 
ba£
[
MAX_NUM_VARS
];

43 
coÜdš©es
[
MAX_NUM_VARS
 * 2 + 1];

44 
num_coÜdš©es
 = 
num_æßts
 + 
num_šts
 + 1;

46 
i
=0; i<
num_šts
; i++)

47 
coÜdš©es
[
num_æßts
+1+
i
] = 
šts
[i];

50 
i
 = 0; i < 
num_æßts
; i++)

52 
q¡©e
[
i
] = (è
	`æoÜ
(
æßts
[i] * 
num_tšgs
);

53 
ba£
[
i
] = 0;

57 
j
 = 0; j < 
num_tšgs
; j++)

61 
i
 = 0; i < 
num_æßts
; i++)

65 
coÜdš©es
[
i
] = 
q¡©e
[i] - 
	`mod
(q¡©e[i]-
ba£
[i],
num_tšgs
);

68 
ba£
[
i
] += (1 + (2 * i));

71 
coÜdš©es
[
i
] = 
j
;

73 
tes
[
j
] = 
	`hash_UNH
(
coÜdš©es
, 
num_coÜdš©es
, 
memÜy_size
, 449);

76 
	}
}

79 
	$G‘Tes
(

80 
IÁA¼
* 
pv_tes
,

81 
num_tšgs
,

82 
memÜy_size
,

83 
æßts
[],

84 
num_æßts
,

85 
šts
[],

86 
num_šts
,

87 
off£t
)

89 
i
,
j
;

90 
q¡©e
[
MAX_NUM_VARS
];

91 
ba£
[
MAX_NUM_VARS
];

92 
coÜdš©es
[
MAX_NUM_VARS
 * 2 + 1];

93 
num_coÜdš©es
 = 
num_æßts
 + 
num_šts
 + 1;

95 
i
=0; i<
num_šts
; i++)

96 
coÜdš©es
[
num_æßts
+1+
i
] = 
šts
[i];

99 
i
 = 0; i < 
num_æßts
; i++)

101 
q¡©e
[
i
] = (è
	`æoÜ
(
æßts
[i] * 
num_tšgs
);

102 
ba£
[
i
] = 0;

106 
j
 = 0; j < 
num_tšgs
; j++)

110 
i
 = 0; i < 
num_æßts
; i++)

114 
coÜdš©es
[
i
] = 
q¡©e
[i] - 
	`mod
(q¡©e[i]-
ba£
[i],
num_tšgs
);

117 
ba£
[
i
] += (1 + (2 * i));

120 
coÜdš©es
[
i
] = 
j
;

122 (*
pv_tes
)[
j
] = 
	`hash_UNH
(
coÜdš©es
, 
num_coÜdš©es
, 
memÜy_size
, 449);

123 (*
pv_tes
)[
j
] +ğ()
off£t
;

126 
	}
}

129 
	$G‘Tes
(

130 
tes
[],

131 
num_tšgs
,

132 
cŞlisiÚ_bË
 *
ùabË
,

133 
æßts
[],

134 
num_æßts
,

135 
šts
[],

136 
num_šts
)

138 
i
,
j
;

139 
q¡©e
[
MAX_NUM_VARS
];

140 
ba£
[
MAX_NUM_VARS
];

141 
coÜdš©es
[
MAX_NUM_VARS
 * 2 + 1];

142 
num_coÜdš©es
 = 
num_æßts
 + 
num_šts
 + 1;

144 
i
=0; i<
num_šts
; i++)

145 
coÜdš©es
[
num_æßts
+1+
i
] = 
šts
[i];

148 
i
 = 0; i < 
num_æßts
; i++)

150 
q¡©e
[
i
] = (è
	`æoÜ
(
æßts
[i] * 
num_tšgs
);

151 
ba£
[
i
] = 0;

155 
j
 = 0; j < 
num_tšgs
; j++)

159 
i
 = 0; i < 
num_æßts
; i++)

163 
coÜdš©es
[
i
] = 
q¡©e
[i] - 
	`mod
(q¡©e[i]-
ba£
[i],
num_tšgs
);

166 
ba£
[
i
] += (1 + (2 * i));

169 
coÜdš©es
[
i
] = 
j
;

171 
tes
[
j
] = 
	`hash
(
coÜdš©es
, 
num_coÜdš©es
,
ùabË
);

174 
	}
}

182 
	$hash_UNH
(*
šts
, 
num_šts
, 
m
, 
šüem’t
)

184 
ºd£q
[2048];

185 
fœ¡_ÿÎ
 = 1;

186 
i
,
k
;

187 
šdex
;

188 
sum
 = 0;

191 ià(
fœ¡_ÿÎ
)

193 
k
 = 0; k < 2048; k++)

195 
ºd£q
[
k
] = 0;

196 
i
=0; i < ()(); ++i)

197 
ºd£q
[
k
] = (ºd£q[k] << 8è| (
	`¿nd
() & 0xff);

199 
fœ¡_ÿÎ
 = 0;

202 
i
 = 0; i < 
num_šts
; i++)

205 
šdex
 = 
šts
[
i
];

206 
šdex
 +ğ(
šüem’t
 * 
i
);

207 
šdex
 %= 2048;

208 
šdex
 < 0)

209 
šdex
 += 2048;

212 
sum
 +ğ()
ºd£q
[()
šdex
];

214 
šdex
 = ()(
sum
 % 
m
);

215 
šdex
 < 0)

216 
šdex
 +ğ
m
;

218 (
šdex
);

219 
	}
}

222 
hash
(*
šts
, 
num_šts
, 
cŞlisiÚ_bË
 *
ù
);

227 
	$hash
(*
šts
, 
num_šts
, 
cŞlisiÚ_bË
 *
ù
)

229 
j
;

230 
ccheck
;

232 
ù
->
ÿÎs
++;

233 
j
 = 
	`hash_UNH
(
šts
, 
num_šts
, 
ù
->
m
, 449);

234 
ccheck
 = 
	`hash_UNH
(
šts
, 
num_šts
, 
MaxLONGINT
, 457);

235 ià(
ccheck
 =ğ
ù
->
d©a
[
j
])

236 
ù
->
ş—rh™s
++;

237 ià(
ù
->
d©a
[
j
] == -1)

239 
ù
->
ş—rh™s
++;

240 
ù
->
d©a
[
j
] = 
ccheck
;

242 ià(
ù
->
§ã
 == 0)

243 
ù
->
cŞlisiÚs
++;

246 
h2
 = 1 + 2 * 
	`hash_UNH
(
šts
,
num_šts
,(
MaxLONGINT
)/4,449);

247 
i
 = 0;

248 ++
i
)

250 
ù
->
cŞlisiÚs
++;

251 
j
 = (j+
h2
è% (
ù
->
m
);

253 ià(
i
 > 
ù
->
m
)

255 
	`´štf
("\nOut of Memory");

256 
	`ex™
(0);

258 ià(
ccheck
 =ğ
ù
->
d©a
[
j
])

260 ià(
ù
->
d©a
[
j
] == -1)

262 
ù
->
d©a
[
j
] = 
ccheck
;

267  
j
;

268 
	}
}

270 
	gcŞlisiÚ_bË
::
	$»£t
()

272 
i
=0; i<
m
; i++)

273 
d©a
[
i
] = -1;

274 
ÿÎs
 = 0;

275 
ş—rh™s
 = 0;

276 
cŞlisiÚs
 = 0;

277 
	}
}

279 
	gcŞlisiÚ_bË
::
	$cŞlisiÚ_bË
(
size
, 
§ãty
)

281 
tmp
 = 
size
;

282 
tmp
 > 2)

284 ià(
tmp
 % 2 != 0)

286 
	`´štf
("\nSizoàcŞlisiÚabË mu¡ bpow” oà2 %d",
size
);

287 
	`ex™
(0);

289 
tmp
 /= 2;

291 
d©a
 = 
Ãw
 [
size
];

292 
m
 = 
size
;

293 
§ã
 = 
§ãty
;

294 
	`»£t
();

295 
	}
}

297 
	gcŞlisiÚ_bË
::~
	$cŞlisiÚ_bË
()

299 
d–‘e
[] 
d©a
;

300 
	}
}

302 
	gcŞlisiÚ_bË
::
	$u§ge
()

304 
couÁ
 = 0;

305 
i
=0; i<
m
; i++)

306 ià(
d©a
[
i
] != -1)

307 
couÁ
++;

308  
couÁ
;

309 
	}
}

311 
	gcŞlisiÚ_bË
::
	$§ve
(
fe
)

313 
	`wr™e
(
fe
, (*è&
m
, ());

314 
	`wr™e
(
fe
, (*è&
§ã
, ());

315 
	`wr™e
(
fe
, (*è&
ÿÎs
, ());

316 
	`wr™e
(
fe
, (*è&
ş—rh™s
, ());

317 
	`wr™e
(
fe
, (*è&
cŞlisiÚs
, ());

318 
	`wr™e
(
fe
, (*è
d©a
, 
m
*());

319 
	}
}

321 
	gcŞlisiÚ_bË
::
	$»¡Üe
(
fe
)

323 
	`»ad
(
fe
, (*è&
m
, ());

324 
	`»ad
(
fe
, (*è&
§ã
, ());

325 
	`»ad
(
fe
, (*è&
ÿÎs
, ());

326 
	`»ad
(
fe
, (*è&
ş—rh™s
, ());

327 
	`»ad
(
fe
, (*è&
cŞlisiÚs
, ());

328 
	`»ad
(
fe
, (*è
d©a
, 
m
*());

329 
	}
}

342 
	gi_tmp_¬r
[
MAX_NUM_VARS
];

343 
	gf_tmp_¬r
[
MAX_NUM_VARS
];

346 
	$G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
)

348 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
æßts
,
nf
,
i_tmp_¬r
,0);

349 
	}
}

350 
	$G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
)

352 
	`G‘Tes
(
tes
,
Á
,
ù
,
æßts
,
nf
,
i_tmp_¬r
,0);

353 
	}
}

356 
	$G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
)

358 
i_tmp_¬r
[0]=
h1
;

359 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
æßts
,
nf
,
i_tmp_¬r
,1);

360 
	}
}

362 
	$G‘Tes
(
IÁA¼
* 
pv_tes
,
Á
,
memÜy
,
æßts
[],
nf
,
h1
,

363 
off£t
) {

364 
i_tmp_¬r
[0]=
h1
;

365 
	`G‘Tes
(
pv_tes
,
Á
,
memÜy
,
æßts
,
nf
,
i_tmp_¬r
,1, 
off£t
);

366 
	}
}

368 
	$G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
)

370 
i_tmp_¬r
[0]=
h1
;

371 
	`G‘Tes
(
tes
,
Á
,
ù
,
æßts
,
nf
,
i_tmp_¬r
,1);

372 
	}
}

375 
	$G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
,
h2
)

377 
i_tmp_¬r
[0]=
h1
;

378 
i_tmp_¬r
[1]=
h2
;

379 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
æßts
,
nf
,
i_tmp_¬r
,2);

380 
	}
}

381 
	$G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
,
h2
)

383 
i_tmp_¬r
[0]=
h1
;

384 
i_tmp_¬r
[1]=
h2
;

385 
	`G‘Tes
(
tes
,
Á
,
ù
,
æßts
,
nf
,
i_tmp_¬r
,2);

386 
	}
}

389 
	$G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
,
h2
,
h3
)

391 
i_tmp_¬r
[0]=
h1
;

392 
i_tmp_¬r
[1]=
h2
;

393 
i_tmp_¬r
[2]=
h3
;

394 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
æßts
,
nf
,
i_tmp_¬r
,3);

395 
	}
}

396 
	$G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
,
h2
,
h3
)

398 
i_tmp_¬r
[0]=
h1
;

399 
i_tmp_¬r
[1]=
h2
;

400 
i_tmp_¬r
[2]=
h3
;

401 
	`G‘Tes
(
tes
,
Á
,
ù
,
æßts
,
nf
,
i_tmp_¬r
,3);

402 
	}
}

405 
	$G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
)

407 
f_tmp_¬r
[0]=
f1
;

408 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,1,
i_tmp_¬r
,0);

409 
	}
}

410 
	$G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
)

412 
f_tmp_¬r
[0]=
f1
;

413 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,1,
i_tmp_¬r
,0);

414 
	}
}

417 
	$G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
)

419 
f_tmp_¬r
[0]=
f1
;

420 
i_tmp_¬r
[0]=
h1
;

421 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,1,
i_tmp_¬r
,1);

422 
	}
}

423 
	$G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
)

425 
f_tmp_¬r
[0]=
f1
;

426 
i_tmp_¬r
[0]=
h1
;

427 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,1,
i_tmp_¬r
,1);

428 
	}
}

431 
	$G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
,
h2
)

433 
f_tmp_¬r
[0]=
f1
;

434 
i_tmp_¬r
[0]=
h1
;

435 
i_tmp_¬r
[1]=
h2
;

436 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,1,
i_tmp_¬r
,2);

437 
	}
}

438 
	$G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
,
h2
)

440 
f_tmp_¬r
[0]=
f1
;

441 
i_tmp_¬r
[0]=
h1
;

442 
i_tmp_¬r
[1]=
h2
;

443 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,1,
i_tmp_¬r
,2);

444 
	}
}

447 
	$G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
,
h2
,
h3
)

449 
f_tmp_¬r
[0]=
f1
;

450 
i_tmp_¬r
[0]=
h1
;

451 
i_tmp_¬r
[1]=
h2
;

452 
i_tmp_¬r
[2]=
h3
;

453 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,1,
i_tmp_¬r
,3);

454 
	}
}

455 
	$G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
,
h2
,
h3
)

457 
f_tmp_¬r
[0]=
f1
;

458 
i_tmp_¬r
[0]=
h1
;

459 
i_tmp_¬r
[1]=
h2
;

460 
i_tmp_¬r
[2]=
h3
;

461 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,1,
i_tmp_¬r
,3);

462 
	}
}

465 
	$G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
)

467 
f_tmp_¬r
[0]=
f1
;

468 
f_tmp_¬r
[1]=
f2
;

469 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,2,
i_tmp_¬r
,0);

470 
	}
}

471 
	$G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
)

473 
f_tmp_¬r
[0]=
f1
;

474 
f_tmp_¬r
[1]=
f2
;

475 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,2,
i_tmp_¬r
,0);

476 
	}
}

479 
	$G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
)

481 
f_tmp_¬r
[0]=
f1
;

482 
f_tmp_¬r
[1]=
f2
;

483 
i_tmp_¬r
[0]=
h1
;

484 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,2,
i_tmp_¬r
,1);

485 
	}
}

486 
	$G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
)

488 
f_tmp_¬r
[0]=
f1
;

489 
f_tmp_¬r
[1]=
f2
;

490 
i_tmp_¬r
[0]=
h1
;

491 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,2,
i_tmp_¬r
,1);

492 
	}
}

495 
	$G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
,
h2
)

497 
f_tmp_¬r
[0]=
f1
;

498 
f_tmp_¬r
[1]=
f2
;

499 
i_tmp_¬r
[0]=
h1
;

500 
i_tmp_¬r
[1]=
h2
;

501 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,2,
i_tmp_¬r
,2);

502 
	}
}

503 
	$G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
,
h2
)

505 
f_tmp_¬r
[0]=
f1
;

506 
f_tmp_¬r
[1]=
f2
;

507 
i_tmp_¬r
[0]=
h1
;

508 
i_tmp_¬r
[1]=
h2
;

509 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,2,
i_tmp_¬r
,2);

510 
	}
}

513 
	$G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
,
h2
,
h3
)

515 
f_tmp_¬r
[0]=
f1
;

516 
f_tmp_¬r
[1]=
f2
;

517 
i_tmp_¬r
[0]=
h1
;

518 
i_tmp_¬r
[1]=
h2
;

519 
i_tmp_¬r
[2]=
h3
;

520 
	`G‘Tes
(
tes
,
Á
,
memÜy
,
f_tmp_¬r
,2,
i_tmp_¬r
,3);

521 
	}
}

522 
	$G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
,
h2
,
h3
)

524 
f_tmp_¬r
[0]=
f1
;

525 
f_tmp_¬r
[1]=
f2
;

526 
i_tmp_¬r
[0]=
h1
;

527 
i_tmp_¬r
[1]=
h2
;

528 
i_tmp_¬r
[2]=
h3
;

529 
	`G‘Tes
(
tes
,
Á
,
ù
,
f_tmp_¬r
,2,
i_tmp_¬r
,3);

530 
	}
}

532 
	$G‘TesW¿p
(

533 
tes
[],

534 
num_tšgs
,

535 
memÜy_size
,

536 
æßts
[],

537 
num_æßts
,

538 
w¿p_widths
[],

539 
šts
[],

540 
num_šts
)

542 
i
,
j
;

543 
q¡©e
[
MAX_NUM_VARS
];

544 
ba£
[
MAX_NUM_VARS
];

545 
w¿p_widths_times_num_tšgs
[
MAX_NUM_VARS
];

546 
coÜdš©es
[
MAX_NUM_VARS
 * 2 + 1];

547 
num_coÜdš©es
 = 
num_æßts
 + 
num_šts
 + 1;

549 
i
=0; i<
num_šts
; i++)

550 
coÜdš©es
[
num_æßts
+1+
i
] = 
šts
[i];

553 
i
 = 0; i < 
num_æßts
; i++)

555 
q¡©e
[
i
] = (è
	`æoÜ
(
æßts
[i] * 
num_tšgs
);

556 
ba£
[
i
] = 0;

557 
w¿p_widths_times_num_tšgs
[
i
] = 
w¿p_widths
[i] * 
num_tšgs
;

561 
j
 = 0; j < 
num_tšgs
; j++)

565 
i
 = 0; i < 
num_æßts
; i++)

569 
coÜdš©es
[
i
] = 
q¡©e
[i] - 
	`mod
(q¡©e[i]-
ba£
[i],
num_tšgs
);

570 ià(
w¿p_widths
[
i
]!=0)

571 
coÜdš©es
[
i
] = coÜdš©es[i] % 
w¿p_widths_times_num_tšgs
[i];

573 
ba£
[
i
] += (1 + (2 * i));

576 
coÜdš©es
[
i
] = 
j
;

578 
tes
[
j
] = 
	`hash_UNH
(
coÜdš©es
, 
num_coÜdš©es
, 
memÜy_size
, 449);

581 
	}
}

583 
	$G‘TesW¿p
(

584 
tes
[],

585 
num_tšgs
,

586 
cŞlisiÚ_bË
 *
ùabË
,

587 
æßts
[],

588 
num_æßts
,

589 
w¿p_widths
[],

590 
šts
[],

591 
num_šts
)

593 
i
,
j
;

594 
q¡©e
[
MAX_NUM_VARS
];

595 
ba£
[
MAX_NUM_VARS
];

596 
w¿p_widths_times_num_tšgs
[
MAX_NUM_VARS
];

597 
coÜdš©es
[
MAX_NUM_VARS
 * 2 + 1];

598 
num_coÜdš©es
 = 
num_æßts
 + 
num_šts
 + 1;

600 
i
=0; i<
num_šts
; i++)

601 
coÜdš©es
[
num_æßts
+1+
i
] = 
šts
[i];

604 
i
 = 0; i < 
num_æßts
; i++)

606 
q¡©e
[
i
] = (è
	`æoÜ
(
æßts
[i] * 
num_tšgs
);

607 
ba£
[
i
] = 0;

608 
w¿p_widths_times_num_tšgs
[
i
] = 
w¿p_widths
[i] * 
num_tšgs
;

612 
j
 = 0; j < 
num_tšgs
; j++)

616 
i
 = 0; i < 
num_æßts
; i++)

620 
coÜdš©es
[
i
] = 
q¡©e
[i] - 
	`mod
(q¡©e[i]-
ba£
[i],
num_tšgs
);

622 ià(
w¿p_widths
[
i
]!=0)

623 
coÜdš©es
[
i
] = 
	`mod
(coÜdš©es[i], 
w¿p_widths_times_num_tšgs
[i]);

625 
ba£
[
i
] += (1 + (2 * i));

628 
coÜdš©es
[
i
] = 
j
;

630 
tes
[
j
] = 
	`hash
(
coÜdš©es
, 
num_coÜdš©es
,
ùabË
);

633 
	}
}

635 
	$G‘TesW¿p
(
tes
[],
num_tšgs
,
memÜy_size
,
æßts
[],

636 
num_æßts
,
w¿p_widths
[])

638 
	`G‘TesW¿p
(
tes
,
num_tšgs
,
memÜy_size
,
æßts
,

639 
num_æßts
,
w¿p_widths
,
i_tmp_¬r
,0);

640 
	}
}

	@player_agents/tiles2.h

1 #iâdeà
_TILES2_H_


2 
	#_TILES2_H_


	)

4 
	~<¡dio.h
>

5 
	~<¡dlib.h
>

6 
	~<fú.h
>

7 
	~<uni¡d.h
>

8 
	~"commÚ_cÚ¡ªts.h
"

11 
	#MAX_NUM_VARS
 20

12 
	#MAX_NUM_COORDS
 100

13 
	#MaxLONGINT
 2147483647

	)

15 
G‘Tes
(

16 
tes
[],

17 
num_tšgs
,

18 
memÜy_size
,

19 
æßts
[],

20 
num_æßts
,

21 
šts
[],

22 
num_šts
);

24 
G‘Tes
(

25 
IÁA¼
* 
tes
,

26 
num_tšgs
,

27 
memÜy_size
,

28 
æßts
[],

29 
num_æßts
,

30 
šts
[],

31 
num_šts
,

32 
off£t
 = 0);

34 şas 
	ccŞlisiÚ_bË
 {

35 
	mpublic
:

36 
cŞlisiÚ_bË
(,);

37 ~
cŞlisiÚ_bË
();

38 
	mm
;

39 *
	md©a
;

40 
	m§ã
;

41 
	mÿÎs
;

42 
	mş—rh™s
;

43 
	mcŞlisiÚs
;

44 
»£t
();

45 
u§ge
();

46 
§ve
();

47 
»¡Üe
();

51 
G‘Tes
(

52 
tes
[],

53 
num_tšgs
,

54 
cŞlisiÚ_bË
 *
ùabË
,

55 
æßts
[],

56 
num_æßts
,

57 
šts
[],

58 
num_šts
);

60 
hash_UNH
(*
šts
, 
num_šts
, 
m
, 
šüem’t
);

61 
hash
(*
šts
, 
num_šts
, 
cŞlisiÚ_bË
 *
ùabË
);

64 
G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
);

65 
G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
);

69 
G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
);

70 
G‘Tes
(
IÁA¼
* 
tes
,
Á
,
memÜy
,
æßts
[],
nf
,
h1
, 
off£t
 = 0);

71 
G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
);

74 
G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
,
h2
);

75 
G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
,
h2
);

78 
G‘Tes
(
tes
[],
Á
,
memÜy
,
æßts
[],
nf
,
h1
,
h2
,
h3
);

79 
G‘Tes
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
æßts
[],
nf
,
h1
,
h2
,
h3
);

82 
G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
);

83 
G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
);

86 
G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
);

87 
G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
);

90 
G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
,
h2
);

91 
G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
,
h2
);

94 
G‘Tes1
(
tes
[],
Á
,
memÜy
,
f1
,
h1
,
h2
,
h3
);

95 
G‘Tes1
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
h1
,
h2
,
h3
);

98 
G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
);

99 
G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
);

102 
G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
);

103 
G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
);

106 
G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
,
h2
);

107 
G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
,
h2
);

110 
G‘Tes2
(
tes
[],
Á
,
memÜy
,
f1
,
f2
,
h1
,
h2
,
h3
);

111 
G‘Tes2
(
tes
[],
Á
,
cŞlisiÚ_bË
 *
ù
,
f1
,
f2
,
h1
,
h2
,
h3
);

113 
G‘TesW¿p
(

114 
tes
[],

115 
num_tšgs
,

116 
memÜy_size
,

117 
æßts
[],

118 
num_æßts
,

119 
w¿p_widths
[],

120 
šts
[],

121 
num_šts
);

123 
G‘TesW¿p
(

124 
tes
[],

125 
num_tšgs
,

126 
cŞlisiÚ_bË
 *
ùabË
,

127 
æßts
[],

128 
num_æßts
,

129 
w¿p_widths
[],

130 
šts
[],

131 
num_šts
);

134 
G‘TesW¿p
(
tes
[],
num_tšgs
,
memÜy_size
,
æßts
[],

135 
num_æßts
,
w¿p_widths
[]);

	@player_agents/tree_node.cpp

16 
	~"Œ“_node.h
"

17 
	~"£¬ch_ag’t.h
"

25 
	gT»eNode
::
	$T»eNode
Ğ
T»eNode
* 
·»Á
, cÚ¡ 
¡ršg
 
¡¬t_¡©e
,

26 
¡¬t_äame_num
,

27 
S—rchAg’t
* 
£¬ch_ag’t
,

28 
num_simuÏ‹_¡•s
, 
AùiÚ
 
a
):

29 
	`p_·»Á
(
·»Á
),

30 
	`¡r_¡©e
(""),

31 
	`i_äame_num
(-1),

32 
	`f_node_»w¬d
(0.0),

33 
	`f_b¿nch_»w¬d
(0.0),

34 
	`i_be¡_b¿nch
(-1),

35 
	`b_is_d—d
(
çl£
),

36 
	`f_uù_v®ue
(0.0),

37 
	`i_uù_vis™_couÁ
(0),

38 
	`i_uù_d—th_couÁ
(0),

39 
	$f_uù_sum_»w¬d
(0.0) {

41 
£¬ch_ag’t
->
	`lßd_¡©e
(
¡¬t_¡©e
);

42 
£¬ch_ag’t
->
	`simuÏ‹_game
(
a
, 
num_simuÏ‹_¡•s
, 
¡¬t_äame_num
,

43 
f_node_»w¬d
, 
b_is_d—d
);

44 
¡r_¡©e
 = 
£¬ch_ag’t
->
	`§ve_¡©e
();

45 
i_äame_num
 = 
¡¬t_äame_num
 + 
num_simuÏ‹_¡•s
;

46 
f_b¿nch_»w¬d
 = 
f_node_»w¬d
;

47 
	}
}

	@player_agents/tree_node.h

16 #iâdeà
TREE_NODE_H


17 
	#TREE_NODE_H


	)

19 
	~"commÚ_cÚ¡ªts.h
"

20 
şass
 
	gS—rchAg’t
;

21 
şass
 
	gT»eNode
;

22 
	gveùÜ
<
	tT»eNode
*> 
	tNodeLi¡
;

24 şas 
	cT»eNode
 {

29 
	mpublic
:

35 
T»eNode
ĞT»eNode* 
·»Á
, cÚ¡ 
¡ršg
 
¡¬t_¡©e
,

36 
¡¬t_äame_num
, 
S—rchAg’t
* 
£¬ch_ag’t
,

37 
num_simuÏ‹_¡•s
, 
AùiÚ
 
a
);

42 
boŞ
 
	$is_Ëaf
() {

43  (
v_chd»n
.
	`em±y
());

46 
¡ršg
 
¡r_¡©e
;

47 
f_node_»w¬d
;

48 
f_b¿nch_»w¬d
;

51 
i_be¡_b¿nch
;

53 
boŞ
 
b_is_d—d
;

55 
i_äame_num
;

56 
NodeLi¡
 
v_chd»n
;

57 
T»eNode
* 
p_·»Á
;

58 
f_uù_v®ue
;

60 
i_uù_vis™_couÁ
;

61 
i_uù_d—th_couÁ
;

63 
f_uù_sum_»w¬d
;

67 
	}
};

	@player_agents/uct_search_tree.cpp

16 
	~"uù_£¬ch_Œ“.h
"

17 
	~"£¬ch_ag’t.h
"

18 
	~"¿ndom_toŞs.h
"

23 
	gUCTS—rchT»e
::
	$UCTS—rchT»e
(
S—rchAg’t
* 
£¬ch_ag’t
) :

24 
	$S—rchT»e
(
£¬ch_ag’t
) {

25 
S‘tšgs
& 
£‰šgs
 = 
p_£¬ch_ag’t
->
p_osy¡em
->
	`£‰šgs
();

26 
i_uù_mÚ‹_ÿ¾o_¡•s
 = 
£‰šgs
.
	`g‘IÁ
("uù_mÚ‹_ÿ¾o_¡•s", 
Œue
);

27 
f_uù_ex¶Ü©iÚ_cÚ¡
 = 
£‰šgs
.
	`g‘Flßt
("uù_ex¶Ü©iÚ_cÚ¡", 
Œue
);

28 
i_uù_mš_d—th_couÁ
 = 
£‰šgs
.
	`g‘IÁ
("uù_mš_d—th_couÁ", 
Œue
);

29 ià(
£‰šgs
.
	`g‘SŒšg
("uù_b¿nch_v®ue_m‘hod", 
Œue
) == "average") {

30 
cout
 << "UCT:akšghav”agv®uoàthchd»n" << 
’dl
;

31 
b_b¿nch_v®ue_av”age
 = 
Œue
;

33 
cout
 << "UCT:akšghmax v®uoàthchd»n" << 
’dl
;

34 
b_b¿nch_v®ue_av”age
 = 
çl£
;

36 
b_avg_»w¬d_³r_äame
 = 
£‰šgs
.
	`g‘BoŞ
("uct_avg_reward_per_frame",

37 
Œue
);

38 ià(
b_avg_»w¬d_³r_äame
) {

39 
cout
 << "UCT: uct_avg_reward_per_frame isrue. " <<

40 "lookšg‡ˆ»w¬d/äame,‚Ù ju¡„ew¬d" << 
’dl
;

42 
	}
}

47 
	gUCTS—rchT»e
::~
	$UCTS—rchT»e
() {

49 
	}
}

54 
UCTS—rchT»e
::
	$bud
ĞcÚ¡ 
¡ršg
 
¡¬t_¡©e
, 
¡¬t_äame_num
) {

55 
	`as£¹
(
p_roÙ
 =ğ
NULL
);

56 
p_roÙ
 = 
Ãw
 
	`T»eNode
(
NULL
, 
¡¬t_¡©e
, 
¡¬t_äame_num
,

57 
p_£¬ch_ag’t
, 0, 
UNDEFINED
);

58 ià(
p_roÙ
->
b_is_d—d
) {

59 
cout
 << "OMG! WE'RE GONNA DIE!! :(Ğ ... f¿me:" << 
¡¬t_äame_num
 << 
’dl
;

60 
	`´št
();

63 
	`ex·nd_node
(
p_roÙ
);

64 
	`upd©e_Œ“
();

65 
is_but
 = 
Œue
;

66 
	}
}

71 
	gUCTS—rchT»e
::
	$upd©e_Œ“
() {

72 
i
 = 0;

73 
Œue
) {

74 
i
++;

75 
	`sšgË_uù_™”©iÚ
();

76 ià(
p_£¬ch_ag’t
->
	`g‘_num_simuÏ‹d_¡•s
() >

77 
i_max_sim_¡•s_³r_Œ“
) {

78 
cout
 << "P”fom»d " << 
i
 << " UCT i‹¿tiÚs" << 
’dl
;

82 
	}
}

88 
	gUCTS—rchT»e
::
	$sšgË_uù_™”©iÚ
() {

89 
T»eNode
* 
cu¼_node
 = 
p_roÙ
;

91 
boŞ
 
do_ex·nd_£Ëùed_node
 = 
Œue
;

92 !
cu¼_node
->
	`is_Ëaf
()) {

94 
z”o_couÁ_chd
 = 
	`g‘_chd_w™h_couÁ_z”o
(
cu¼_node
);

95 ià(
z”o_couÁ_chd
 != -1) {

96 
do_ex·nd_£Ëùed_node
 = 
çl£
;

97 
cu¼_node
 = cu¼_node->
v_chd»n
[
z”o_couÁ_chd
];

99 
be¡_uù_b¿nch
 = 
	`g‘_be¡_b¿nch
(
cu¼_node
, 
Œue
);

100 
cu¼_node
 = cu¼_node->
v_chd»n
[
be¡_uù_b¿nch
];

104 ià(
do_ex·nd_£Ëùed_node
) {

105 
	`ex·nd_node
(
cu¼_node
);

106 
cu¼_node
 = cu¼_node->
v_chd»n
[0];

110 
Ãw_»w¬d
;

111 
boŞ
 
is_d—d
;

112 
	`do_mÚ‹_ÿ¾o
(
cu¼_node
, 
Ãw_»w¬d
, 
is_d—d
);

113 
is_d—d
 = is_d—d || 
cu¼_node
->
b_is_d—d
;

115 ià(
b_avg_»w¬d_³r_äame
) {

116 
äames_äom_roÙ
 = 
cu¼_node
->
i_äame_num
 - 
p_roÙ
->i_frame_num;

117 
	`as£¹
 (
äames_äom_roÙ
 > 0);

118 
äames_äom_roÙ
 +ğ
i_uù_mÚ‹_ÿ¾o_¡•s
;

119 
Ãw_»w¬d
 /ğ
äames_äom_roÙ
;

121 
	`upd©e_v®ues
(
cu¼_node
, 
Ãw_»w¬d
, 
is_d—d
);

123 
	}
}

128 
AùiÚ
 
	gUCTS—rchT»e
::
	$g‘_be¡_aùiÚ
() {

129 
	`as£¹
 (
p_roÙ
 !ğ
NULL
);

130 
be¡_b¿nch
 = 
	`g‘_be¡_b¿nch
(
p_roÙ
, 
çl£
);

131 
T»eNode
* 
be¡_chd
 = 
p_roÙ
->
v_chd»n
[
be¡_b¿nch
];

132 
veùÜ
<> 
be¡_b¿nches
;

133 
be¡_b¿nches
.
	`push_back
(
be¡_b¿nch
);

134 
c
 = 0; c < 
p_roÙ
->
v_chd»n
.
	`size
(); c++) {

135 
T»eNode
* 
cu¼_chd
 = 
p_roÙ
->
v_chd»n
[
c
];

136 ià(
c
 !ğ
be¡_b¿nch
 &&

137 
cu¼_chd
->
f_b¿nch_»w¬d
 =ğ
be¡_chd
->f_branch_reward &&

138 
cu¼_chd
->
b_is_d—d
 =ğ
be¡_chd
->b_is_dead) {

139 
be¡_b¿nches
.
	`push_back
(
c
);

142 ià(
be¡_b¿nches
.
	`size
() > 1) {

144 
cout
 << "¿ndomly choosšg‡ b¿nch‡mÚg " << 
be¡_b¿nches
.
	`size
()

145 << " b¿nches. was: " << 
be¡_b¿nch
 << " - ";

146 
be¡_b¿nch
 = 
	`choiû
(&
be¡_b¿nches
);

147 
cout
 << "i now: " << 
be¡_b¿nch
 << 
’dl
;

149 
p_roÙ
->
i_be¡_b¿nch
 = 
be¡_b¿nch
;

150 
AùiÚ
 
be¡_aù
 = (*
p_£¬ch_ag’t
->
p_game_£‰šgs
->

151 
pv_possibË_aùiÚs
)[
be¡_b¿nch
];

152  
be¡_aù
;

153 
	}
}

159 
	gUCTS—rchT»e
::
	$g‘_chd_w™h_couÁ_z”o
(cÚ¡ 
T»eNode
* 
node
) const {

160 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

161 ià(
node
->
v_chd»n
[
c
]->
i_uù_vis™_couÁ
 == 0) {

162  
c
;

166 
	}
}

173 
	gUCTS—rchT»e
::
	$g‘_be¡_b¿nch
(
T»eNode
* 
node
,

174 
boŞ
 
add_exp_ex¶t_v®
) {

175 
be¡_v®ue
 = 0;

176 
be¡_b¿nch
 = -1;

177 ià(
node
->
v_chd»n
.
	`size
() == 0) {

178 
	`´št
();

179 
û¼
 << "get_best_branch called on‡‚ode with‚o child. frame-num: "

180 << 
node
->
i_äame_num
 << 
’dl
;

181 
	`ex™
(-1);

183 
boŞ
 
®l_chd»n_d—d
 = 
Œue
;

184 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

185 
®l_chd»n_d—d
 =‡Î_chd»n_d—d & 
node
->
v_chd»n
[
c
]->
b_is_d—d
;

187 ià(
®l_chd»n_d—d
) {

193 
node
->
b_is_d—d
 = 
Œue
;

195 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

196 
T»eNode
* 
cu¼_chd
 = 
node
->
v_chd»n
[
c
];

197 ià((!
node
->
b_is_d—d
è&& 
cu¼_chd
->b_is_dead) {

200 
cu¼_v®
 = 
cu¼_chd
->
f_b¿nch_»w¬d
;

201 ià(
add_exp_ex¶t_v®
) {

202 
ex´_ex¶t_v®
 = 
	`log
Ğ()
node
->
i_uù_vis™_couÁ
) /

203 ()(
cu¼_chd
->
i_uù_vis™_couÁ
);

204 
ex´_ex¶t_v®
 = 
	`sq¹
(expr_explt_val);

208 
cu¼_v®
 +ğ
f_uù_ex¶Ü©iÚ_cÚ¡
 * 
ex´_ex¶t_v®
;

210 ià(
be¡_b¿nch
 == -1 ||

211 
cu¼_v®
 > 
be¡_v®ue
) {

212 
be¡_v®ue
 = 
cu¼_v®
;

213 
be¡_b¿nch
 = 
c
;

216 ià(
be¡_b¿nch
 == -1) {

218 
û¼
 << "Best-branch is -1 for Node with i_frame = "

219 << 
node
->
i_äame_num
 << 
’dl


220 << "PrštšghŒ“ s¹šg fromhgiv’‚ode: " << 
’dl
;

221 
	`´št
(
cÚ¡_ÿ¡
<
T»eNode
 *>(
node
));

222 
	`ex™
(-1);

224  
be¡_b¿nch
;

225 
	}
}

231 
	gUCTS—rchT»e
::
	$ex·nd_node
(
T»eNode
* 
node
) {

232 
	`as£¹
(
node
->
	`is_Ëaf
());

233 
a
 = 0;‡ < 
p_£¬ch_ag’t
->
i_num_aùiÚs
;‡++) {

234 
AùiÚ
 
aù
 = (*
p_£¬ch_ag’t
->
p_game_£‰šgs
->
pv_possibË_aùiÚs
)[
a
];

235 
T»eNode
* 
Ãw_chd
 = 
Ãw
 
	`T»eNode
Ğ
node
,

236 
node
->
¡r_¡©e
,

237 
node
->
i_äame_num
,

238 
p_£¬ch_ag’t
,

239 
i_sim_¡•s_³r_node
,

240 
aù
);

241 
node
->
v_chd»n
.
	`push_back
(
Ãw_chd
);

242 ià(
Ãw_chd
->
i_äame_num
 > 
i_d“³¡_node_äame_num
) {

243 
i_d“³¡_node_äame_num
 = 
Ãw_chd
->
i_äame_num
;

245 ià(
b_avg_»w¬d_³r_äame
) {

246 
äames_äom_roÙ
 = 
Ãw_chd
->
i_äame_num
 - 
p_roÙ
->i_frame_num;

247 
	`as£¹
 (
äames_äom_roÙ
 > 0);

248 
Ãw_chd
->
f_node_»w¬d
 /ğ
äames_äom_roÙ
;

249 
Ãw_chd
->
f_b¿nch_»w¬d
 /ğ
äames_äom_roÙ
;

252 
	}
}

260 
	gUCTS—rchT»e
::
	$do_mÚ‹_ÿ¾o
(
T»eNode
* 
¡¬t_node
,

261 & 
»w¬d
, 
boŞ
& 
is_d—d
) {

262 
p_£¬ch_ag’t
->
	`lßd_¡©e
(
¡¬t_node
->
¡r_¡©e
);

263 
p_£¬ch_ag’t
->
	`simuÏ‹_game
(
RANDOM
, 
i_uù_mÚ‹_ÿ¾o_¡•s
,

264 
¡¬t_node
->
i_äame_num
,

265 
»w¬d
, 
is_d—d
);

267 
	}
}

272 
	gUCTS—rchT»e
::
	$upd©e_v®ues
(
T»eNode
* 
node
, 
»w¬d
, 
boŞ
 
is_d—d
) {

273 
node
 !ğ
NULL
) {

274 
node
->
i_uù_vis™_couÁ
++;

275 ià(
is_d—d
) {

276 
node
->
i_uù_d—th_couÁ
++;

277 ià(
node
->
i_uù_d—th_couÁ
 >ğ
i_uù_mš_d—th_couÁ
 &&

278 
node
->
i_uù_d—th_couÁ
 =ğnode->
i_uù_vis™_couÁ
) {

280 
node
->
b_is_d—d
 = 
Œue
;

283 
node
->
b_is_d—d
 = 
çl£
;

286 ià(
node
->
i_uù_vis™_couÁ
 == 1) {

287 
node
->
f_b¿nch_»w¬d
 = 0;

288 
node
->
f_uù_sum_»w¬d
 = 
»w¬d
;

290 ià(
b_b¿nch_v®ue_av”age
) {

292 
node
->
f_uù_sum_»w¬d
 +ğ
»w¬d
;

293 
node
->
f_b¿nch_»w¬d
 =

294 
node
->
f_uù_sum_»w¬d
 /‚ode->
i_uù_vis™_couÁ
;

297 ià(
node
->
i_uù_d—th_couÁ
 < 
i_uù_mš_d—th_couÁ
 ||

298 
node
->
b_is_d—d
 =ğ
is_d—d
) {

299 
node
->
f_b¿nch_»w¬d
 = 
	`max
(node->f_branch_reward,

300 
node
->
f_node_»w¬d
 + 
»w¬d
);

304 
node
->
f_b¿nch_»w¬d
 +ğnode->
f_node_»w¬d
;

305 
»w¬d
 = 
node
->
f_b¿nch_»w¬d
;

306 
node
 =‚ode->
p_·»Á
;

307 
»w¬d
 *ğ
f_discouÁ_çùÜ
;

309 
	}
}

316 
	gUCTS—rchT»e
::
	$´št
(
T»eNode
* 
node
) const {

317 ià(
node
 =ğ
NULL
) {

318 
node
 = 
p_roÙ
;

320 
queue
<
T»eNode
*> 
q
;

321 
q
.
	`push
(
node
);

322 
cu¼_Ëv–
 = 0;

323 
û¼
 << "(i_uct_visit_count, f_branch_reward, i_uct_death_count, "

324 << "b_is_d—d)" << 
’dl
;

325 !
q
.
	`em±y
()) {

326 
T»eNode
* 
node
 = 
q
.
	`äÚt
();

327 
q
.
	`pİ
();

328 
	`as£¹
 (!(
node
->
i_äame_num
 < 
cu¼_Ëv–
));

329 ià(
node
->
i_äame_num
 > 
cu¼_Ëv–
) {

330 
cu¼_Ëv–
 = 
node
->
i_äame_num
;

331 
û¼
 << 
’dl
 << 
cu¼_Ëv–
 << ": ";

333 
û¼
 << "(" << 
node
->
i_uù_vis™_couÁ
 << ","

334 << 
node
->
f_b¿nch_»w¬d
 << ","

335 << 
node
->
i_uù_d—th_couÁ
 << ","

336 << 
node
->
b_is_d—d
 << "),";

337 
c
 = 0; c < 
node
->
v_chd»n
.
	`size
(); c++) {

338 
q
.
	`push
(
node
->
v_chd»n
[
c
]);

341 
cout
 << 
’dl
;

342 
	}
}

	@player_agents/uct_search_tree.h

16 #iâdeà
UCT_SEARCH_TREE_H


17 
	#UCT_SEARCH_TREE_H


	)

19 
	~"£¬ch_Œ“.h
"

23 şas 
	cUCTS—rchT»e
 : 
public
 
S—rchT»e
 {

29 
public
:

33 
UCTS—rchT»e
(
S—rchAg’t
* 
£¬ch_ag’t
);

38 
	mvœtu®
 ~
UCTS—rchT»e
();

43 
vœtu®
 
bud
ĞcÚ¡ 
¡ršg
 
¡¬t_¡©e
, 
¡¬t_äame_num
);

48 
vœtu®
 
upd©e_Œ“
();

53 
vœtu®
 
AùiÚ
 
g‘_be¡_aùiÚ
();

59 
vœtu®
 
	$´št
(
T»eNode
* 
node
 = 
NULL
) const;

61 
´Ùeùed
:

66 
vœtu®
 
	`sšgË_uù_™”©iÚ
();

72 
	$g‘_chd_w™h_couÁ_z”o
(cÚ¡ 
T»eNode
* 
node
) const;

79 
	`g‘_be¡_b¿nch
(
T»eNode
* 
node
, 
boŞ
 
add_exp_ex¶t_v®
);

84 
	`ex·nd_node
(
T»eNode
* 
node
);

90 
	`do_mÚ‹_ÿ¾o
(
T»eNode
* 
¡¬t_node
, & 
»w¬d
, 
boŞ
& 
is_d—d
);

96 
	`upd©e_v®ues
(
T»eNode
* 
node
, 
»w¬d
, 
boŞ
 
is_d—d
);

99 
i_uù_mÚ‹_ÿ¾o_¡•s
;

101 
f_uù_ex¶Ü©iÚ_cÚ¡
;

102 
i_uù_mš_d—th_couÁ
;

105 
boŞ
 
b_b¿nch_v®ue_av”age
;

108 
boŞ
 
b_avg_»w¬d_³r_äame
;

	@
1
.
0
207
5002
common/Array.hxx
common/GuiUtils.hxx
common/RectList.cxx
common/RectList.hxx
common/SoundNull.cxx
common/SoundNull.hxx
common/SoundSDL.cxx
common/SoundSDL.hxx
common/Version.hxx
common/VideoModeList.hxx
common/export_screen.cpp
common/export_screen.h
common/export_tools.h
common/misc_tools.h
common/random_tools.h
common/vector_matrix_tools.cpp
common/vector_matrix_tools.h
control/fifo_controller.cpp
control/fifo_controller.h
control/game_controller.cpp
control/game_controller.h
control/internal_controller.cpp
control/internal_controller.h
emucore/AtariVox.cxx
emucore/AtariVox.hxx
emucore/Booster.cxx
emucore/Booster.hxx
emucore/Cart.cxx
emucore/Cart.hxx
emucore/Cart0840.cxx
emucore/Cart0840.hxx
emucore/Cart2K.cxx
emucore/Cart2K.hxx
emucore/Cart3E.cxx
emucore/Cart3E.hxx
emucore/Cart3F.cxx
emucore/Cart3F.hxx
emucore/Cart4A50.cxx
emucore/Cart4A50.hxx
emucore/Cart4K.cxx
emucore/Cart4K.hxx
emucore/CartAR.cxx
emucore/CartAR.hxx
emucore/CartCV.cxx
emucore/CartCV.hxx
emucore/CartDPC.cxx
emucore/CartDPC.hxx
emucore/CartE0.cxx
emucore/CartE0.hxx
emucore/CartE7.cxx
emucore/CartE7.hxx
emucore/CartF4.cxx
emucore/CartF4.hxx
emucore/CartF4SC.cxx
emucore/CartF4SC.hxx
emucore/CartF6.cxx
emucore/CartF6.hxx
emucore/CartF6SC.cxx
emucore/CartF6SC.hxx
emucore/CartF8.cxx
emucore/CartF8.hxx
emucore/CartF8SC.cxx
emucore/CartF8SC.hxx
emucore/CartFASC.cxx
emucore/CartFASC.hxx
emucore/CartFE.cxx
emucore/CartFE.hxx
emucore/CartMB.cxx
emucore/CartMB.hxx
emucore/CartMC.cxx
emucore/CartMC.hxx
emucore/CartUA.cxx
emucore/CartUA.hxx
emucore/Console.cxx
emucore/Console.hxx
emucore/Control.cxx
emucore/Control.hxx
emucore/DefProps.hxx
emucore/Deserializer.cxx
emucore/Deserializer.hxx
emucore/Driving.cxx
emucore/Driving.hxx
emucore/Event.cxx
emucore/Event.hxx
emucore/EventStreamer.cxx
emucore/EventStreamer.hxx
emucore/FSNode.cxx
emucore/FSNode.hxx
emucore/Joystick.cxx
emucore/Joystick.hxx
emucore/Keyboard.cxx
emucore/Keyboard.hxx
emucore/M6532.cxx
emucore/M6532.hxx
emucore/MD5.cxx
emucore/MD5.hxx
emucore/MediaSrc.cxx
emucore/MediaSrc.hxx
emucore/OSystem.cxx
emucore/OSystem.hxx
emucore/Paddles.cxx
emucore/Paddles.hxx
emucore/Props.cxx
emucore/Props.hxx
emucore/PropsSet.cxx
emucore/PropsSet.hxx
emucore/Random.cxx
emucore/Random.hxx
emucore/Serializer.cxx
emucore/Serializer.hxx
emucore/Settings.cxx
emucore/Settings.hxx
emucore/Sound.hxx
emucore/SpeakJet.cxx
emucore/SpeakJet.hxx
emucore/Switches.cxx
emucore/Switches.hxx
emucore/TIA.cxx
emucore/TIA.hxx
emucore/TIASnd.cxx
emucore/TIASnd.hxx
emucore/m6502/src/Device.cxx
emucore/m6502/src/Device.hxx
emucore/m6502/src/M6502.cxx
emucore/m6502/src/M6502.hxx
emucore/m6502/src/M6502Hi.cxx
emucore/m6502/src/M6502Hi.hxx
emucore/m6502/src/M6502Low.cxx
emucore/m6502/src/M6502Low.hxx
emucore/m6502/src/NullDev.cxx
emucore/m6502/src/NullDev.hxx
emucore/m6502/src/System.cxx
emucore/m6502/src/System.hxx
emucore/m6502/src/bspf/src/bspf.hxx
emucore/rsynth/config.h
emucore/rsynth/darray.c
emucore/rsynth/darray.h
emucore/rsynth/elements.c
emucore/rsynth/holmes.c
emucore/rsynth/opsynth.c
emucore/rsynth/phfeat.h
emucore/rsynth/phones.c
emucore/rsynth/phones.h
emucore/rsynth/phtoelm.c
emucore/rsynth/phtoelm.h
emucore/rsynth/rsynth.h
emucore/rsynth/trie.c
emucore/rsynth/trie.h
emucore/rsynth/useconfig.h
emucore/unzip.c
emucore/unzip.h
main.cpp
os_dependent/FSNodePOSIX.cxx
os_dependent/OSystemUNIX.cxx
os_dependent/OSystemUNIX.hxx
os_dependent/SettingsUNIX.cxx
os_dependent/SettingsUNIX.hxx
player_agents/actions_summary_agent.cpp
player_agents/actions_summary_agent.h
player_agents/background_detector.cpp
player_agents/background_detector.h
player_agents/blob_class.cpp
player_agents/blob_class.h
player_agents/blob_object.cpp
player_agents/blob_object.h
player_agents/class_agent.cpp
player_agents/class_agent.h
player_agents/class_discovery.cpp
player_agents/class_discovery.h
player_agents/class_shape.cpp
player_agents/class_shape.h
player_agents/common_constants.cpp
player_agents/common_constants.h
player_agents/freeway_agent.cpp
player_agents/freeway_agent.h
player_agents/full_search_tree.cpp
player_agents/full_search_tree.h
player_agents/game_settings.cpp
player_agents/game_settings.h
player_agents/grid_screen_agent.cpp
player_agents/grid_screen_agent.h
player_agents/mountain_car_test.cpp
player_agents/mountain_car_test.h
player_agents/player_agent.cpp
player_agents/player_agent.h
player_agents/ram_agent.cpp
player_agents/ram_agent.h
player_agents/random_agent.cpp
player_agents/random_agent.h
player_agents/region_manager.cpp
player_agents/region_manager.h
player_agents/rl_sarsa_lambda.cpp
player_agents/rl_sarsa_lambda.h
player_agents/search_agent.cpp
player_agents/search_agent.h
player_agents/search_tree.cpp
player_agents/search_tree.h
player_agents/shape_tools.cpp
player_agents/shape_tools.h
player_agents/single_action_agent.cpp
player_agents/single_action_agent.h
player_agents/tiles2.cpp
player_agents/tiles2.h
player_agents/tree_node.cpp
player_agents/tree_node.h
player_agents/uct_search_tree.cpp
player_agents/uct_search_tree.h
